function UV(i,s){for(var h=0;h<s.length;h++){const f=s[h];if(typeof f!="string"&&!Array.isArray(f)){for(const g in f)if(g!=="default"&&!(g in i)){const y=Object.getOwnPropertyDescriptor(f,g);y&&Object.defineProperty(i,g,y.get?y:{enumerable:!0,get:()=>f[g]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))f(g);new MutationObserver(g=>{for(const y of g)if(y.type==="childList")for(const b of y.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&f(b)}).observe(document,{childList:!0,subtree:!0});function h(g){const y={};return g.integrity&&(y.integrity=g.integrity),g.referrerPolicy&&(y.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?y.credentials="include":g.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function f(g){if(g.ep)return;g.ep=!0;const y=h(g);fetch(g.href,y)}})();var ki=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $p(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function q3(i){if(i.__esModule)return i;var s=i.default;if(typeof s=="function"){var h=function f(){return this instanceof f?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};h.prototype=s.prototype}else h={};return Object.defineProperty(h,"__esModule",{value:!0}),Object.keys(i).forEach(function(f){var g=Object.getOwnPropertyDescriptor(i,f);Object.defineProperty(h,f,g.get?g:{enumerable:!0,get:function(){return i[f]}})}),h}var H3={exports:{}},Gy={},Z3={exports:{}},Yn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vp=Symbol.for("react.element"),$V=Symbol.for("react.portal"),VV=Symbol.for("react.fragment"),GV=Symbol.for("react.strict_mode"),WV=Symbol.for("react.profiler"),qV=Symbol.for("react.provider"),HV=Symbol.for("react.context"),ZV=Symbol.for("react.forward_ref"),XV=Symbol.for("react.suspense"),KV=Symbol.for("react.memo"),YV=Symbol.for("react.lazy"),dO=Symbol.iterator;function QV(i){return i===null||typeof i!="object"?null:(i=dO&&i[dO]||i["@@iterator"],typeof i=="function"?i:null)}var X3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},K3=Object.assign,Y3={};function _d(i,s,h){this.props=i,this.context=s,this.refs=Y3,this.updater=h||X3}_d.prototype.isReactComponent={};_d.prototype.setState=function(i,s){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,s,"setState")};_d.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function Q3(){}Q3.prototype=_d.prototype;function NT(i,s,h){this.props=i,this.context=s,this.refs=Y3,this.updater=h||X3}var jT=NT.prototype=new Q3;jT.constructor=NT;K3(jT,_d.prototype);jT.isPureReactComponent=!0;var fO=Array.isArray,J3=Object.prototype.hasOwnProperty,UT={current:null},tz={key:!0,ref:!0,__self:!0,__source:!0};function ez(i,s,h){var f,g={},y=null,b=null;if(s!=null)for(f in s.ref!==void 0&&(b=s.ref),s.key!==void 0&&(y=""+s.key),s)J3.call(s,f)&&!tz.hasOwnProperty(f)&&(g[f]=s[f]);var M=arguments.length-2;if(M===1)g.children=h;else if(1<M){for(var E=Array(M),C=0;C<M;C++)E[C]=arguments[C+2];g.children=E}if(i&&i.defaultProps)for(f in M=i.defaultProps,M)g[f]===void 0&&(g[f]=M[f]);return{$$typeof:Vp,type:i,key:y,ref:b,props:g,_owner:UT.current}}function JV(i,s){return{$$typeof:Vp,type:i.type,key:s,ref:i.ref,props:i.props,_owner:i._owner}}function $T(i){return typeof i=="object"&&i!==null&&i.$$typeof===Vp}function tG(i){var s={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(h){return s[h]})}var pO=/\/+/g;function Rb(i,s){return typeof i=="object"&&i!==null&&i.key!=null?tG(""+i.key):s.toString(36)}function O_(i,s,h,f,g){var y=typeof i;(y==="undefined"||y==="boolean")&&(i=null);var b=!1;if(i===null)b=!0;else switch(y){case"string":case"number":b=!0;break;case"object":switch(i.$$typeof){case Vp:case $V:b=!0}}if(b)return b=i,g=g(b),i=f===""?"."+Rb(b,0):f,fO(g)?(h="",i!=null&&(h=i.replace(pO,"$&/")+"/"),O_(g,s,h,"",function(C){return C})):g!=null&&($T(g)&&(g=JV(g,h+(!g.key||b&&b.key===g.key?"":(""+g.key).replace(pO,"$&/")+"/")+i)),s.push(g)),1;if(b=0,f=f===""?".":f+":",fO(i))for(var M=0;M<i.length;M++){y=i[M];var E=f+Rb(y,M);b+=O_(y,s,h,E,g)}else if(E=QV(i),typeof E=="function")for(i=E.call(i),M=0;!(y=i.next()).done;)y=y.value,E=f+Rb(y,M++),b+=O_(y,s,h,E,g);else if(y==="object")throw s=String(i),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return b}function i_(i,s,h){if(i==null)return i;var f=[],g=0;return O_(i,f,"","",function(y){return s.call(h,y,g++)}),f}function eG(i){if(i._status===-1){var s=i._result;s=s(),s.then(function(h){(i._status===0||i._status===-1)&&(i._status=1,i._result=h)},function(h){(i._status===0||i._status===-1)&&(i._status=2,i._result=h)}),i._status===-1&&(i._status=0,i._result=s)}if(i._status===1)return i._result.default;throw i._result}var go={current:null},L_={transition:null},nG={ReactCurrentDispatcher:go,ReactCurrentBatchConfig:L_,ReactCurrentOwner:UT};Yn.Children={map:i_,forEach:function(i,s,h){i_(i,function(){s.apply(this,arguments)},h)},count:function(i){var s=0;return i_(i,function(){s++}),s},toArray:function(i){return i_(i,function(s){return s})||[]},only:function(i){if(!$T(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};Yn.Component=_d;Yn.Fragment=VV;Yn.Profiler=WV;Yn.PureComponent=NT;Yn.StrictMode=GV;Yn.Suspense=XV;Yn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nG;Yn.cloneElement=function(i,s,h){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var f=K3({},i.props),g=i.key,y=i.ref,b=i._owner;if(s!=null){if(s.ref!==void 0&&(y=s.ref,b=UT.current),s.key!==void 0&&(g=""+s.key),i.type&&i.type.defaultProps)var M=i.type.defaultProps;for(E in s)J3.call(s,E)&&!tz.hasOwnProperty(E)&&(f[E]=s[E]===void 0&&M!==void 0?M[E]:s[E])}var E=arguments.length-2;if(E===1)f.children=h;else if(1<E){M=Array(E);for(var C=0;C<E;C++)M[C]=arguments[C+2];f.children=M}return{$$typeof:Vp,type:i.type,key:g,ref:y,props:f,_owner:b}};Yn.createContext=function(i){return i={$$typeof:HV,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:qV,_context:i},i.Consumer=i};Yn.createElement=ez;Yn.createFactory=function(i){var s=ez.bind(null,i);return s.type=i,s};Yn.createRef=function(){return{current:null}};Yn.forwardRef=function(i){return{$$typeof:ZV,render:i}};Yn.isValidElement=$T;Yn.lazy=function(i){return{$$typeof:YV,_payload:{_status:-1,_result:i},_init:eG}};Yn.memo=function(i,s){return{$$typeof:KV,type:i,compare:s===void 0?null:s}};Yn.startTransition=function(i){var s=L_.transition;L_.transition={};try{i()}finally{L_.transition=s}};Yn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Yn.useCallback=function(i,s){return go.current.useCallback(i,s)};Yn.useContext=function(i){return go.current.useContext(i)};Yn.useDebugValue=function(){};Yn.useDeferredValue=function(i){return go.current.useDeferredValue(i)};Yn.useEffect=function(i,s){return go.current.useEffect(i,s)};Yn.useId=function(){return go.current.useId()};Yn.useImperativeHandle=function(i,s,h){return go.current.useImperativeHandle(i,s,h)};Yn.useInsertionEffect=function(i,s){return go.current.useInsertionEffect(i,s)};Yn.useLayoutEffect=function(i,s){return go.current.useLayoutEffect(i,s)};Yn.useMemo=function(i,s){return go.current.useMemo(i,s)};Yn.useReducer=function(i,s,h){return go.current.useReducer(i,s,h)};Yn.useRef=function(i){return go.current.useRef(i)};Yn.useState=function(i){return go.current.useState(i)};Yn.useSyncExternalStore=function(i,s,h){return go.current.useSyncExternalStore(i,s,h)};Yn.useTransition=function(){return go.current.useTransition()};Yn.version="18.2.0";Z3.exports=Yn;var lt=Z3.exports;const Xr=$p(lt),ny=UV({__proto__:null,default:Xr},[lt]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rG=lt,iG=Symbol.for("react.element"),oG=Symbol.for("react.fragment"),sG=Object.prototype.hasOwnProperty,aG=rG.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,lG={key:!0,ref:!0,__self:!0,__source:!0};function nz(i,s,h){var f,g={},y=null,b=null;h!==void 0&&(y=""+h),s.key!==void 0&&(y=""+s.key),s.ref!==void 0&&(b=s.ref);for(f in s)sG.call(s,f)&&!lG.hasOwnProperty(f)&&(g[f]=s[f]);if(i&&i.defaultProps)for(f in s=i.defaultProps,s)g[f]===void 0&&(g[f]=s[f]);return{$$typeof:iG,type:i,key:y,ref:b,props:g,_owner:aG.current}}Gy.Fragment=oG;Gy.jsx=nz;Gy.jsxs=nz;H3.exports=Gy;var rt=H3.exports,rz={exports:{}},es={},iz={exports:{}},oz={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function s(Et,$t){var ee=Et.length;Et.push($t);t:for(;0<ee;){var Ee=ee-1>>>1,jt=Et[Ee];if(0<g(jt,$t))Et[Ee]=$t,Et[ee]=jt,ee=Ee;else break t}}function h(Et){return Et.length===0?null:Et[0]}function f(Et){if(Et.length===0)return null;var $t=Et[0],ee=Et.pop();if(ee!==$t){Et[0]=ee;t:for(var Ee=0,jt=Et.length,Le=jt>>>1;Ee<Le;){var we=2*(Ee+1)-1,kt=Et[we],Xt=we+1,Ot=Et[Xt];if(0>g(kt,ee))Xt<jt&&0>g(Ot,kt)?(Et[Ee]=Ot,Et[Xt]=ee,Ee=Xt):(Et[Ee]=kt,Et[we]=ee,Ee=we);else if(Xt<jt&&0>g(Ot,ee))Et[Ee]=Ot,Et[Xt]=ee,Ee=Xt;else break t}}return $t}function g(Et,$t){var ee=Et.sortIndex-$t.sortIndex;return ee!==0?ee:Et.id-$t.id}if(typeof performance=="object"&&typeof performance.now=="function"){var y=performance;i.unstable_now=function(){return y.now()}}else{var b=Date,M=b.now();i.unstable_now=function(){return b.now()-M}}var E=[],C=[],L=1,B=null,z=3,H=!1,U=!1,q=!1,tt=typeof setTimeout=="function"?setTimeout:null,V=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(Et){for(var $t=h(C);$t!==null;){if($t.callback===null)f(C);else if($t.startTime<=Et)f(C),$t.sortIndex=$t.expirationTime,s(E,$t);else break;$t=h(C)}}function $(Et){if(q=!1,D(Et),!U)if(h(E)!==null)U=!0,Vt(J);else{var $t=h(C);$t!==null&&ne($,$t.startTime-Et)}}function J(Et,$t){U=!1,q&&(q=!1,V(yt),yt=-1),H=!0;var ee=z;try{for(D($t),B=h(E);B!==null&&(!(B.expirationTime>$t)||Et&&!et());){var Ee=B.callback;if(typeof Ee=="function"){B.callback=null,z=B.priorityLevel;var jt=Ee(B.expirationTime<=$t);$t=i.unstable_now(),typeof jt=="function"?B.callback=jt:B===h(E)&&f(E),D($t)}else f(E);B=h(E)}if(B!==null)var Le=!0;else{var we=h(C);we!==null&&ne($,we.startTime-$t),Le=!1}return Le}finally{B=null,z=ee,H=!1}}var ct=!1,st=null,yt=-1,ut=5,N=-1;function et(){return!(i.unstable_now()-N<ut)}function Mt(){if(st!==null){var Et=i.unstable_now();N=Et;var $t=!0;try{$t=st(!0,Et)}finally{$t?Lt():(ct=!1,st=null)}}else ct=!1}var Lt;if(typeof F=="function")Lt=function(){F(Mt)};else if(typeof MessageChannel<"u"){var it=new MessageChannel,Tt=it.port2;it.port1.onmessage=Mt,Lt=function(){Tt.postMessage(null)}}else Lt=function(){tt(Mt,0)};function Vt(Et){st=Et,ct||(ct=!0,Lt())}function ne(Et,$t){yt=tt(function(){Et(i.unstable_now())},$t)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Et){Et.callback=null},i.unstable_continueExecution=function(){U||H||(U=!0,Vt(J))},i.unstable_forceFrameRate=function(Et){0>Et||125<Et?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ut=0<Et?Math.floor(1e3/Et):5},i.unstable_getCurrentPriorityLevel=function(){return z},i.unstable_getFirstCallbackNode=function(){return h(E)},i.unstable_next=function(Et){switch(z){case 1:case 2:case 3:var $t=3;break;default:$t=z}var ee=z;z=$t;try{return Et()}finally{z=ee}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(Et,$t){switch(Et){case 1:case 2:case 3:case 4:case 5:break;default:Et=3}var ee=z;z=Et;try{return $t()}finally{z=ee}},i.unstable_scheduleCallback=function(Et,$t,ee){var Ee=i.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?Ee+ee:Ee):ee=Ee,Et){case 1:var jt=-1;break;case 2:jt=250;break;case 5:jt=1073741823;break;case 4:jt=1e4;break;default:jt=5e3}return jt=ee+jt,Et={id:L++,callback:$t,priorityLevel:Et,startTime:ee,expirationTime:jt,sortIndex:-1},ee>Ee?(Et.sortIndex=ee,s(C,Et),h(E)===null&&Et===h(C)&&(q?(V(yt),yt=-1):q=!0,ne($,ee-Ee))):(Et.sortIndex=jt,s(E,Et),U||H||(U=!0,Vt(J))),Et},i.unstable_shouldYield=et,i.unstable_wrapCallback=function(Et){var $t=z;return function(){var ee=z;z=$t;try{return Et.apply(this,arguments)}finally{z=ee}}}})(oz);iz.exports=oz;var cG=iz.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sz=lt,ts=cG;function Se(i){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+i,h=1;h<arguments.length;h++)s+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var az=new Set,_p={};function vu(i,s){ed(i,s),ed(i+"Capture",s)}function ed(i,s){for(_p[i]=s,i=0;i<s.length;i++)az.add(s[i])}var Qa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sw=Object.prototype.hasOwnProperty,uG=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,mO={},gO={};function hG(i){return Sw.call(gO,i)?!0:Sw.call(mO,i)?!1:uG.test(i)?gO[i]=!0:(mO[i]=!0,!1)}function dG(i,s,h,f){if(h!==null&&h.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return f?!1:h!==null?!h.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function fG(i,s,h,f){if(s===null||typeof s>"u"||dG(i,s,h,f))return!0;if(f)return!1;if(h!==null)switch(h.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function _o(i,s,h,f,g,y,b){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=f,this.attributeNamespace=g,this.mustUseProperty=h,this.propertyName=i,this.type=s,this.sanitizeURL=y,this.removeEmptyString=b}var qi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){qi[i]=new _o(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var s=i[0];qi[s]=new _o(s,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){qi[i]=new _o(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){qi[i]=new _o(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){qi[i]=new _o(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){qi[i]=new _o(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){qi[i]=new _o(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){qi[i]=new _o(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){qi[i]=new _o(i,5,!1,i.toLowerCase(),null,!1,!1)});var VT=/[\-:]([a-z])/g;function GT(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var s=i.replace(VT,GT);qi[s]=new _o(s,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var s=i.replace(VT,GT);qi[s]=new _o(s,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var s=i.replace(VT,GT);qi[s]=new _o(s,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){qi[i]=new _o(i,1,!1,i.toLowerCase(),null,!1,!1)});qi.xlinkHref=new _o("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){qi[i]=new _o(i,1,!1,i.toLowerCase(),null,!0,!0)});function WT(i,s,h,f){var g=qi.hasOwnProperty(s)?qi[s]:null;(g!==null?g.type!==0:f||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(fG(s,h,g,f)&&(h=null),f||g===null?hG(s)&&(h===null?i.removeAttribute(s):i.setAttribute(s,""+h)):g.mustUseProperty?i[g.propertyName]=h===null?g.type===3?!1:"":h:(s=g.attributeName,f=g.attributeNamespace,h===null?i.removeAttribute(s):(g=g.type,h=g===3||g===4&&h===!0?"":""+h,f?i.setAttributeNS(f,s,h):i.setAttribute(s,h))))}var nl=sz.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,o_=Symbol.for("react.element"),Ph=Symbol.for("react.portal"),Rh=Symbol.for("react.fragment"),qT=Symbol.for("react.strict_mode"),Ew=Symbol.for("react.profiler"),lz=Symbol.for("react.provider"),cz=Symbol.for("react.context"),HT=Symbol.for("react.forward_ref"),Cw=Symbol.for("react.suspense"),Mw=Symbol.for("react.suspense_list"),ZT=Symbol.for("react.memo"),Vl=Symbol.for("react.lazy"),uz=Symbol.for("react.offscreen"),_O=Symbol.iterator;function Lf(i){return i===null||typeof i!="object"?null:(i=_O&&i[_O]||i["@@iterator"],typeof i=="function"?i:null)}var ni=Object.assign,kb;function Yf(i){if(kb===void 0)try{throw Error()}catch(h){var s=h.stack.trim().match(/\n( *(at )?)/);kb=s&&s[1]||""}return`
`+kb+i}var Ob=!1;function Lb(i,s){if(!i||Ob)return"";Ob=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(C){var f=C}Reflect.construct(i,[],s)}else{try{s.call()}catch(C){f=C}i.call(s.prototype)}else{try{throw Error()}catch(C){f=C}i()}}catch(C){if(C&&f&&typeof C.stack=="string"){for(var g=C.stack.split(`
`),y=f.stack.split(`
`),b=g.length-1,M=y.length-1;1<=b&&0<=M&&g[b]!==y[M];)M--;for(;1<=b&&0<=M;b--,M--)if(g[b]!==y[M]){if(b!==1||M!==1)do if(b--,M--,0>M||g[b]!==y[M]){var E=`
`+g[b].replace(" at new "," at ");return i.displayName&&E.includes("<anonymous>")&&(E=E.replace("<anonymous>",i.displayName)),E}while(1<=b&&0<=M);break}}}finally{Ob=!1,Error.prepareStackTrace=h}return(i=i?i.displayName||i.name:"")?Yf(i):""}function pG(i){switch(i.tag){case 5:return Yf(i.type);case 16:return Yf("Lazy");case 13:return Yf("Suspense");case 19:return Yf("SuspenseList");case 0:case 2:case 15:return i=Lb(i.type,!1),i;case 11:return i=Lb(i.type.render,!1),i;case 1:return i=Lb(i.type,!0),i;default:return""}}function Iw(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Rh:return"Fragment";case Ph:return"Portal";case Ew:return"Profiler";case qT:return"StrictMode";case Cw:return"Suspense";case Mw:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case cz:return(i.displayName||"Context")+".Consumer";case lz:return(i._context.displayName||"Context")+".Provider";case HT:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case ZT:return s=i.displayName||null,s!==null?s:Iw(i.type)||"Memo";case Vl:s=i._payload,i=i._init;try{return Iw(i(s))}catch{}}return null}function mG(i){var s=i.type;switch(i.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=s.render,i=i.displayName||i.name||"",s.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Iw(s);case 8:return s===qT?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function sc(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function hz(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function gG(i){var s=hz(i)?"checked":"value",h=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),f=""+i[s];if(!i.hasOwnProperty(s)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var g=h.get,y=h.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return g.call(this)},set:function(b){f=""+b,y.call(this,b)}}),Object.defineProperty(i,s,{enumerable:h.enumerable}),{getValue:function(){return f},setValue:function(b){f=""+b},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function s_(i){i._valueTracker||(i._valueTracker=gG(i))}function dz(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var h=s.getValue(),f="";return i&&(f=hz(i)?i.checked?"true":"false":i.value),i=f,i!==h?(s.setValue(i),!0):!1}function ry(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Aw(i,s){var h=s.checked;return ni({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??i._wrapperState.initialChecked})}function yO(i,s){var h=s.defaultValue==null?"":s.defaultValue,f=s.checked!=null?s.checked:s.defaultChecked;h=sc(s.value!=null?s.value:h),i._wrapperState={initialChecked:f,initialValue:h,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function fz(i,s){s=s.checked,s!=null&&WT(i,"checked",s,!1)}function Pw(i,s){fz(i,s);var h=sc(s.value),f=s.type;if(h!=null)f==="number"?(h===0&&i.value===""||i.value!=h)&&(i.value=""+h):i.value!==""+h&&(i.value=""+h);else if(f==="submit"||f==="reset"){i.removeAttribute("value");return}s.hasOwnProperty("value")?Rw(i,s.type,h):s.hasOwnProperty("defaultValue")&&Rw(i,s.type,sc(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(i.defaultChecked=!!s.defaultChecked)}function vO(i,s,h){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var f=s.type;if(!(f!=="submit"&&f!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+i._wrapperState.initialValue,h||s===i.value||(i.value=s),i.defaultValue=s}h=i.name,h!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,h!==""&&(i.name=h)}function Rw(i,s,h){(s!=="number"||ry(i.ownerDocument)!==i)&&(h==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+h&&(i.defaultValue=""+h))}var Qf=Array.isArray;function Gh(i,s,h,f){if(i=i.options,s){s={};for(var g=0;g<h.length;g++)s["$"+h[g]]=!0;for(h=0;h<i.length;h++)g=s.hasOwnProperty("$"+i[h].value),i[h].selected!==g&&(i[h].selected=g),g&&f&&(i[h].defaultSelected=!0)}else{for(h=""+sc(h),s=null,g=0;g<i.length;g++){if(i[g].value===h){i[g].selected=!0,f&&(i[g].defaultSelected=!0);return}s!==null||i[g].disabled||(s=i[g])}s!==null&&(s.selected=!0)}}function kw(i,s){if(s.dangerouslySetInnerHTML!=null)throw Error(Se(91));return ni({},s,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function xO(i,s){var h=s.value;if(h==null){if(h=s.children,s=s.defaultValue,h!=null){if(s!=null)throw Error(Se(92));if(Qf(h)){if(1<h.length)throw Error(Se(93));h=h[0]}s=h}s==null&&(s=""),h=s}i._wrapperState={initialValue:sc(h)}}function pz(i,s){var h=sc(s.value),f=sc(s.defaultValue);h!=null&&(h=""+h,h!==i.value&&(i.value=h),s.defaultValue==null&&i.defaultValue!==h&&(i.defaultValue=h)),f!=null&&(i.defaultValue=""+f)}function bO(i){var s=i.textContent;s===i._wrapperState.initialValue&&s!==""&&s!==null&&(i.value=s)}function mz(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ow(i,s){return i==null||i==="http://www.w3.org/1999/xhtml"?mz(s):i==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var a_,gz=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,h,f,g){MSApp.execUnsafeLocalFunction(function(){return i(s,h,f,g)})}:i}(function(i,s){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=s;else{for(a_=a_||document.createElement("div"),a_.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=a_.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;s.firstChild;)i.appendChild(s.firstChild)}});function yp(i,s){if(s){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=s;return}}i.textContent=s}var rp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_G=["Webkit","ms","Moz","O"];Object.keys(rp).forEach(function(i){_G.forEach(function(s){s=s+i.charAt(0).toUpperCase()+i.substring(1),rp[s]=rp[i]})});function _z(i,s,h){return s==null||typeof s=="boolean"||s===""?"":h||typeof s!="number"||s===0||rp.hasOwnProperty(i)&&rp[i]?(""+s).trim():s+"px"}function yz(i,s){i=i.style;for(var h in s)if(s.hasOwnProperty(h)){var f=h.indexOf("--")===0,g=_z(h,s[h],f);h==="float"&&(h="cssFloat"),f?i.setProperty(h,g):i[h]=g}}var yG=ni({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Lw(i,s){if(s){if(yG[i]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(Se(137,i));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(Se(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(Se(61))}if(s.style!=null&&typeof s.style!="object")throw Error(Se(62))}}function zw(i,s){if(i.indexOf("-")===-1)return typeof s.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dw=null;function XT(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Bw=null,Wh=null,qh=null;function wO(i){if(i=qp(i)){if(typeof Bw!="function")throw Error(Se(280));var s=i.stateNode;s&&(s=Xy(s),Bw(i.stateNode,i.type,s))}}function vz(i){Wh?qh?qh.push(i):qh=[i]:Wh=i}function xz(){if(Wh){var i=Wh,s=qh;if(qh=Wh=null,wO(i),s)for(i=0;i<s.length;i++)wO(s[i])}}function bz(i,s){return i(s)}function wz(){}var zb=!1;function Tz(i,s,h){if(zb)return i(s,h);zb=!0;try{return bz(i,s,h)}finally{zb=!1,(Wh!==null||qh!==null)&&(wz(),xz())}}function vp(i,s){var h=i.stateNode;if(h===null)return null;var f=Xy(h);if(f===null)return null;h=f[s];t:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break t;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(Se(231,s,typeof h));return h}var Fw=!1;if(Qa)try{var zf={};Object.defineProperty(zf,"passive",{get:function(){Fw=!0}}),window.addEventListener("test",zf,zf),window.removeEventListener("test",zf,zf)}catch{Fw=!1}function vG(i,s,h,f,g,y,b,M,E){var C=Array.prototype.slice.call(arguments,3);try{s.apply(h,C)}catch(L){this.onError(L)}}var ip=!1,iy=null,oy=!1,Nw=null,xG={onError:function(i){ip=!0,iy=i}};function bG(i,s,h,f,g,y,b,M,E){ip=!1,iy=null,vG.apply(xG,arguments)}function wG(i,s,h,f,g,y,b,M,E){if(bG.apply(this,arguments),ip){if(ip){var C=iy;ip=!1,iy=null}else throw Error(Se(198));oy||(oy=!0,Nw=C)}}function xu(i){var s=i,h=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,s.flags&4098&&(h=s.return),i=s.return;while(i)}return s.tag===3?h:null}function Sz(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function TO(i){if(xu(i)!==i)throw Error(Se(188))}function TG(i){var s=i.alternate;if(!s){if(s=xu(i),s===null)throw Error(Se(188));return s!==i?null:i}for(var h=i,f=s;;){var g=h.return;if(g===null)break;var y=g.alternate;if(y===null){if(f=g.return,f!==null){h=f;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===h)return TO(g),i;if(y===f)return TO(g),s;y=y.sibling}throw Error(Se(188))}if(h.return!==f.return)h=g,f=y;else{for(var b=!1,M=g.child;M;){if(M===h){b=!0,h=g,f=y;break}if(M===f){b=!0,f=g,h=y;break}M=M.sibling}if(!b){for(M=y.child;M;){if(M===h){b=!0,h=y,f=g;break}if(M===f){b=!0,f=y,h=g;break}M=M.sibling}if(!b)throw Error(Se(189))}}if(h.alternate!==f)throw Error(Se(190))}if(h.tag!==3)throw Error(Se(188));return h.stateNode.current===h?i:s}function Ez(i){return i=TG(i),i!==null?Cz(i):null}function Cz(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var s=Cz(i);if(s!==null)return s;i=i.sibling}return null}var Mz=ts.unstable_scheduleCallback,SO=ts.unstable_cancelCallback,SG=ts.unstable_shouldYield,EG=ts.unstable_requestPaint,mi=ts.unstable_now,CG=ts.unstable_getCurrentPriorityLevel,KT=ts.unstable_ImmediatePriority,Iz=ts.unstable_UserBlockingPriority,sy=ts.unstable_NormalPriority,MG=ts.unstable_LowPriority,Az=ts.unstable_IdlePriority,Wy=null,xa=null;function IG(i){if(xa&&typeof xa.onCommitFiberRoot=="function")try{xa.onCommitFiberRoot(Wy,i,void 0,(i.current.flags&128)===128)}catch{}}var Ws=Math.clz32?Math.clz32:RG,AG=Math.log,PG=Math.LN2;function RG(i){return i>>>=0,i===0?32:31-(AG(i)/PG|0)|0}var l_=64,c_=4194304;function Jf(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function ay(i,s){var h=i.pendingLanes;if(h===0)return 0;var f=0,g=i.suspendedLanes,y=i.pingedLanes,b=h&268435455;if(b!==0){var M=b&~g;M!==0?f=Jf(M):(y&=b,y!==0&&(f=Jf(y)))}else b=h&~g,b!==0?f=Jf(b):y!==0&&(f=Jf(y));if(f===0)return 0;if(s!==0&&s!==f&&!(s&g)&&(g=f&-f,y=s&-s,g>=y||g===16&&(y&4194240)!==0))return s;if(f&4&&(f|=h&16),s=i.entangledLanes,s!==0)for(i=i.entanglements,s&=f;0<s;)h=31-Ws(s),g=1<<h,f|=i[h],s&=~g;return f}function kG(i,s){switch(i){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function OG(i,s){for(var h=i.suspendedLanes,f=i.pingedLanes,g=i.expirationTimes,y=i.pendingLanes;0<y;){var b=31-Ws(y),M=1<<b,E=g[b];E===-1?(!(M&h)||M&f)&&(g[b]=kG(M,s)):E<=s&&(i.expiredLanes|=M),y&=~M}}function jw(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Pz(){var i=l_;return l_<<=1,!(l_&4194240)&&(l_=64),i}function Db(i){for(var s=[],h=0;31>h;h++)s.push(i);return s}function Gp(i,s,h){i.pendingLanes|=s,s!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,s=31-Ws(s),i[s]=h}function LG(i,s){var h=i.pendingLanes&~s;i.pendingLanes=s,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=s,i.mutableReadLanes&=s,i.entangledLanes&=s,s=i.entanglements;var f=i.eventTimes;for(i=i.expirationTimes;0<h;){var g=31-Ws(h),y=1<<g;s[g]=0,f[g]=-1,i[g]=-1,h&=~y}}function YT(i,s){var h=i.entangledLanes|=s;for(i=i.entanglements;h;){var f=31-Ws(h),g=1<<f;g&s|i[f]&s&&(i[f]|=s),h&=~g}}var xr=0;function Rz(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var kz,QT,Oz,Lz,zz,Uw=!1,u_=[],Yl=null,Ql=null,Jl=null,xp=new Map,bp=new Map,Wl=[],zG="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function EO(i,s){switch(i){case"focusin":case"focusout":Yl=null;break;case"dragenter":case"dragleave":Ql=null;break;case"mouseover":case"mouseout":Jl=null;break;case"pointerover":case"pointerout":xp.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":bp.delete(s.pointerId)}}function Df(i,s,h,f,g,y){return i===null||i.nativeEvent!==y?(i={blockedOn:s,domEventName:h,eventSystemFlags:f,nativeEvent:y,targetContainers:[g]},s!==null&&(s=qp(s),s!==null&&QT(s)),i):(i.eventSystemFlags|=f,s=i.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),i)}function DG(i,s,h,f,g){switch(s){case"focusin":return Yl=Df(Yl,i,s,h,f,g),!0;case"dragenter":return Ql=Df(Ql,i,s,h,f,g),!0;case"mouseover":return Jl=Df(Jl,i,s,h,f,g),!0;case"pointerover":var y=g.pointerId;return xp.set(y,Df(xp.get(y)||null,i,s,h,f,g)),!0;case"gotpointercapture":return y=g.pointerId,bp.set(y,Df(bp.get(y)||null,i,s,h,f,g)),!0}return!1}function Dz(i){var s=Jc(i.target);if(s!==null){var h=xu(s);if(h!==null){if(s=h.tag,s===13){if(s=Sz(h),s!==null){i.blockedOn=s,zz(i.priority,function(){Oz(h)});return}}else if(s===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function z_(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var h=$w(i.domEventName,i.eventSystemFlags,s[0],i.nativeEvent);if(h===null){h=i.nativeEvent;var f=new h.constructor(h.type,h);Dw=f,h.target.dispatchEvent(f),Dw=null}else return s=qp(h),s!==null&&QT(s),i.blockedOn=h,!1;s.shift()}return!0}function CO(i,s,h){z_(i)&&h.delete(s)}function BG(){Uw=!1,Yl!==null&&z_(Yl)&&(Yl=null),Ql!==null&&z_(Ql)&&(Ql=null),Jl!==null&&z_(Jl)&&(Jl=null),xp.forEach(CO),bp.forEach(CO)}function Bf(i,s){i.blockedOn===s&&(i.blockedOn=null,Uw||(Uw=!0,ts.unstable_scheduleCallback(ts.unstable_NormalPriority,BG)))}function wp(i){function s(g){return Bf(g,i)}if(0<u_.length){Bf(u_[0],i);for(var h=1;h<u_.length;h++){var f=u_[h];f.blockedOn===i&&(f.blockedOn=null)}}for(Yl!==null&&Bf(Yl,i),Ql!==null&&Bf(Ql,i),Jl!==null&&Bf(Jl,i),xp.forEach(s),bp.forEach(s),h=0;h<Wl.length;h++)f=Wl[h],f.blockedOn===i&&(f.blockedOn=null);for(;0<Wl.length&&(h=Wl[0],h.blockedOn===null);)Dz(h),h.blockedOn===null&&Wl.shift()}var Hh=nl.ReactCurrentBatchConfig,ly=!0;function FG(i,s,h,f){var g=xr,y=Hh.transition;Hh.transition=null;try{xr=1,JT(i,s,h,f)}finally{xr=g,Hh.transition=y}}function NG(i,s,h,f){var g=xr,y=Hh.transition;Hh.transition=null;try{xr=4,JT(i,s,h,f)}finally{xr=g,Hh.transition=y}}function JT(i,s,h,f){if(ly){var g=$w(i,s,h,f);if(g===null)qb(i,s,f,cy,h),EO(i,f);else if(DG(g,i,s,h,f))f.stopPropagation();else if(EO(i,f),s&4&&-1<zG.indexOf(i)){for(;g!==null;){var y=qp(g);if(y!==null&&kz(y),y=$w(i,s,h,f),y===null&&qb(i,s,f,cy,h),y===g)break;g=y}g!==null&&f.stopPropagation()}else qb(i,s,f,null,h)}}var cy=null;function $w(i,s,h,f){if(cy=null,i=XT(f),i=Jc(i),i!==null)if(s=xu(i),s===null)i=null;else if(h=s.tag,h===13){if(i=Sz(s),i!==null)return i;i=null}else if(h===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null);return cy=i,null}function Bz(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(CG()){case KT:return 1;case Iz:return 4;case sy:case MG:return 16;case Az:return 536870912;default:return 16}default:return 16}}var Zl=null,tS=null,D_=null;function Fz(){if(D_)return D_;var i,s=tS,h=s.length,f,g="value"in Zl?Zl.value:Zl.textContent,y=g.length;for(i=0;i<h&&s[i]===g[i];i++);var b=h-i;for(f=1;f<=b&&s[h-f]===g[y-f];f++);return D_=g.slice(i,1<f?1-f:void 0)}function B_(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function h_(){return!0}function MO(){return!1}function ns(i){function s(h,f,g,y,b){this._reactName=h,this._targetInst=g,this.type=f,this.nativeEvent=y,this.target=b,this.currentTarget=null;for(var M in i)i.hasOwnProperty(M)&&(h=i[M],this[M]=h?h(y):y[M]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?h_:MO,this.isPropagationStopped=MO,this}return ni(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=h_)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=h_)},persist:function(){},isPersistent:h_}),s}var yd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},eS=ns(yd),Wp=ni({},yd,{view:0,detail:0}),jG=ns(Wp),Bb,Fb,Ff,qy=ni({},Wp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nS,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ff&&(Ff&&i.type==="mousemove"?(Bb=i.screenX-Ff.screenX,Fb=i.screenY-Ff.screenY):Fb=Bb=0,Ff=i),Bb)},movementY:function(i){return"movementY"in i?i.movementY:Fb}}),IO=ns(qy),UG=ni({},qy,{dataTransfer:0}),$G=ns(UG),VG=ni({},Wp,{relatedTarget:0}),Nb=ns(VG),GG=ni({},yd,{animationName:0,elapsedTime:0,pseudoElement:0}),WG=ns(GG),qG=ni({},yd,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),HG=ns(qG),ZG=ni({},yd,{data:0}),AO=ns(ZG),XG={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},KG={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},YG={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function QG(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=YG[i])?!!s[i]:!1}function nS(){return QG}var JG=ni({},Wp,{key:function(i){if(i.key){var s=XG[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=B_(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?KG[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nS,charCode:function(i){return i.type==="keypress"?B_(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?B_(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),t7=ns(JG),e7=ni({},qy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),PO=ns(e7),n7=ni({},Wp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nS}),r7=ns(n7),i7=ni({},yd,{propertyName:0,elapsedTime:0,pseudoElement:0}),o7=ns(i7),s7=ni({},qy,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),a7=ns(s7),l7=[9,13,27,32],rS=Qa&&"CompositionEvent"in window,op=null;Qa&&"documentMode"in document&&(op=document.documentMode);var c7=Qa&&"TextEvent"in window&&!op,Nz=Qa&&(!rS||op&&8<op&&11>=op),RO=" ",kO=!1;function jz(i,s){switch(i){case"keyup":return l7.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Uz(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var kh=!1;function u7(i,s){switch(i){case"compositionend":return Uz(s);case"keypress":return s.which!==32?null:(kO=!0,RO);case"textInput":return i=s.data,i===RO&&kO?null:i;default:return null}}function h7(i,s){if(kh)return i==="compositionend"||!rS&&jz(i,s)?(i=Fz(),D_=tS=Zl=null,kh=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Nz&&s.locale!=="ko"?null:s.data;default:return null}}var d7={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function OO(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!d7[i.type]:s==="textarea"}function $z(i,s,h,f){vz(f),s=uy(s,"onChange"),0<s.length&&(h=new eS("onChange","change",null,h,f),i.push({event:h,listeners:s}))}var sp=null,Tp=null;function f7(i){Jz(i,0)}function Hy(i){var s=zh(i);if(dz(s))return i}function p7(i,s){if(i==="change")return s}var Vz=!1;if(Qa){var jb;if(Qa){var Ub="oninput"in document;if(!Ub){var LO=document.createElement("div");LO.setAttribute("oninput","return;"),Ub=typeof LO.oninput=="function"}jb=Ub}else jb=!1;Vz=jb&&(!document.documentMode||9<document.documentMode)}function zO(){sp&&(sp.detachEvent("onpropertychange",Gz),Tp=sp=null)}function Gz(i){if(i.propertyName==="value"&&Hy(Tp)){var s=[];$z(s,Tp,i,XT(i)),Tz(f7,s)}}function m7(i,s,h){i==="focusin"?(zO(),sp=s,Tp=h,sp.attachEvent("onpropertychange",Gz)):i==="focusout"&&zO()}function g7(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Hy(Tp)}function _7(i,s){if(i==="click")return Hy(s)}function y7(i,s){if(i==="input"||i==="change")return Hy(s)}function v7(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var Zs=typeof Object.is=="function"?Object.is:v7;function Sp(i,s){if(Zs(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var h=Object.keys(i),f=Object.keys(s);if(h.length!==f.length)return!1;for(f=0;f<h.length;f++){var g=h[f];if(!Sw.call(s,g)||!Zs(i[g],s[g]))return!1}return!0}function DO(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function BO(i,s){var h=DO(i);i=0;for(var f;h;){if(h.nodeType===3){if(f=i+h.textContent.length,i<=s&&f>=s)return{node:h,offset:s-i};i=f}t:{for(;h;){if(h.nextSibling){h=h.nextSibling;break t}h=h.parentNode}h=void 0}h=DO(h)}}function Wz(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?Wz(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function qz(){for(var i=window,s=ry();s instanceof i.HTMLIFrameElement;){try{var h=typeof s.contentWindow.location.href=="string"}catch{h=!1}if(h)i=s.contentWindow;else break;s=ry(i.document)}return s}function iS(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}function x7(i){var s=qz(),h=i.focusedElem,f=i.selectionRange;if(s!==h&&h&&h.ownerDocument&&Wz(h.ownerDocument.documentElement,h)){if(f!==null&&iS(h)){if(s=f.start,i=f.end,i===void 0&&(i=s),"selectionStart"in h)h.selectionStart=s,h.selectionEnd=Math.min(i,h.value.length);else if(i=(s=h.ownerDocument||document)&&s.defaultView||window,i.getSelection){i=i.getSelection();var g=h.textContent.length,y=Math.min(f.start,g);f=f.end===void 0?y:Math.min(f.end,g),!i.extend&&y>f&&(g=f,f=y,y=g),g=BO(h,y);var b=BO(h,f);g&&b&&(i.rangeCount!==1||i.anchorNode!==g.node||i.anchorOffset!==g.offset||i.focusNode!==b.node||i.focusOffset!==b.offset)&&(s=s.createRange(),s.setStart(g.node,g.offset),i.removeAllRanges(),y>f?(i.addRange(s),i.extend(b.node,b.offset)):(s.setEnd(b.node,b.offset),i.addRange(s)))}}for(s=[],i=h;i=i.parentNode;)i.nodeType===1&&s.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<s.length;h++)i=s[h],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var b7=Qa&&"documentMode"in document&&11>=document.documentMode,Oh=null,Vw=null,ap=null,Gw=!1;function FO(i,s,h){var f=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Gw||Oh==null||Oh!==ry(f)||(f=Oh,"selectionStart"in f&&iS(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),ap&&Sp(ap,f)||(ap=f,f=uy(Vw,"onSelect"),0<f.length&&(s=new eS("onSelect","select",null,s,h),i.push({event:s,listeners:f}),s.target=Oh)))}function d_(i,s){var h={};return h[i.toLowerCase()]=s.toLowerCase(),h["Webkit"+i]="webkit"+s,h["Moz"+i]="moz"+s,h}var Lh={animationend:d_("Animation","AnimationEnd"),animationiteration:d_("Animation","AnimationIteration"),animationstart:d_("Animation","AnimationStart"),transitionend:d_("Transition","TransitionEnd")},$b={},Hz={};Qa&&(Hz=document.createElement("div").style,"AnimationEvent"in window||(delete Lh.animationend.animation,delete Lh.animationiteration.animation,delete Lh.animationstart.animation),"TransitionEvent"in window||delete Lh.transitionend.transition);function Zy(i){if($b[i])return $b[i];if(!Lh[i])return i;var s=Lh[i],h;for(h in s)if(s.hasOwnProperty(h)&&h in Hz)return $b[i]=s[h];return i}var Zz=Zy("animationend"),Xz=Zy("animationiteration"),Kz=Zy("animationstart"),Yz=Zy("transitionend"),Qz=new Map,NO="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function dc(i,s){Qz.set(i,s),vu(s,[i])}for(var Vb=0;Vb<NO.length;Vb++){var Gb=NO[Vb],w7=Gb.toLowerCase(),T7=Gb[0].toUpperCase()+Gb.slice(1);dc(w7,"on"+T7)}dc(Zz,"onAnimationEnd");dc(Xz,"onAnimationIteration");dc(Kz,"onAnimationStart");dc("dblclick","onDoubleClick");dc("focusin","onFocus");dc("focusout","onBlur");dc(Yz,"onTransitionEnd");ed("onMouseEnter",["mouseout","mouseover"]);ed("onMouseLeave",["mouseout","mouseover"]);ed("onPointerEnter",["pointerout","pointerover"]);ed("onPointerLeave",["pointerout","pointerover"]);vu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vu("onBeforeInput",["compositionend","keypress","textInput","paste"]);vu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),S7=new Set("cancel close invalid load scroll toggle".split(" ").concat(tp));function jO(i,s,h){var f=i.type||"unknown-event";i.currentTarget=h,wG(f,s,void 0,i),i.currentTarget=null}function Jz(i,s){s=(s&4)!==0;for(var h=0;h<i.length;h++){var f=i[h],g=f.event;f=f.listeners;t:{var y=void 0;if(s)for(var b=f.length-1;0<=b;b--){var M=f[b],E=M.instance,C=M.currentTarget;if(M=M.listener,E!==y&&g.isPropagationStopped())break t;jO(g,M,C),y=E}else for(b=0;b<f.length;b++){if(M=f[b],E=M.instance,C=M.currentTarget,M=M.listener,E!==y&&g.isPropagationStopped())break t;jO(g,M,C),y=E}}}if(oy)throw i=Nw,oy=!1,Nw=null,i}function Ur(i,s){var h=s[Xw];h===void 0&&(h=s[Xw]=new Set);var f=i+"__bubble";h.has(f)||(tD(s,i,2,!1),h.add(f))}function Wb(i,s,h){var f=0;s&&(f|=4),tD(h,i,f,s)}var f_="_reactListening"+Math.random().toString(36).slice(2);function Ep(i){if(!i[f_]){i[f_]=!0,az.forEach(function(h){h!=="selectionchange"&&(S7.has(h)||Wb(h,!1,i),Wb(h,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[f_]||(s[f_]=!0,Wb("selectionchange",!1,s))}}function tD(i,s,h,f){switch(Bz(s)){case 1:var g=FG;break;case 4:g=NG;break;default:g=JT}h=g.bind(null,s,h,i),g=void 0,!Fw||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),f?g!==void 0?i.addEventListener(s,h,{capture:!0,passive:g}):i.addEventListener(s,h,!0):g!==void 0?i.addEventListener(s,h,{passive:g}):i.addEventListener(s,h,!1)}function qb(i,s,h,f,g){var y=f;if(!(s&1)&&!(s&2)&&f!==null)t:for(;;){if(f===null)return;var b=f.tag;if(b===3||b===4){var M=f.stateNode.containerInfo;if(M===g||M.nodeType===8&&M.parentNode===g)break;if(b===4)for(b=f.return;b!==null;){var E=b.tag;if((E===3||E===4)&&(E=b.stateNode.containerInfo,E===g||E.nodeType===8&&E.parentNode===g))return;b=b.return}for(;M!==null;){if(b=Jc(M),b===null)return;if(E=b.tag,E===5||E===6){f=y=b;continue t}M=M.parentNode}}f=f.return}Tz(function(){var C=y,L=XT(h),B=[];t:{var z=Qz.get(i);if(z!==void 0){var H=eS,U=i;switch(i){case"keypress":if(B_(h)===0)break t;case"keydown":case"keyup":H=t7;break;case"focusin":U="focus",H=Nb;break;case"focusout":U="blur",H=Nb;break;case"beforeblur":case"afterblur":H=Nb;break;case"click":if(h.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":H=IO;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":H=$G;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":H=r7;break;case Zz:case Xz:case Kz:H=WG;break;case Yz:H=o7;break;case"scroll":H=jG;break;case"wheel":H=a7;break;case"copy":case"cut":case"paste":H=HG;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":H=PO}var q=(s&4)!==0,tt=!q&&i==="scroll",V=q?z!==null?z+"Capture":null:z;q=[];for(var F=C,D;F!==null;){D=F;var $=D.stateNode;if(D.tag===5&&$!==null&&(D=$,V!==null&&($=vp(F,V),$!=null&&q.push(Cp(F,$,D)))),tt)break;F=F.return}0<q.length&&(z=new H(z,U,null,h,L),B.push({event:z,listeners:q}))}}if(!(s&7)){t:{if(z=i==="mouseover"||i==="pointerover",H=i==="mouseout"||i==="pointerout",z&&h!==Dw&&(U=h.relatedTarget||h.fromElement)&&(Jc(U)||U[Ja]))break t;if((H||z)&&(z=L.window===L?L:(z=L.ownerDocument)?z.defaultView||z.parentWindow:window,H?(U=h.relatedTarget||h.toElement,H=C,U=U?Jc(U):null,U!==null&&(tt=xu(U),U!==tt||U.tag!==5&&U.tag!==6)&&(U=null)):(H=null,U=C),H!==U)){if(q=IO,$="onMouseLeave",V="onMouseEnter",F="mouse",(i==="pointerout"||i==="pointerover")&&(q=PO,$="onPointerLeave",V="onPointerEnter",F="pointer"),tt=H==null?z:zh(H),D=U==null?z:zh(U),z=new q($,F+"leave",H,h,L),z.target=tt,z.relatedTarget=D,$=null,Jc(L)===C&&(q=new q(V,F+"enter",U,h,L),q.target=D,q.relatedTarget=tt,$=q),tt=$,H&&U)e:{for(q=H,V=U,F=0,D=q;D;D=vh(D))F++;for(D=0,$=V;$;$=vh($))D++;for(;0<F-D;)q=vh(q),F--;for(;0<D-F;)V=vh(V),D--;for(;F--;){if(q===V||V!==null&&q===V.alternate)break e;q=vh(q),V=vh(V)}q=null}else q=null;H!==null&&UO(B,z,H,q,!1),U!==null&&tt!==null&&UO(B,tt,U,q,!0)}}t:{if(z=C?zh(C):window,H=z.nodeName&&z.nodeName.toLowerCase(),H==="select"||H==="input"&&z.type==="file")var J=p7;else if(OO(z))if(Vz)J=y7;else{J=g7;var ct=m7}else(H=z.nodeName)&&H.toLowerCase()==="input"&&(z.type==="checkbox"||z.type==="radio")&&(J=_7);if(J&&(J=J(i,C))){$z(B,J,h,L);break t}ct&&ct(i,z,C),i==="focusout"&&(ct=z._wrapperState)&&ct.controlled&&z.type==="number"&&Rw(z,"number",z.value)}switch(ct=C?zh(C):window,i){case"focusin":(OO(ct)||ct.contentEditable==="true")&&(Oh=ct,Vw=C,ap=null);break;case"focusout":ap=Vw=Oh=null;break;case"mousedown":Gw=!0;break;case"contextmenu":case"mouseup":case"dragend":Gw=!1,FO(B,h,L);break;case"selectionchange":if(b7)break;case"keydown":case"keyup":FO(B,h,L)}var st;if(rS)t:{switch(i){case"compositionstart":var yt="onCompositionStart";break t;case"compositionend":yt="onCompositionEnd";break t;case"compositionupdate":yt="onCompositionUpdate";break t}yt=void 0}else kh?jz(i,h)&&(yt="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(yt="onCompositionStart");yt&&(Nz&&h.locale!=="ko"&&(kh||yt!=="onCompositionStart"?yt==="onCompositionEnd"&&kh&&(st=Fz()):(Zl=L,tS="value"in Zl?Zl.value:Zl.textContent,kh=!0)),ct=uy(C,yt),0<ct.length&&(yt=new AO(yt,i,null,h,L),B.push({event:yt,listeners:ct}),st?yt.data=st:(st=Uz(h),st!==null&&(yt.data=st)))),(st=c7?u7(i,h):h7(i,h))&&(C=uy(C,"onBeforeInput"),0<C.length&&(L=new AO("onBeforeInput","beforeinput",null,h,L),B.push({event:L,listeners:C}),L.data=st))}Jz(B,s)})}function Cp(i,s,h){return{instance:i,listener:s,currentTarget:h}}function uy(i,s){for(var h=s+"Capture",f=[];i!==null;){var g=i,y=g.stateNode;g.tag===5&&y!==null&&(g=y,y=vp(i,h),y!=null&&f.unshift(Cp(i,y,g)),y=vp(i,s),y!=null&&f.push(Cp(i,y,g))),i=i.return}return f}function vh(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function UO(i,s,h,f,g){for(var y=s._reactName,b=[];h!==null&&h!==f;){var M=h,E=M.alternate,C=M.stateNode;if(E!==null&&E===f)break;M.tag===5&&C!==null&&(M=C,g?(E=vp(h,y),E!=null&&b.unshift(Cp(h,E,M))):g||(E=vp(h,y),E!=null&&b.push(Cp(h,E,M)))),h=h.return}b.length!==0&&i.push({event:s,listeners:b})}var E7=/\r\n?/g,C7=/\u0000|\uFFFD/g;function $O(i){return(typeof i=="string"?i:""+i).replace(E7,`
`).replace(C7,"")}function p_(i,s,h){if(s=$O(s),$O(i)!==s&&h)throw Error(Se(425))}function hy(){}var Ww=null,qw=null;function Hw(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Zw=typeof setTimeout=="function"?setTimeout:void 0,M7=typeof clearTimeout=="function"?clearTimeout:void 0,VO=typeof Promise=="function"?Promise:void 0,I7=typeof queueMicrotask=="function"?queueMicrotask:typeof VO<"u"?function(i){return VO.resolve(null).then(i).catch(A7)}:Zw;function A7(i){setTimeout(function(){throw i})}function Hb(i,s){var h=s,f=0;do{var g=h.nextSibling;if(i.removeChild(h),g&&g.nodeType===8)if(h=g.data,h==="/$"){if(f===0){i.removeChild(g),wp(s);return}f--}else h!=="$"&&h!=="$?"&&h!=="$!"||f++;h=g}while(h);wp(s)}function tc(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return i}function GO(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"){if(s===0)return i;s--}else h==="/$"&&s++}i=i.previousSibling}return null}var vd=Math.random().toString(36).slice(2),va="__reactFiber$"+vd,Mp="__reactProps$"+vd,Ja="__reactContainer$"+vd,Xw="__reactEvents$"+vd,P7="__reactListeners$"+vd,R7="__reactHandles$"+vd;function Jc(i){var s=i[va];if(s)return s;for(var h=i.parentNode;h;){if(s=h[Ja]||h[va]){if(h=s.alternate,s.child!==null||h!==null&&h.child!==null)for(i=GO(i);i!==null;){if(h=i[va])return h;i=GO(i)}return s}i=h,h=i.parentNode}return null}function qp(i){return i=i[va]||i[Ja],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function zh(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(Se(33))}function Xy(i){return i[Mp]||null}var Kw=[],Dh=-1;function fc(i){return{current:i}}function Vr(i){0>Dh||(i.current=Kw[Dh],Kw[Dh]=null,Dh--)}function Br(i,s){Dh++,Kw[Dh]=i.current,i.current=s}var ac={},ro=fc(ac),Ro=fc(!1),uu=ac;function nd(i,s){var h=i.type.contextTypes;if(!h)return ac;var f=i.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===s)return f.__reactInternalMemoizedMaskedChildContext;var g={},y;for(y in h)g[y]=s[y];return f&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=s,i.__reactInternalMemoizedMaskedChildContext=g),g}function ko(i){return i=i.childContextTypes,i!=null}function dy(){Vr(Ro),Vr(ro)}function WO(i,s,h){if(ro.current!==ac)throw Error(Se(168));Br(ro,s),Br(Ro,h)}function eD(i,s,h){var f=i.stateNode;if(s=s.childContextTypes,typeof f.getChildContext!="function")return h;f=f.getChildContext();for(var g in f)if(!(g in s))throw Error(Se(108,mG(i)||"Unknown",g));return ni({},h,f)}function fy(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||ac,uu=ro.current,Br(ro,i),Br(Ro,Ro.current),!0}function qO(i,s,h){var f=i.stateNode;if(!f)throw Error(Se(169));h?(i=eD(i,s,uu),f.__reactInternalMemoizedMergedChildContext=i,Vr(Ro),Vr(ro),Br(ro,i)):Vr(Ro),Br(Ro,h)}var Za=null,Ky=!1,Zb=!1;function nD(i){Za===null?Za=[i]:Za.push(i)}function k7(i){Ky=!0,nD(i)}function pc(){if(!Zb&&Za!==null){Zb=!0;var i=0,s=xr;try{var h=Za;for(xr=1;i<h.length;i++){var f=h[i];do f=f(!0);while(f!==null)}Za=null,Ky=!1}catch(g){throw Za!==null&&(Za=Za.slice(i+1)),Mz(KT,pc),g}finally{xr=s,Zb=!1}}return null}var Bh=[],Fh=0,py=null,my=0,_s=[],ys=0,hu=null,Xa=1,Ka="";function Zc(i,s){Bh[Fh++]=my,Bh[Fh++]=py,py=i,my=s}function rD(i,s,h){_s[ys++]=Xa,_s[ys++]=Ka,_s[ys++]=hu,hu=i;var f=Xa;i=Ka;var g=32-Ws(f)-1;f&=~(1<<g),h+=1;var y=32-Ws(s)+g;if(30<y){var b=g-g%5;y=(f&(1<<b)-1).toString(32),f>>=b,g-=b,Xa=1<<32-Ws(s)+g|h<<g|f,Ka=y+i}else Xa=1<<y|h<<g|f,Ka=i}function oS(i){i.return!==null&&(Zc(i,1),rD(i,1,0))}function sS(i){for(;i===py;)py=Bh[--Fh],Bh[Fh]=null,my=Bh[--Fh],Bh[Fh]=null;for(;i===hu;)hu=_s[--ys],_s[ys]=null,Ka=_s[--ys],_s[ys]=null,Xa=_s[--ys],_s[ys]=null}var Qo=null,Yo=null,Zr=!1,Gs=null;function iD(i,s){var h=xs(5,null,null,0);h.elementType="DELETED",h.stateNode=s,h.return=i,s=i.deletions,s===null?(i.deletions=[h],i.flags|=16):s.push(h)}function HO(i,s){switch(i.tag){case 5:var h=i.type;return s=s.nodeType!==1||h.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(i.stateNode=s,Qo=i,Yo=tc(s.firstChild),!0):!1;case 6:return s=i.pendingProps===""||s.nodeType!==3?null:s,s!==null?(i.stateNode=s,Qo=i,Yo=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(h=hu!==null?{id:Xa,overflow:Ka}:null,i.memoizedState={dehydrated:s,treeContext:h,retryLane:1073741824},h=xs(18,null,null,0),h.stateNode=s,h.return=i,i.child=h,Qo=i,Yo=null,!0):!1;default:return!1}}function Yw(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Qw(i){if(Zr){var s=Yo;if(s){var h=s;if(!HO(i,s)){if(Yw(i))throw Error(Se(418));s=tc(h.nextSibling);var f=Qo;s&&HO(i,s)?iD(f,h):(i.flags=i.flags&-4097|2,Zr=!1,Qo=i)}}else{if(Yw(i))throw Error(Se(418));i.flags=i.flags&-4097|2,Zr=!1,Qo=i}}}function ZO(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Qo=i}function m_(i){if(i!==Qo)return!1;if(!Zr)return ZO(i),Zr=!0,!1;var s;if((s=i.tag!==3)&&!(s=i.tag!==5)&&(s=i.type,s=s!=="head"&&s!=="body"&&!Hw(i.type,i.memoizedProps)),s&&(s=Yo)){if(Yw(i))throw oD(),Error(Se(418));for(;s;)iD(i,s),s=tc(s.nextSibling)}if(ZO(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Se(317));t:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"){if(s===0){Yo=tc(i.nextSibling);break t}s--}else h!=="$"&&h!=="$!"&&h!=="$?"||s++}i=i.nextSibling}Yo=null}}else Yo=Qo?tc(i.stateNode.nextSibling):null;return!0}function oD(){for(var i=Yo;i;)i=tc(i.nextSibling)}function rd(){Yo=Qo=null,Zr=!1}function aS(i){Gs===null?Gs=[i]:Gs.push(i)}var O7=nl.ReactCurrentBatchConfig;function $s(i,s){if(i&&i.defaultProps){s=ni({},s),i=i.defaultProps;for(var h in i)s[h]===void 0&&(s[h]=i[h]);return s}return s}var gy=fc(null),_y=null,Nh=null,lS=null;function cS(){lS=Nh=_y=null}function uS(i){var s=gy.current;Vr(gy),i._currentValue=s}function Jw(i,s,h){for(;i!==null;){var f=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),i===h)break;i=i.return}}function Zh(i,s){_y=i,lS=Nh=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&s&&(Po=!0),i.firstContext=null)}function ws(i){var s=i._currentValue;if(lS!==i)if(i={context:i,memoizedValue:s,next:null},Nh===null){if(_y===null)throw Error(Se(308));Nh=i,_y.dependencies={lanes:0,firstContext:i}}else Nh=Nh.next=i;return s}var tu=null;function hS(i){tu===null?tu=[i]:tu.push(i)}function sD(i,s,h,f){var g=s.interleaved;return g===null?(h.next=h,hS(s)):(h.next=g.next,g.next=h),s.interleaved=h,tl(i,f)}function tl(i,s){i.lanes|=s;var h=i.alternate;for(h!==null&&(h.lanes|=s),h=i,i=i.return;i!==null;)i.childLanes|=s,h=i.alternate,h!==null&&(h.childLanes|=s),h=i,i=i.return;return h.tag===3?h.stateNode:null}var Gl=!1;function dS(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function aD(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Ya(i,s){return{eventTime:i,lane:s,tag:0,payload:null,callback:null,next:null}}function ec(i,s,h){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,ir&2){var g=f.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),f.pending=s,tl(i,h)}return g=f.interleaved,g===null?(s.next=s,hS(f)):(s.next=g.next,g.next=s),f.interleaved=s,tl(i,h)}function F_(i,s,h){if(s=s.updateQueue,s!==null&&(s=s.shared,(h&4194240)!==0)){var f=s.lanes;f&=i.pendingLanes,h|=f,s.lanes=h,YT(i,h)}}function XO(i,s){var h=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,h===f)){var g=null,y=null;if(h=h.firstBaseUpdate,h!==null){do{var b={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};y===null?g=y=b:y=y.next=b,h=h.next}while(h!==null);y===null?g=y=s:y=y.next=s}else g=y=s;h={baseState:f.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:f.shared,effects:f.effects},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=s:i.next=s,h.lastBaseUpdate=s}function yy(i,s,h,f){var g=i.updateQueue;Gl=!1;var y=g.firstBaseUpdate,b=g.lastBaseUpdate,M=g.shared.pending;if(M!==null){g.shared.pending=null;var E=M,C=E.next;E.next=null,b===null?y=C:b.next=C,b=E;var L=i.alternate;L!==null&&(L=L.updateQueue,M=L.lastBaseUpdate,M!==b&&(M===null?L.firstBaseUpdate=C:M.next=C,L.lastBaseUpdate=E))}if(y!==null){var B=g.baseState;b=0,L=C=E=null,M=y;do{var z=M.lane,H=M.eventTime;if((f&z)===z){L!==null&&(L=L.next={eventTime:H,lane:0,tag:M.tag,payload:M.payload,callback:M.callback,next:null});t:{var U=i,q=M;switch(z=s,H=h,q.tag){case 1:if(U=q.payload,typeof U=="function"){B=U.call(H,B,z);break t}B=U;break t;case 3:U.flags=U.flags&-65537|128;case 0:if(U=q.payload,z=typeof U=="function"?U.call(H,B,z):U,z==null)break t;B=ni({},B,z);break t;case 2:Gl=!0}}M.callback!==null&&M.lane!==0&&(i.flags|=64,z=g.effects,z===null?g.effects=[M]:z.push(M))}else H={eventTime:H,lane:z,tag:M.tag,payload:M.payload,callback:M.callback,next:null},L===null?(C=L=H,E=B):L=L.next=H,b|=z;if(M=M.next,M===null){if(M=g.shared.pending,M===null)break;z=M,M=z.next,z.next=null,g.lastBaseUpdate=z,g.shared.pending=null}}while(!0);if(L===null&&(E=B),g.baseState=E,g.firstBaseUpdate=C,g.lastBaseUpdate=L,s=g.shared.interleaved,s!==null){g=s;do b|=g.lane,g=g.next;while(g!==s)}else y===null&&(g.shared.lanes=0);fu|=b,i.lanes=b,i.memoizedState=B}}function KO(i,s,h){if(i=s.effects,s.effects=null,i!==null)for(s=0;s<i.length;s++){var f=i[s],g=f.callback;if(g!==null){if(f.callback=null,f=h,typeof g!="function")throw Error(Se(191,g));g.call(f)}}}var lD=new sz.Component().refs;function tT(i,s,h,f){s=i.memoizedState,h=h(f,s),h=h==null?s:ni({},s,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var Yy={isMounted:function(i){return(i=i._reactInternals)?xu(i)===i:!1},enqueueSetState:function(i,s,h){i=i._reactInternals;var f=mo(),g=rc(i),y=Ya(f,g);y.payload=s,h!=null&&(y.callback=h),s=ec(i,y,g),s!==null&&(qs(s,i,g,f),F_(s,i,g))},enqueueReplaceState:function(i,s,h){i=i._reactInternals;var f=mo(),g=rc(i),y=Ya(f,g);y.tag=1,y.payload=s,h!=null&&(y.callback=h),s=ec(i,y,g),s!==null&&(qs(s,i,g,f),F_(s,i,g))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var h=mo(),f=rc(i),g=Ya(h,f);g.tag=2,s!=null&&(g.callback=s),s=ec(i,g,f),s!==null&&(qs(s,i,f,h),F_(s,i,f))}};function YO(i,s,h,f,g,y,b){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,y,b):s.prototype&&s.prototype.isPureReactComponent?!Sp(h,f)||!Sp(g,y):!0}function cD(i,s,h){var f=!1,g=ac,y=s.contextType;return typeof y=="object"&&y!==null?y=ws(y):(g=ko(s)?uu:ro.current,f=s.contextTypes,y=(f=f!=null)?nd(i,g):ac),s=new s(h,y),i.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=Yy,i.stateNode=s,s._reactInternals=i,f&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=g,i.__reactInternalMemoizedMaskedChildContext=y),s}function QO(i,s,h,f){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(h,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(h,f),s.state!==i&&Yy.enqueueReplaceState(s,s.state,null)}function eT(i,s,h,f){var g=i.stateNode;g.props=h,g.state=i.memoizedState,g.refs=lD,dS(i);var y=s.contextType;typeof y=="object"&&y!==null?g.context=ws(y):(y=ko(s)?uu:ro.current,g.context=nd(i,y)),g.state=i.memoizedState,y=s.getDerivedStateFromProps,typeof y=="function"&&(tT(i,s,y,h),g.state=i.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(s=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),s!==g.state&&Yy.enqueueReplaceState(g,g.state,null),yy(i,h,g,f),g.state=i.memoizedState),typeof g.componentDidMount=="function"&&(i.flags|=4194308)}function Nf(i,s,h){if(i=h.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(Se(309));var f=h.stateNode}if(!f)throw Error(Se(147,i));var g=f,y=""+i;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===y?s.ref:(s=function(b){var M=g.refs;M===lD&&(M=g.refs={}),b===null?delete M[y]:M[y]=b},s._stringRef=y,s)}if(typeof i!="string")throw Error(Se(284));if(!h._owner)throw Error(Se(290,i))}return i}function g_(i,s){throw i=Object.prototype.toString.call(s),Error(Se(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i))}function JO(i){var s=i._init;return s(i._payload)}function uD(i){function s(V,F){if(i){var D=V.deletions;D===null?(V.deletions=[F],V.flags|=16):D.push(F)}}function h(V,F){if(!i)return null;for(;F!==null;)s(V,F),F=F.sibling;return null}function f(V,F){for(V=new Map;F!==null;)F.key!==null?V.set(F.key,F):V.set(F.index,F),F=F.sibling;return V}function g(V,F){return V=ic(V,F),V.index=0,V.sibling=null,V}function y(V,F,D){return V.index=D,i?(D=V.alternate,D!==null?(D=D.index,D<F?(V.flags|=2,F):D):(V.flags|=2,F)):(V.flags|=1048576,F)}function b(V){return i&&V.alternate===null&&(V.flags|=2),V}function M(V,F,D,$){return F===null||F.tag!==6?(F=ew(D,V.mode,$),F.return=V,F):(F=g(F,D),F.return=V,F)}function E(V,F,D,$){var J=D.type;return J===Rh?L(V,F,D.props.children,$,D.key):F!==null&&(F.elementType===J||typeof J=="object"&&J!==null&&J.$$typeof===Vl&&JO(J)===F.type)?($=g(F,D.props),$.ref=Nf(V,F,D),$.return=V,$):($=G_(D.type,D.key,D.props,null,V.mode,$),$.ref=Nf(V,F,D),$.return=V,$)}function C(V,F,D,$){return F===null||F.tag!==4||F.stateNode.containerInfo!==D.containerInfo||F.stateNode.implementation!==D.implementation?(F=nw(D,V.mode,$),F.return=V,F):(F=g(F,D.children||[]),F.return=V,F)}function L(V,F,D,$,J){return F===null||F.tag!==7?(F=su(D,V.mode,$,J),F.return=V,F):(F=g(F,D),F.return=V,F)}function B(V,F,D){if(typeof F=="string"&&F!==""||typeof F=="number")return F=ew(""+F,V.mode,D),F.return=V,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case o_:return D=G_(F.type,F.key,F.props,null,V.mode,D),D.ref=Nf(V,null,F),D.return=V,D;case Ph:return F=nw(F,V.mode,D),F.return=V,F;case Vl:var $=F._init;return B(V,$(F._payload),D)}if(Qf(F)||Lf(F))return F=su(F,V.mode,D,null),F.return=V,F;g_(V,F)}return null}function z(V,F,D,$){var J=F!==null?F.key:null;if(typeof D=="string"&&D!==""||typeof D=="number")return J!==null?null:M(V,F,""+D,$);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case o_:return D.key===J?E(V,F,D,$):null;case Ph:return D.key===J?C(V,F,D,$):null;case Vl:return J=D._init,z(V,F,J(D._payload),$)}if(Qf(D)||Lf(D))return J!==null?null:L(V,F,D,$,null);g_(V,D)}return null}function H(V,F,D,$,J){if(typeof $=="string"&&$!==""||typeof $=="number")return V=V.get(D)||null,M(F,V,""+$,J);if(typeof $=="object"&&$!==null){switch($.$$typeof){case o_:return V=V.get($.key===null?D:$.key)||null,E(F,V,$,J);case Ph:return V=V.get($.key===null?D:$.key)||null,C(F,V,$,J);case Vl:var ct=$._init;return H(V,F,D,ct($._payload),J)}if(Qf($)||Lf($))return V=V.get(D)||null,L(F,V,$,J,null);g_(F,$)}return null}function U(V,F,D,$){for(var J=null,ct=null,st=F,yt=F=0,ut=null;st!==null&&yt<D.length;yt++){st.index>yt?(ut=st,st=null):ut=st.sibling;var N=z(V,st,D[yt],$);if(N===null){st===null&&(st=ut);break}i&&st&&N.alternate===null&&s(V,st),F=y(N,F,yt),ct===null?J=N:ct.sibling=N,ct=N,st=ut}if(yt===D.length)return h(V,st),Zr&&Zc(V,yt),J;if(st===null){for(;yt<D.length;yt++)st=B(V,D[yt],$),st!==null&&(F=y(st,F,yt),ct===null?J=st:ct.sibling=st,ct=st);return Zr&&Zc(V,yt),J}for(st=f(V,st);yt<D.length;yt++)ut=H(st,V,yt,D[yt],$),ut!==null&&(i&&ut.alternate!==null&&st.delete(ut.key===null?yt:ut.key),F=y(ut,F,yt),ct===null?J=ut:ct.sibling=ut,ct=ut);return i&&st.forEach(function(et){return s(V,et)}),Zr&&Zc(V,yt),J}function q(V,F,D,$){var J=Lf(D);if(typeof J!="function")throw Error(Se(150));if(D=J.call(D),D==null)throw Error(Se(151));for(var ct=J=null,st=F,yt=F=0,ut=null,N=D.next();st!==null&&!N.done;yt++,N=D.next()){st.index>yt?(ut=st,st=null):ut=st.sibling;var et=z(V,st,N.value,$);if(et===null){st===null&&(st=ut);break}i&&st&&et.alternate===null&&s(V,st),F=y(et,F,yt),ct===null?J=et:ct.sibling=et,ct=et,st=ut}if(N.done)return h(V,st),Zr&&Zc(V,yt),J;if(st===null){for(;!N.done;yt++,N=D.next())N=B(V,N.value,$),N!==null&&(F=y(N,F,yt),ct===null?J=N:ct.sibling=N,ct=N);return Zr&&Zc(V,yt),J}for(st=f(V,st);!N.done;yt++,N=D.next())N=H(st,V,yt,N.value,$),N!==null&&(i&&N.alternate!==null&&st.delete(N.key===null?yt:N.key),F=y(N,F,yt),ct===null?J=N:ct.sibling=N,ct=N);return i&&st.forEach(function(Mt){return s(V,Mt)}),Zr&&Zc(V,yt),J}function tt(V,F,D,$){if(typeof D=="object"&&D!==null&&D.type===Rh&&D.key===null&&(D=D.props.children),typeof D=="object"&&D!==null){switch(D.$$typeof){case o_:t:{for(var J=D.key,ct=F;ct!==null;){if(ct.key===J){if(J=D.type,J===Rh){if(ct.tag===7){h(V,ct.sibling),F=g(ct,D.props.children),F.return=V,V=F;break t}}else if(ct.elementType===J||typeof J=="object"&&J!==null&&J.$$typeof===Vl&&JO(J)===ct.type){h(V,ct.sibling),F=g(ct,D.props),F.ref=Nf(V,ct,D),F.return=V,V=F;break t}h(V,ct);break}else s(V,ct);ct=ct.sibling}D.type===Rh?(F=su(D.props.children,V.mode,$,D.key),F.return=V,V=F):($=G_(D.type,D.key,D.props,null,V.mode,$),$.ref=Nf(V,F,D),$.return=V,V=$)}return b(V);case Ph:t:{for(ct=D.key;F!==null;){if(F.key===ct)if(F.tag===4&&F.stateNode.containerInfo===D.containerInfo&&F.stateNode.implementation===D.implementation){h(V,F.sibling),F=g(F,D.children||[]),F.return=V,V=F;break t}else{h(V,F);break}else s(V,F);F=F.sibling}F=nw(D,V.mode,$),F.return=V,V=F}return b(V);case Vl:return ct=D._init,tt(V,F,ct(D._payload),$)}if(Qf(D))return U(V,F,D,$);if(Lf(D))return q(V,F,D,$);g_(V,D)}return typeof D=="string"&&D!==""||typeof D=="number"?(D=""+D,F!==null&&F.tag===6?(h(V,F.sibling),F=g(F,D),F.return=V,V=F):(h(V,F),F=ew(D,V.mode,$),F.return=V,V=F),b(V)):h(V,F)}return tt}var id=uD(!0),hD=uD(!1),Hp={},ba=fc(Hp),Ip=fc(Hp),Ap=fc(Hp);function eu(i){if(i===Hp)throw Error(Se(174));return i}function fS(i,s){switch(Br(Ap,s),Br(Ip,i),Br(ba,Hp),i=s.nodeType,i){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:Ow(null,"");break;default:i=i===8?s.parentNode:s,s=i.namespaceURI||null,i=i.tagName,s=Ow(s,i)}Vr(ba),Br(ba,s)}function od(){Vr(ba),Vr(Ip),Vr(Ap)}function dD(i){eu(Ap.current);var s=eu(ba.current),h=Ow(s,i.type);s!==h&&(Br(Ip,i),Br(ba,h))}function pS(i){Ip.current===i&&(Vr(ba),Vr(Ip))}var ti=fc(0);function vy(i){for(var s=i;s!==null;){if(s.tag===13){var h=s.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Xb=[];function mS(){for(var i=0;i<Xb.length;i++)Xb[i]._workInProgressVersionPrimary=null;Xb.length=0}var N_=nl.ReactCurrentDispatcher,Kb=nl.ReactCurrentBatchConfig,du=0,ei=null,Oi=null,Di=null,xy=!1,lp=!1,Pp=0,L7=0;function Qi(){throw Error(Se(321))}function gS(i,s){if(s===null)return!1;for(var h=0;h<s.length&&h<i.length;h++)if(!Zs(i[h],s[h]))return!1;return!0}function _S(i,s,h,f,g,y){if(du=y,ei=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,N_.current=i===null||i.memoizedState===null?F7:N7,i=h(f,g),lp){y=0;do{if(lp=!1,Pp=0,25<=y)throw Error(Se(301));y+=1,Di=Oi=null,s.updateQueue=null,N_.current=j7,i=h(f,g)}while(lp)}if(N_.current=by,s=Oi!==null&&Oi.next!==null,du=0,Di=Oi=ei=null,xy=!1,s)throw Error(Se(300));return i}function yS(){var i=Pp!==0;return Pp=0,i}function ma(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Di===null?ei.memoizedState=Di=i:Di=Di.next=i,Di}function Ts(){if(Oi===null){var i=ei.alternate;i=i!==null?i.memoizedState:null}else i=Oi.next;var s=Di===null?ei.memoizedState:Di.next;if(s!==null)Di=s,Oi=i;else{if(i===null)throw Error(Se(310));Oi=i,i={memoizedState:Oi.memoizedState,baseState:Oi.baseState,baseQueue:Oi.baseQueue,queue:Oi.queue,next:null},Di===null?ei.memoizedState=Di=i:Di=Di.next=i}return Di}function Rp(i,s){return typeof s=="function"?s(i):s}function Yb(i){var s=Ts(),h=s.queue;if(h===null)throw Error(Se(311));h.lastRenderedReducer=i;var f=Oi,g=f.baseQueue,y=h.pending;if(y!==null){if(g!==null){var b=g.next;g.next=y.next,y.next=b}f.baseQueue=g=y,h.pending=null}if(g!==null){y=g.next,f=f.baseState;var M=b=null,E=null,C=y;do{var L=C.lane;if((du&L)===L)E!==null&&(E=E.next={lane:0,action:C.action,hasEagerState:C.hasEagerState,eagerState:C.eagerState,next:null}),f=C.hasEagerState?C.eagerState:i(f,C.action);else{var B={lane:L,action:C.action,hasEagerState:C.hasEagerState,eagerState:C.eagerState,next:null};E===null?(M=E=B,b=f):E=E.next=B,ei.lanes|=L,fu|=L}C=C.next}while(C!==null&&C!==y);E===null?b=f:E.next=M,Zs(f,s.memoizedState)||(Po=!0),s.memoizedState=f,s.baseState=b,s.baseQueue=E,h.lastRenderedState=f}if(i=h.interleaved,i!==null){g=i;do y=g.lane,ei.lanes|=y,fu|=y,g=g.next;while(g!==i)}else g===null&&(h.lanes=0);return[s.memoizedState,h.dispatch]}function Qb(i){var s=Ts(),h=s.queue;if(h===null)throw Error(Se(311));h.lastRenderedReducer=i;var f=h.dispatch,g=h.pending,y=s.memoizedState;if(g!==null){h.pending=null;var b=g=g.next;do y=i(y,b.action),b=b.next;while(b!==g);Zs(y,s.memoizedState)||(Po=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),h.lastRenderedState=y}return[y,f]}function fD(){}function pD(i,s){var h=ei,f=Ts(),g=s(),y=!Zs(f.memoizedState,g);if(y&&(f.memoizedState=g,Po=!0),f=f.queue,vS(_D.bind(null,h,f,i),[i]),f.getSnapshot!==s||y||Di!==null&&Di.memoizedState.tag&1){if(h.flags|=2048,kp(9,gD.bind(null,h,f,g,s),void 0,null),Fi===null)throw Error(Se(349));du&30||mD(h,s,g)}return g}function mD(i,s,h){i.flags|=16384,i={getSnapshot:s,value:h},s=ei.updateQueue,s===null?(s={lastEffect:null,stores:null},ei.updateQueue=s,s.stores=[i]):(h=s.stores,h===null?s.stores=[i]:h.push(i))}function gD(i,s,h,f){s.value=h,s.getSnapshot=f,yD(s)&&vD(i)}function _D(i,s,h){return h(function(){yD(s)&&vD(i)})}function yD(i){var s=i.getSnapshot;i=i.value;try{var h=s();return!Zs(i,h)}catch{return!0}}function vD(i){var s=tl(i,1);s!==null&&qs(s,i,1,-1)}function tL(i){var s=ma();return typeof i=="function"&&(i=i()),s.memoizedState=s.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rp,lastRenderedState:i},s.queue=i,i=i.dispatch=B7.bind(null,ei,i),[s.memoizedState,i]}function kp(i,s,h,f){return i={tag:i,create:s,destroy:h,deps:f,next:null},s=ei.updateQueue,s===null?(s={lastEffect:null,stores:null},ei.updateQueue=s,s.lastEffect=i.next=i):(h=s.lastEffect,h===null?s.lastEffect=i.next=i:(f=h.next,h.next=i,i.next=f,s.lastEffect=i)),i}function xD(){return Ts().memoizedState}function j_(i,s,h,f){var g=ma();ei.flags|=i,g.memoizedState=kp(1|s,h,void 0,f===void 0?null:f)}function Qy(i,s,h,f){var g=Ts();f=f===void 0?null:f;var y=void 0;if(Oi!==null){var b=Oi.memoizedState;if(y=b.destroy,f!==null&&gS(f,b.deps)){g.memoizedState=kp(s,h,y,f);return}}ei.flags|=i,g.memoizedState=kp(1|s,h,y,f)}function eL(i,s){return j_(8390656,8,i,s)}function vS(i,s){return Qy(2048,8,i,s)}function bD(i,s){return Qy(4,2,i,s)}function wD(i,s){return Qy(4,4,i,s)}function TD(i,s){if(typeof s=="function")return i=i(),s(i),function(){s(null)};if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function SD(i,s,h){return h=h!=null?h.concat([i]):null,Qy(4,4,TD.bind(null,s,i),h)}function xS(){}function ED(i,s){var h=Ts();s=s===void 0?null:s;var f=h.memoizedState;return f!==null&&s!==null&&gS(s,f[1])?f[0]:(h.memoizedState=[i,s],i)}function CD(i,s){var h=Ts();s=s===void 0?null:s;var f=h.memoizedState;return f!==null&&s!==null&&gS(s,f[1])?f[0]:(i=i(),h.memoizedState=[i,s],i)}function MD(i,s,h){return du&21?(Zs(h,s)||(h=Pz(),ei.lanes|=h,fu|=h,i.baseState=!0),s):(i.baseState&&(i.baseState=!1,Po=!0),i.memoizedState=h)}function z7(i,s){var h=xr;xr=h!==0&&4>h?h:4,i(!0);var f=Kb.transition;Kb.transition={};try{i(!1),s()}finally{xr=h,Kb.transition=f}}function ID(){return Ts().memoizedState}function D7(i,s,h){var f=rc(i);if(h={lane:f,action:h,hasEagerState:!1,eagerState:null,next:null},AD(i))PD(s,h);else if(h=sD(i,s,h,f),h!==null){var g=mo();qs(h,i,f,g),RD(h,s,f)}}function B7(i,s,h){var f=rc(i),g={lane:f,action:h,hasEagerState:!1,eagerState:null,next:null};if(AD(i))PD(s,g);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var b=s.lastRenderedState,M=y(b,h);if(g.hasEagerState=!0,g.eagerState=M,Zs(M,b)){var E=s.interleaved;E===null?(g.next=g,hS(s)):(g.next=E.next,E.next=g),s.interleaved=g;return}}catch{}finally{}h=sD(i,s,g,f),h!==null&&(g=mo(),qs(h,i,f,g),RD(h,s,f))}}function AD(i){var s=i.alternate;return i===ei||s!==null&&s===ei}function PD(i,s){lp=xy=!0;var h=i.pending;h===null?s.next=s:(s.next=h.next,h.next=s),i.pending=s}function RD(i,s,h){if(h&4194240){var f=s.lanes;f&=i.pendingLanes,h|=f,s.lanes=h,YT(i,h)}}var by={readContext:ws,useCallback:Qi,useContext:Qi,useEffect:Qi,useImperativeHandle:Qi,useInsertionEffect:Qi,useLayoutEffect:Qi,useMemo:Qi,useReducer:Qi,useRef:Qi,useState:Qi,useDebugValue:Qi,useDeferredValue:Qi,useTransition:Qi,useMutableSource:Qi,useSyncExternalStore:Qi,useId:Qi,unstable_isNewReconciler:!1},F7={readContext:ws,useCallback:function(i,s){return ma().memoizedState=[i,s===void 0?null:s],i},useContext:ws,useEffect:eL,useImperativeHandle:function(i,s,h){return h=h!=null?h.concat([i]):null,j_(4194308,4,TD.bind(null,s,i),h)},useLayoutEffect:function(i,s){return j_(4194308,4,i,s)},useInsertionEffect:function(i,s){return j_(4,2,i,s)},useMemo:function(i,s){var h=ma();return s=s===void 0?null:s,i=i(),h.memoizedState=[i,s],i},useReducer:function(i,s,h){var f=ma();return s=h!==void 0?h(s):s,f.memoizedState=f.baseState=s,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:s},f.queue=i,i=i.dispatch=D7.bind(null,ei,i),[f.memoizedState,i]},useRef:function(i){var s=ma();return i={current:i},s.memoizedState=i},useState:tL,useDebugValue:xS,useDeferredValue:function(i){return ma().memoizedState=i},useTransition:function(){var i=tL(!1),s=i[0];return i=z7.bind(null,i[1]),ma().memoizedState=i,[s,i]},useMutableSource:function(){},useSyncExternalStore:function(i,s,h){var f=ei,g=ma();if(Zr){if(h===void 0)throw Error(Se(407));h=h()}else{if(h=s(),Fi===null)throw Error(Se(349));du&30||mD(f,s,h)}g.memoizedState=h;var y={value:h,getSnapshot:s};return g.queue=y,eL(_D.bind(null,f,y,i),[i]),f.flags|=2048,kp(9,gD.bind(null,f,y,h,s),void 0,null),h},useId:function(){var i=ma(),s=Fi.identifierPrefix;if(Zr){var h=Ka,f=Xa;h=(f&~(1<<32-Ws(f)-1)).toString(32)+h,s=":"+s+"R"+h,h=Pp++,0<h&&(s+="H"+h.toString(32)),s+=":"}else h=L7++,s=":"+s+"r"+h.toString(32)+":";return i.memoizedState=s},unstable_isNewReconciler:!1},N7={readContext:ws,useCallback:ED,useContext:ws,useEffect:vS,useImperativeHandle:SD,useInsertionEffect:bD,useLayoutEffect:wD,useMemo:CD,useReducer:Yb,useRef:xD,useState:function(){return Yb(Rp)},useDebugValue:xS,useDeferredValue:function(i){var s=Ts();return MD(s,Oi.memoizedState,i)},useTransition:function(){var i=Yb(Rp)[0],s=Ts().memoizedState;return[i,s]},useMutableSource:fD,useSyncExternalStore:pD,useId:ID,unstable_isNewReconciler:!1},j7={readContext:ws,useCallback:ED,useContext:ws,useEffect:vS,useImperativeHandle:SD,useInsertionEffect:bD,useLayoutEffect:wD,useMemo:CD,useReducer:Qb,useRef:xD,useState:function(){return Qb(Rp)},useDebugValue:xS,useDeferredValue:function(i){var s=Ts();return Oi===null?s.memoizedState=i:MD(s,Oi.memoizedState,i)},useTransition:function(){var i=Qb(Rp)[0],s=Ts().memoizedState;return[i,s]},useMutableSource:fD,useSyncExternalStore:pD,useId:ID,unstable_isNewReconciler:!1};function sd(i,s){try{var h="",f=s;do h+=pG(f),f=f.return;while(f);var g=h}catch(y){g=`
Error generating stack: `+y.message+`
`+y.stack}return{value:i,source:s,stack:g,digest:null}}function Jb(i,s,h){return{value:i,source:null,stack:h??null,digest:s??null}}function nT(i,s){try{console.error(s.value)}catch(h){setTimeout(function(){throw h})}}var U7=typeof WeakMap=="function"?WeakMap:Map;function kD(i,s,h){h=Ya(-1,h),h.tag=3,h.payload={element:null};var f=s.value;return h.callback=function(){Ty||(Ty=!0,dT=f),nT(i,s)},h}function OD(i,s,h){h=Ya(-1,h),h.tag=3;var f=i.type.getDerivedStateFromError;if(typeof f=="function"){var g=s.value;h.payload=function(){return f(g)},h.callback=function(){nT(i,s)}}var y=i.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(h.callback=function(){nT(i,s),typeof f!="function"&&(nc===null?nc=new Set([this]):nc.add(this));var b=s.stack;this.componentDidCatch(s.value,{componentStack:b!==null?b:""})}),h}function nL(i,s,h){var f=i.pingCache;if(f===null){f=i.pingCache=new U7;var g=new Set;f.set(s,g)}else g=f.get(s),g===void 0&&(g=new Set,f.set(s,g));g.has(h)||(g.add(h),i=e9.bind(null,i,s,h),s.then(i,i))}function rL(i){do{var s;if((s=i.tag===13)&&(s=i.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return i;i=i.return}while(i!==null);return null}function iL(i,s,h,f,g){return i.mode&1?(i.flags|=65536,i.lanes=g,i):(i===s?i.flags|=65536:(i.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(s=Ya(-1,1),s.tag=2,ec(h,s,1))),h.lanes|=1),i)}var $7=nl.ReactCurrentOwner,Po=!1;function po(i,s,h,f){s.child=i===null?hD(s,null,h,f):id(s,i.child,h,f)}function oL(i,s,h,f,g){h=h.render;var y=s.ref;return Zh(s,g),f=_S(i,s,h,f,y,g),h=yS(),i!==null&&!Po?(s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~g,el(i,s,g)):(Zr&&h&&oS(s),s.flags|=1,po(i,s,f,g),s.child)}function sL(i,s,h,f,g){if(i===null){var y=h.type;return typeof y=="function"&&!IS(y)&&y.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(s.tag=15,s.type=y,LD(i,s,y,f,g)):(i=G_(h.type,null,f,s,s.mode,g),i.ref=s.ref,i.return=s,s.child=i)}if(y=i.child,!(i.lanes&g)){var b=y.memoizedProps;if(h=h.compare,h=h!==null?h:Sp,h(b,f)&&i.ref===s.ref)return el(i,s,g)}return s.flags|=1,i=ic(y,f),i.ref=s.ref,i.return=s,s.child=i}function LD(i,s,h,f,g){if(i!==null){var y=i.memoizedProps;if(Sp(y,f)&&i.ref===s.ref)if(Po=!1,s.pendingProps=f=y,(i.lanes&g)!==0)i.flags&131072&&(Po=!0);else return s.lanes=i.lanes,el(i,s,g)}return rT(i,s,h,f,g)}function zD(i,s,h){var f=s.pendingProps,g=f.children,y=i!==null?i.memoizedState:null;if(f.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},Br(Uh,Xo),Xo|=h;else{if(!(h&1073741824))return i=y!==null?y.baseLanes|h:h,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:i,cachePool:null,transitions:null},s.updateQueue=null,Br(Uh,Xo),Xo|=i,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=y!==null?y.baseLanes:h,Br(Uh,Xo),Xo|=f}else y!==null?(f=y.baseLanes|h,s.memoizedState=null):f=h,Br(Uh,Xo),Xo|=f;return po(i,s,g,h),s.child}function DD(i,s){var h=s.ref;(i===null&&h!==null||i!==null&&i.ref!==h)&&(s.flags|=512,s.flags|=2097152)}function rT(i,s,h,f,g){var y=ko(h)?uu:ro.current;return y=nd(s,y),Zh(s,g),h=_S(i,s,h,f,y,g),f=yS(),i!==null&&!Po?(s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~g,el(i,s,g)):(Zr&&f&&oS(s),s.flags|=1,po(i,s,h,g),s.child)}function aL(i,s,h,f,g){if(ko(h)){var y=!0;fy(s)}else y=!1;if(Zh(s,g),s.stateNode===null)U_(i,s),cD(s,h,f),eT(s,h,f,g),f=!0;else if(i===null){var b=s.stateNode,M=s.memoizedProps;b.props=M;var E=b.context,C=h.contextType;typeof C=="object"&&C!==null?C=ws(C):(C=ko(h)?uu:ro.current,C=nd(s,C));var L=h.getDerivedStateFromProps,B=typeof L=="function"||typeof b.getSnapshotBeforeUpdate=="function";B||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(M!==f||E!==C)&&QO(s,b,f,C),Gl=!1;var z=s.memoizedState;b.state=z,yy(s,f,b,g),E=s.memoizedState,M!==f||z!==E||Ro.current||Gl?(typeof L=="function"&&(tT(s,h,L,f),E=s.memoizedState),(M=Gl||YO(s,h,M,f,z,E,C))?(B||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(s.flags|=4194308)):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=E),b.props=f,b.state=E,b.context=C,f=M):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{b=s.stateNode,aD(i,s),M=s.memoizedProps,C=s.type===s.elementType?M:$s(s.type,M),b.props=C,B=s.pendingProps,z=b.context,E=h.contextType,typeof E=="object"&&E!==null?E=ws(E):(E=ko(h)?uu:ro.current,E=nd(s,E));var H=h.getDerivedStateFromProps;(L=typeof H=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(M!==B||z!==E)&&QO(s,b,f,E),Gl=!1,z=s.memoizedState,b.state=z,yy(s,f,b,g);var U=s.memoizedState;M!==B||z!==U||Ro.current||Gl?(typeof H=="function"&&(tT(s,h,H,f),U=s.memoizedState),(C=Gl||YO(s,h,C,f,z,U,E)||!1)?(L||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(f,U,E),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(f,U,E)),typeof b.componentDidUpdate=="function"&&(s.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof b.componentDidUpdate!="function"||M===i.memoizedProps&&z===i.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||M===i.memoizedProps&&z===i.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=U),b.props=f,b.state=U,b.context=E,f=C):(typeof b.componentDidUpdate!="function"||M===i.memoizedProps&&z===i.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||M===i.memoizedProps&&z===i.memoizedState||(s.flags|=1024),f=!1)}return iT(i,s,h,f,y,g)}function iT(i,s,h,f,g,y){DD(i,s);var b=(s.flags&128)!==0;if(!f&&!b)return g&&qO(s,h,!1),el(i,s,y);f=s.stateNode,$7.current=s;var M=b&&typeof h.getDerivedStateFromError!="function"?null:f.render();return s.flags|=1,i!==null&&b?(s.child=id(s,i.child,null,y),s.child=id(s,null,M,y)):po(i,s,M,y),s.memoizedState=f.state,g&&qO(s,h,!0),s.child}function BD(i){var s=i.stateNode;s.pendingContext?WO(i,s.pendingContext,s.pendingContext!==s.context):s.context&&WO(i,s.context,!1),fS(i,s.containerInfo)}function lL(i,s,h,f,g){return rd(),aS(g),s.flags|=256,po(i,s,h,f),s.child}var oT={dehydrated:null,treeContext:null,retryLane:0};function sT(i){return{baseLanes:i,cachePool:null,transitions:null}}function FD(i,s,h){var f=s.pendingProps,g=ti.current,y=!1,b=(s.flags&128)!==0,M;if((M=b)||(M=i!==null&&i.memoizedState===null?!1:(g&2)!==0),M?(y=!0,s.flags&=-129):(i===null||i.memoizedState!==null)&&(g|=1),Br(ti,g&1),i===null)return Qw(s),i=s.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(s.mode&1?i.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(b=f.children,i=f.fallback,y?(f=s.mode,y=s.child,b={mode:"hidden",children:b},!(f&1)&&y!==null?(y.childLanes=0,y.pendingProps=b):y=e0(b,f,0,null),i=su(i,f,h,null),y.return=s,i.return=s,y.sibling=i,s.child=y,s.child.memoizedState=sT(h),s.memoizedState=oT,i):bS(s,b));if(g=i.memoizedState,g!==null&&(M=g.dehydrated,M!==null))return V7(i,s,b,f,M,g,h);if(y){y=f.fallback,b=s.mode,g=i.child,M=g.sibling;var E={mode:"hidden",children:f.children};return!(b&1)&&s.child!==g?(f=s.child,f.childLanes=0,f.pendingProps=E,s.deletions=null):(f=ic(g,E),f.subtreeFlags=g.subtreeFlags&14680064),M!==null?y=ic(M,y):(y=su(y,b,h,null),y.flags|=2),y.return=s,f.return=s,f.sibling=y,s.child=f,f=y,y=s.child,b=i.child.memoizedState,b=b===null?sT(h):{baseLanes:b.baseLanes|h,cachePool:null,transitions:b.transitions},y.memoizedState=b,y.childLanes=i.childLanes&~h,s.memoizedState=oT,f}return y=i.child,i=y.sibling,f=ic(y,{mode:"visible",children:f.children}),!(s.mode&1)&&(f.lanes=h),f.return=s,f.sibling=null,i!==null&&(h=s.deletions,h===null?(s.deletions=[i],s.flags|=16):h.push(i)),s.child=f,s.memoizedState=null,f}function bS(i,s){return s=e0({mode:"visible",children:s},i.mode,0,null),s.return=i,i.child=s}function __(i,s,h,f){return f!==null&&aS(f),id(s,i.child,null,h),i=bS(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function V7(i,s,h,f,g,y,b){if(h)return s.flags&256?(s.flags&=-257,f=Jb(Error(Se(422))),__(i,s,b,f)):s.memoizedState!==null?(s.child=i.child,s.flags|=128,null):(y=f.fallback,g=s.mode,f=e0({mode:"visible",children:f.children},g,0,null),y=su(y,g,b,null),y.flags|=2,f.return=s,y.return=s,f.sibling=y,s.child=f,s.mode&1&&id(s,i.child,null,b),s.child.memoizedState=sT(b),s.memoizedState=oT,y);if(!(s.mode&1))return __(i,s,b,null);if(g.data==="$!"){if(f=g.nextSibling&&g.nextSibling.dataset,f)var M=f.dgst;return f=M,y=Error(Se(419)),f=Jb(y,f,void 0),__(i,s,b,f)}if(M=(b&i.childLanes)!==0,Po||M){if(f=Fi,f!==null){switch(b&-b){case 4:g=2;break;case 16:g=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:g=32;break;case 536870912:g=268435456;break;default:g=0}g=g&(f.suspendedLanes|b)?0:g,g!==0&&g!==y.retryLane&&(y.retryLane=g,tl(i,g),qs(f,i,g,-1))}return MS(),f=Jb(Error(Se(421))),__(i,s,b,f)}return g.data==="$?"?(s.flags|=128,s.child=i.child,s=n9.bind(null,i),g._reactRetry=s,null):(i=y.treeContext,Yo=tc(g.nextSibling),Qo=s,Zr=!0,Gs=null,i!==null&&(_s[ys++]=Xa,_s[ys++]=Ka,_s[ys++]=hu,Xa=i.id,Ka=i.overflow,hu=s),s=bS(s,f.children),s.flags|=4096,s)}function cL(i,s,h){i.lanes|=s;var f=i.alternate;f!==null&&(f.lanes|=s),Jw(i.return,s,h)}function tw(i,s,h,f,g){var y=i.memoizedState;y===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:h,tailMode:g}:(y.isBackwards=s,y.rendering=null,y.renderingStartTime=0,y.last=f,y.tail=h,y.tailMode=g)}function ND(i,s,h){var f=s.pendingProps,g=f.revealOrder,y=f.tail;if(po(i,s,f.children,h),f=ti.current,f&2)f=f&1|2,s.flags|=128;else{if(i!==null&&i.flags&128)t:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&cL(i,h,s);else if(i.tag===19)cL(i,h,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break t;for(;i.sibling===null;){if(i.return===null||i.return===s)break t;i=i.return}i.sibling.return=i.return,i=i.sibling}f&=1}if(Br(ti,f),!(s.mode&1))s.memoizedState=null;else switch(g){case"forwards":for(h=s.child,g=null;h!==null;)i=h.alternate,i!==null&&vy(i)===null&&(g=h),h=h.sibling;h=g,h===null?(g=s.child,s.child=null):(g=h.sibling,h.sibling=null),tw(s,!1,g,h,y);break;case"backwards":for(h=null,g=s.child,s.child=null;g!==null;){if(i=g.alternate,i!==null&&vy(i)===null){s.child=g;break}i=g.sibling,g.sibling=h,h=g,g=i}tw(s,!0,h,null,y);break;case"together":tw(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function U_(i,s){!(s.mode&1)&&i!==null&&(i.alternate=null,s.alternate=null,s.flags|=2)}function el(i,s,h){if(i!==null&&(s.dependencies=i.dependencies),fu|=s.lanes,!(h&s.childLanes))return null;if(i!==null&&s.child!==i.child)throw Error(Se(153));if(s.child!==null){for(i=s.child,h=ic(i,i.pendingProps),s.child=h,h.return=s;i.sibling!==null;)i=i.sibling,h=h.sibling=ic(i,i.pendingProps),h.return=s;h.sibling=null}return s.child}function G7(i,s,h){switch(s.tag){case 3:BD(s),rd();break;case 5:dD(s);break;case 1:ko(s.type)&&fy(s);break;case 4:fS(s,s.stateNode.containerInfo);break;case 10:var f=s.type._context,g=s.memoizedProps.value;Br(gy,f._currentValue),f._currentValue=g;break;case 13:if(f=s.memoizedState,f!==null)return f.dehydrated!==null?(Br(ti,ti.current&1),s.flags|=128,null):h&s.child.childLanes?FD(i,s,h):(Br(ti,ti.current&1),i=el(i,s,h),i!==null?i.sibling:null);Br(ti,ti.current&1);break;case 19:if(f=(h&s.childLanes)!==0,i.flags&128){if(f)return ND(i,s,h);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Br(ti,ti.current),f)break;return null;case 22:case 23:return s.lanes=0,zD(i,s,h)}return el(i,s,h)}var jD,aT,UD,$D;jD=function(i,s){for(var h=s.child;h!==null;){if(h.tag===5||h.tag===6)i.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===s)break;for(;h.sibling===null;){if(h.return===null||h.return===s)return;h=h.return}h.sibling.return=h.return,h=h.sibling}};aT=function(){};UD=function(i,s,h,f){var g=i.memoizedProps;if(g!==f){i=s.stateNode,eu(ba.current);var y=null;switch(h){case"input":g=Aw(i,g),f=Aw(i,f),y=[];break;case"select":g=ni({},g,{value:void 0}),f=ni({},f,{value:void 0}),y=[];break;case"textarea":g=kw(i,g),f=kw(i,f),y=[];break;default:typeof g.onClick!="function"&&typeof f.onClick=="function"&&(i.onclick=hy)}Lw(h,f);var b;h=null;for(C in g)if(!f.hasOwnProperty(C)&&g.hasOwnProperty(C)&&g[C]!=null)if(C==="style"){var M=g[C];for(b in M)M.hasOwnProperty(b)&&(h||(h={}),h[b]="")}else C!=="dangerouslySetInnerHTML"&&C!=="children"&&C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(_p.hasOwnProperty(C)?y||(y=[]):(y=y||[]).push(C,null));for(C in f){var E=f[C];if(M=g!=null?g[C]:void 0,f.hasOwnProperty(C)&&E!==M&&(E!=null||M!=null))if(C==="style")if(M){for(b in M)!M.hasOwnProperty(b)||E&&E.hasOwnProperty(b)||(h||(h={}),h[b]="");for(b in E)E.hasOwnProperty(b)&&M[b]!==E[b]&&(h||(h={}),h[b]=E[b])}else h||(y||(y=[]),y.push(C,h)),h=E;else C==="dangerouslySetInnerHTML"?(E=E?E.__html:void 0,M=M?M.__html:void 0,E!=null&&M!==E&&(y=y||[]).push(C,E)):C==="children"?typeof E!="string"&&typeof E!="number"||(y=y||[]).push(C,""+E):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&(_p.hasOwnProperty(C)?(E!=null&&C==="onScroll"&&Ur("scroll",i),y||M===E||(y=[])):(y=y||[]).push(C,E))}h&&(y=y||[]).push("style",h);var C=y;(s.updateQueue=C)&&(s.flags|=4)}};$D=function(i,s,h,f){h!==f&&(s.flags|=4)};function jf(i,s){if(!Zr)switch(i.tailMode){case"hidden":s=i.tail;for(var h=null;s!==null;)s.alternate!==null&&(h=s),s=s.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var f=null;h!==null;)h.alternate!==null&&(f=h),h=h.sibling;f===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function Ji(i){var s=i.alternate!==null&&i.alternate.child===i.child,h=0,f=0;if(s)for(var g=i.child;g!==null;)h|=g.lanes|g.childLanes,f|=g.subtreeFlags&14680064,f|=g.flags&14680064,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)h|=g.lanes|g.childLanes,f|=g.subtreeFlags,f|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=f,i.childLanes=h,s}function W7(i,s,h){var f=s.pendingProps;switch(sS(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ji(s),null;case 1:return ko(s.type)&&dy(),Ji(s),null;case 3:return f=s.stateNode,od(),Vr(Ro),Vr(ro),mS(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(i===null||i.child===null)&&(m_(s)?s.flags|=4:i===null||i.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,Gs!==null&&(mT(Gs),Gs=null))),aT(i,s),Ji(s),null;case 5:pS(s);var g=eu(Ap.current);if(h=s.type,i!==null&&s.stateNode!=null)UD(i,s,h,f,g),i.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!f){if(s.stateNode===null)throw Error(Se(166));return Ji(s),null}if(i=eu(ba.current),m_(s)){f=s.stateNode,h=s.type;var y=s.memoizedProps;switch(f[va]=s,f[Mp]=y,i=(s.mode&1)!==0,h){case"dialog":Ur("cancel",f),Ur("close",f);break;case"iframe":case"object":case"embed":Ur("load",f);break;case"video":case"audio":for(g=0;g<tp.length;g++)Ur(tp[g],f);break;case"source":Ur("error",f);break;case"img":case"image":case"link":Ur("error",f),Ur("load",f);break;case"details":Ur("toggle",f);break;case"input":yO(f,y),Ur("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!y.multiple},Ur("invalid",f);break;case"textarea":xO(f,y),Ur("invalid",f)}Lw(h,y),g=null;for(var b in y)if(y.hasOwnProperty(b)){var M=y[b];b==="children"?typeof M=="string"?f.textContent!==M&&(y.suppressHydrationWarning!==!0&&p_(f.textContent,M,i),g=["children",M]):typeof M=="number"&&f.textContent!==""+M&&(y.suppressHydrationWarning!==!0&&p_(f.textContent,M,i),g=["children",""+M]):_p.hasOwnProperty(b)&&M!=null&&b==="onScroll"&&Ur("scroll",f)}switch(h){case"input":s_(f),vO(f,y,!0);break;case"textarea":s_(f),bO(f);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(f.onclick=hy)}f=g,s.updateQueue=f,f!==null&&(s.flags|=4)}else{b=g.nodeType===9?g:g.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=mz(h)),i==="http://www.w3.org/1999/xhtml"?h==="script"?(i=b.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof f.is=="string"?i=b.createElement(h,{is:f.is}):(i=b.createElement(h),h==="select"&&(b=i,f.multiple?b.multiple=!0:f.size&&(b.size=f.size))):i=b.createElementNS(i,h),i[va]=s,i[Mp]=f,jD(i,s,!1,!1),s.stateNode=i;t:{switch(b=zw(h,f),h){case"dialog":Ur("cancel",i),Ur("close",i),g=f;break;case"iframe":case"object":case"embed":Ur("load",i),g=f;break;case"video":case"audio":for(g=0;g<tp.length;g++)Ur(tp[g],i);g=f;break;case"source":Ur("error",i),g=f;break;case"img":case"image":case"link":Ur("error",i),Ur("load",i),g=f;break;case"details":Ur("toggle",i),g=f;break;case"input":yO(i,f),g=Aw(i,f),Ur("invalid",i);break;case"option":g=f;break;case"select":i._wrapperState={wasMultiple:!!f.multiple},g=ni({},f,{value:void 0}),Ur("invalid",i);break;case"textarea":xO(i,f),g=kw(i,f),Ur("invalid",i);break;default:g=f}Lw(h,g),M=g;for(y in M)if(M.hasOwnProperty(y)){var E=M[y];y==="style"?yz(i,E):y==="dangerouslySetInnerHTML"?(E=E?E.__html:void 0,E!=null&&gz(i,E)):y==="children"?typeof E=="string"?(h!=="textarea"||E!=="")&&yp(i,E):typeof E=="number"&&yp(i,""+E):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(_p.hasOwnProperty(y)?E!=null&&y==="onScroll"&&Ur("scroll",i):E!=null&&WT(i,y,E,b))}switch(h){case"input":s_(i),vO(i,f,!1);break;case"textarea":s_(i),bO(i);break;case"option":f.value!=null&&i.setAttribute("value",""+sc(f.value));break;case"select":i.multiple=!!f.multiple,y=f.value,y!=null?Gh(i,!!f.multiple,y,!1):f.defaultValue!=null&&Gh(i,!!f.multiple,f.defaultValue,!0);break;default:typeof g.onClick=="function"&&(i.onclick=hy)}switch(h){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break t;case"img":f=!0;break t;default:f=!1}}f&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return Ji(s),null;case 6:if(i&&s.stateNode!=null)$D(i,s,i.memoizedProps,f);else{if(typeof f!="string"&&s.stateNode===null)throw Error(Se(166));if(h=eu(Ap.current),eu(ba.current),m_(s)){if(f=s.stateNode,h=s.memoizedProps,f[va]=s,(y=f.nodeValue!==h)&&(i=Qo,i!==null))switch(i.tag){case 3:p_(f.nodeValue,h,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&p_(f.nodeValue,h,(i.mode&1)!==0)}y&&(s.flags|=4)}else f=(h.nodeType===9?h:h.ownerDocument).createTextNode(f),f[va]=s,s.stateNode=f}return Ji(s),null;case 13:if(Vr(ti),f=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Zr&&Yo!==null&&s.mode&1&&!(s.flags&128))oD(),rd(),s.flags|=98560,y=!1;else if(y=m_(s),f!==null&&f.dehydrated!==null){if(i===null){if(!y)throw Error(Se(318));if(y=s.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(Se(317));y[va]=s}else rd(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;Ji(s),y=!1}else Gs!==null&&(mT(Gs),Gs=null),y=!0;if(!y)return s.flags&65536?s:null}return s.flags&128?(s.lanes=h,s):(f=f!==null,f!==(i!==null&&i.memoizedState!==null)&&f&&(s.child.flags|=8192,s.mode&1&&(i===null||ti.current&1?Li===0&&(Li=3):MS())),s.updateQueue!==null&&(s.flags|=4),Ji(s),null);case 4:return od(),aT(i,s),i===null&&Ep(s.stateNode.containerInfo),Ji(s),null;case 10:return uS(s.type._context),Ji(s),null;case 17:return ko(s.type)&&dy(),Ji(s),null;case 19:if(Vr(ti),y=s.memoizedState,y===null)return Ji(s),null;if(f=(s.flags&128)!==0,b=y.rendering,b===null)if(f)jf(y,!1);else{if(Li!==0||i!==null&&i.flags&128)for(i=s.child;i!==null;){if(b=vy(i),b!==null){for(s.flags|=128,jf(y,!1),f=b.updateQueue,f!==null&&(s.updateQueue=f,s.flags|=4),s.subtreeFlags=0,f=h,h=s.child;h!==null;)y=h,i=f,y.flags&=14680066,b=y.alternate,b===null?(y.childLanes=0,y.lanes=i,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=b.childLanes,y.lanes=b.lanes,y.child=b.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=b.memoizedProps,y.memoizedState=b.memoizedState,y.updateQueue=b.updateQueue,y.type=b.type,i=b.dependencies,y.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),h=h.sibling;return Br(ti,ti.current&1|2),s.child}i=i.sibling}y.tail!==null&&mi()>ad&&(s.flags|=128,f=!0,jf(y,!1),s.lanes=4194304)}else{if(!f)if(i=vy(b),i!==null){if(s.flags|=128,f=!0,h=i.updateQueue,h!==null&&(s.updateQueue=h,s.flags|=4),jf(y,!0),y.tail===null&&y.tailMode==="hidden"&&!b.alternate&&!Zr)return Ji(s),null}else 2*mi()-y.renderingStartTime>ad&&h!==1073741824&&(s.flags|=128,f=!0,jf(y,!1),s.lanes=4194304);y.isBackwards?(b.sibling=s.child,s.child=b):(h=y.last,h!==null?h.sibling=b:s.child=b,y.last=b)}return y.tail!==null?(s=y.tail,y.rendering=s,y.tail=s.sibling,y.renderingStartTime=mi(),s.sibling=null,h=ti.current,Br(ti,f?h&1|2:h&1),s):(Ji(s),null);case 22:case 23:return CS(),f=s.memoizedState!==null,i!==null&&i.memoizedState!==null!==f&&(s.flags|=8192),f&&s.mode&1?Xo&1073741824&&(Ji(s),s.subtreeFlags&6&&(s.flags|=8192)):Ji(s),null;case 24:return null;case 25:return null}throw Error(Se(156,s.tag))}function q7(i,s){switch(sS(s),s.tag){case 1:return ko(s.type)&&dy(),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return od(),Vr(Ro),Vr(ro),mS(),i=s.flags,i&65536&&!(i&128)?(s.flags=i&-65537|128,s):null;case 5:return pS(s),null;case 13:if(Vr(ti),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(Se(340));rd()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return Vr(ti),null;case 4:return od(),null;case 10:return uS(s.type._context),null;case 22:case 23:return CS(),null;case 24:return null;default:return null}}var y_=!1,eo=!1,H7=typeof WeakSet=="function"?WeakSet:Set,Ye=null;function jh(i,s){var h=i.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(f){li(i,s,f)}else h.current=null}function lT(i,s,h){try{h()}catch(f){li(i,s,f)}}var uL=!1;function Z7(i,s){if(Ww=ly,i=qz(),iS(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else t:{h=(h=i.ownerDocument)&&h.defaultView||window;var f=h.getSelection&&h.getSelection();if(f&&f.rangeCount!==0){h=f.anchorNode;var g=f.anchorOffset,y=f.focusNode;f=f.focusOffset;try{h.nodeType,y.nodeType}catch{h=null;break t}var b=0,M=-1,E=-1,C=0,L=0,B=i,z=null;e:for(;;){for(var H;B!==h||g!==0&&B.nodeType!==3||(M=b+g),B!==y||f!==0&&B.nodeType!==3||(E=b+f),B.nodeType===3&&(b+=B.nodeValue.length),(H=B.firstChild)!==null;)z=B,B=H;for(;;){if(B===i)break e;if(z===h&&++C===g&&(M=b),z===y&&++L===f&&(E=b),(H=B.nextSibling)!==null)break;B=z,z=B.parentNode}B=H}h=M===-1||E===-1?null:{start:M,end:E}}else h=null}h=h||{start:0,end:0}}else h=null;for(qw={focusedElem:i,selectionRange:h},ly=!1,Ye=s;Ye!==null;)if(s=Ye,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,Ye=i;else for(;Ye!==null;){s=Ye;try{var U=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(U!==null){var q=U.memoizedProps,tt=U.memoizedState,V=s.stateNode,F=V.getSnapshotBeforeUpdate(s.elementType===s.type?q:$s(s.type,q),tt);V.__reactInternalSnapshotBeforeUpdate=F}break;case 3:var D=s.stateNode.containerInfo;D.nodeType===1?D.textContent="":D.nodeType===9&&D.documentElement&&D.removeChild(D.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Se(163))}}catch($){li(s,s.return,$)}if(i=s.sibling,i!==null){i.return=s.return,Ye=i;break}Ye=s.return}return U=uL,uL=!1,U}function cp(i,s,h){var f=s.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var g=f=f.next;do{if((g.tag&i)===i){var y=g.destroy;g.destroy=void 0,y!==void 0&&lT(s,h,y)}g=g.next}while(g!==f)}}function Jy(i,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var h=s=s.next;do{if((h.tag&i)===i){var f=h.create;h.destroy=f()}h=h.next}while(h!==s)}}function cT(i){var s=i.ref;if(s!==null){var h=i.stateNode;switch(i.tag){case 5:i=h;break;default:i=h}typeof s=="function"?s(i):s.current=i}}function VD(i){var s=i.alternate;s!==null&&(i.alternate=null,VD(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&(delete s[va],delete s[Mp],delete s[Xw],delete s[P7],delete s[R7])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function GD(i){return i.tag===5||i.tag===3||i.tag===4}function hL(i){t:for(;;){for(;i.sibling===null;){if(i.return===null||GD(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue t;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function uT(i,s,h){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?h.nodeType===8?h.parentNode.insertBefore(i,s):h.insertBefore(i,s):(h.nodeType===8?(s=h.parentNode,s.insertBefore(i,h)):(s=h,s.appendChild(i)),h=h._reactRootContainer,h!=null||s.onclick!==null||(s.onclick=hy));else if(f!==4&&(i=i.child,i!==null))for(uT(i,s,h),i=i.sibling;i!==null;)uT(i,s,h),i=i.sibling}function hT(i,s,h){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?h.insertBefore(i,s):h.appendChild(i);else if(f!==4&&(i=i.child,i!==null))for(hT(i,s,h),i=i.sibling;i!==null;)hT(i,s,h),i=i.sibling}var Vi=null,Vs=!1;function Nl(i,s,h){for(h=h.child;h!==null;)WD(i,s,h),h=h.sibling}function WD(i,s,h){if(xa&&typeof xa.onCommitFiberUnmount=="function")try{xa.onCommitFiberUnmount(Wy,h)}catch{}switch(h.tag){case 5:eo||jh(h,s);case 6:var f=Vi,g=Vs;Vi=null,Nl(i,s,h),Vi=f,Vs=g,Vi!==null&&(Vs?(i=Vi,h=h.stateNode,i.nodeType===8?i.parentNode.removeChild(h):i.removeChild(h)):Vi.removeChild(h.stateNode));break;case 18:Vi!==null&&(Vs?(i=Vi,h=h.stateNode,i.nodeType===8?Hb(i.parentNode,h):i.nodeType===1&&Hb(i,h),wp(i)):Hb(Vi,h.stateNode));break;case 4:f=Vi,g=Vs,Vi=h.stateNode.containerInfo,Vs=!0,Nl(i,s,h),Vi=f,Vs=g;break;case 0:case 11:case 14:case 15:if(!eo&&(f=h.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){g=f=f.next;do{var y=g,b=y.destroy;y=y.tag,b!==void 0&&(y&2||y&4)&&lT(h,s,b),g=g.next}while(g!==f)}Nl(i,s,h);break;case 1:if(!eo&&(jh(h,s),f=h.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=h.memoizedProps,f.state=h.memoizedState,f.componentWillUnmount()}catch(M){li(h,s,M)}Nl(i,s,h);break;case 21:Nl(i,s,h);break;case 22:h.mode&1?(eo=(f=eo)||h.memoizedState!==null,Nl(i,s,h),eo=f):Nl(i,s,h);break;default:Nl(i,s,h)}}function dL(i){var s=i.updateQueue;if(s!==null){i.updateQueue=null;var h=i.stateNode;h===null&&(h=i.stateNode=new H7),s.forEach(function(f){var g=r9.bind(null,i,f);h.has(f)||(h.add(f),f.then(g,g))})}}function Us(i,s){var h=s.deletions;if(h!==null)for(var f=0;f<h.length;f++){var g=h[f];try{var y=i,b=s,M=b;t:for(;M!==null;){switch(M.tag){case 5:Vi=M.stateNode,Vs=!1;break t;case 3:Vi=M.stateNode.containerInfo,Vs=!0;break t;case 4:Vi=M.stateNode.containerInfo,Vs=!0;break t}M=M.return}if(Vi===null)throw Error(Se(160));WD(y,b,g),Vi=null,Vs=!1;var E=g.alternate;E!==null&&(E.return=null),g.return=null}catch(C){li(g,s,C)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)qD(s,i),s=s.sibling}function qD(i,s){var h=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Us(s,i),fa(i),f&4){try{cp(3,i,i.return),Jy(3,i)}catch(q){li(i,i.return,q)}try{cp(5,i,i.return)}catch(q){li(i,i.return,q)}}break;case 1:Us(s,i),fa(i),f&512&&h!==null&&jh(h,h.return);break;case 5:if(Us(s,i),fa(i),f&512&&h!==null&&jh(h,h.return),i.flags&32){var g=i.stateNode;try{yp(g,"")}catch(q){li(i,i.return,q)}}if(f&4&&(g=i.stateNode,g!=null)){var y=i.memoizedProps,b=h!==null?h.memoizedProps:y,M=i.type,E=i.updateQueue;if(i.updateQueue=null,E!==null)try{M==="input"&&y.type==="radio"&&y.name!=null&&fz(g,y),zw(M,b);var C=zw(M,y);for(b=0;b<E.length;b+=2){var L=E[b],B=E[b+1];L==="style"?yz(g,B):L==="dangerouslySetInnerHTML"?gz(g,B):L==="children"?yp(g,B):WT(g,L,B,C)}switch(M){case"input":Pw(g,y);break;case"textarea":pz(g,y);break;case"select":var z=g._wrapperState.wasMultiple;g._wrapperState.wasMultiple=!!y.multiple;var H=y.value;H!=null?Gh(g,!!y.multiple,H,!1):z!==!!y.multiple&&(y.defaultValue!=null?Gh(g,!!y.multiple,y.defaultValue,!0):Gh(g,!!y.multiple,y.multiple?[]:"",!1))}g[Mp]=y}catch(q){li(i,i.return,q)}}break;case 6:if(Us(s,i),fa(i),f&4){if(i.stateNode===null)throw Error(Se(162));g=i.stateNode,y=i.memoizedProps;try{g.nodeValue=y}catch(q){li(i,i.return,q)}}break;case 3:if(Us(s,i),fa(i),f&4&&h!==null&&h.memoizedState.isDehydrated)try{wp(s.containerInfo)}catch(q){li(i,i.return,q)}break;case 4:Us(s,i),fa(i);break;case 13:Us(s,i),fa(i),g=i.child,g.flags&8192&&(y=g.memoizedState!==null,g.stateNode.isHidden=y,!y||g.alternate!==null&&g.alternate.memoizedState!==null||(SS=mi())),f&4&&dL(i);break;case 22:if(L=h!==null&&h.memoizedState!==null,i.mode&1?(eo=(C=eo)||L,Us(s,i),eo=C):Us(s,i),fa(i),f&8192){if(C=i.memoizedState!==null,(i.stateNode.isHidden=C)&&!L&&i.mode&1)for(Ye=i,L=i.child;L!==null;){for(B=Ye=L;Ye!==null;){switch(z=Ye,H=z.child,z.tag){case 0:case 11:case 14:case 15:cp(4,z,z.return);break;case 1:jh(z,z.return);var U=z.stateNode;if(typeof U.componentWillUnmount=="function"){f=z,h=z.return;try{s=f,U.props=s.memoizedProps,U.state=s.memoizedState,U.componentWillUnmount()}catch(q){li(f,h,q)}}break;case 5:jh(z,z.return);break;case 22:if(z.memoizedState!==null){pL(B);continue}}H!==null?(H.return=z,Ye=H):pL(B)}L=L.sibling}t:for(L=null,B=i;;){if(B.tag===5){if(L===null){L=B;try{g=B.stateNode,C?(y=g.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(M=B.stateNode,E=B.memoizedProps.style,b=E!=null&&E.hasOwnProperty("display")?E.display:null,M.style.display=_z("display",b))}catch(q){li(i,i.return,q)}}}else if(B.tag===6){if(L===null)try{B.stateNode.nodeValue=C?"":B.memoizedProps}catch(q){li(i,i.return,q)}}else if((B.tag!==22&&B.tag!==23||B.memoizedState===null||B===i)&&B.child!==null){B.child.return=B,B=B.child;continue}if(B===i)break t;for(;B.sibling===null;){if(B.return===null||B.return===i)break t;L===B&&(L=null),B=B.return}L===B&&(L=null),B.sibling.return=B.return,B=B.sibling}}break;case 19:Us(s,i),fa(i),f&4&&dL(i);break;case 21:break;default:Us(s,i),fa(i)}}function fa(i){var s=i.flags;if(s&2){try{t:{for(var h=i.return;h!==null;){if(GD(h)){var f=h;break t}h=h.return}throw Error(Se(160))}switch(f.tag){case 5:var g=f.stateNode;f.flags&32&&(yp(g,""),f.flags&=-33);var y=hL(i);hT(i,y,g);break;case 3:case 4:var b=f.stateNode.containerInfo,M=hL(i);uT(i,M,b);break;default:throw Error(Se(161))}}catch(E){li(i,i.return,E)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function X7(i,s,h){Ye=i,HD(i)}function HD(i,s,h){for(var f=(i.mode&1)!==0;Ye!==null;){var g=Ye,y=g.child;if(g.tag===22&&f){var b=g.memoizedState!==null||y_;if(!b){var M=g.alternate,E=M!==null&&M.memoizedState!==null||eo;M=y_;var C=eo;if(y_=b,(eo=E)&&!C)for(Ye=g;Ye!==null;)b=Ye,E=b.child,b.tag===22&&b.memoizedState!==null?mL(g):E!==null?(E.return=b,Ye=E):mL(g);for(;y!==null;)Ye=y,HD(y),y=y.sibling;Ye=g,y_=M,eo=C}fL(i)}else g.subtreeFlags&8772&&y!==null?(y.return=g,Ye=y):fL(i)}}function fL(i){for(;Ye!==null;){var s=Ye;if(s.flags&8772){var h=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:eo||Jy(5,s);break;case 1:var f=s.stateNode;if(s.flags&4&&!eo)if(h===null)f.componentDidMount();else{var g=s.elementType===s.type?h.memoizedProps:$s(s.type,h.memoizedProps);f.componentDidUpdate(g,h.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var y=s.updateQueue;y!==null&&KO(s,y,f);break;case 3:var b=s.updateQueue;if(b!==null){if(h=null,s.child!==null)switch(s.child.tag){case 5:h=s.child.stateNode;break;case 1:h=s.child.stateNode}KO(s,b,h)}break;case 5:var M=s.stateNode;if(h===null&&s.flags&4){h=M;var E=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":E.autoFocus&&h.focus();break;case"img":E.src&&(h.src=E.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var C=s.alternate;if(C!==null){var L=C.memoizedState;if(L!==null){var B=L.dehydrated;B!==null&&wp(B)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Se(163))}eo||s.flags&512&&cT(s)}catch(z){li(s,s.return,z)}}if(s===i){Ye=null;break}if(h=s.sibling,h!==null){h.return=s.return,Ye=h;break}Ye=s.return}}function pL(i){for(;Ye!==null;){var s=Ye;if(s===i){Ye=null;break}var h=s.sibling;if(h!==null){h.return=s.return,Ye=h;break}Ye=s.return}}function mL(i){for(;Ye!==null;){var s=Ye;try{switch(s.tag){case 0:case 11:case 15:var h=s.return;try{Jy(4,s)}catch(E){li(s,h,E)}break;case 1:var f=s.stateNode;if(typeof f.componentDidMount=="function"){var g=s.return;try{f.componentDidMount()}catch(E){li(s,g,E)}}var y=s.return;try{cT(s)}catch(E){li(s,y,E)}break;case 5:var b=s.return;try{cT(s)}catch(E){li(s,b,E)}}}catch(E){li(s,s.return,E)}if(s===i){Ye=null;break}var M=s.sibling;if(M!==null){M.return=s.return,Ye=M;break}Ye=s.return}}var K7=Math.ceil,wy=nl.ReactCurrentDispatcher,wS=nl.ReactCurrentOwner,bs=nl.ReactCurrentBatchConfig,ir=0,Fi=null,Si=null,Wi=0,Xo=0,Uh=fc(0),Li=0,Op=null,fu=0,t0=0,TS=0,up=null,Ao=null,SS=0,ad=1/0,qa=null,Ty=!1,dT=null,nc=null,v_=!1,Xl=null,Sy=0,hp=0,fT=null,$_=-1,V_=0;function mo(){return ir&6?mi():$_!==-1?$_:$_=mi()}function rc(i){return i.mode&1?ir&2&&Wi!==0?Wi&-Wi:O7.transition!==null?(V_===0&&(V_=Pz()),V_):(i=xr,i!==0||(i=window.event,i=i===void 0?16:Bz(i.type)),i):1}function qs(i,s,h,f){if(50<hp)throw hp=0,fT=null,Error(Se(185));Gp(i,h,f),(!(ir&2)||i!==Fi)&&(i===Fi&&(!(ir&2)&&(t0|=h),Li===4&&ql(i,Wi)),Oo(i,f),h===1&&ir===0&&!(s.mode&1)&&(ad=mi()+500,Ky&&pc()))}function Oo(i,s){var h=i.callbackNode;OG(i,s);var f=ay(i,i===Fi?Wi:0);if(f===0)h!==null&&SO(h),i.callbackNode=null,i.callbackPriority=0;else if(s=f&-f,i.callbackPriority!==s){if(h!=null&&SO(h),s===1)i.tag===0?k7(gL.bind(null,i)):nD(gL.bind(null,i)),I7(function(){!(ir&6)&&pc()}),h=null;else{switch(Rz(f)){case 1:h=KT;break;case 4:h=Iz;break;case 16:h=sy;break;case 536870912:h=Az;break;default:h=sy}h=e4(h,ZD.bind(null,i))}i.callbackPriority=s,i.callbackNode=h}}function ZD(i,s){if($_=-1,V_=0,ir&6)throw Error(Se(327));var h=i.callbackNode;if(Xh()&&i.callbackNode!==h)return null;var f=ay(i,i===Fi?Wi:0);if(f===0)return null;if(f&30||f&i.expiredLanes||s)s=Ey(i,f);else{s=f;var g=ir;ir|=2;var y=KD();(Fi!==i||Wi!==s)&&(qa=null,ad=mi()+500,ou(i,s));do try{J7();break}catch(M){XD(i,M)}while(!0);cS(),wy.current=y,ir=g,Si!==null?s=0:(Fi=null,Wi=0,s=Li)}if(s!==0){if(s===2&&(g=jw(i),g!==0&&(f=g,s=pT(i,g))),s===1)throw h=Op,ou(i,0),ql(i,f),Oo(i,mi()),h;if(s===6)ql(i,f);else{if(g=i.current.alternate,!(f&30)&&!Y7(g)&&(s=Ey(i,f),s===2&&(y=jw(i),y!==0&&(f=y,s=pT(i,y))),s===1))throw h=Op,ou(i,0),ql(i,f),Oo(i,mi()),h;switch(i.finishedWork=g,i.finishedLanes=f,s){case 0:case 1:throw Error(Se(345));case 2:Xc(i,Ao,qa);break;case 3:if(ql(i,f),(f&130023424)===f&&(s=SS+500-mi(),10<s)){if(ay(i,0)!==0)break;if(g=i.suspendedLanes,(g&f)!==f){mo(),i.pingedLanes|=i.suspendedLanes&g;break}i.timeoutHandle=Zw(Xc.bind(null,i,Ao,qa),s);break}Xc(i,Ao,qa);break;case 4:if(ql(i,f),(f&4194240)===f)break;for(s=i.eventTimes,g=-1;0<f;){var b=31-Ws(f);y=1<<b,b=s[b],b>g&&(g=b),f&=~y}if(f=g,f=mi()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*K7(f/1960))-f,10<f){i.timeoutHandle=Zw(Xc.bind(null,i,Ao,qa),f);break}Xc(i,Ao,qa);break;case 5:Xc(i,Ao,qa);break;default:throw Error(Se(329))}}}return Oo(i,mi()),i.callbackNode===h?ZD.bind(null,i):null}function pT(i,s){var h=up;return i.current.memoizedState.isDehydrated&&(ou(i,s).flags|=256),i=Ey(i,s),i!==2&&(s=Ao,Ao=h,s!==null&&mT(s)),i}function mT(i){Ao===null?Ao=i:Ao.push.apply(Ao,i)}function Y7(i){for(var s=i;;){if(s.flags&16384){var h=s.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var f=0;f<h.length;f++){var g=h[f],y=g.getSnapshot;g=g.value;try{if(!Zs(y(),g))return!1}catch{return!1}}}if(h=s.child,s.subtreeFlags&16384&&h!==null)h.return=s,s=h;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ql(i,s){for(s&=~TS,s&=~t0,i.suspendedLanes|=s,i.pingedLanes&=~s,i=i.expirationTimes;0<s;){var h=31-Ws(s),f=1<<h;i[h]=-1,s&=~f}}function gL(i){if(ir&6)throw Error(Se(327));Xh();var s=ay(i,0);if(!(s&1))return Oo(i,mi()),null;var h=Ey(i,s);if(i.tag!==0&&h===2){var f=jw(i);f!==0&&(s=f,h=pT(i,f))}if(h===1)throw h=Op,ou(i,0),ql(i,s),Oo(i,mi()),h;if(h===6)throw Error(Se(345));return i.finishedWork=i.current.alternate,i.finishedLanes=s,Xc(i,Ao,qa),Oo(i,mi()),null}function ES(i,s){var h=ir;ir|=1;try{return i(s)}finally{ir=h,ir===0&&(ad=mi()+500,Ky&&pc())}}function pu(i){Xl!==null&&Xl.tag===0&&!(ir&6)&&Xh();var s=ir;ir|=1;var h=bs.transition,f=xr;try{if(bs.transition=null,xr=1,i)return i()}finally{xr=f,bs.transition=h,ir=s,!(ir&6)&&pc()}}function CS(){Xo=Uh.current,Vr(Uh)}function ou(i,s){i.finishedWork=null,i.finishedLanes=0;var h=i.timeoutHandle;if(h!==-1&&(i.timeoutHandle=-1,M7(h)),Si!==null)for(h=Si.return;h!==null;){var f=h;switch(sS(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&dy();break;case 3:od(),Vr(Ro),Vr(ro),mS();break;case 5:pS(f);break;case 4:od();break;case 13:Vr(ti);break;case 19:Vr(ti);break;case 10:uS(f.type._context);break;case 22:case 23:CS()}h=h.return}if(Fi=i,Si=i=ic(i.current,null),Wi=Xo=s,Li=0,Op=null,TS=t0=fu=0,Ao=up=null,tu!==null){for(s=0;s<tu.length;s++)if(h=tu[s],f=h.interleaved,f!==null){h.interleaved=null;var g=f.next,y=h.pending;if(y!==null){var b=y.next;y.next=g,f.next=b}h.pending=f}tu=null}return i}function XD(i,s){do{var h=Si;try{if(cS(),N_.current=by,xy){for(var f=ei.memoizedState;f!==null;){var g=f.queue;g!==null&&(g.pending=null),f=f.next}xy=!1}if(du=0,Di=Oi=ei=null,lp=!1,Pp=0,wS.current=null,h===null||h.return===null){Li=1,Op=s,Si=null;break}t:{var y=i,b=h.return,M=h,E=s;if(s=Wi,M.flags|=32768,E!==null&&typeof E=="object"&&typeof E.then=="function"){var C=E,L=M,B=L.tag;if(!(L.mode&1)&&(B===0||B===11||B===15)){var z=L.alternate;z?(L.updateQueue=z.updateQueue,L.memoizedState=z.memoizedState,L.lanes=z.lanes):(L.updateQueue=null,L.memoizedState=null)}var H=rL(b);if(H!==null){H.flags&=-257,iL(H,b,M,y,s),H.mode&1&&nL(y,C,s),s=H,E=C;var U=s.updateQueue;if(U===null){var q=new Set;q.add(E),s.updateQueue=q}else U.add(E);break t}else{if(!(s&1)){nL(y,C,s),MS();break t}E=Error(Se(426))}}else if(Zr&&M.mode&1){var tt=rL(b);if(tt!==null){!(tt.flags&65536)&&(tt.flags|=256),iL(tt,b,M,y,s),aS(sd(E,M));break t}}y=E=sd(E,M),Li!==4&&(Li=2),up===null?up=[y]:up.push(y),y=b;do{switch(y.tag){case 3:y.flags|=65536,s&=-s,y.lanes|=s;var V=kD(y,E,s);XO(y,V);break t;case 1:M=E;var F=y.type,D=y.stateNode;if(!(y.flags&128)&&(typeof F.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(nc===null||!nc.has(D)))){y.flags|=65536,s&=-s,y.lanes|=s;var $=OD(y,M,s);XO(y,$);break t}}y=y.return}while(y!==null)}QD(h)}catch(J){s=J,Si===h&&h!==null&&(Si=h=h.return);continue}break}while(!0)}function KD(){var i=wy.current;return wy.current=by,i===null?by:i}function MS(){(Li===0||Li===3||Li===2)&&(Li=4),Fi===null||!(fu&268435455)&&!(t0&268435455)||ql(Fi,Wi)}function Ey(i,s){var h=ir;ir|=2;var f=KD();(Fi!==i||Wi!==s)&&(qa=null,ou(i,s));do try{Q7();break}catch(g){XD(i,g)}while(!0);if(cS(),ir=h,wy.current=f,Si!==null)throw Error(Se(261));return Fi=null,Wi=0,Li}function Q7(){for(;Si!==null;)YD(Si)}function J7(){for(;Si!==null&&!SG();)YD(Si)}function YD(i){var s=t4(i.alternate,i,Xo);i.memoizedProps=i.pendingProps,s===null?QD(i):Si=s,wS.current=null}function QD(i){var s=i;do{var h=s.alternate;if(i=s.return,s.flags&32768){if(h=q7(h,s),h!==null){h.flags&=32767,Si=h;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Li=6,Si=null;return}}else if(h=W7(h,s,Xo),h!==null){Si=h;return}if(s=s.sibling,s!==null){Si=s;return}Si=s=i}while(s!==null);Li===0&&(Li=5)}function Xc(i,s,h){var f=xr,g=bs.transition;try{bs.transition=null,xr=1,t9(i,s,h,f)}finally{bs.transition=g,xr=f}return null}function t9(i,s,h,f){do Xh();while(Xl!==null);if(ir&6)throw Error(Se(327));h=i.finishedWork;var g=i.finishedLanes;if(h===null)return null;if(i.finishedWork=null,i.finishedLanes=0,h===i.current)throw Error(Se(177));i.callbackNode=null,i.callbackPriority=0;var y=h.lanes|h.childLanes;if(LG(i,y),i===Fi&&(Si=Fi=null,Wi=0),!(h.subtreeFlags&2064)&&!(h.flags&2064)||v_||(v_=!0,e4(sy,function(){return Xh(),null})),y=(h.flags&15990)!==0,h.subtreeFlags&15990||y){y=bs.transition,bs.transition=null;var b=xr;xr=1;var M=ir;ir|=4,wS.current=null,Z7(i,h),qD(h,i),x7(qw),ly=!!Ww,qw=Ww=null,i.current=h,X7(h),EG(),ir=M,xr=b,bs.transition=y}else i.current=h;if(v_&&(v_=!1,Xl=i,Sy=g),y=i.pendingLanes,y===0&&(nc=null),IG(h.stateNode),Oo(i,mi()),s!==null)for(f=i.onRecoverableError,h=0;h<s.length;h++)g=s[h],f(g.value,{componentStack:g.stack,digest:g.digest});if(Ty)throw Ty=!1,i=dT,dT=null,i;return Sy&1&&i.tag!==0&&Xh(),y=i.pendingLanes,y&1?i===fT?hp++:(hp=0,fT=i):hp=0,pc(),null}function Xh(){if(Xl!==null){var i=Rz(Sy),s=bs.transition,h=xr;try{if(bs.transition=null,xr=16>i?16:i,Xl===null)var f=!1;else{if(i=Xl,Xl=null,Sy=0,ir&6)throw Error(Se(331));var g=ir;for(ir|=4,Ye=i.current;Ye!==null;){var y=Ye,b=y.child;if(Ye.flags&16){var M=y.deletions;if(M!==null){for(var E=0;E<M.length;E++){var C=M[E];for(Ye=C;Ye!==null;){var L=Ye;switch(L.tag){case 0:case 11:case 15:cp(8,L,y)}var B=L.child;if(B!==null)B.return=L,Ye=B;else for(;Ye!==null;){L=Ye;var z=L.sibling,H=L.return;if(VD(L),L===C){Ye=null;break}if(z!==null){z.return=H,Ye=z;break}Ye=H}}}var U=y.alternate;if(U!==null){var q=U.child;if(q!==null){U.child=null;do{var tt=q.sibling;q.sibling=null,q=tt}while(q!==null)}}Ye=y}}if(y.subtreeFlags&2064&&b!==null)b.return=y,Ye=b;else t:for(;Ye!==null;){if(y=Ye,y.flags&2048)switch(y.tag){case 0:case 11:case 15:cp(9,y,y.return)}var V=y.sibling;if(V!==null){V.return=y.return,Ye=V;break t}Ye=y.return}}var F=i.current;for(Ye=F;Ye!==null;){b=Ye;var D=b.child;if(b.subtreeFlags&2064&&D!==null)D.return=b,Ye=D;else t:for(b=F;Ye!==null;){if(M=Ye,M.flags&2048)try{switch(M.tag){case 0:case 11:case 15:Jy(9,M)}}catch(J){li(M,M.return,J)}if(M===b){Ye=null;break t}var $=M.sibling;if($!==null){$.return=M.return,Ye=$;break t}Ye=M.return}}if(ir=g,pc(),xa&&typeof xa.onPostCommitFiberRoot=="function")try{xa.onPostCommitFiberRoot(Wy,i)}catch{}f=!0}return f}finally{xr=h,bs.transition=s}}return!1}function _L(i,s,h){s=sd(h,s),s=kD(i,s,1),i=ec(i,s,1),s=mo(),i!==null&&(Gp(i,1,s),Oo(i,s))}function li(i,s,h){if(i.tag===3)_L(i,i,h);else for(;s!==null;){if(s.tag===3){_L(s,i,h);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(nc===null||!nc.has(f))){i=sd(h,i),i=OD(s,i,1),s=ec(s,i,1),i=mo(),s!==null&&(Gp(s,1,i),Oo(s,i));break}}s=s.return}}function e9(i,s,h){var f=i.pingCache;f!==null&&f.delete(s),s=mo(),i.pingedLanes|=i.suspendedLanes&h,Fi===i&&(Wi&h)===h&&(Li===4||Li===3&&(Wi&130023424)===Wi&&500>mi()-SS?ou(i,0):TS|=h),Oo(i,s)}function JD(i,s){s===0&&(i.mode&1?(s=c_,c_<<=1,!(c_&130023424)&&(c_=4194304)):s=1);var h=mo();i=tl(i,s),i!==null&&(Gp(i,s,h),Oo(i,h))}function n9(i){var s=i.memoizedState,h=0;s!==null&&(h=s.retryLane),JD(i,h)}function r9(i,s){var h=0;switch(i.tag){case 13:var f=i.stateNode,g=i.memoizedState;g!==null&&(h=g.retryLane);break;case 19:f=i.stateNode;break;default:throw Error(Se(314))}f!==null&&f.delete(s),JD(i,h)}var t4;t4=function(i,s,h){if(i!==null)if(i.memoizedProps!==s.pendingProps||Ro.current)Po=!0;else{if(!(i.lanes&h)&&!(s.flags&128))return Po=!1,G7(i,s,h);Po=!!(i.flags&131072)}else Po=!1,Zr&&s.flags&1048576&&rD(s,my,s.index);switch(s.lanes=0,s.tag){case 2:var f=s.type;U_(i,s),i=s.pendingProps;var g=nd(s,ro.current);Zh(s,h),g=_S(null,s,f,i,g,h);var y=yS();return s.flags|=1,typeof g=="object"&&g!==null&&typeof g.render=="function"&&g.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,ko(f)?(y=!0,fy(s)):y=!1,s.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,dS(s),g.updater=Yy,s.stateNode=g,g._reactInternals=s,eT(s,f,i,h),s=iT(null,s,f,!0,y,h)):(s.tag=0,Zr&&y&&oS(s),po(null,s,g,h),s=s.child),s;case 16:f=s.elementType;t:{switch(U_(i,s),i=s.pendingProps,g=f._init,f=g(f._payload),s.type=f,g=s.tag=o9(f),i=$s(f,i),g){case 0:s=rT(null,s,f,i,h);break t;case 1:s=aL(null,s,f,i,h);break t;case 11:s=oL(null,s,f,i,h);break t;case 14:s=sL(null,s,f,$s(f.type,i),h);break t}throw Error(Se(306,f,""))}return s;case 0:return f=s.type,g=s.pendingProps,g=s.elementType===f?g:$s(f,g),rT(i,s,f,g,h);case 1:return f=s.type,g=s.pendingProps,g=s.elementType===f?g:$s(f,g),aL(i,s,f,g,h);case 3:t:{if(BD(s),i===null)throw Error(Se(387));f=s.pendingProps,y=s.memoizedState,g=y.element,aD(i,s),yy(s,f,null,h);var b=s.memoizedState;if(f=b.element,y.isDehydrated)if(y={element:f,isDehydrated:!1,cache:b.cache,pendingSuspenseBoundaries:b.pendingSuspenseBoundaries,transitions:b.transitions},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){g=sd(Error(Se(423)),s),s=lL(i,s,f,h,g);break t}else if(f!==g){g=sd(Error(Se(424)),s),s=lL(i,s,f,h,g);break t}else for(Yo=tc(s.stateNode.containerInfo.firstChild),Qo=s,Zr=!0,Gs=null,h=hD(s,null,f,h),s.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(rd(),f===g){s=el(i,s,h);break t}po(i,s,f,h)}s=s.child}return s;case 5:return dD(s),i===null&&Qw(s),f=s.type,g=s.pendingProps,y=i!==null?i.memoizedProps:null,b=g.children,Hw(f,g)?b=null:y!==null&&Hw(f,y)&&(s.flags|=32),DD(i,s),po(i,s,b,h),s.child;case 6:return i===null&&Qw(s),null;case 13:return FD(i,s,h);case 4:return fS(s,s.stateNode.containerInfo),f=s.pendingProps,i===null?s.child=id(s,null,f,h):po(i,s,f,h),s.child;case 11:return f=s.type,g=s.pendingProps,g=s.elementType===f?g:$s(f,g),oL(i,s,f,g,h);case 7:return po(i,s,s.pendingProps,h),s.child;case 8:return po(i,s,s.pendingProps.children,h),s.child;case 12:return po(i,s,s.pendingProps.children,h),s.child;case 10:t:{if(f=s.type._context,g=s.pendingProps,y=s.memoizedProps,b=g.value,Br(gy,f._currentValue),f._currentValue=b,y!==null)if(Zs(y.value,b)){if(y.children===g.children&&!Ro.current){s=el(i,s,h);break t}}else for(y=s.child,y!==null&&(y.return=s);y!==null;){var M=y.dependencies;if(M!==null){b=y.child;for(var E=M.firstContext;E!==null;){if(E.context===f){if(y.tag===1){E=Ya(-1,h&-h),E.tag=2;var C=y.updateQueue;if(C!==null){C=C.shared;var L=C.pending;L===null?E.next=E:(E.next=L.next,L.next=E),C.pending=E}}y.lanes|=h,E=y.alternate,E!==null&&(E.lanes|=h),Jw(y.return,h,s),M.lanes|=h;break}E=E.next}}else if(y.tag===10)b=y.type===s.type?null:y.child;else if(y.tag===18){if(b=y.return,b===null)throw Error(Se(341));b.lanes|=h,M=b.alternate,M!==null&&(M.lanes|=h),Jw(b,h,s),b=y.sibling}else b=y.child;if(b!==null)b.return=y;else for(b=y;b!==null;){if(b===s){b=null;break}if(y=b.sibling,y!==null){y.return=b.return,b=y;break}b=b.return}y=b}po(i,s,g.children,h),s=s.child}return s;case 9:return g=s.type,f=s.pendingProps.children,Zh(s,h),g=ws(g),f=f(g),s.flags|=1,po(i,s,f,h),s.child;case 14:return f=s.type,g=$s(f,s.pendingProps),g=$s(f.type,g),sL(i,s,f,g,h);case 15:return LD(i,s,s.type,s.pendingProps,h);case 17:return f=s.type,g=s.pendingProps,g=s.elementType===f?g:$s(f,g),U_(i,s),s.tag=1,ko(f)?(i=!0,fy(s)):i=!1,Zh(s,h),cD(s,f,g),eT(s,f,g,h),iT(null,s,f,!0,i,h);case 19:return ND(i,s,h);case 22:return zD(i,s,h)}throw Error(Se(156,s.tag))};function e4(i,s){return Mz(i,s)}function i9(i,s,h,f){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xs(i,s,h,f){return new i9(i,s,h,f)}function IS(i){return i=i.prototype,!(!i||!i.isReactComponent)}function o9(i){if(typeof i=="function")return IS(i)?1:0;if(i!=null){if(i=i.$$typeof,i===HT)return 11;if(i===ZT)return 14}return 2}function ic(i,s){var h=i.alternate;return h===null?(h=xs(i.tag,s,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=s,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&14680064,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,s=i.dependencies,h.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h}function G_(i,s,h,f,g,y){var b=2;if(f=i,typeof i=="function")IS(i)&&(b=1);else if(typeof i=="string")b=5;else t:switch(i){case Rh:return su(h.children,g,y,s);case qT:b=8,g|=8;break;case Ew:return i=xs(12,h,s,g|2),i.elementType=Ew,i.lanes=y,i;case Cw:return i=xs(13,h,s,g),i.elementType=Cw,i.lanes=y,i;case Mw:return i=xs(19,h,s,g),i.elementType=Mw,i.lanes=y,i;case uz:return e0(h,g,y,s);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case lz:b=10;break t;case cz:b=9;break t;case HT:b=11;break t;case ZT:b=14;break t;case Vl:b=16,f=null;break t}throw Error(Se(130,i==null?i:typeof i,""))}return s=xs(b,h,s,g),s.elementType=i,s.type=f,s.lanes=y,s}function su(i,s,h,f){return i=xs(7,i,f,s),i.lanes=h,i}function e0(i,s,h,f){return i=xs(22,i,f,s),i.elementType=uz,i.lanes=h,i.stateNode={isHidden:!1},i}function ew(i,s,h){return i=xs(6,i,null,s),i.lanes=h,i}function nw(i,s,h){return s=xs(4,i.children!==null?i.children:[],i.key,s),s.lanes=h,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}function s9(i,s,h,f,g){this.tag=s,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Db(0),this.expirationTimes=Db(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Db(0),this.identifierPrefix=f,this.onRecoverableError=g,this.mutableSourceEagerHydrationData=null}function AS(i,s,h,f,g,y,b,M,E){return i=new s9(i,s,h,M,E),s===1?(s=1,y===!0&&(s|=8)):s=0,y=xs(3,null,null,s),i.current=y,y.stateNode=i,y.memoizedState={element:f,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},dS(y),i}function a9(i,s,h){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ph,key:f==null?null:""+f,children:i,containerInfo:s,implementation:h}}function n4(i){if(!i)return ac;i=i._reactInternals;t:{if(xu(i)!==i||i.tag!==1)throw Error(Se(170));var s=i;do{switch(s.tag){case 3:s=s.stateNode.context;break t;case 1:if(ko(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break t}}s=s.return}while(s!==null);throw Error(Se(171))}if(i.tag===1){var h=i.type;if(ko(h))return eD(i,h,s)}return s}function r4(i,s,h,f,g,y,b,M,E){return i=AS(h,f,!0,i,g,y,b,M,E),i.context=n4(null),h=i.current,f=mo(),g=rc(h),y=Ya(f,g),y.callback=s??null,ec(h,y,g),i.current.lanes=g,Gp(i,g,f),Oo(i,f),i}function n0(i,s,h,f){var g=s.current,y=mo(),b=rc(g);return h=n4(h),s.context===null?s.context=h:s.pendingContext=h,s=Ya(y,b),s.payload={element:i},f=f===void 0?null:f,f!==null&&(s.callback=f),i=ec(g,s,b),i!==null&&(qs(i,g,b,y),F_(i,g,b)),b}function Cy(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function yL(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<s?h:s}}function PS(i,s){yL(i,s),(i=i.alternate)&&yL(i,s)}function l9(){return null}var i4=typeof reportError=="function"?reportError:function(i){console.error(i)};function RS(i){this._internalRoot=i}r0.prototype.render=RS.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(Se(409));n0(i,s,null,null)};r0.prototype.unmount=RS.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;pu(function(){n0(null,i,null,null)}),s[Ja]=null}};function r0(i){this._internalRoot=i}r0.prototype.unstable_scheduleHydration=function(i){if(i){var s=Lz();i={blockedOn:null,target:i,priority:s};for(var h=0;h<Wl.length&&s!==0&&s<Wl[h].priority;h++);Wl.splice(h,0,i),h===0&&Dz(i)}};function kS(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function i0(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function vL(){}function c9(i,s,h,f,g){if(g){if(typeof f=="function"){var y=f;f=function(){var C=Cy(b);y.call(C)}}var b=r4(s,f,i,0,null,!1,!1,"",vL);return i._reactRootContainer=b,i[Ja]=b.current,Ep(i.nodeType===8?i.parentNode:i),pu(),b}for(;g=i.lastChild;)i.removeChild(g);if(typeof f=="function"){var M=f;f=function(){var C=Cy(E);M.call(C)}}var E=AS(i,0,!1,null,null,!1,!1,"",vL);return i._reactRootContainer=E,i[Ja]=E.current,Ep(i.nodeType===8?i.parentNode:i),pu(function(){n0(s,E,h,f)}),E}function o0(i,s,h,f,g){var y=h._reactRootContainer;if(y){var b=y;if(typeof g=="function"){var M=g;g=function(){var E=Cy(b);M.call(E)}}n0(s,b,i,g)}else b=c9(h,s,i,g,f);return Cy(b)}kz=function(i){switch(i.tag){case 3:var s=i.stateNode;if(s.current.memoizedState.isDehydrated){var h=Jf(s.pendingLanes);h!==0&&(YT(s,h|1),Oo(s,mi()),!(ir&6)&&(ad=mi()+500,pc()))}break;case 13:pu(function(){var f=tl(i,1);if(f!==null){var g=mo();qs(f,i,1,g)}}),PS(i,1)}};QT=function(i){if(i.tag===13){var s=tl(i,134217728);if(s!==null){var h=mo();qs(s,i,134217728,h)}PS(i,134217728)}};Oz=function(i){if(i.tag===13){var s=rc(i),h=tl(i,s);if(h!==null){var f=mo();qs(h,i,s,f)}PS(i,s)}};Lz=function(){return xr};zz=function(i,s){var h=xr;try{return xr=i,s()}finally{xr=h}};Bw=function(i,s,h){switch(s){case"input":if(Pw(i,h),s=h.name,h.type==="radio"&&s!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<h.length;s++){var f=h[s];if(f!==i&&f.form===i.form){var g=Xy(f);if(!g)throw Error(Se(90));dz(f),Pw(f,g)}}}break;case"textarea":pz(i,h);break;case"select":s=h.value,s!=null&&Gh(i,!!h.multiple,s,!1)}};bz=ES;wz=pu;var u9={usingClientEntryPoint:!1,Events:[qp,zh,Xy,vz,xz,ES]},Uf={findFiberByHostInstance:Jc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},h9={bundleType:Uf.bundleType,version:Uf.version,rendererPackageName:Uf.rendererPackageName,rendererConfig:Uf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:nl.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Ez(i),i===null?null:i.stateNode},findFiberByHostInstance:Uf.findFiberByHostInstance||l9,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var x_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!x_.isDisabled&&x_.supportsFiber)try{Wy=x_.inject(h9),xa=x_}catch{}}es.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=u9;es.createPortal=function(i,s){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kS(s))throw Error(Se(200));return a9(i,s,null,h)};es.createRoot=function(i,s){if(!kS(i))throw Error(Se(299));var h=!1,f="",g=i4;return s!=null&&(s.unstable_strictMode===!0&&(h=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onRecoverableError!==void 0&&(g=s.onRecoverableError)),s=AS(i,1,!1,null,null,h,!1,f,g),i[Ja]=s.current,Ep(i.nodeType===8?i.parentNode:i),new RS(s)};es.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(Se(188)):(i=Object.keys(i).join(","),Error(Se(268,i)));return i=Ez(s),i=i===null?null:i.stateNode,i};es.flushSync=function(i){return pu(i)};es.hydrate=function(i,s,h){if(!i0(s))throw Error(Se(200));return o0(null,i,s,!0,h)};es.hydrateRoot=function(i,s,h){if(!kS(i))throw Error(Se(405));var f=h!=null&&h.hydratedSources||null,g=!1,y="",b=i4;if(h!=null&&(h.unstable_strictMode===!0&&(g=!0),h.identifierPrefix!==void 0&&(y=h.identifierPrefix),h.onRecoverableError!==void 0&&(b=h.onRecoverableError)),s=r4(s,null,i,1,h??null,g,!1,y,b),i[Ja]=s.current,Ep(i),f)for(i=0;i<f.length;i++)h=f[i],g=h._getVersion,g=g(h._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[h,g]:s.mutableSourceEagerHydrationData.push(h,g);return new r0(s)};es.render=function(i,s,h){if(!i0(s))throw Error(Se(200));return o0(null,i,s,!1,h)};es.unmountComponentAtNode=function(i){if(!i0(i))throw Error(Se(40));return i._reactRootContainer?(pu(function(){o0(null,null,i,!1,function(){i._reactRootContainer=null,i[Ja]=null})}),!0):!1};es.unstable_batchedUpdates=ES;es.unstable_renderSubtreeIntoContainer=function(i,s,h,f){if(!i0(h))throw Error(Se(200));if(i==null||i._reactInternals===void 0)throw Error(Se(38));return o0(i,s,h,!1,f)};es.version="18.2.0-next-9e3b772b8-20220608";function o4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o4)}catch(i){console.error(i)}}o4(),rz.exports=es;var s0=rz.exports;const b_=$p(s0);var s4,xL=s0;s4=xL.createRoot,xL.hydrateRoot;const d9="/assets/HW-St.-Edwards-Baseball-20-1200x750-QYrjkG6q.jpg";var no=function(){return no=Object.assign||function(s){for(var h,f=1,g=arguments.length;f<g;f++){h=arguments[f];for(var y in h)Object.prototype.hasOwnProperty.call(h,y)&&(s[y]=h[y])}return s},no.apply(this,arguments)};function My(i,s,h){if(h||arguments.length===2)for(var f=0,g=s.length,y;f<g;f++)(y||!(f in s))&&(y||(y=Array.prototype.slice.call(s,0,f)),y[f]=s[f]);return i.concat(y||Array.prototype.slice.call(s))}function a4(i){var s=Object.create(null);return function(h){return s[h]===void 0&&(s[h]=i(h)),s[h]}}var f9=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,p9=a4(function(i){return f9.test(i)||i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)<91}),$r="-ms-",dp="-moz-",_r="-webkit-",l4="comm",a0="rule",OS="decl",m9="@import",c4="@keyframes",g9="@layer",u4=Math.abs,LS=String.fromCharCode,gT=Object.assign;function _9(i,s){return Bi(i,0)^45?(((s<<2^Bi(i,0))<<2^Bi(i,1))<<2^Bi(i,2))<<2^Bi(i,3):0}function h4(i){return i.trim()}function Ha(i,s){return(i=s.exec(i))?i[0]:i}function Un(i,s,h){return i.replace(s,h)}function W_(i,s,h){return i.indexOf(s,h)}function Bi(i,s){return i.charCodeAt(s)|0}function ld(i,s,h){return i.slice(s,h)}function ga(i){return i.length}function d4(i){return i.length}function ep(i,s){return s.push(i),i}function y9(i,s){return i.map(s).join("")}function bL(i,s){return i.filter(function(h){return!Ha(h,s)})}var l0=1,cd=1,f4=0,Ss=0,wi=0,xd="";function c0(i,s,h,f,g,y,b,M){return{value:i,root:s,parent:h,type:f,props:g,children:y,line:l0,column:cd,length:b,return:"",siblings:M}}function $l(i,s){return gT(c0("",null,null,"",null,null,0,i.siblings),i,{length:-i.length},s)}function xh(i){for(;i.root;)i=$l(i.root,{children:[i]});ep(i,i.siblings)}function v9(){return wi}function x9(){return wi=Ss>0?Bi(xd,--Ss):0,cd--,wi===10&&(cd=1,l0--),wi}function Hs(){return wi=Ss<f4?Bi(xd,Ss++):0,cd++,wi===10&&(cd=1,l0++),wi}function au(){return Bi(xd,Ss)}function q_(){return Ss}function u0(i,s){return ld(xd,i,s)}function _T(i){switch(i){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function b9(i){return l0=cd=1,f4=ga(xd=i),Ss=0,[]}function w9(i){return xd="",i}function rw(i){return h4(u0(Ss-1,yT(i===91?i+2:i===40?i+1:i)))}function T9(i){for(;(wi=au())&&wi<33;)Hs();return _T(i)>2||_T(wi)>3?"":" "}function S9(i,s){for(;--s&&Hs()&&!(wi<48||wi>102||wi>57&&wi<65||wi>70&&wi<97););return u0(i,q_()+(s<6&&au()==32&&Hs()==32))}function yT(i){for(;Hs();)switch(wi){case i:return Ss;case 34:case 39:i!==34&&i!==39&&yT(wi);break;case 40:i===41&&yT(i);break;case 92:Hs();break}return Ss}function E9(i,s){for(;Hs()&&i+wi!==57;)if(i+wi===84&&au()===47)break;return"/*"+u0(s,Ss-1)+"*"+LS(i===47?i:Hs())}function C9(i){for(;!_T(au());)Hs();return u0(i,Ss)}function M9(i){return w9(H_("",null,null,null,[""],i=b9(i),0,[0],i))}function H_(i,s,h,f,g,y,b,M,E){for(var C=0,L=0,B=b,z=0,H=0,U=0,q=1,tt=1,V=1,F=0,D="",$=g,J=y,ct=f,st=D;tt;)switch(U=F,F=Hs()){case 40:if(U!=108&&Bi(st,B-1)==58){W_(st+=Un(rw(F),"&","&\f"),"&\f",u4(C?M[C-1]:0))!=-1&&(V=-1);break}case 34:case 39:case 91:st+=rw(F);break;case 9:case 10:case 13:case 32:st+=T9(U);break;case 92:st+=S9(q_()-1,7);continue;case 47:switch(au()){case 42:case 47:ep(I9(E9(Hs(),q_()),s,h,E),E);break;default:st+="/"}break;case 123*q:M[C++]=ga(st)*V;case 125*q:case 59:case 0:switch(F){case 0:case 125:tt=0;case 59+L:V==-1&&(st=Un(st,/\f/g,"")),H>0&&ga(st)-B&&ep(H>32?TL(st+";",f,h,B-1,E):TL(Un(st," ","")+";",f,h,B-2,E),E);break;case 59:st+=";";default:if(ep(ct=wL(st,s,h,C,L,g,M,D,$=[],J=[],B,y),y),F===123)if(L===0)H_(st,s,ct,ct,$,y,B,M,J);else switch(z===99&&Bi(st,3)===110?100:z){case 100:case 108:case 109:case 115:H_(i,ct,ct,f&&ep(wL(i,ct,ct,0,0,g,M,D,g,$=[],B,J),J),g,J,B,M,f?$:J);break;default:H_(st,ct,ct,ct,[""],J,0,M,J)}}C=L=H=0,q=V=1,D=st="",B=b;break;case 58:B=1+ga(st),H=U;default:if(q<1){if(F==123)--q;else if(F==125&&q++==0&&x9()==125)continue}switch(st+=LS(F),F*q){case 38:V=L>0?1:(st+="\f",-1);break;case 44:M[C++]=(ga(st)-1)*V,V=1;break;case 64:au()===45&&(st+=rw(Hs())),z=au(),L=B=ga(D=st+=C9(q_())),F++;break;case 45:U===45&&ga(st)==2&&(q=0)}}return y}function wL(i,s,h,f,g,y,b,M,E,C,L,B){for(var z=g-1,H=g===0?y:[""],U=d4(H),q=0,tt=0,V=0;q<f;++q)for(var F=0,D=ld(i,z+1,z=u4(tt=b[q])),$=i;F<U;++F)($=h4(tt>0?H[F]+" "+D:Un(D,/&\f/g,H[F])))&&(E[V++]=$);return c0(i,s,h,g===0?a0:M,E,C,L,B)}function I9(i,s,h,f){return c0(i,s,h,l4,LS(v9()),ld(i,2,-2),0,f)}function TL(i,s,h,f,g){return c0(i,s,h,OS,ld(i,0,f),ld(i,f+1,-1),f,g)}function p4(i,s,h){switch(_9(i,s)){case 5103:return _r+"print-"+i+i;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return _r+i+i;case 4789:return dp+i+i;case 5349:case 4246:case 4810:case 6968:case 2756:return _r+i+dp+i+$r+i+i;case 5936:switch(Bi(i,s+11)){case 114:return _r+i+$r+Un(i,/[svh]\w+-[tblr]{2}/,"tb")+i;case 108:return _r+i+$r+Un(i,/[svh]\w+-[tblr]{2}/,"tb-rl")+i;case 45:return _r+i+$r+Un(i,/[svh]\w+-[tblr]{2}/,"lr")+i}case 6828:case 4268:case 2903:return _r+i+$r+i+i;case 6165:return _r+i+$r+"flex-"+i+i;case 5187:return _r+i+Un(i,/(\w+).+(:[^]+)/,_r+"box-$1$2"+$r+"flex-$1$2")+i;case 5443:return _r+i+$r+"flex-item-"+Un(i,/flex-|-self/g,"")+(Ha(i,/flex-|baseline/)?"":$r+"grid-row-"+Un(i,/flex-|-self/g,""))+i;case 4675:return _r+i+$r+"flex-line-pack"+Un(i,/align-content|flex-|-self/g,"")+i;case 5548:return _r+i+$r+Un(i,"shrink","negative")+i;case 5292:return _r+i+$r+Un(i,"basis","preferred-size")+i;case 6060:return _r+"box-"+Un(i,"-grow","")+_r+i+$r+Un(i,"grow","positive")+i;case 4554:return _r+Un(i,/([^-])(transform)/g,"$1"+_r+"$2")+i;case 6187:return Un(Un(Un(i,/(zoom-|grab)/,_r+"$1"),/(image-set)/,_r+"$1"),i,"")+i;case 5495:case 3959:return Un(i,/(image-set\([^]*)/,_r+"$1$`$1");case 4968:return Un(Un(i,/(.+:)(flex-)?(.*)/,_r+"box-pack:$3"+$r+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+_r+i+i;case 4200:if(!Ha(i,/flex-|baseline/))return $r+"grid-column-align"+ld(i,s)+i;break;case 2592:case 3360:return $r+Un(i,"template-","")+i;case 4384:case 3616:return h&&h.some(function(f,g){return s=g,Ha(f.props,/grid-\w+-end/)})?~W_(i+(h=h[s].value),"span",0)?i:$r+Un(i,"-start","")+i+$r+"grid-row-span:"+(~W_(h,"span",0)?Ha(h,/\d+/):+Ha(h,/\d+/)-+Ha(i,/\d+/))+";":$r+Un(i,"-start","")+i;case 4896:case 4128:return h&&h.some(function(f){return Ha(f.props,/grid-\w+-start/)})?i:$r+Un(Un(i,"-end","-span"),"span ","")+i;case 4095:case 3583:case 4068:case 2532:return Un(i,/(.+)-inline(.+)/,_r+"$1$2")+i;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ga(i)-1-s>6)switch(Bi(i,s+1)){case 109:if(Bi(i,s+4)!==45)break;case 102:return Un(i,/(.+:)(.+)-([^]+)/,"$1"+_r+"$2-$3$1"+dp+(Bi(i,s+3)==108?"$3":"$2-$3"))+i;case 115:return~W_(i,"stretch",0)?p4(Un(i,"stretch","fill-available"),s,h)+i:i}break;case 5152:case 5920:return Un(i,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(f,g,y,b,M,E,C){return $r+g+":"+y+C+(b?$r+g+"-span:"+(M?E:+E-+y)+C:"")+i});case 4949:if(Bi(i,s+6)===121)return Un(i,":",":"+_r)+i;break;case 6444:switch(Bi(i,Bi(i,14)===45?18:11)){case 120:return Un(i,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+_r+(Bi(i,14)===45?"inline-":"")+"box$3$1"+_r+"$2$3$1"+$r+"$2box$3")+i;case 100:return Un(i,":",":"+$r)+i}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Un(i,"scroll-","scroll-snap-")+i}return i}function Iy(i,s){for(var h="",f=0;f<i.length;f++)h+=s(i[f],f,i,s)||"";return h}function A9(i,s,h,f){switch(i.type){case g9:if(i.children.length)break;case m9:case OS:return i.return=i.return||i.value;case l4:return"";case c4:return i.return=i.value+"{"+Iy(i.children,f)+"}";case a0:if(!ga(i.value=i.props.join(",")))return""}return ga(h=Iy(i.children,f))?i.return=i.value+"{"+h+"}":""}function P9(i){var s=d4(i);return function(h,f,g,y){for(var b="",M=0;M<s;M++)b+=i[M](h,f,g,y)||"";return b}}function R9(i){return function(s){s.root||(s=s.return)&&i(s)}}function k9(i,s,h,f){if(i.length>-1&&!i.return)switch(i.type){case OS:i.return=p4(i.value,i.length,h);return;case c4:return Iy([$l(i,{value:Un(i.value,"@","@"+_r)})],f);case a0:if(i.length)return y9(h=i.props,function(g){switch(Ha(g,f=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":xh($l(i,{props:[Un(g,/:(read-\w+)/,":"+dp+"$1")]})),xh($l(i,{props:[g]})),gT(i,{props:bL(h,f)});break;case"::placeholder":xh($l(i,{props:[Un(g,/:(plac\w+)/,":"+_r+"input-$1")]})),xh($l(i,{props:[Un(g,/:(plac\w+)/,":"+dp+"$1")]})),xh($l(i,{props:[Un(g,/:(plac\w+)/,$r+"input-$1")]})),xh($l(i,{props:[g]})),gT(i,{props:bL(h,f)});break}return""})}}var O9={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Zo={},ud=typeof process<"u"&&Zo!==void 0&&(Zo.REACT_APP_SC_ATTR||Zo.SC_ATTR)||"data-styled",m4="active",g4="data-styled-version",h0="6.1.8",zS=`/*!sc*/
`,DS=typeof window<"u"&&"HTMLElement"in window,L9=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&Zo!==void 0&&Zo.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&Zo.REACT_APP_SC_DISABLE_SPEEDY!==""?Zo.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&Zo.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&Zo!==void 0&&Zo.SC_DISABLE_SPEEDY!==void 0&&Zo.SC_DISABLE_SPEEDY!==""&&Zo.SC_DISABLE_SPEEDY!=="false"&&Zo.SC_DISABLE_SPEEDY),d0=Object.freeze([]),hd=Object.freeze({});function z9(i,s,h){return h===void 0&&(h=hd),i.theme!==h.theme&&i.theme||s||h.theme}var _4=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),D9=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,B9=/(^-|-$)/g;function SL(i){return i.replace(D9,"-").replace(B9,"")}var F9=/(a)(d)/gi,w_=52,EL=function(i){return String.fromCharCode(i+(i>25?39:97))};function vT(i){var s,h="";for(s=Math.abs(i);s>w_;s=s/w_|0)h=EL(s%w_)+h;return(EL(s%w_)+h).replace(F9,"$1-$2")}var iw,y4=5381,$h=function(i,s){for(var h=s.length;h;)i=33*i^s.charCodeAt(--h);return i},v4=function(i){return $h(y4,i)};function N9(i){return vT(v4(i)>>>0)}function j9(i){return i.displayName||i.name||"Component"}function ow(i){return typeof i=="string"&&!0}var x4=typeof Symbol=="function"&&Symbol.for,b4=x4?Symbol.for("react.memo"):60115,U9=x4?Symbol.for("react.forward_ref"):60112,$9={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},V9={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},w4={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},G9=((iw={})[U9]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},iw[b4]=w4,iw);function CL(i){return("type"in(s=i)&&s.type.$$typeof)===b4?w4:"$$typeof"in i?G9[i.$$typeof]:$9;var s}var W9=Object.defineProperty,q9=Object.getOwnPropertyNames,ML=Object.getOwnPropertySymbols,H9=Object.getOwnPropertyDescriptor,Z9=Object.getPrototypeOf,IL=Object.prototype;function T4(i,s,h){if(typeof s!="string"){if(IL){var f=Z9(s);f&&f!==IL&&T4(i,f,h)}var g=q9(s);ML&&(g=g.concat(ML(s)));for(var y=CL(i),b=CL(s),M=0;M<g.length;++M){var E=g[M];if(!(E in V9||h&&h[E]||b&&E in b||y&&E in y)){var C=H9(s,E);try{W9(i,E,C)}catch{}}}}return i}function mu(i){return typeof i=="function"}function BS(i){return typeof i=="object"&&"styledComponentId"in i}function nu(i,s){return i&&s?"".concat(i," ").concat(s):i||s||""}function AL(i,s){if(i.length===0)return"";for(var h=i[0],f=1;f<i.length;f++)h+=s?s+i[f]:i[f];return h}function Lp(i){return i!==null&&typeof i=="object"&&i.constructor.name===Object.name&&!("props"in i&&i.$$typeof)}function xT(i,s,h){if(h===void 0&&(h=!1),!h&&!Lp(i)&&!Array.isArray(i))return s;if(Array.isArray(s))for(var f=0;f<s.length;f++)i[f]=xT(i[f],s[f]);else if(Lp(s))for(var f in s)i[f]=xT(i[f],s[f]);return i}function FS(i,s){Object.defineProperty(i,"toString",{value:s})}function gu(i){for(var s=[],h=1;h<arguments.length;h++)s[h-1]=arguments[h];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(i," for more information.").concat(s.length>0?" Args: ".concat(s.join(", ")):""))}var X9=function(){function i(s){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=s}return i.prototype.indexOfGroup=function(s){for(var h=0,f=0;f<s;f++)h+=this.groupSizes[f];return h},i.prototype.insertRules=function(s,h){if(s>=this.groupSizes.length){for(var f=this.groupSizes,g=f.length,y=g;s>=y;)if((y<<=1)<0)throw gu(16,"".concat(s));this.groupSizes=new Uint32Array(y),this.groupSizes.set(f),this.length=y;for(var b=g;b<y;b++)this.groupSizes[b]=0}for(var M=this.indexOfGroup(s+1),E=(b=0,h.length);b<E;b++)this.tag.insertRule(M,h[b])&&(this.groupSizes[s]++,M++)},i.prototype.clearGroup=function(s){if(s<this.length){var h=this.groupSizes[s],f=this.indexOfGroup(s),g=f+h;this.groupSizes[s]=0;for(var y=f;y<g;y++)this.tag.deleteRule(f)}},i.prototype.getGroup=function(s){var h="";if(s>=this.length||this.groupSizes[s]===0)return h;for(var f=this.groupSizes[s],g=this.indexOfGroup(s),y=g+f,b=g;b<y;b++)h+="".concat(this.tag.getRule(b)).concat(zS);return h},i}(),Z_=new Map,Ay=new Map,X_=1,T_=function(i){if(Z_.has(i))return Z_.get(i);for(;Ay.has(X_);)X_++;var s=X_++;return Z_.set(i,s),Ay.set(s,i),s},K9=function(i,s){X_=s+1,Z_.set(i,s),Ay.set(s,i)},Y9="style[".concat(ud,"][").concat(g4,'="').concat(h0,'"]'),Q9=new RegExp("^".concat(ud,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),J9=function(i,s,h){for(var f,g=h.split(","),y=0,b=g.length;y<b;y++)(f=g[y])&&i.registerName(s,f)},tW=function(i,s){for(var h,f=((h=s.textContent)!==null&&h!==void 0?h:"").split(zS),g=[],y=0,b=f.length;y<b;y++){var M=f[y].trim();if(M){var E=M.match(Q9);if(E){var C=0|parseInt(E[1],10),L=E[2];C!==0&&(K9(L,C),J9(i,L,E[3]),i.getTag().insertRules(C,g)),g.length=0}else g.push(M)}}};function eW(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var S4=function(i){var s=document.head,h=i||s,f=document.createElement("style"),g=function(M){var E=Array.from(M.querySelectorAll("style[".concat(ud,"]")));return E[E.length-1]}(h),y=g!==void 0?g.nextSibling:null;f.setAttribute(ud,m4),f.setAttribute(g4,h0);var b=eW();return b&&f.setAttribute("nonce",b),h.insertBefore(f,y),f},nW=function(){function i(s){this.element=S4(s),this.element.appendChild(document.createTextNode("")),this.sheet=function(h){if(h.sheet)return h.sheet;for(var f=document.styleSheets,g=0,y=f.length;g<y;g++){var b=f[g];if(b.ownerNode===h)return b}throw gu(17)}(this.element),this.length=0}return i.prototype.insertRule=function(s,h){try{return this.sheet.insertRule(h,s),this.length++,!0}catch{return!1}},i.prototype.deleteRule=function(s){this.sheet.deleteRule(s),this.length--},i.prototype.getRule=function(s){var h=this.sheet.cssRules[s];return h&&h.cssText?h.cssText:""},i}(),rW=function(){function i(s){this.element=S4(s),this.nodes=this.element.childNodes,this.length=0}return i.prototype.insertRule=function(s,h){if(s<=this.length&&s>=0){var f=document.createTextNode(h);return this.element.insertBefore(f,this.nodes[s]||null),this.length++,!0}return!1},i.prototype.deleteRule=function(s){this.element.removeChild(this.nodes[s]),this.length--},i.prototype.getRule=function(s){return s<this.length?this.nodes[s].textContent:""},i}(),iW=function(){function i(s){this.rules=[],this.length=0}return i.prototype.insertRule=function(s,h){return s<=this.length&&(this.rules.splice(s,0,h),this.length++,!0)},i.prototype.deleteRule=function(s){this.rules.splice(s,1),this.length--},i.prototype.getRule=function(s){return s<this.length?this.rules[s]:""},i}(),PL=DS,oW={isServer:!DS,useCSSOMInjection:!L9},E4=function(){function i(s,h,f){s===void 0&&(s=hd),h===void 0&&(h={});var g=this;this.options=no(no({},oW),s),this.gs=h,this.names=new Map(f),this.server=!!s.isServer,!this.server&&DS&&PL&&(PL=!1,function(y){for(var b=document.querySelectorAll(Y9),M=0,E=b.length;M<E;M++){var C=b[M];C&&C.getAttribute(ud)!==m4&&(tW(y,C),C.parentNode&&C.parentNode.removeChild(C))}}(this)),FS(this,function(){return function(y){for(var b=y.getTag(),M=b.length,E="",C=function(B){var z=function(V){return Ay.get(V)}(B);if(z===void 0)return"continue";var H=y.names.get(z),U=b.getGroup(B);if(H===void 0||U.length===0)return"continue";var q="".concat(ud,".g").concat(B,'[id="').concat(z,'"]'),tt="";H!==void 0&&H.forEach(function(V){V.length>0&&(tt+="".concat(V,","))}),E+="".concat(U).concat(q,'{content:"').concat(tt,'"}').concat(zS)},L=0;L<M;L++)C(L);return E}(g)})}return i.registerId=function(s){return T_(s)},i.prototype.reconstructWithOptions=function(s,h){return h===void 0&&(h=!0),new i(no(no({},this.options),s),this.gs,h&&this.names||void 0)},i.prototype.allocateGSInstance=function(s){return this.gs[s]=(this.gs[s]||0)+1},i.prototype.getTag=function(){return this.tag||(this.tag=(s=function(h){var f=h.useCSSOMInjection,g=h.target;return h.isServer?new iW(g):f?new nW(g):new rW(g)}(this.options),new X9(s)));var s},i.prototype.hasNameForId=function(s,h){return this.names.has(s)&&this.names.get(s).has(h)},i.prototype.registerName=function(s,h){if(T_(s),this.names.has(s))this.names.get(s).add(h);else{var f=new Set;f.add(h),this.names.set(s,f)}},i.prototype.insertRules=function(s,h,f){this.registerName(s,h),this.getTag().insertRules(T_(s),f)},i.prototype.clearNames=function(s){this.names.has(s)&&this.names.get(s).clear()},i.prototype.clearRules=function(s){this.getTag().clearGroup(T_(s)),this.clearNames(s)},i.prototype.clearTag=function(){this.tag=void 0},i}(),sW=/&/g,aW=/^\s*\/\/.*$/gm;function C4(i,s){return i.map(function(h){return h.type==="rule"&&(h.value="".concat(s," ").concat(h.value),h.value=h.value.replaceAll(",",",".concat(s," ")),h.props=h.props.map(function(f){return"".concat(s," ").concat(f)})),Array.isArray(h.children)&&h.type!=="@keyframes"&&(h.children=C4(h.children,s)),h})}function lW(i){var s,h,f,g=i===void 0?hd:i,y=g.options,b=y===void 0?hd:y,M=g.plugins,E=M===void 0?d0:M,C=function(z,H,U){return U.startsWith(h)&&U.endsWith(h)&&U.replaceAll(h,"").length>0?".".concat(s):z},L=E.slice();L.push(function(z){z.type===a0&&z.value.includes("&")&&(z.props[0]=z.props[0].replace(sW,h).replace(f,C))}),b.prefix&&L.push(k9),L.push(A9);var B=function(z,H,U,q){H===void 0&&(H=""),U===void 0&&(U=""),q===void 0&&(q="&"),s=q,h=H,f=new RegExp("\\".concat(h,"\\b"),"g");var tt=z.replace(aW,""),V=M9(U||H?"".concat(U," ").concat(H," { ").concat(tt," }"):tt);b.namespace&&(V=C4(V,b.namespace));var F=[];return Iy(V,P9(L.concat(R9(function(D){return F.push(D)})))),F};return B.hash=E.length?E.reduce(function(z,H){return H.name||gu(15),$h(z,H.name)},y4).toString():"",B}var cW=new E4,bT=lW(),M4=Xr.createContext({shouldForwardProp:void 0,styleSheet:cW,stylis:bT});M4.Consumer;Xr.createContext(void 0);function RL(){return lt.useContext(M4)}var uW=function(){function i(s,h){var f=this;this.inject=function(g,y){y===void 0&&(y=bT);var b=f.name+y.hash;g.hasNameForId(f.id,b)||g.insertRules(f.id,b,y(f.rules,b,"@keyframes"))},this.name=s,this.id="sc-keyframes-".concat(s),this.rules=h,FS(this,function(){throw gu(12,String(f.name))})}return i.prototype.getName=function(s){return s===void 0&&(s=bT),this.name+s.hash},i}(),hW=function(i){return i>="A"&&i<="Z"};function kL(i){for(var s="",h=0;h<i.length;h++){var f=i[h];if(h===1&&f==="-"&&i[0]==="-")return i;hW(f)?s+="-"+f.toLowerCase():s+=f}return s.startsWith("ms-")?"-"+s:s}var I4=function(i){return i==null||i===!1||i===""},A4=function(i){var s,h,f=[];for(var g in i){var y=i[g];i.hasOwnProperty(g)&&!I4(y)&&(Array.isArray(y)&&y.isCss||mu(y)?f.push("".concat(kL(g),":"),y,";"):Lp(y)?f.push.apply(f,My(My(["".concat(g," {")],A4(y),!1),["}"],!1)):f.push("".concat(kL(g),": ").concat((s=g,(h=y)==null||typeof h=="boolean"||h===""?"":typeof h!="number"||h===0||s in O9||s.startsWith("--")?String(h).trim():"".concat(h,"px")),";")))}return f};function lu(i,s,h,f){if(I4(i))return[];if(BS(i))return[".".concat(i.styledComponentId)];if(mu(i)){if(!mu(y=i)||y.prototype&&y.prototype.isReactComponent||!s)return[i];var g=i(s);return lu(g,s,h,f)}var y;return i instanceof uW?h?(i.inject(h,f),[i.getName(f)]):[i]:Lp(i)?A4(i):Array.isArray(i)?Array.prototype.concat.apply(d0,i.map(function(b){return lu(b,s,h,f)})):[i.toString()]}function dW(i){for(var s=0;s<i.length;s+=1){var h=i[s];if(mu(h)&&!BS(h))return!1}return!0}var fW=v4(h0),pW=function(){function i(s,h,f){this.rules=s,this.staticRulesId="",this.isStatic=(f===void 0||f.isStatic)&&dW(s),this.componentId=h,this.baseHash=$h(fW,h),this.baseStyle=f,E4.registerId(h)}return i.prototype.generateAndInjectStyles=function(s,h,f){var g=this.baseStyle?this.baseStyle.generateAndInjectStyles(s,h,f):"";if(this.isStatic&&!f.hash)if(this.staticRulesId&&h.hasNameForId(this.componentId,this.staticRulesId))g=nu(g,this.staticRulesId);else{var y=AL(lu(this.rules,s,h,f)),b=vT($h(this.baseHash,y)>>>0);if(!h.hasNameForId(this.componentId,b)){var M=f(y,".".concat(b),void 0,this.componentId);h.insertRules(this.componentId,b,M)}g=nu(g,b),this.staticRulesId=b}else{for(var E=$h(this.baseHash,f.hash),C="",L=0;L<this.rules.length;L++){var B=this.rules[L];if(typeof B=="string")C+=B;else if(B){var z=AL(lu(B,s,h,f));E=$h(E,z+L),C+=z}}if(C){var H=vT(E>>>0);h.hasNameForId(this.componentId,H)||h.insertRules(this.componentId,H,f(C,".".concat(H),void 0,this.componentId)),g=nu(g,H)}}return g},i}(),Py=Xr.createContext(void 0);Py.Consumer;function mW(i){var s=Xr.useContext(Py),h=lt.useMemo(function(){return function(f,g){if(!f)throw gu(14);if(mu(f)){var y=f(g);return y}if(Array.isArray(f)||typeof f!="object")throw gu(8);return g?no(no({},g),f):f}(i.theme,s)},[i.theme,s]);return i.children?Xr.createElement(Py.Provider,{value:h},i.children):null}var sw={};function gW(i,s,h){var f=BS(i),g=i,y=!ow(i),b=s.attrs,M=b===void 0?d0:b,E=s.componentId,C=E===void 0?function($,J){var ct=typeof $!="string"?"sc":SL($);sw[ct]=(sw[ct]||0)+1;var st="".concat(ct,"-").concat(N9(h0+ct+sw[ct]));return J?"".concat(J,"-").concat(st):st}(s.displayName,s.parentComponentId):E,L=s.displayName,B=L===void 0?function($){return ow($)?"styled.".concat($):"Styled(".concat(j9($),")")}(i):L,z=s.displayName&&s.componentId?"".concat(SL(s.displayName),"-").concat(s.componentId):s.componentId||C,H=f&&g.attrs?g.attrs.concat(M).filter(Boolean):M,U=s.shouldForwardProp;if(f&&g.shouldForwardProp){var q=g.shouldForwardProp;if(s.shouldForwardProp){var tt=s.shouldForwardProp;U=function($,J){return q($,J)&&tt($,J)}}else U=q}var V=new pW(h,z,f?g.componentStyle:void 0);function F($,J){return function(ct,st,yt){var ut=ct.attrs,N=ct.componentStyle,et=ct.defaultProps,Mt=ct.foldedComponentIds,Lt=ct.styledComponentId,it=ct.target,Tt=Xr.useContext(Py),Vt=RL(),ne=ct.shouldForwardProp||Vt.shouldForwardProp,Et=z9(st,Tt,et)||hd,$t=function(kt,Xt,Ot){for(var Pe,ie=no(no({},Xt),{className:void 0,theme:Ot}),Ne=0;Ne<kt.length;Ne+=1){var Fe=mu(Pe=kt[Ne])?Pe(ie):Pe;for(var je in Fe)ie[je]=je==="className"?nu(ie[je],Fe[je]):je==="style"?no(no({},ie[je]),Fe[je]):Fe[je]}return Xt.className&&(ie.className=nu(ie.className,Xt.className)),ie}(ut,st,Et),ee=$t.as||it,Ee={};for(var jt in $t)$t[jt]===void 0||jt[0]==="$"||jt==="as"||jt==="theme"&&$t.theme===Et||(jt==="forwardedAs"?Ee.as=$t.forwardedAs:ne&&!ne(jt,ee)||(Ee[jt]=$t[jt]));var Le=function(kt,Xt){var Ot=RL(),Pe=kt.generateAndInjectStyles(Xt,Ot.styleSheet,Ot.stylis);return Pe}(N,$t),we=nu(Mt,Lt);return Le&&(we+=" "+Le),$t.className&&(we+=" "+$t.className),Ee[ow(ee)&&!_4.has(ee)?"class":"className"]=we,Ee.ref=yt,lt.createElement(ee,Ee)}(D,$,J)}F.displayName=B;var D=Xr.forwardRef(F);return D.attrs=H,D.componentStyle=V,D.displayName=B,D.shouldForwardProp=U,D.foldedComponentIds=f?nu(g.foldedComponentIds,g.styledComponentId):"",D.styledComponentId=z,D.target=f?g.target:i,Object.defineProperty(D,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function($){this._foldedDefaultProps=f?function(J){for(var ct=[],st=1;st<arguments.length;st++)ct[st-1]=arguments[st];for(var yt=0,ut=ct;yt<ut.length;yt++)xT(J,ut[yt],!0);return J}({},g.defaultProps,$):$}}),FS(D,function(){return".".concat(D.styledComponentId)}),y&&T4(D,i,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),D}function OL(i,s){for(var h=[i[0]],f=0,g=s.length;f<g;f+=1)h.push(s[f],i[f+1]);return h}var LL=function(i){return Object.assign(i,{isCss:!0})};function _W(i){for(var s=[],h=1;h<arguments.length;h++)s[h-1]=arguments[h];if(mu(i)||Lp(i))return LL(lu(OL(d0,My([i],s,!0))));var f=i;return s.length===0&&f.length===1&&typeof f[0]=="string"?lu(f):LL(lu(OL(f,s)))}function wT(i,s,h){if(h===void 0&&(h=hd),!s)throw gu(1,s);var f=function(g){for(var y=[],b=1;b<arguments.length;b++)y[b-1]=arguments[b];return i(s,h,_W.apply(void 0,My([g],y,!1)))};return f.attrs=function(g){return wT(i,s,no(no({},h),{attrs:Array.prototype.concat(h.attrs,g).filter(Boolean)}))},f.withConfig=function(g){return wT(i,s,no(no({},h),g))},f}var P4=function(i){return wT(gW,i)},yW=P4;_4.forEach(function(i){yW[i]=P4(i)});var NS={},R4={exports:{}};(function(i){function s(h){return h&&h.__esModule?h:{default:h}}i.exports=s,i.exports.__esModule=!0,i.exports.default=i.exports})(R4);var jS=R4.exports,aw={};function xt(){return xt=Object.assign?Object.assign.bind():function(i){for(var s=1;s<arguments.length;s++){var h=arguments[s];for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(i[f]=h[f])}return i},xt.apply(this,arguments)}function Hl(i){if(typeof i!="object"||i===null)return!1;const s=Object.getPrototypeOf(i);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)}function k4(i){if(!Hl(i))return i;const s={};return Object.keys(i).forEach(h=>{s[h]=k4(i[h])}),s}function Lo(i,s,h={clone:!0}){const f=h.clone?xt({},i):i;return Hl(i)&&Hl(s)&&Object.keys(s).forEach(g=>{g!=="__proto__"&&(Hl(s[g])&&g in i&&Hl(i[g])?f[g]=Lo(i[g],s[g],h):h.clone?f[g]=Hl(s[g])?k4(s[g]):s[g]:f[g]=s[g])}),f}function lc(i){let s="https://mui.com/production-error/?code="+i;for(let h=1;h<arguments.length;h+=1)s+="&args[]="+encodeURIComponent(arguments[h]);return"Minified MUI error #"+i+"; visit "+s+" for the full message."}var Ar={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var US=Symbol.for("react.element"),$S=Symbol.for("react.portal"),f0=Symbol.for("react.fragment"),p0=Symbol.for("react.strict_mode"),m0=Symbol.for("react.profiler"),g0=Symbol.for("react.provider"),_0=Symbol.for("react.context"),vW=Symbol.for("react.server_context"),y0=Symbol.for("react.forward_ref"),v0=Symbol.for("react.suspense"),x0=Symbol.for("react.suspense_list"),b0=Symbol.for("react.memo"),w0=Symbol.for("react.lazy"),xW=Symbol.for("react.offscreen"),O4;O4=Symbol.for("react.module.reference");function Es(i){if(typeof i=="object"&&i!==null){var s=i.$$typeof;switch(s){case US:switch(i=i.type,i){case f0:case m0:case p0:case v0:case x0:return i;default:switch(i=i&&i.$$typeof,i){case vW:case _0:case y0:case w0:case b0:case g0:return i;default:return s}}case $S:return s}}}Ar.ContextConsumer=_0;Ar.ContextProvider=g0;Ar.Element=US;Ar.ForwardRef=y0;Ar.Fragment=f0;Ar.Lazy=w0;Ar.Memo=b0;Ar.Portal=$S;Ar.Profiler=m0;Ar.StrictMode=p0;Ar.Suspense=v0;Ar.SuspenseList=x0;Ar.isAsyncMode=function(){return!1};Ar.isConcurrentMode=function(){return!1};Ar.isContextConsumer=function(i){return Es(i)===_0};Ar.isContextProvider=function(i){return Es(i)===g0};Ar.isElement=function(i){return typeof i=="object"&&i!==null&&i.$$typeof===US};Ar.isForwardRef=function(i){return Es(i)===y0};Ar.isFragment=function(i){return Es(i)===f0};Ar.isLazy=function(i){return Es(i)===w0};Ar.isMemo=function(i){return Es(i)===b0};Ar.isPortal=function(i){return Es(i)===$S};Ar.isProfiler=function(i){return Es(i)===m0};Ar.isStrictMode=function(i){return Es(i)===p0};Ar.isSuspense=function(i){return Es(i)===v0};Ar.isSuspenseList=function(i){return Es(i)===x0};Ar.isValidElementType=function(i){return typeof i=="string"||typeof i=="function"||i===f0||i===m0||i===p0||i===v0||i===x0||i===xW||typeof i=="object"&&i!==null&&(i.$$typeof===w0||i.$$typeof===b0||i.$$typeof===g0||i.$$typeof===_0||i.$$typeof===y0||i.$$typeof===O4||i.getModuleId!==void 0)};Ar.typeOf=Es;function Ln(i){if(typeof i!="string")throw new Error(lc(7));return i.charAt(0).toUpperCase()+i.slice(1)}function TT(...i){return i.reduce((s,h)=>h==null?s:function(...g){s.apply(this,g),h.apply(this,g)},()=>{})}function T0(i,s=166){let h;function f(...g){const y=()=>{i.apply(this,g)};clearTimeout(h),h=setTimeout(y,s)}return f.clear=()=>{clearTimeout(h)},f}function bW(i,s){return()=>null}function K_(i,s){var h,f;return lt.isValidElement(i)&&s.indexOf((h=i.type.muiName)!=null?h:(f=i.type)==null||(f=f._payload)==null||(f=f.value)==null?void 0:f.muiName)!==-1}function zo(i){return i&&i.ownerDocument||document}function Ta(i){return zo(i).defaultView||window}function wW(i,s){return()=>null}function Ry(i,s){typeof i=="function"?i(s):i&&(i.current=s)}const TW=typeof window<"u"?lt.useLayoutEffect:lt.useEffect,cc=TW;let zL=0;function SW(i){const[s,h]=lt.useState(i),f=i||s;return lt.useEffect(()=>{s==null&&(zL+=1,h(`mui-${zL}`))},[s]),f}const DL=ny.useId;function VS(i){if(DL!==void 0){const s=DL();return i??s}return SW(i)}function EW(i,s,h,f,g){return null}function ST({controlled:i,default:s,name:h,state:f="value"}){const{current:g}=lt.useRef(i!==void 0),[y,b]=lt.useState(s),M=g?i:y,E=lt.useCallback(C=>{g||b(C)},[]);return[M,E]}function ru(i){const s=lt.useRef(i);return cc(()=>{s.current=i}),lt.useRef((...h)=>(0,s.current)(...h)).current}function io(...i){return lt.useMemo(()=>i.every(s=>s==null)?null:s=>{i.forEach(h=>{Ry(h,s)})},i)}const BL={};function CW(i,s){const h=lt.useRef(BL);return h.current===BL&&(h.current=i(s)),h}const MW=[];function IW(i){lt.useEffect(i,MW)}class S0{constructor(){this.currentId=0,this.clear=()=>{this.currentId!==0&&(clearTimeout(this.currentId),this.currentId=0)},this.disposeEffect=()=>this.clear}static create(){return new S0}start(s,h){this.clear(),this.currentId=setTimeout(()=>{this.currentId=0,h()},s)}}function L4(){const i=CW(S0.create).current;return IW(i.disposeEffect),i}let E0=!0,ET=!1;const AW=new S0,PW={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function RW(i){const{type:s,tagName:h}=i;return!!(h==="INPUT"&&PW[s]&&!i.readOnly||h==="TEXTAREA"&&!i.readOnly||i.isContentEditable)}function kW(i){i.metaKey||i.altKey||i.ctrlKey||(E0=!0)}function lw(){E0=!1}function OW(){this.visibilityState==="hidden"&&ET&&(E0=!0)}function LW(i){i.addEventListener("keydown",kW,!0),i.addEventListener("mousedown",lw,!0),i.addEventListener("pointerdown",lw,!0),i.addEventListener("touchstart",lw,!0),i.addEventListener("visibilitychange",OW,!0)}function zW(i){const{target:s}=i;try{return s.matches(":focus-visible")}catch{}return E0||RW(s)}function z4(){const i=lt.useCallback(g=>{g!=null&&LW(g.ownerDocument)},[]),s=lt.useRef(!1);function h(){return s.current?(ET=!0,AW.start(100,()=>{ET=!1}),s.current=!1,!0):!1}function f(g){return zW(g)?(s.current=!0,!0):!1}return{isFocusVisibleRef:s,onFocus:f,onBlur:h,ref:i}}function D4(i){const s=i.documentElement.clientWidth;return Math.abs(window.innerWidth-s)}function GS(i,s){const h=xt({},s);return Object.keys(i).forEach(f=>{if(f.toString().match(/^(components|slots)$/))h[f]=xt({},i[f],h[f]);else if(f.toString().match(/^(componentsProps|slotProps)$/)){const g=i[f]||{},y=s[f];h[f]={},!y||!Object.keys(y)?h[f]=g:!g||!Object.keys(g)?h[f]=y:(h[f]=xt({},y),Object.keys(g).forEach(b=>{h[f][b]=GS(g[b],y[b])}))}else h[f]===void 0&&(h[f]=i[f])}),h}function br(i,s,h=void 0){const f={};return Object.keys(i).forEach(g=>{f[g]=i[g].reduce((y,b)=>{if(b){const M=s(b);M!==""&&y.push(M),h&&h[b]&&y.push(h[b])}return y},[]).join(" ")}),f}const FL=i=>i,DW=()=>{let i=FL;return{configure(s){i=s},generate(s){return i(s)},reset(){i=FL}}},BW=DW(),WS=BW,FW={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function yr(i,s,h="Mui"){const f=FW[s];return f?`${h}-${f}`:`${WS.generate(i)}-${s}`}function wr(i,s,h="Mui"){const f={};return s.forEach(g=>{f[g]=yr(i,g,h)}),f}function NW(i,s=Number.MIN_SAFE_INTEGER,h=Number.MAX_SAFE_INTEGER){return Math.max(s,Math.min(i,h))}function cn(i,s){if(i==null)return{};var h={},f=Object.keys(i),g,y;for(y=0;y<f.length;y++)g=f[y],!(s.indexOf(g)>=0)&&(h[g]=i[g]);return h}function B4(i){var s,h,f="";if(typeof i=="string"||typeof i=="number")f+=i;else if(typeof i=="object")if(Array.isArray(i)){var g=i.length;for(s=0;s<g;s++)i[s]&&(h=B4(i[s]))&&(f&&(f+=" "),f+=h)}else for(h in i)i[h]&&(f&&(f+=" "),f+=h);return f}function In(){for(var i,s,h=0,f="",g=arguments.length;h<g;h++)(i=arguments[h])&&(s=B4(i))&&(f&&(f+=" "),f+=s);return f}function jW(i){if(i.sheet)return i.sheet;for(var s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].ownerNode===i)return document.styleSheets[s]}function UW(i){var s=document.createElement("style");return s.setAttribute("data-emotion",i.key),i.nonce!==void 0&&s.setAttribute("nonce",i.nonce),s.appendChild(document.createTextNode("")),s.setAttribute("data-s",""),s}var $W=function(){function i(h){var f=this;this._insertTag=function(g){var y;f.tags.length===0?f.insertionPoint?y=f.insertionPoint.nextSibling:f.prepend?y=f.container.firstChild:y=f.before:y=f.tags[f.tags.length-1].nextSibling,f.container.insertBefore(g,y),f.tags.push(g)},this.isSpeedy=h.speedy===void 0?!0:h.speedy,this.tags=[],this.ctr=0,this.nonce=h.nonce,this.key=h.key,this.container=h.container,this.prepend=h.prepend,this.insertionPoint=h.insertionPoint,this.before=null}var s=i.prototype;return s.hydrate=function(f){f.forEach(this._insertTag)},s.insert=function(f){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(UW(this));var g=this.tags[this.tags.length-1];if(this.isSpeedy){var y=jW(g);try{y.insertRule(f,y.cssRules.length)}catch{}}else g.appendChild(document.createTextNode(f));this.ctr++},s.flush=function(){this.tags.forEach(function(f){return f.parentNode&&f.parentNode.removeChild(f)}),this.tags=[],this.ctr=0},i}(),to="-ms-",ky="-moz-",hr="-webkit-",F4="comm",qS="rule",HS="decl",VW="@import",N4="@keyframes",GW="@layer",WW=Math.abs,C0=String.fromCharCode,qW=Object.assign;function HW(i,s){return Gi(i,0)^45?(((s<<2^Gi(i,0))<<2^Gi(i,1))<<2^Gi(i,2))<<2^Gi(i,3):0}function j4(i){return i.trim()}function ZW(i,s){return(i=s.exec(i))?i[0]:i}function dr(i,s,h){return i.replace(s,h)}function CT(i,s){return i.indexOf(s)}function Gi(i,s){return i.charCodeAt(s)|0}function zp(i,s,h){return i.slice(s,h)}function _a(i){return i.length}function ZS(i){return i.length}function S_(i,s){return s.push(i),i}function XW(i,s){return i.map(s).join("")}var M0=1,dd=1,U4=0,Do=0,Ti=0,bd="";function I0(i,s,h,f,g,y,b){return{value:i,root:s,parent:h,type:f,props:g,children:y,line:M0,column:dd,length:b,return:""}}function $f(i,s){return qW(I0("",null,null,"",null,null,0),i,{length:-i.length},s)}function KW(){return Ti}function YW(){return Ti=Do>0?Gi(bd,--Do):0,dd--,Ti===10&&(dd=1,M0--),Ti}function Jo(){return Ti=Do<U4?Gi(bd,Do++):0,dd++,Ti===10&&(dd=1,M0++),Ti}function wa(){return Gi(bd,Do)}function Y_(){return Do}function Zp(i,s){return zp(bd,i,s)}function Dp(i){switch(i){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function $4(i){return M0=dd=1,U4=_a(bd=i),Do=0,[]}function V4(i){return bd="",i}function Q_(i){return j4(Zp(Do-1,MT(i===91?i+2:i===40?i+1:i)))}function QW(i){for(;(Ti=wa())&&Ti<33;)Jo();return Dp(i)>2||Dp(Ti)>3?"":" "}function JW(i,s){for(;--s&&Jo()&&!(Ti<48||Ti>102||Ti>57&&Ti<65||Ti>70&&Ti<97););return Zp(i,Y_()+(s<6&&wa()==32&&Jo()==32))}function MT(i){for(;Jo();)switch(Ti){case i:return Do;case 34:case 39:i!==34&&i!==39&&MT(Ti);break;case 40:i===41&&MT(i);break;case 92:Jo();break}return Do}function tq(i,s){for(;Jo()&&i+Ti!==57;)if(i+Ti===84&&wa()===47)break;return"/*"+Zp(s,Do-1)+"*"+C0(i===47?i:Jo())}function eq(i){for(;!Dp(wa());)Jo();return Zp(i,Do)}function nq(i){return V4(J_("",null,null,null,[""],i=$4(i),0,[0],i))}function J_(i,s,h,f,g,y,b,M,E){for(var C=0,L=0,B=b,z=0,H=0,U=0,q=1,tt=1,V=1,F=0,D="",$=g,J=y,ct=f,st=D;tt;)switch(U=F,F=Jo()){case 40:if(U!=108&&Gi(st,B-1)==58){CT(st+=dr(Q_(F),"&","&\f"),"&\f")!=-1&&(V=-1);break}case 34:case 39:case 91:st+=Q_(F);break;case 9:case 10:case 13:case 32:st+=QW(U);break;case 92:st+=JW(Y_()-1,7);continue;case 47:switch(wa()){case 42:case 47:S_(rq(tq(Jo(),Y_()),s,h),E);break;default:st+="/"}break;case 123*q:M[C++]=_a(st)*V;case 125*q:case 59:case 0:switch(F){case 0:case 125:tt=0;case 59+L:V==-1&&(st=dr(st,/\f/g,"")),H>0&&_a(st)-B&&S_(H>32?jL(st+";",f,h,B-1):jL(dr(st," ","")+";",f,h,B-2),E);break;case 59:st+=";";default:if(S_(ct=NL(st,s,h,C,L,g,M,D,$=[],J=[],B),y),F===123)if(L===0)J_(st,s,ct,ct,$,y,B,M,J);else switch(z===99&&Gi(st,3)===110?100:z){case 100:case 108:case 109:case 115:J_(i,ct,ct,f&&S_(NL(i,ct,ct,0,0,g,M,D,g,$=[],B),J),g,J,B,M,f?$:J);break;default:J_(st,ct,ct,ct,[""],J,0,M,J)}}C=L=H=0,q=V=1,D=st="",B=b;break;case 58:B=1+_a(st),H=U;default:if(q<1){if(F==123)--q;else if(F==125&&q++==0&&YW()==125)continue}switch(st+=C0(F),F*q){case 38:V=L>0?1:(st+="\f",-1);break;case 44:M[C++]=(_a(st)-1)*V,V=1;break;case 64:wa()===45&&(st+=Q_(Jo())),z=wa(),L=B=_a(D=st+=eq(Y_())),F++;break;case 45:U===45&&_a(st)==2&&(q=0)}}return y}function NL(i,s,h,f,g,y,b,M,E,C,L){for(var B=g-1,z=g===0?y:[""],H=ZS(z),U=0,q=0,tt=0;U<f;++U)for(var V=0,F=zp(i,B+1,B=WW(q=b[U])),D=i;V<H;++V)(D=j4(q>0?z[V]+" "+F:dr(F,/&\f/g,z[V])))&&(E[tt++]=D);return I0(i,s,h,g===0?qS:M,E,C,L)}function rq(i,s,h){return I0(i,s,h,F4,C0(KW()),zp(i,2,-2),0)}function jL(i,s,h,f){return I0(i,s,h,HS,zp(i,0,f),zp(i,f+1,-1),f)}function Kh(i,s){for(var h="",f=ZS(i),g=0;g<f;g++)h+=s(i[g],g,i,s)||"";return h}function iq(i,s,h,f){switch(i.type){case GW:if(i.children.length)break;case VW:case HS:return i.return=i.return||i.value;case F4:return"";case N4:return i.return=i.value+"{"+Kh(i.children,f)+"}";case qS:i.value=i.props.join(",")}return _a(h=Kh(i.children,f))?i.return=i.value+"{"+h+"}":""}function oq(i){var s=ZS(i);return function(h,f,g,y){for(var b="",M=0;M<s;M++)b+=i[M](h,f,g,y)||"";return b}}function sq(i){return function(s){s.root||(s=s.return)&&i(s)}}var aq=function(s,h,f){for(var g=0,y=0;g=y,y=wa(),g===38&&y===12&&(h[f]=1),!Dp(y);)Jo();return Zp(s,Do)},lq=function(s,h){var f=-1,g=44;do switch(Dp(g)){case 0:g===38&&wa()===12&&(h[f]=1),s[f]+=aq(Do-1,h,f);break;case 2:s[f]+=Q_(g);break;case 4:if(g===44){s[++f]=wa()===58?"&\f":"",h[f]=s[f].length;break}default:s[f]+=C0(g)}while(g=Jo());return s},cq=function(s,h){return V4(lq($4(s),h))},UL=new WeakMap,uq=function(s){if(!(s.type!=="rule"||!s.parent||s.length<1)){for(var h=s.value,f=s.parent,g=s.column===f.column&&s.line===f.line;f.type!=="rule";)if(f=f.parent,!f)return;if(!(s.props.length===1&&h.charCodeAt(0)!==58&&!UL.get(f))&&!g){UL.set(s,!0);for(var y=[],b=cq(h,y),M=f.props,E=0,C=0;E<b.length;E++)for(var L=0;L<M.length;L++,C++)s.props[C]=y[E]?b[E].replace(/&\f/g,M[L]):M[L]+" "+b[E]}}},hq=function(s){if(s.type==="decl"){var h=s.value;h.charCodeAt(0)===108&&h.charCodeAt(2)===98&&(s.return="",s.value="")}};function G4(i,s){switch(HW(i,s)){case 5103:return hr+"print-"+i+i;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return hr+i+i;case 5349:case 4246:case 4810:case 6968:case 2756:return hr+i+ky+i+to+i+i;case 6828:case 4268:return hr+i+to+i+i;case 6165:return hr+i+to+"flex-"+i+i;case 5187:return hr+i+dr(i,/(\w+).+(:[^]+)/,hr+"box-$1$2"+to+"flex-$1$2")+i;case 5443:return hr+i+to+"flex-item-"+dr(i,/flex-|-self/,"")+i;case 4675:return hr+i+to+"flex-line-pack"+dr(i,/align-content|flex-|-self/,"")+i;case 5548:return hr+i+to+dr(i,"shrink","negative")+i;case 5292:return hr+i+to+dr(i,"basis","preferred-size")+i;case 6060:return hr+"box-"+dr(i,"-grow","")+hr+i+to+dr(i,"grow","positive")+i;case 4554:return hr+dr(i,/([^-])(transform)/g,"$1"+hr+"$2")+i;case 6187:return dr(dr(dr(i,/(zoom-|grab)/,hr+"$1"),/(image-set)/,hr+"$1"),i,"")+i;case 5495:case 3959:return dr(i,/(image-set\([^]*)/,hr+"$1$`$1");case 4968:return dr(dr(i,/(.+:)(flex-)?(.*)/,hr+"box-pack:$3"+to+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+hr+i+i;case 4095:case 3583:case 4068:case 2532:return dr(i,/(.+)-inline(.+)/,hr+"$1$2")+i;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(_a(i)-1-s>6)switch(Gi(i,s+1)){case 109:if(Gi(i,s+4)!==45)break;case 102:return dr(i,/(.+:)(.+)-([^]+)/,"$1"+hr+"$2-$3$1"+ky+(Gi(i,s+3)==108?"$3":"$2-$3"))+i;case 115:return~CT(i,"stretch")?G4(dr(i,"stretch","fill-available"),s)+i:i}break;case 4949:if(Gi(i,s+1)!==115)break;case 6444:switch(Gi(i,_a(i)-3-(~CT(i,"!important")&&10))){case 107:return dr(i,":",":"+hr)+i;case 101:return dr(i,/(.+:)([^;!]+)(;|!.+)?/,"$1"+hr+(Gi(i,14)===45?"inline-":"")+"box$3$1"+hr+"$2$3$1"+to+"$2box$3")+i}break;case 5936:switch(Gi(i,s+11)){case 114:return hr+i+to+dr(i,/[svh]\w+-[tblr]{2}/,"tb")+i;case 108:return hr+i+to+dr(i,/[svh]\w+-[tblr]{2}/,"tb-rl")+i;case 45:return hr+i+to+dr(i,/[svh]\w+-[tblr]{2}/,"lr")+i}return hr+i+to+i+i}return i}var dq=function(s,h,f,g){if(s.length>-1&&!s.return)switch(s.type){case HS:s.return=G4(s.value,s.length);break;case N4:return Kh([$f(s,{value:dr(s.value,"@","@"+hr)})],g);case qS:if(s.length)return XW(s.props,function(y){switch(ZW(y,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Kh([$f(s,{props:[dr(y,/:(read-\w+)/,":"+ky+"$1")]})],g);case"::placeholder":return Kh([$f(s,{props:[dr(y,/:(plac\w+)/,":"+hr+"input-$1")]}),$f(s,{props:[dr(y,/:(plac\w+)/,":"+ky+"$1")]}),$f(s,{props:[dr(y,/:(plac\w+)/,to+"input-$1")]})],g)}return""})}},fq=[dq],pq=function(s){var h=s.key;if(h==="css"){var f=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(f,function(q){var tt=q.getAttribute("data-emotion");tt.indexOf(" ")!==-1&&(document.head.appendChild(q),q.setAttribute("data-s",""))})}var g=s.stylisPlugins||fq,y={},b,M=[];b=s.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+h+' "]'),function(q){for(var tt=q.getAttribute("data-emotion").split(" "),V=1;V<tt.length;V++)y[tt[V]]=!0;M.push(q)});var E,C=[uq,hq];{var L,B=[iq,sq(function(q){L.insert(q)})],z=oq(C.concat(g,B)),H=function(tt){return Kh(nq(tt),z)};E=function(tt,V,F,D){L=F,H(tt?tt+"{"+V.styles+"}":V.styles),D&&(U.inserted[V.name]=!0)}}var U={key:h,sheet:new $W({key:h,container:b,nonce:s.nonce,speedy:s.speedy,prepend:s.prepend,insertionPoint:s.insertionPoint}),nonce:s.nonce,inserted:y,registered:{},insert:E};return U.sheet.hydrate(M),U},W4={exports:{}},Tr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ni=typeof Symbol=="function"&&Symbol.for,XS=Ni?Symbol.for("react.element"):60103,KS=Ni?Symbol.for("react.portal"):60106,A0=Ni?Symbol.for("react.fragment"):60107,P0=Ni?Symbol.for("react.strict_mode"):60108,R0=Ni?Symbol.for("react.profiler"):60114,k0=Ni?Symbol.for("react.provider"):60109,O0=Ni?Symbol.for("react.context"):60110,YS=Ni?Symbol.for("react.async_mode"):60111,L0=Ni?Symbol.for("react.concurrent_mode"):60111,z0=Ni?Symbol.for("react.forward_ref"):60112,D0=Ni?Symbol.for("react.suspense"):60113,mq=Ni?Symbol.for("react.suspense_list"):60120,B0=Ni?Symbol.for("react.memo"):60115,F0=Ni?Symbol.for("react.lazy"):60116,gq=Ni?Symbol.for("react.block"):60121,_q=Ni?Symbol.for("react.fundamental"):60117,yq=Ni?Symbol.for("react.responder"):60118,vq=Ni?Symbol.for("react.scope"):60119;function rs(i){if(typeof i=="object"&&i!==null){var s=i.$$typeof;switch(s){case XS:switch(i=i.type,i){case YS:case L0:case A0:case R0:case P0:case D0:return i;default:switch(i=i&&i.$$typeof,i){case O0:case z0:case F0:case B0:case k0:return i;default:return s}}case KS:return s}}}function q4(i){return rs(i)===L0}Tr.AsyncMode=YS;Tr.ConcurrentMode=L0;Tr.ContextConsumer=O0;Tr.ContextProvider=k0;Tr.Element=XS;Tr.ForwardRef=z0;Tr.Fragment=A0;Tr.Lazy=F0;Tr.Memo=B0;Tr.Portal=KS;Tr.Profiler=R0;Tr.StrictMode=P0;Tr.Suspense=D0;Tr.isAsyncMode=function(i){return q4(i)||rs(i)===YS};Tr.isConcurrentMode=q4;Tr.isContextConsumer=function(i){return rs(i)===O0};Tr.isContextProvider=function(i){return rs(i)===k0};Tr.isElement=function(i){return typeof i=="object"&&i!==null&&i.$$typeof===XS};Tr.isForwardRef=function(i){return rs(i)===z0};Tr.isFragment=function(i){return rs(i)===A0};Tr.isLazy=function(i){return rs(i)===F0};Tr.isMemo=function(i){return rs(i)===B0};Tr.isPortal=function(i){return rs(i)===KS};Tr.isProfiler=function(i){return rs(i)===R0};Tr.isStrictMode=function(i){return rs(i)===P0};Tr.isSuspense=function(i){return rs(i)===D0};Tr.isValidElementType=function(i){return typeof i=="string"||typeof i=="function"||i===A0||i===L0||i===R0||i===P0||i===D0||i===mq||typeof i=="object"&&i!==null&&(i.$$typeof===F0||i.$$typeof===B0||i.$$typeof===k0||i.$$typeof===O0||i.$$typeof===z0||i.$$typeof===_q||i.$$typeof===yq||i.$$typeof===vq||i.$$typeof===gq)};Tr.typeOf=rs;W4.exports=Tr;var xq=W4.exports,H4=xq,bq={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},wq={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Z4={};Z4[H4.ForwardRef]=bq;Z4[H4.Memo]=wq;var Tq=!0;function Sq(i,s,h){var f="";return h.split(" ").forEach(function(g){i[g]!==void 0?s.push(i[g]+";"):f+=g+" "}),f}var X4=function(s,h,f){var g=s.key+"-"+h.name;(f===!1||Tq===!1)&&s.registered[g]===void 0&&(s.registered[g]=h.styles)},K4=function(s,h,f){X4(s,h,f);var g=s.key+"-"+h.name;if(s.inserted[h.name]===void 0){var y=h;do s.insert(h===y?"."+g:"",y,s.sheet,!0),y=y.next;while(y!==void 0)}};function Eq(i){for(var s=0,h,f=0,g=i.length;g>=4;++f,g-=4)h=i.charCodeAt(f)&255|(i.charCodeAt(++f)&255)<<8|(i.charCodeAt(++f)&255)<<16|(i.charCodeAt(++f)&255)<<24,h=(h&65535)*1540483477+((h>>>16)*59797<<16),h^=h>>>24,s=(h&65535)*1540483477+((h>>>16)*59797<<16)^(s&65535)*1540483477+((s>>>16)*59797<<16);switch(g){case 3:s^=(i.charCodeAt(f+2)&255)<<16;case 2:s^=(i.charCodeAt(f+1)&255)<<8;case 1:s^=i.charCodeAt(f)&255,s=(s&65535)*1540483477+((s>>>16)*59797<<16)}return s^=s>>>13,s=(s&65535)*1540483477+((s>>>16)*59797<<16),((s^s>>>15)>>>0).toString(36)}var Cq={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Mq=/[A-Z]|^ms/g,Iq=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Y4=function(s){return s.charCodeAt(1)===45},$L=function(s){return s!=null&&typeof s!="boolean"},cw=a4(function(i){return Y4(i)?i:i.replace(Mq,"-$&").toLowerCase()}),VL=function(s,h){switch(s){case"animation":case"animationName":if(typeof h=="string")return h.replace(Iq,function(f,g,y){return ya={name:g,styles:y,next:ya},g})}return Cq[s]!==1&&!Y4(s)&&typeof h=="number"&&h!==0?h+"px":h};function Bp(i,s,h){if(h==null)return"";if(h.__emotion_styles!==void 0)return h;switch(typeof h){case"boolean":return"";case"object":{if(h.anim===1)return ya={name:h.name,styles:h.styles,next:ya},h.name;if(h.styles!==void 0){var f=h.next;if(f!==void 0)for(;f!==void 0;)ya={name:f.name,styles:f.styles,next:ya},f=f.next;var g=h.styles+";";return g}return Aq(i,s,h)}case"function":{if(i!==void 0){var y=ya,b=h(i);return ya=y,Bp(i,s,b)}break}}if(s==null)return h;var M=s[h];return M!==void 0?M:h}function Aq(i,s,h){var f="";if(Array.isArray(h))for(var g=0;g<h.length;g++)f+=Bp(i,s,h[g])+";";else for(var y in h){var b=h[y];if(typeof b!="object")s!=null&&s[b]!==void 0?f+=y+"{"+s[b]+"}":$L(b)&&(f+=cw(y)+":"+VL(y,b)+";");else if(Array.isArray(b)&&typeof b[0]=="string"&&(s==null||s[b[0]]===void 0))for(var M=0;M<b.length;M++)$L(b[M])&&(f+=cw(y)+":"+VL(y,b[M])+";");else{var E=Bp(i,s,b);switch(y){case"animation":case"animationName":{f+=cw(y)+":"+E+";";break}default:f+=y+"{"+E+"}"}}}return f}var GL=/label:\s*([^\s;\n{]+)\s*(;|$)/g,ya,QS=function(s,h,f){if(s.length===1&&typeof s[0]=="object"&&s[0]!==null&&s[0].styles!==void 0)return s[0];var g=!0,y="";ya=void 0;var b=s[0];b==null||b.raw===void 0?(g=!1,y+=Bp(f,h,b)):y+=b[0];for(var M=1;M<s.length;M++)y+=Bp(f,h,s[M]),g&&(y+=b[M]);GL.lastIndex=0;for(var E="",C;(C=GL.exec(y))!==null;)E+="-"+C[1];var L=Eq(y)+E;return{name:L,styles:y,next:ya}},Pq=function(s){return s()},Q4=ny.useInsertionEffect?ny.useInsertionEffect:!1,Rq=Q4||Pq,WL=Q4||lt.useLayoutEffect,J4=lt.createContext(typeof HTMLElement<"u"?pq({key:"css"}):null);J4.Provider;var t5=function(s){return lt.forwardRef(function(h,f){var g=lt.useContext(J4);return s(h,g,f)})},JS=lt.createContext({}),kq=t5(function(i,s){var h=i.styles,f=QS([h],void 0,lt.useContext(JS)),g=lt.useRef();return WL(function(){var y=s.key+"-global",b=new s.sheet.constructor({key:y,nonce:s.sheet.nonce,container:s.sheet.container,speedy:s.sheet.isSpeedy}),M=!1,E=document.querySelector('style[data-emotion="'+y+" "+f.name+'"]');return s.sheet.tags.length&&(b.before=s.sheet.tags[0]),E!==null&&(M=!0,E.setAttribute("data-emotion",y),b.hydrate([E])),g.current=[b,M],function(){b.flush()}},[s]),WL(function(){var y=g.current,b=y[0],M=y[1];if(M){y[1]=!1;return}if(f.next!==void 0&&K4(s,f.next,!0),b.tags.length){var E=b.tags[b.tags.length-1].nextElementSibling;b.before=E,b.flush()}s.insert("",f,b,!1)},[s,f.name]),null});function Oq(){for(var i=arguments.length,s=new Array(i),h=0;h<i;h++)s[h]=arguments[h];return QS(s)}var tE=function(){var s=Oq.apply(void 0,arguments),h="animation-"+s.name;return{name:h,styles:"@keyframes "+h+"{"+s.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},Lq=p9,zq=function(s){return s!=="theme"},qL=function(s){return typeof s=="string"&&s.charCodeAt(0)>96?Lq:zq},HL=function(s,h,f){var g;if(h){var y=h.shouldForwardProp;g=s.__emotion_forwardProp&&y?function(b){return s.__emotion_forwardProp(b)&&y(b)}:y}return typeof g!="function"&&f&&(g=s.__emotion_forwardProp),g},Dq=function(s){var h=s.cache,f=s.serialized,g=s.isStringTag;return X4(h,f,g),Rq(function(){return K4(h,f,g)}),null},Bq=function i(s,h){var f=s.__emotion_real===s,g=f&&s.__emotion_base||s,y,b;h!==void 0&&(y=h.label,b=h.target);var M=HL(s,h,f),E=M||qL(g),C=!E("as");return function(){var L=arguments,B=f&&s.__emotion_styles!==void 0?s.__emotion_styles.slice(0):[];if(y!==void 0&&B.push("label:"+y+";"),L[0]==null||L[0].raw===void 0)B.push.apply(B,L);else{B.push(L[0][0]);for(var z=L.length,H=1;H<z;H++)B.push(L[H],L[0][H])}var U=t5(function(q,tt,V){var F=C&&q.as||g,D="",$=[],J=q;if(q.theme==null){J={};for(var ct in q)J[ct]=q[ct];J.theme=lt.useContext(JS)}typeof q.className=="string"?D=Sq(tt.registered,$,q.className):q.className!=null&&(D=q.className+" ");var st=QS(B.concat($),tt.registered,J);D+=tt.key+"-"+st.name,b!==void 0&&(D+=" "+b);var yt=C&&M===void 0?qL(F):E,ut={};for(var N in q)C&&N==="as"||yt(N)&&(ut[N]=q[N]);return ut.className=D,ut.ref=V,lt.createElement(lt.Fragment,null,lt.createElement(Dq,{cache:tt,serialized:st,isStringTag:typeof F=="string"}),lt.createElement(F,ut))});return U.displayName=y!==void 0?y:"Styled("+(typeof g=="string"?g:g.displayName||g.name||"Component")+")",U.defaultProps=s.defaultProps,U.__emotion_real=U,U.__emotion_base=g,U.__emotion_styles=B,U.__emotion_forwardProp=M,Object.defineProperty(U,"toString",{value:function(){return"."+b}}),U.withComponent=function(q,tt){return i(q,xt({},h,tt,{shouldForwardProp:HL(U,tt,!0)})).apply(void 0,B)},U}},Fq=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],IT=Bq.bind();Fq.forEach(function(i){IT[i]=IT(i)});function Nq(i){return i==null||Object.keys(i).length===0}function jq(i){const{styles:s,defaultTheme:h={}}=i,f=typeof s=="function"?g=>s(Nq(g)?h:g):s;return rt.jsx(kq,{styles:f})}function e5(i,s){return IT(i,s)}const Uq=(i,s)=>{Array.isArray(i.__emotion_styles)&&(i.__emotion_styles=s(i.__emotion_styles))},$q=["values","unit","step"],Vq=i=>{const s=Object.keys(i).map(h=>({key:h,val:i[h]}))||[];return s.sort((h,f)=>h.val-f.val),s.reduce((h,f)=>xt({},h,{[f.key]:f.val}),{})};function Gq(i){const{values:s={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:h="px",step:f=5}=i,g=cn(i,$q),y=Vq(s),b=Object.keys(y);function M(z){return`@media (min-width:${typeof s[z]=="number"?s[z]:z}${h})`}function E(z){return`@media (max-width:${(typeof s[z]=="number"?s[z]:z)-f/100}${h})`}function C(z,H){const U=b.indexOf(H);return`@media (min-width:${typeof s[z]=="number"?s[z]:z}${h}) and (max-width:${(U!==-1&&typeof s[b[U]]=="number"?s[b[U]]:H)-f/100}${h})`}function L(z){return b.indexOf(z)+1<b.length?C(z,b[b.indexOf(z)+1]):M(z)}function B(z){const H=b.indexOf(z);return H===0?M(b[1]):H===b.length-1?E(b[H]):C(z,b[b.indexOf(z)+1]).replace("@media","@media not all and")}return xt({keys:b,values:y,up:M,down:E,between:C,only:L,not:B,unit:h},g)}const Wq={borderRadius:4},qq=Wq;function fp(i,s){return s?Lo(i,s,{clone:!1}):i}const eE={xs:0,sm:600,md:900,lg:1200,xl:1536},ZL={keys:["xs","sm","md","lg","xl"],up:i=>`@media (min-width:${eE[i]}px)`};function Bo(i,s,h){const f=i.theme||{};if(Array.isArray(s)){const y=f.breakpoints||ZL;return s.reduce((b,M,E)=>(b[y.up(y.keys[E])]=h(s[E]),b),{})}if(typeof s=="object"){const y=f.breakpoints||ZL;return Object.keys(s).reduce((b,M)=>{if(Object.keys(y.values||eE).indexOf(M)!==-1){const E=y.up(M);b[E]=h(s[M],M)}else{const E=M;b[E]=s[E]}return b},{})}return h(s)}function n5(i={}){var s;return((s=i.keys)==null?void 0:s.reduce((f,g)=>{const y=i.up(g);return f[y]={},f},{}))||{}}function r5(i,s){return i.reduce((h,f)=>{const g=h[f];return(!g||Object.keys(g).length===0)&&delete h[f],h},s)}function Hq(i,...s){const h=n5(i),f=[h,...s].reduce((g,y)=>Lo(g,y),{});return r5(Object.keys(h),f)}function Zq(i,s){if(typeof i!="object")return{};const h={},f=Object.keys(s);return Array.isArray(i)?f.forEach((g,y)=>{y<i.length&&(h[g]=!0)}):f.forEach(g=>{i[g]!=null&&(h[g]=!0)}),h}function cu({values:i,breakpoints:s,base:h}){const f=h||Zq(i,s),g=Object.keys(f);if(g.length===0)return i;let y;return g.reduce((b,M,E)=>(Array.isArray(i)?(b[M]=i[E]!=null?i[E]:i[y],y=E):typeof i=="object"?(b[M]=i[M]!=null?i[M]:i[y],y=M):b[M]=i,b),{})}function N0(i,s,h=!0){if(!s||typeof s!="string")return null;if(i&&i.vars&&h){const f=`vars.${s}`.split(".").reduce((g,y)=>g&&g[y]?g[y]:null,i);if(f!=null)return f}return s.split(".").reduce((f,g)=>f&&f[g]!=null?f[g]:null,i)}function Oy(i,s,h,f=h){let g;return typeof i=="function"?g=i(h):Array.isArray(i)?g=i[h]||f:g=N0(i,h)||f,s&&(g=s(g,f,i)),g}function gi(i){const{prop:s,cssProperty:h=i.prop,themeKey:f,transform:g}=i,y=b=>{if(b[s]==null)return null;const M=b[s],E=b.theme,C=N0(E,f)||{};return Bo(b,M,B=>{let z=Oy(C,g,B);return B===z&&typeof B=="string"&&(z=Oy(C,g,`${s}${B==="default"?"":Ln(B)}`,B)),h===!1?z:{[h]:z}})};return y.propTypes={},y.filterProps=[s],y}function Xq(i){const s={};return h=>(s[h]===void 0&&(s[h]=i(h)),s[h])}const Kq={m:"margin",p:"padding"},Yq={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},XL={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Qq=Xq(i=>{if(i.length>2)if(XL[i])i=XL[i];else return[i];const[s,h]=i.split(""),f=Kq[s],g=Yq[h]||"";return Array.isArray(g)?g.map(y=>f+y):[f+g]}),nE=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],rE=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...nE,...rE];function Xp(i,s,h,f){var g;const y=(g=N0(i,s,!1))!=null?g:h;return typeof y=="number"?b=>typeof b=="string"?b:y*b:Array.isArray(y)?b=>typeof b=="string"?b:y[b]:typeof y=="function"?y:()=>{}}function iE(i){return Xp(i,"spacing",8)}function _u(i,s){if(typeof s=="string"||s==null)return s;const h=Math.abs(s),f=i(h);return s>=0?f:typeof f=="number"?-f:`-${f}`}function Jq(i,s){return h=>i.reduce((f,g)=>(f[g]=_u(s,h),f),{})}function tH(i,s,h,f){if(s.indexOf(h)===-1)return null;const g=Qq(h),y=Jq(g,f),b=i[h];return Bo(i,b,y)}function i5(i,s){const h=iE(i.theme);return Object.keys(i).map(f=>tH(i,s,f,h)).reduce(fp,{})}function si(i){return i5(i,nE)}si.propTypes={};si.filterProps=nE;function ai(i){return i5(i,rE)}ai.propTypes={};ai.filterProps=rE;function eH(i=8){if(i.mui)return i;const s=iE({spacing:i}),h=(...f)=>(f.length===0?[1]:f).map(y=>{const b=s(y);return typeof b=="number"?`${b}px`:b}).join(" ");return h.mui=!0,h}function j0(...i){const s=i.reduce((f,g)=>(g.filterProps.forEach(y=>{f[y]=g}),f),{}),h=f=>Object.keys(f).reduce((g,y)=>s[y]?fp(g,s[y](f)):g,{});return h.propTypes={},h.filterProps=i.reduce((f,g)=>f.concat(g.filterProps),[]),h}function vs(i){return typeof i!="number"?i:`${i}px solid`}function Cs(i,s){return gi({prop:i,themeKey:"borders",transform:s})}const nH=Cs("border",vs),rH=Cs("borderTop",vs),iH=Cs("borderRight",vs),oH=Cs("borderBottom",vs),sH=Cs("borderLeft",vs),aH=Cs("borderColor"),lH=Cs("borderTopColor"),cH=Cs("borderRightColor"),uH=Cs("borderBottomColor"),hH=Cs("borderLeftColor"),dH=Cs("outline",vs),fH=Cs("outlineColor"),U0=i=>{if(i.borderRadius!==void 0&&i.borderRadius!==null){const s=Xp(i.theme,"shape.borderRadius",4),h=f=>({borderRadius:_u(s,f)});return Bo(i,i.borderRadius,h)}return null};U0.propTypes={};U0.filterProps=["borderRadius"];j0(nH,rH,iH,oH,sH,aH,lH,cH,uH,hH,U0,dH,fH);const $0=i=>{if(i.gap!==void 0&&i.gap!==null){const s=Xp(i.theme,"spacing",8),h=f=>({gap:_u(s,f)});return Bo(i,i.gap,h)}return null};$0.propTypes={};$0.filterProps=["gap"];const V0=i=>{if(i.columnGap!==void 0&&i.columnGap!==null){const s=Xp(i.theme,"spacing",8),h=f=>({columnGap:_u(s,f)});return Bo(i,i.columnGap,h)}return null};V0.propTypes={};V0.filterProps=["columnGap"];const G0=i=>{if(i.rowGap!==void 0&&i.rowGap!==null){const s=Xp(i.theme,"spacing",8),h=f=>({rowGap:_u(s,f)});return Bo(i,i.rowGap,h)}return null};G0.propTypes={};G0.filterProps=["rowGap"];const pH=gi({prop:"gridColumn"}),mH=gi({prop:"gridRow"}),gH=gi({prop:"gridAutoFlow"}),_H=gi({prop:"gridAutoColumns"}),yH=gi({prop:"gridAutoRows"}),vH=gi({prop:"gridTemplateColumns"}),xH=gi({prop:"gridTemplateRows"}),bH=gi({prop:"gridTemplateAreas"}),wH=gi({prop:"gridArea"});j0($0,V0,G0,pH,mH,gH,_H,yH,vH,xH,bH,wH);function Yh(i,s){return s==="grey"?s:i}const TH=gi({prop:"color",themeKey:"palette",transform:Yh}),SH=gi({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Yh}),EH=gi({prop:"backgroundColor",themeKey:"palette",transform:Yh});j0(TH,SH,EH);function Ko(i){return i<=1&&i!==0?`${i*100}%`:i}const CH=gi({prop:"width",transform:Ko}),oE=i=>{if(i.maxWidth!==void 0&&i.maxWidth!==null){const s=h=>{var f,g;const y=((f=i.theme)==null||(f=f.breakpoints)==null||(f=f.values)==null?void 0:f[h])||eE[h];return y?((g=i.theme)==null||(g=g.breakpoints)==null?void 0:g.unit)!=="px"?{maxWidth:`${y}${i.theme.breakpoints.unit}`}:{maxWidth:y}:{maxWidth:Ko(h)}};return Bo(i,i.maxWidth,s)}return null};oE.filterProps=["maxWidth"];const MH=gi({prop:"minWidth",transform:Ko}),IH=gi({prop:"height",transform:Ko}),AH=gi({prop:"maxHeight",transform:Ko}),PH=gi({prop:"minHeight",transform:Ko});gi({prop:"size",cssProperty:"width",transform:Ko});gi({prop:"size",cssProperty:"height",transform:Ko});const RH=gi({prop:"boxSizing"});j0(CH,oE,MH,IH,AH,PH,RH);const kH={border:{themeKey:"borders",transform:vs},borderTop:{themeKey:"borders",transform:vs},borderRight:{themeKey:"borders",transform:vs},borderBottom:{themeKey:"borders",transform:vs},borderLeft:{themeKey:"borders",transform:vs},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:vs},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:U0},color:{themeKey:"palette",transform:Yh},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Yh},backgroundColor:{themeKey:"palette",transform:Yh},p:{style:ai},pt:{style:ai},pr:{style:ai},pb:{style:ai},pl:{style:ai},px:{style:ai},py:{style:ai},padding:{style:ai},paddingTop:{style:ai},paddingRight:{style:ai},paddingBottom:{style:ai},paddingLeft:{style:ai},paddingX:{style:ai},paddingY:{style:ai},paddingInline:{style:ai},paddingInlineStart:{style:ai},paddingInlineEnd:{style:ai},paddingBlock:{style:ai},paddingBlockStart:{style:ai},paddingBlockEnd:{style:ai},m:{style:si},mt:{style:si},mr:{style:si},mb:{style:si},ml:{style:si},mx:{style:si},my:{style:si},margin:{style:si},marginTop:{style:si},marginRight:{style:si},marginBottom:{style:si},marginLeft:{style:si},marginX:{style:si},marginY:{style:si},marginInline:{style:si},marginInlineStart:{style:si},marginInlineEnd:{style:si},marginBlock:{style:si},marginBlockStart:{style:si},marginBlockEnd:{style:si},displayPrint:{cssProperty:!1,transform:i=>({"@media print":{display:i}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:$0},rowGap:{style:G0},columnGap:{style:V0},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Ko},maxWidth:{style:oE},minWidth:{transform:Ko},height:{transform:Ko},maxHeight:{transform:Ko},minHeight:{transform:Ko},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},W0=kH;function OH(...i){const s=i.reduce((f,g)=>f.concat(Object.keys(g)),[]),h=new Set(s);return i.every(f=>h.size===Object.keys(f).length)}function LH(i,s){return typeof i=="function"?i(s):i}function zH(){function i(h,f,g,y){const b={[h]:f,theme:g},M=y[h];if(!M)return{[h]:f};const{cssProperty:E=h,themeKey:C,transform:L,style:B}=M;if(f==null)return null;if(C==="typography"&&f==="inherit")return{[h]:f};const z=N0(g,C)||{};return B?B(b):Bo(b,f,U=>{let q=Oy(z,L,U);return U===q&&typeof U=="string"&&(q=Oy(z,L,`${h}${U==="default"?"":Ln(U)}`,U)),E===!1?q:{[E]:q}})}function s(h){var f;const{sx:g,theme:y={}}=h||{};if(!g)return null;const b=(f=y.unstable_sxConfig)!=null?f:W0;function M(E){let C=E;if(typeof E=="function")C=E(y);else if(typeof E!="object")return E;if(!C)return null;const L=n5(y.breakpoints),B=Object.keys(L);let z=L;return Object.keys(C).forEach(H=>{const U=LH(C[H],y);if(U!=null)if(typeof U=="object")if(b[H])z=fp(z,i(H,U,y,b));else{const q=Bo({theme:y},U,tt=>({[H]:tt}));OH(q,U)?z[H]=s({sx:U,theme:y}):z=fp(z,q)}else z=fp(z,i(H,U,y,b))}),r5(B,z)}return Array.isArray(g)?g.map(M):M(g)}return s}const o5=zH();o5.filterProps=["sx"];const q0=o5;function DH(i,s){const h=this;return h.vars&&typeof h.getColorSchemeSelector=="function"?{[h.getColorSchemeSelector(i).replace(/(\[[^\]]+\])/,"*:where($1)")]:s}:h.palette.mode===i?s:{}}const BH=["breakpoints","palette","spacing","shape"];function Kp(i={},...s){const{breakpoints:h={},palette:f={},spacing:g,shape:y={}}=i,b=cn(i,BH),M=Gq(h),E=eH(g);let C=Lo({breakpoints:M,direction:"ltr",components:{},palette:xt({mode:"light"},f),spacing:E,shape:xt({},qq,y)},b);return C.applyStyles=DH,C=s.reduce((L,B)=>Lo(L,B),C),C.unstable_sxConfig=xt({},W0,b==null?void 0:b.unstable_sxConfig),C.unstable_sx=function(B){return q0({sx:B,theme:this})},C}function FH(i){return Object.keys(i).length===0}function NH(i=null){const s=lt.useContext(JS);return!s||FH(s)?i:s}const jH=Kp();function H0(i=jH){return NH(i)}function UH({styles:i,themeId:s,defaultTheme:h={}}){const f=H0(h),g=typeof i=="function"?i(s&&f[s]||f):i;return rt.jsx(jq,{styles:g})}const $H=["sx"],VH=i=>{var s,h;const f={systemProps:{},otherProps:{}},g=(s=i==null||(h=i.theme)==null?void 0:h.unstable_sxConfig)!=null?s:W0;return Object.keys(i).forEach(y=>{g[y]?f.systemProps[y]=i[y]:f.otherProps[y]=i[y]}),f};function Z0(i){const{sx:s}=i,h=cn(i,$H),{systemProps:f,otherProps:g}=VH(h);let y;return Array.isArray(s)?y=[f,...s]:typeof s=="function"?y=(...b)=>{const M=s(...b);return Hl(M)?xt({},f,M):f}:y=xt({},f,s),xt({},g,{sx:y})}const GH=["className","component"];function WH(i={}){const{themeId:s,defaultTheme:h,defaultClassName:f="MuiBox-root",generateClassName:g}=i,y=e5("div",{shouldForwardProp:M=>M!=="theme"&&M!=="sx"&&M!=="as"})(q0);return lt.forwardRef(function(E,C){const L=H0(h),B=Z0(E),{className:z,component:H="div"}=B,U=cn(B,GH);return rt.jsx(y,xt({as:H,ref:C,className:In(z,g?g(f):f),theme:s&&L[s]||L},U))})}const qH=["ownerState"],HH=["variants"],ZH=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function XH(i){return Object.keys(i).length===0}function KH(i){return typeof i=="string"&&i.charCodeAt(0)>96}function pp(i){return i!=="ownerState"&&i!=="theme"&&i!=="sx"&&i!=="as"}const YH=Kp(),QH=i=>i&&i.charAt(0).toLowerCase()+i.slice(1);function E_({defaultTheme:i,theme:s,themeId:h}){return XH(s)?i:s[h]||s}function JH(i){return i?(s,h)=>h[i]:null}function ty(i,s){let{ownerState:h}=s,f=cn(s,qH);const g=typeof i=="function"?i(xt({ownerState:h},f)):i;if(Array.isArray(g))return g.flatMap(y=>ty(y,xt({ownerState:h},f)));if(g&&typeof g=="object"&&Array.isArray(g.variants)){const{variants:y=[]}=g;let M=cn(g,HH);return y.forEach(E=>{let C=!0;typeof E.props=="function"?C=E.props(xt({ownerState:h},f)):Object.keys(E.props).forEach(L=>{(h==null?void 0:h[L])!==E.props[L]&&f[L]!==E.props[L]&&(C=!1)}),C&&(Array.isArray(M)||(M=[M]),M.push(typeof E.style=="function"?E.style(xt({ownerState:h},f)):E.style))}),M}return g}function s5(i={}){const{themeId:s,defaultTheme:h=YH,rootShouldForwardProp:f=pp,slotShouldForwardProp:g=pp}=i,y=b=>q0(xt({},b,{theme:E_(xt({},b,{defaultTheme:h,themeId:s}))}));return y.__mui_systemSx=!0,(b,M={})=>{Uq(b,J=>J.filter(ct=>!(ct!=null&&ct.__mui_systemSx)));const{name:E,slot:C,skipVariantsResolver:L,skipSx:B,overridesResolver:z=JH(QH(C))}=M,H=cn(M,ZH),U=L!==void 0?L:C&&C!=="Root"&&C!=="root"||!1,q=B||!1;let tt,V=pp;C==="Root"||C==="root"?V=f:C?V=g:KH(b)&&(V=void 0);const F=e5(b,xt({shouldForwardProp:V,label:tt},H)),D=J=>typeof J=="function"&&J.__emotion_real!==J||Hl(J)?ct=>ty(J,xt({},ct,{theme:E_({theme:ct.theme,defaultTheme:h,themeId:s})})):J,$=(J,...ct)=>{let st=D(J);const yt=ct?ct.map(D):[];E&&z&&yt.push(et=>{const Mt=E_(xt({},et,{defaultTheme:h,themeId:s}));if(!Mt.components||!Mt.components[E]||!Mt.components[E].styleOverrides)return null;const Lt=Mt.components[E].styleOverrides,it={};return Object.entries(Lt).forEach(([Tt,Vt])=>{it[Tt]=ty(Vt,xt({},et,{theme:Mt}))}),z(et,it)}),E&&!U&&yt.push(et=>{var Mt;const Lt=E_(xt({},et,{defaultTheme:h,themeId:s})),it=Lt==null||(Mt=Lt.components)==null||(Mt=Mt[E])==null?void 0:Mt.variants;return ty({variants:it},xt({},et,{theme:Lt}))}),q||yt.push(y);const ut=yt.length-ct.length;if(Array.isArray(J)&&ut>0){const et=new Array(ut).fill("");st=[...J,...et],st.raw=[...J.raw,...et]}const N=F(st,...yt);return b.muiName&&(N.muiName=b.muiName),N};return F.withConfig&&($.withConfig=F.withConfig),$}}const a5=s5();function tZ(i){const{theme:s,name:h,props:f}=i;return!s||!s.components||!s.components[h]||!s.components[h].defaultProps?f:GS(s.components[h].defaultProps,f)}function sE({props:i,name:s,defaultTheme:h,themeId:f}){let g=H0(h);return f&&(g=g[f]||g),tZ({theme:g,name:s,props:i})}function aE(i,s=0,h=1){return NW(i,s,h)}function eZ(i){i=i.slice(1);const s=new RegExp(`.{1,${i.length>=6?2:1}}`,"g");let h=i.match(s);return h&&h[0].length===1&&(h=h.map(f=>f+f)),h?`rgb${h.length===4?"a":""}(${h.map((f,g)=>g<3?parseInt(f,16):Math.round(parseInt(f,16)/255*1e3)/1e3).join(", ")})`:""}function yu(i){if(i.type)return i;if(i.charAt(0)==="#")return yu(eZ(i));const s=i.indexOf("("),h=i.substring(0,s);if(["rgb","rgba","hsl","hsla","color"].indexOf(h)===-1)throw new Error(lc(9,i));let f=i.substring(s+1,i.length-1),g;if(h==="color"){if(f=f.split(" "),g=f.shift(),f.length===4&&f[3].charAt(0)==="/"&&(f[3]=f[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(g)===-1)throw new Error(lc(10,g))}else f=f.split(",");return f=f.map(y=>parseFloat(y)),{type:h,values:f,colorSpace:g}}function X0(i){const{type:s,colorSpace:h}=i;let{values:f}=i;return s.indexOf("rgb")!==-1?f=f.map((g,y)=>y<3?parseInt(g,10):g):s.indexOf("hsl")!==-1&&(f[1]=`${f[1]}%`,f[2]=`${f[2]}%`),s.indexOf("color")!==-1?f=`${h} ${f.join(" ")}`:f=`${f.join(", ")}`,`${s}(${f})`}function nZ(i){i=yu(i);const{values:s}=i,h=s[0],f=s[1]/100,g=s[2]/100,y=f*Math.min(g,1-g),b=(C,L=(C+h/30)%12)=>g-y*Math.max(Math.min(L-3,9-L,1),-1);let M="rgb";const E=[Math.round(b(0)*255),Math.round(b(8)*255),Math.round(b(4)*255)];return i.type==="hsla"&&(M+="a",E.push(s[3])),X0({type:M,values:E})}function KL(i){i=yu(i);let s=i.type==="hsl"||i.type==="hsla"?yu(nZ(i)).values:i.values;return s=s.map(h=>(i.type!=="color"&&(h/=255),h<=.03928?h/12.92:((h+.055)/1.055)**2.4)),Number((.2126*s[0]+.7152*s[1]+.0722*s[2]).toFixed(3))}function rZ(i,s){const h=KL(i),f=KL(s);return(Math.max(h,f)+.05)/(Math.min(h,f)+.05)}function Vh(i,s){return i=yu(i),s=aE(s),(i.type==="rgb"||i.type==="hsl")&&(i.type+="a"),i.type==="color"?i.values[3]=`/${s}`:i.values[3]=s,X0(i)}function iZ(i,s){if(i=yu(i),s=aE(s),i.type.indexOf("hsl")!==-1)i.values[2]*=1-s;else if(i.type.indexOf("rgb")!==-1||i.type.indexOf("color")!==-1)for(let h=0;h<3;h+=1)i.values[h]*=1-s;return X0(i)}function oZ(i,s){if(i=yu(i),s=aE(s),i.type.indexOf("hsl")!==-1)i.values[2]+=(100-i.values[2])*s;else if(i.type.indexOf("rgb")!==-1)for(let h=0;h<3;h+=1)i.values[h]+=(255-i.values[h])*s;else if(i.type.indexOf("color")!==-1)for(let h=0;h<3;h+=1)i.values[h]+=(1-i.values[h])*s;return X0(i)}const sZ=["className","component","disableGutters","fixed","maxWidth","classes"],aZ=Kp(),lZ=a5("div",{name:"MuiContainer",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.root,s[`maxWidth${Ln(String(h.maxWidth))}`],h.fixed&&s.fixed,h.disableGutters&&s.disableGutters]}}),cZ=i=>sE({props:i,name:"MuiContainer",defaultTheme:aZ}),uZ=(i,s)=>{const h=E=>yr(s,E),{classes:f,fixed:g,disableGutters:y,maxWidth:b}=i,M={root:["root",b&&`maxWidth${Ln(String(b))}`,g&&"fixed",y&&"disableGutters"]};return br(M,h,f)};function hZ(i={}){const{createStyledComponent:s=lZ,useThemeProps:h=cZ,componentName:f="MuiContainer"}=i,g=s(({theme:b,ownerState:M})=>xt({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!M.disableGutters&&{paddingLeft:b.spacing(2),paddingRight:b.spacing(2),[b.breakpoints.up("sm")]:{paddingLeft:b.spacing(3),paddingRight:b.spacing(3)}}),({theme:b,ownerState:M})=>M.fixed&&Object.keys(b.breakpoints.values).reduce((E,C)=>{const L=C,B=b.breakpoints.values[L];return B!==0&&(E[b.breakpoints.up(L)]={maxWidth:`${B}${b.breakpoints.unit}`}),E},{}),({theme:b,ownerState:M})=>xt({},M.maxWidth==="xs"&&{[b.breakpoints.up("xs")]:{maxWidth:Math.max(b.breakpoints.values.xs,444)}},M.maxWidth&&M.maxWidth!=="xs"&&{[b.breakpoints.up(M.maxWidth)]:{maxWidth:`${b.breakpoints.values[M.maxWidth]}${b.breakpoints.unit}`}}));return lt.forwardRef(function(M,E){const C=h(M),{className:L,component:B="div",disableGutters:z=!1,fixed:H=!1,maxWidth:U="lg"}=C,q=cn(C,sZ),tt=xt({},C,{component:B,disableGutters:z,fixed:H,maxWidth:U}),V=uZ(tt,f);return rt.jsx(g,xt({as:B,ownerState:tt,className:In(V.root,L),ref:E},q))})}const dZ=["component","direction","spacing","divider","children","className","useFlexGap"],fZ=Kp(),pZ=a5("div",{name:"MuiStack",slot:"Root",overridesResolver:(i,s)=>s.root});function mZ(i){return sE({props:i,name:"MuiStack",defaultTheme:fZ})}function gZ(i,s){const h=lt.Children.toArray(i).filter(Boolean);return h.reduce((f,g,y)=>(f.push(g),y<h.length-1&&f.push(lt.cloneElement(s,{key:`separator-${y}`})),f),[])}const _Z=i=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[i],yZ=({ownerState:i,theme:s})=>{let h=xt({display:"flex",flexDirection:"column"},Bo({theme:s},cu({values:i.direction,breakpoints:s.breakpoints.values}),f=>({flexDirection:f})));if(i.spacing){const f=iE(s),g=Object.keys(s.breakpoints.values).reduce((E,C)=>((typeof i.spacing=="object"&&i.spacing[C]!=null||typeof i.direction=="object"&&i.direction[C]!=null)&&(E[C]=!0),E),{}),y=cu({values:i.direction,base:g}),b=cu({values:i.spacing,base:g});typeof y=="object"&&Object.keys(y).forEach((E,C,L)=>{if(!y[E]){const z=C>0?y[L[C-1]]:"column";y[E]=z}}),h=Lo(h,Bo({theme:s},b,(E,C)=>i.useFlexGap?{gap:_u(f,E)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${_Z(C?y[C]:i.direction)}`]:_u(f,E)}}))}return h=Hq(s.breakpoints,h),h};function vZ(i={}){const{createStyledComponent:s=pZ,useThemeProps:h=mZ,componentName:f="MuiStack"}=i,g=()=>br({root:["root"]},E=>yr(f,E),{}),y=s(yZ);return lt.forwardRef(function(E,C){const L=h(E),B=Z0(L),{component:z="div",direction:H="column",spacing:U=0,divider:q,children:tt,className:V,useFlexGap:F=!1}=B,D=cn(B,dZ),$={direction:H,spacing:U,useFlexGap:F},J=g();return rt.jsx(y,xt({as:z,ownerState:$,ref:C,className:In(J.root,V)},D,{children:q?gZ(tt,q):tt}))})}function xZ(i,s){return xt({toolbar:{minHeight:56,[i.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[i.up("sm")]:{minHeight:64}}},s)}const bZ={black:"#000",white:"#fff"},Fp=bZ,wZ={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},TZ=wZ,SZ={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},bh=SZ,EZ={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},wh=EZ,CZ={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Vf=CZ,MZ={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Th=MZ,IZ={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Sh=IZ,AZ={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Eh=AZ,PZ=["mode","contrastThreshold","tonalOffset"],YL={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Fp.white,default:Fp.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},uw={text:{primary:Fp.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Fp.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function QL(i,s,h,f){const g=f.light||f,y=f.dark||f*1.5;i[s]||(i.hasOwnProperty(h)?i[s]=i[h]:s==="light"?i.light=oZ(i.main,g):s==="dark"&&(i.dark=iZ(i.main,y)))}function RZ(i="light"){return i==="dark"?{main:Th[200],light:Th[50],dark:Th[400]}:{main:Th[700],light:Th[400],dark:Th[800]}}function kZ(i="light"){return i==="dark"?{main:bh[200],light:bh[50],dark:bh[400]}:{main:bh[500],light:bh[300],dark:bh[700]}}function OZ(i="light"){return i==="dark"?{main:wh[500],light:wh[300],dark:wh[700]}:{main:wh[700],light:wh[400],dark:wh[800]}}function LZ(i="light"){return i==="dark"?{main:Sh[400],light:Sh[300],dark:Sh[700]}:{main:Sh[700],light:Sh[500],dark:Sh[900]}}function zZ(i="light"){return i==="dark"?{main:Eh[400],light:Eh[300],dark:Eh[700]}:{main:Eh[800],light:Eh[500],dark:Eh[900]}}function DZ(i="light"){return i==="dark"?{main:Vf[400],light:Vf[300],dark:Vf[700]}:{main:"#ed6c02",light:Vf[500],dark:Vf[900]}}function BZ(i){const{mode:s="light",contrastThreshold:h=3,tonalOffset:f=.2}=i,g=cn(i,PZ),y=i.primary||RZ(s),b=i.secondary||kZ(s),M=i.error||OZ(s),E=i.info||LZ(s),C=i.success||zZ(s),L=i.warning||DZ(s);function B(q){return rZ(q,uw.text.primary)>=h?uw.text.primary:YL.text.primary}const z=({color:q,name:tt,mainShade:V=500,lightShade:F=300,darkShade:D=700})=>{if(q=xt({},q),!q.main&&q[V]&&(q.main=q[V]),!q.hasOwnProperty("main"))throw new Error(lc(11,tt?` (${tt})`:"",V));if(typeof q.main!="string")throw new Error(lc(12,tt?` (${tt})`:"",JSON.stringify(q.main)));return QL(q,"light",F,f),QL(q,"dark",D,f),q.contrastText||(q.contrastText=B(q.main)),q},H={dark:uw,light:YL};return Lo(xt({common:xt({},Fp),mode:s,primary:z({color:y,name:"primary"}),secondary:z({color:b,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:z({color:M,name:"error"}),warning:z({color:L,name:"warning"}),info:z({color:E,name:"info"}),success:z({color:C,name:"success"}),grey:TZ,contrastThreshold:h,getContrastText:B,augmentColor:z,tonalOffset:f},H[s]),g)}const FZ=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function NZ(i){return Math.round(i*1e5)/1e5}const JL={textTransform:"uppercase"},t3='"Roboto", "Helvetica", "Arial", sans-serif';function jZ(i,s){const h=typeof s=="function"?s(i):s,{fontFamily:f=t3,fontSize:g=14,fontWeightLight:y=300,fontWeightRegular:b=400,fontWeightMedium:M=500,fontWeightBold:E=700,htmlFontSize:C=16,allVariants:L,pxToRem:B}=h,z=cn(h,FZ),H=g/14,U=B||(V=>`${V/C*H}rem`),q=(V,F,D,$,J)=>xt({fontFamily:f,fontWeight:V,fontSize:U(F),lineHeight:D},f===t3?{letterSpacing:`${NZ($/F)}em`}:{},J,L),tt={h1:q(y,96,1.167,-1.5),h2:q(y,60,1.2,-.5),h3:q(b,48,1.167,0),h4:q(b,34,1.235,.25),h5:q(b,24,1.334,0),h6:q(M,20,1.6,.15),subtitle1:q(b,16,1.75,.15),subtitle2:q(M,14,1.57,.1),body1:q(b,16,1.5,.15),body2:q(b,14,1.43,.15),button:q(M,14,1.75,.4,JL),caption:q(b,12,1.66,.4),overline:q(b,12,2.66,1,JL),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Lo(xt({htmlFontSize:C,pxToRem:U,fontFamily:f,fontSize:g,fontWeightLight:y,fontWeightRegular:b,fontWeightMedium:M,fontWeightBold:E},tt),z,{clone:!1})}const UZ=.2,$Z=.14,VZ=.12;function Hr(...i){return[`${i[0]}px ${i[1]}px ${i[2]}px ${i[3]}px rgba(0,0,0,${UZ})`,`${i[4]}px ${i[5]}px ${i[6]}px ${i[7]}px rgba(0,0,0,${$Z})`,`${i[8]}px ${i[9]}px ${i[10]}px ${i[11]}px rgba(0,0,0,${VZ})`].join(",")}const GZ=["none",Hr(0,2,1,-1,0,1,1,0,0,1,3,0),Hr(0,3,1,-2,0,2,2,0,0,1,5,0),Hr(0,3,3,-2,0,3,4,0,0,1,8,0),Hr(0,2,4,-1,0,4,5,0,0,1,10,0),Hr(0,3,5,-1,0,5,8,0,0,1,14,0),Hr(0,3,5,-1,0,6,10,0,0,1,18,0),Hr(0,4,5,-2,0,7,10,1,0,2,16,1),Hr(0,5,5,-3,0,8,10,1,0,3,14,2),Hr(0,5,6,-3,0,9,12,1,0,3,16,2),Hr(0,6,6,-3,0,10,14,1,0,4,18,3),Hr(0,6,7,-4,0,11,15,1,0,4,20,3),Hr(0,7,8,-4,0,12,17,2,0,5,22,4),Hr(0,7,8,-4,0,13,19,2,0,5,24,4),Hr(0,7,9,-4,0,14,21,2,0,5,26,4),Hr(0,8,9,-5,0,15,22,2,0,6,28,5),Hr(0,8,10,-5,0,16,24,2,0,6,30,5),Hr(0,8,11,-5,0,17,26,2,0,6,32,5),Hr(0,9,11,-5,0,18,28,2,0,7,34,6),Hr(0,9,12,-6,0,19,29,2,0,7,36,6),Hr(0,10,13,-6,0,20,31,3,0,8,38,7),Hr(0,10,13,-6,0,21,33,3,0,8,40,7),Hr(0,10,14,-6,0,22,35,3,0,8,42,7),Hr(0,11,14,-7,0,23,36,3,0,9,44,8),Hr(0,11,15,-7,0,24,38,3,0,9,46,8)],WZ=["duration","easing","delay"],qZ={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},HZ={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function e3(i){return`${Math.round(i)}ms`}function ZZ(i){if(!i)return 0;const s=i/36;return Math.round((4+15*s**.25+s/5)*10)}function XZ(i){const s=xt({},qZ,i.easing),h=xt({},HZ,i.duration);return xt({getAutoHeightDuration:ZZ,create:(g=["all"],y={})=>{const{duration:b=h.standard,easing:M=s.easeInOut,delay:E=0}=y;return cn(y,WZ),(Array.isArray(g)?g:[g]).map(C=>`${C} ${typeof b=="string"?b:e3(b)} ${M} ${typeof E=="string"?E:e3(E)}`).join(",")}},i,{easing:s,duration:h})}const KZ={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},YZ=KZ,QZ=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function l5(i={},...s){const{mixins:h={},palette:f={},transitions:g={},typography:y={}}=i,b=cn(i,QZ);if(i.vars)throw new Error(lc(18));const M=BZ(f),E=Kp(i);let C=Lo(E,{mixins:xZ(E.breakpoints,h),palette:M,shadows:GZ.slice(),typography:jZ(M,y),transitions:XZ(g),zIndex:xt({},YZ)});return C=Lo(C,b),C=s.reduce((L,B)=>Lo(L,B),C),C.unstable_sxConfig=xt({},W0,b==null?void 0:b.unstable_sxConfig),C.unstable_sx=function(B){return q0({sx:B,theme:this})},C}const JZ=l5(),K0=JZ,Yp="$$material";function Sr({props:i,name:s}){return sE({props:i,name:s,defaultTheme:K0,themeId:Yp})}const Ms=i=>pp(i)&&i!=="classes",tX=pp,mn=s5({themeId:Yp,defaultTheme:K0,rootShouldForwardProp:Ms});function eX(i){return yr("MuiSvgIcon",i)}wr("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const nX=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],rX=i=>{const{color:s,fontSize:h,classes:f}=i,g={root:["root",s!=="inherit"&&`color${Ln(s)}`,`fontSize${Ln(h)}`]};return br(g,eX,f)},iX=mn("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.root,h.color!=="inherit"&&s[`color${Ln(h.color)}`],s[`fontSize${Ln(h.fontSize)}`]]}})(({theme:i,ownerState:s})=>{var h,f,g,y,b,M,E,C,L,B,z,H,U;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:s.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(h=i.transitions)==null||(f=h.create)==null?void 0:f.call(h,"fill",{duration:(g=i.transitions)==null||(g=g.duration)==null?void 0:g.shorter}),fontSize:{inherit:"inherit",small:((y=i.typography)==null||(b=y.pxToRem)==null?void 0:b.call(y,20))||"1.25rem",medium:((M=i.typography)==null||(E=M.pxToRem)==null?void 0:E.call(M,24))||"1.5rem",large:((C=i.typography)==null||(L=C.pxToRem)==null?void 0:L.call(C,35))||"2.1875rem"}[s.fontSize],color:(B=(z=(i.vars||i).palette)==null||(z=z[s.color])==null?void 0:z.main)!=null?B:{action:(H=(i.vars||i).palette)==null||(H=H.action)==null?void 0:H.active,disabled:(U=(i.vars||i).palette)==null||(U=U.action)==null?void 0:U.disabled,inherit:void 0}[s.color]}}),AT=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiSvgIcon"}),{children:g,className:y,color:b="inherit",component:M="svg",fontSize:E="medium",htmlColor:C,inheritViewBox:L=!1,titleAccess:B,viewBox:z="0 0 24 24"}=f,H=cn(f,nX),U=lt.isValidElement(g)&&g.type==="svg",q=xt({},f,{color:b,component:M,fontSize:E,instanceFontSize:s.fontSize,inheritViewBox:L,viewBox:z,hasSvgAsChild:U}),tt={};L||(tt.viewBox=z);const V=rX(q);return rt.jsxs(iX,xt({as:M,className:In(V.root,y),focusable:"false",color:C,"aria-hidden":B?void 0:!0,role:B?"img":void 0,ref:h},tt,H,U&&g.props,{ownerState:q,children:[U?g.props.children:g,B?rt.jsx("title",{children:B}):null]}))});AT.muiName="SvgIcon";function c5(i,s){function h(f,g){return rt.jsx(AT,xt({"data-testid":`${s}Icon`,ref:g},f,{children:i}))}return h.muiName=AT.muiName,lt.memo(lt.forwardRef(h))}const oX={configure:i=>{WS.configure(i)}},sX=Object.freeze(Object.defineProperty({__proto__:null,capitalize:Ln,createChainedFunction:TT,createSvgIcon:c5,debounce:T0,deprecatedPropType:bW,isMuiElement:K_,ownerDocument:zo,ownerWindow:Ta,requirePropFactory:wW,setRef:Ry,unstable_ClassNameGenerator:oX,unstable_useEnhancedEffect:cc,unstable_useId:VS,unsupportedProp:EW,useControlled:ST,useEventCallback:ru,useForkRef:io,useIsFocusVisible:z4},Symbol.toStringTag,{value:"Module"})),aX=q3(sX);var n3;function lE(){return n3||(n3=1,function(i){"use client";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"default",{enumerable:!0,get:function(){return s.createSvgIcon}});var s=aX}(aw)),aw}var lX=jS;Object.defineProperty(NS,"__esModule",{value:!0});var u5=NS.default=void 0,cX=lX(lE()),uX=rt;u5=NS.default=(0,cX.default)((0,uX.jsx)("path",{d:"M19 15.18V7c0-2.21-1.79-4-4-4s-4 1.79-4 4v10c0 1.1-.9 2-2 2s-2-.9-2-2V8.82C8.16 8.4 9 7.3 9 6c0-1.66-1.34-3-3-3S3 4.34 3 6c0 1.3.84 2.4 2 2.82V17c0 2.21 1.79 4 4 4s4-1.79 4-4V7c0-1.1.9-2 2-2s2 .9 2 2v8.18c-1.16.41-2 1.51-2 2.82 0 1.66 1.34 3 3 3s3-1.34 3-3c0-1.3-.84-2.4-2-2.82"}),"Route");var cE={},hX=jS;Object.defineProperty(cE,"__esModule",{value:!0});var h5=cE.default=void 0,dX=hX(lE()),fX=rt;h5=cE.default=(0,dX.default)((0,fX.jsx)("path",{d:"M21 6h-2v9H6v2c0 .55.45 1 1 1h11l4 4V7c0-.55-.45-1-1-1m-4 6V3c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v14l4-4h10c.55 0 1-.45 1-1"}),"Forum");var uE={},pX=jS;Object.defineProperty(uE,"__esModule",{value:!0});var d5=uE.default=void 0,mX=pX(lE()),gX=rt;d5=uE.default=(0,mX.default)((0,gX.jsx)("path",{d:"M17 12h-5v5h5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1zm3 18H5V8h14z"}),"Event");/**
 * @remix-run/router v1.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Np(){return Np=Object.assign?Object.assign.bind():function(i){for(var s=1;s<arguments.length;s++){var h=arguments[s];for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(i[f]=h[f])}return i},Np.apply(this,arguments)}var Kl;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(Kl||(Kl={}));const r3="popstate";function _X(i){i===void 0&&(i={});function s(f,g){let{pathname:y,search:b,hash:M}=f.location;return PT("",{pathname:y,search:b,hash:M},g.state&&g.state.usr||null,g.state&&g.state.key||"default")}function h(f,g){return typeof g=="string"?g:Ly(g)}return vX(s,h,null,i)}function Ei(i,s){if(i===!1||i===null||typeof i>"u")throw new Error(s)}function hE(i,s){if(!i){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function yX(){return Math.random().toString(36).substr(2,8)}function i3(i,s){return{usr:i.state,key:i.key,idx:s}}function PT(i,s,h,f){return h===void 0&&(h=null),Np({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof s=="string"?wd(s):s,{state:h,key:s&&s.key||f||yX()})}function Ly(i){let{pathname:s="/",search:h="",hash:f=""}=i;return h&&h!=="?"&&(s+=h.charAt(0)==="?"?h:"?"+h),f&&f!=="#"&&(s+=f.charAt(0)==="#"?f:"#"+f),s}function wd(i){let s={};if(i){let h=i.indexOf("#");h>=0&&(s.hash=i.substr(h),i=i.substr(0,h));let f=i.indexOf("?");f>=0&&(s.search=i.substr(f),i=i.substr(0,f)),i&&(s.pathname=i)}return s}function vX(i,s,h,f){f===void 0&&(f={});let{window:g=document.defaultView,v5Compat:y=!1}=f,b=g.history,M=Kl.Pop,E=null,C=L();C==null&&(C=0,b.replaceState(Np({},b.state,{idx:C}),""));function L(){return(b.state||{idx:null}).idx}function B(){M=Kl.Pop;let tt=L(),V=tt==null?null:tt-C;C=tt,E&&E({action:M,location:q.location,delta:V})}function z(tt,V){M=Kl.Push;let F=PT(q.location,tt,V);h&&h(F,tt),C=L()+1;let D=i3(F,C),$=q.createHref(F);try{b.pushState(D,"",$)}catch(J){if(J instanceof DOMException&&J.name==="DataCloneError")throw J;g.location.assign($)}y&&E&&E({action:M,location:q.location,delta:1})}function H(tt,V){M=Kl.Replace;let F=PT(q.location,tt,V);h&&h(F,tt),C=L();let D=i3(F,C),$=q.createHref(F);b.replaceState(D,"",$),y&&E&&E({action:M,location:q.location,delta:0})}function U(tt){let V=g.location.origin!=="null"?g.location.origin:g.location.href,F=typeof tt=="string"?tt:Ly(tt);return Ei(V,"No window.location.(origin|href) available to create URL for href: "+F),new URL(F,V)}let q={get action(){return M},get location(){return i(g,b)},listen(tt){if(E)throw new Error("A history only accepts one active listener");return g.addEventListener(r3,B),E=tt,()=>{g.removeEventListener(r3,B),E=null}},createHref(tt){return s(g,tt)},createURL:U,encodeLocation(tt){let V=U(tt);return{pathname:V.pathname,search:V.search,hash:V.hash}},push:z,replace:H,go(tt){return b.go(tt)}};return q}var o3;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(o3||(o3={}));function xX(i,s,h){h===void 0&&(h="/");let f=typeof s=="string"?wd(s):s,g=dE(f.pathname||"/",h);if(g==null)return null;let y=f5(i);bX(y);let b=null;for(let M=0;b==null&&M<y.length;++M)b=PX(y[M],OX(g));return b}function f5(i,s,h,f){s===void 0&&(s=[]),h===void 0&&(h=[]),f===void 0&&(f="");let g=(y,b,M)=>{let E={relativePath:M===void 0?y.path||"":M,caseSensitive:y.caseSensitive===!0,childrenIndex:b,route:y};E.relativePath.startsWith("/")&&(Ei(E.relativePath.startsWith(f),'Absolute route path "'+E.relativePath+'" nested under path '+('"'+f+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),E.relativePath=E.relativePath.slice(f.length));let C=oc([f,E.relativePath]),L=h.concat(E);y.children&&y.children.length>0&&(Ei(y.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+C+'".')),f5(y.children,s,L,C)),!(y.path==null&&!y.index)&&s.push({path:C,score:IX(C,y.index),routesMeta:L})};return i.forEach((y,b)=>{var M;if(y.path===""||!((M=y.path)!=null&&M.includes("?")))g(y,b);else for(let E of p5(y.path))g(y,b,E)}),s}function p5(i){let s=i.split("/");if(s.length===0)return[];let[h,...f]=s,g=h.endsWith("?"),y=h.replace(/\?$/,"");if(f.length===0)return g?[y,""]:[y];let b=p5(f.join("/")),M=[];return M.push(...b.map(E=>E===""?y:[y,E].join("/"))),g&&M.push(...b),M.map(E=>i.startsWith("/")&&E===""?"/":E)}function bX(i){i.sort((s,h)=>s.score!==h.score?h.score-s.score:AX(s.routesMeta.map(f=>f.childrenIndex),h.routesMeta.map(f=>f.childrenIndex)))}const wX=/^:[\w-]+$/,TX=3,SX=2,EX=1,CX=10,MX=-2,s3=i=>i==="*";function IX(i,s){let h=i.split("/"),f=h.length;return h.some(s3)&&(f+=MX),s&&(f+=SX),h.filter(g=>!s3(g)).reduce((g,y)=>g+(wX.test(y)?TX:y===""?EX:CX),f)}function AX(i,s){return i.length===s.length&&i.slice(0,-1).every((f,g)=>f===s[g])?i[i.length-1]-s[s.length-1]:0}function PX(i,s){let{routesMeta:h}=i,f={},g="/",y=[];for(let b=0;b<h.length;++b){let M=h[b],E=b===h.length-1,C=g==="/"?s:s.slice(g.length)||"/",L=RX({path:M.relativePath,caseSensitive:M.caseSensitive,end:E},C);if(!L)return null;Object.assign(f,L.params);let B=M.route;y.push({params:f,pathname:oc([g,L.pathname]),pathnameBase:FX(oc([g,L.pathnameBase])),route:B}),L.pathnameBase!=="/"&&(g=oc([g,L.pathnameBase]))}return y}function RX(i,s){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[h,f]=kX(i.path,i.caseSensitive,i.end),g=s.match(h);if(!g)return null;let y=g[0],b=y.replace(/(.)\/+$/,"$1"),M=g.slice(1);return{params:f.reduce((C,L,B)=>{let{paramName:z,isOptional:H}=L;if(z==="*"){let q=M[B]||"";b=y.slice(0,y.length-q.length).replace(/(.)\/+$/,"$1")}const U=M[B];return H&&!U?C[z]=void 0:C[z]=LX(U||"",z),C},{}),pathname:y,pathnameBase:b,pattern:i}}function kX(i,s,h){s===void 0&&(s=!1),h===void 0&&(h=!0),hE(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let f=[],g="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(b,M,E)=>(f.push({paramName:M,isOptional:E!=null}),E?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(f.push({paramName:"*"}),g+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):h?g+="\\/*$":i!==""&&i!=="/"&&(g+="(?:(?=\\/|$))"),[new RegExp(g,s?void 0:"i"),f]}function OX(i){try{return decodeURI(i)}catch(s){return hE(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),i}}function LX(i,s){try{return decodeURIComponent(i)}catch(h){return hE(!1,'The value for the URL param "'+s+'" will not be decoded because'+(' the string "'+i+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+h+").")),i}}function dE(i,s){if(s==="/")return i;if(!i.toLowerCase().startsWith(s.toLowerCase()))return null;let h=s.endsWith("/")?s.length-1:s.length,f=i.charAt(h);return f&&f!=="/"?null:i.slice(h)||"/"}function zX(i,s){s===void 0&&(s="/");let{pathname:h,search:f="",hash:g=""}=typeof i=="string"?wd(i):i;return{pathname:h?h.startsWith("/")?h:DX(h,s):s,search:NX(f),hash:jX(g)}}function DX(i,s){let h=s.replace(/\/+$/,"").split("/");return i.split("/").forEach(g=>{g===".."?h.length>1&&h.pop():g!=="."&&h.push(g)}),h.length>1?h.join("/"):"/"}function hw(i,s,h,f){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(f)+"].  Please separate it out to the ")+("`to."+h+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function BX(i){return i.filter((s,h)=>h===0||s.route.path&&s.route.path.length>0)}function m5(i,s){let h=BX(i);return s?h.map((f,g)=>g===i.length-1?f.pathname:f.pathnameBase):h.map(f=>f.pathnameBase)}function g5(i,s,h,f){f===void 0&&(f=!1);let g;typeof i=="string"?g=wd(i):(g=Np({},i),Ei(!g.pathname||!g.pathname.includes("?"),hw("?","pathname","search",g)),Ei(!g.pathname||!g.pathname.includes("#"),hw("#","pathname","hash",g)),Ei(!g.search||!g.search.includes("#"),hw("#","search","hash",g)));let y=i===""||g.pathname==="",b=y?"/":g.pathname,M;if(b==null)M=h;else{let B=s.length-1;if(!f&&b.startsWith("..")){let z=b.split("/");for(;z[0]==="..";)z.shift(),B-=1;g.pathname=z.join("/")}M=B>=0?s[B]:"/"}let E=zX(g,M),C=b&&b!=="/"&&b.endsWith("/"),L=(y||b===".")&&h.endsWith("/");return!E.pathname.endsWith("/")&&(C||L)&&(E.pathname+="/"),E}const oc=i=>i.join("/").replace(/\/\/+/g,"/"),FX=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),NX=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,jX=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function UX(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const _5=["post","put","patch","delete"];new Set(_5);const $X=["get",..._5];new Set($X);/**
 * React Router v6.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function jp(){return jp=Object.assign?Object.assign.bind():function(i){for(var s=1;s<arguments.length;s++){var h=arguments[s];for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(i[f]=h[f])}return i},jp.apply(this,arguments)}const fE=lt.createContext(null),VX=lt.createContext(null),bu=lt.createContext(null),Y0=lt.createContext(null),wu=lt.createContext({outlet:null,matches:[],isDataRoute:!1}),y5=lt.createContext(null);function GX(i,s){let{relative:h}=s===void 0?{}:s;Qp()||Ei(!1);let{basename:f,navigator:g}=lt.useContext(bu),{hash:y,pathname:b,search:M}=b5(i,{relative:h}),E=b;return f!=="/"&&(E=b==="/"?f:oc([f,b])),g.createHref({pathname:E,search:M,hash:y})}function Qp(){return lt.useContext(Y0)!=null}function Q0(){return Qp()||Ei(!1),lt.useContext(Y0).location}function v5(i){lt.useContext(bu).static||lt.useLayoutEffect(i)}function x5(){let{isDataRoute:i}=lt.useContext(wu);return i?rK():WX()}function WX(){Qp()||Ei(!1);let i=lt.useContext(fE),{basename:s,future:h,navigator:f}=lt.useContext(bu),{matches:g}=lt.useContext(wu),{pathname:y}=Q0(),b=JSON.stringify(m5(g,h.v7_relativeSplatPath)),M=lt.useRef(!1);return v5(()=>{M.current=!0}),lt.useCallback(function(C,L){if(L===void 0&&(L={}),!M.current)return;if(typeof C=="number"){f.go(C);return}let B=g5(C,JSON.parse(b),y,L.relative==="path");i==null&&s!=="/"&&(B.pathname=B.pathname==="/"?s:oc([s,B.pathname])),(L.replace?f.replace:f.push)(B,L.state,L)},[s,f,b,y,i])}function b5(i,s){let{relative:h}=s===void 0?{}:s,{future:f}=lt.useContext(bu),{matches:g}=lt.useContext(wu),{pathname:y}=Q0(),b=JSON.stringify(m5(g,f.v7_relativeSplatPath));return lt.useMemo(()=>g5(i,JSON.parse(b),y,h==="path"),[i,b,y,h])}function qX(i,s){return HX(i,s)}function HX(i,s,h,f){Qp()||Ei(!1);let{navigator:g}=lt.useContext(bu),{matches:y}=lt.useContext(wu),b=y[y.length-1],M=b?b.params:{};b&&b.pathname;let E=b?b.pathnameBase:"/";b&&b.route;let C=Q0(),L;if(s){var B;let tt=typeof s=="string"?wd(s):s;E==="/"||(B=tt.pathname)!=null&&B.startsWith(E)||Ei(!1),L=tt}else L=C;let z=L.pathname||"/",H=E==="/"?z:z.slice(E.length)||"/",U=xX(i,{pathname:H}),q=QX(U&&U.map(tt=>Object.assign({},tt,{params:Object.assign({},M,tt.params),pathname:oc([E,g.encodeLocation?g.encodeLocation(tt.pathname).pathname:tt.pathname]),pathnameBase:tt.pathnameBase==="/"?E:oc([E,g.encodeLocation?g.encodeLocation(tt.pathnameBase).pathname:tt.pathnameBase])})),y,h,f);return s&&q?lt.createElement(Y0.Provider,{value:{location:jp({pathname:"/",search:"",hash:"",state:null,key:"default"},L),navigationType:Kl.Pop}},q):q}function ZX(){let i=nK(),s=UX(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),h=i instanceof Error?i.stack:null,g={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return lt.createElement(lt.Fragment,null,lt.createElement("h2",null,"Unexpected Application Error!"),lt.createElement("h3",{style:{fontStyle:"italic"}},s),h?lt.createElement("pre",{style:g},h):null,null)}const XX=lt.createElement(ZX,null);class KX extends lt.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,h){return h.location!==s.location||h.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:h.error,location:h.location,revalidation:s.revalidation||h.revalidation}}componentDidCatch(s,h){console.error("React Router caught the following error during render",s,h)}render(){return this.state.error!==void 0?lt.createElement(wu.Provider,{value:this.props.routeContext},lt.createElement(y5.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function YX(i){let{routeContext:s,match:h,children:f}=i,g=lt.useContext(fE);return g&&g.static&&g.staticContext&&(h.route.errorElement||h.route.ErrorBoundary)&&(g.staticContext._deepestRenderedBoundaryId=h.route.id),lt.createElement(wu.Provider,{value:s},f)}function QX(i,s,h,f){var g;if(s===void 0&&(s=[]),h===void 0&&(h=null),f===void 0&&(f=null),i==null){var y;if((y=h)!=null&&y.errors)i=h.matches;else return null}let b=i,M=(g=h)==null?void 0:g.errors;if(M!=null){let L=b.findIndex(B=>B.route.id&&(M==null?void 0:M[B.route.id]));L>=0||Ei(!1),b=b.slice(0,Math.min(b.length,L+1))}let E=!1,C=-1;if(h&&f&&f.v7_partialHydration)for(let L=0;L<b.length;L++){let B=b[L];if((B.route.HydrateFallback||B.route.hydrateFallbackElement)&&(C=L),B.route.id){let{loaderData:z,errors:H}=h,U=B.route.loader&&z[B.route.id]===void 0&&(!H||H[B.route.id]===void 0);if(B.route.lazy||U){E=!0,C>=0?b=b.slice(0,C+1):b=[b[0]];break}}}return b.reduceRight((L,B,z)=>{let H,U=!1,q=null,tt=null;h&&(H=M&&B.route.id?M[B.route.id]:void 0,q=B.route.errorElement||XX,E&&(C<0&&z===0?(iK("route-fallback",!1),U=!0,tt=null):C===z&&(U=!0,tt=B.route.hydrateFallbackElement||null)));let V=s.concat(b.slice(0,z+1)),F=()=>{let D;return H?D=q:U?D=tt:B.route.Component?D=lt.createElement(B.route.Component,null):B.route.element?D=B.route.element:D=L,lt.createElement(YX,{match:B,routeContext:{outlet:L,matches:V,isDataRoute:h!=null},children:D})};return h&&(B.route.ErrorBoundary||B.route.errorElement||z===0)?lt.createElement(KX,{location:h.location,revalidation:h.revalidation,component:q,error:H,children:F(),routeContext:{outlet:null,matches:V,isDataRoute:!0}}):F()},null)}var w5=function(i){return i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i}(w5||{}),zy=function(i){return i.UseBlocker="useBlocker",i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i.UseRouteId="useRouteId",i}(zy||{});function JX(i){let s=lt.useContext(fE);return s||Ei(!1),s}function tK(i){let s=lt.useContext(VX);return s||Ei(!1),s}function eK(i){let s=lt.useContext(wu);return s||Ei(!1),s}function T5(i){let s=eK(),h=s.matches[s.matches.length-1];return h.route.id||Ei(!1),h.route.id}function nK(){var i;let s=lt.useContext(y5),h=tK(zy.UseRouteError),f=T5(zy.UseRouteError);return s!==void 0?s:(i=h.errors)==null?void 0:i[f]}function rK(){let{router:i}=JX(w5.UseNavigateStable),s=T5(zy.UseNavigateStable),h=lt.useRef(!1);return v5(()=>{h.current=!0}),lt.useCallback(function(g,y){y===void 0&&(y={}),h.current&&(typeof g=="number"?i.navigate(g):i.navigate(g,jp({fromRouteId:s},y)))},[i,s])}const a3={};function iK(i,s,h){!s&&!a3[i]&&(a3[i]=!0)}function Ih(i){Ei(!1)}function oK(i){let{basename:s="/",children:h=null,location:f,navigationType:g=Kl.Pop,navigator:y,static:b=!1,future:M}=i;Qp()&&Ei(!1);let E=s.replace(/^\/*/,"/"),C=lt.useMemo(()=>({basename:E,navigator:y,static:b,future:jp({v7_relativeSplatPath:!1},M)}),[E,M,y,b]);typeof f=="string"&&(f=wd(f));let{pathname:L="/",search:B="",hash:z="",state:H=null,key:U="default"}=f,q=lt.useMemo(()=>{let tt=dE(L,E);return tt==null?null:{location:{pathname:tt,search:B,hash:z,state:H,key:U},navigationType:g}},[E,L,B,z,H,U,g]);return q==null?null:lt.createElement(bu.Provider,{value:C},lt.createElement(Y0.Provider,{children:h,value:q}))}function l3(i){let{children:s,location:h}=i;return qX(RT(s),h)}new Promise(()=>{});function RT(i,s){s===void 0&&(s=[]);let h=[];return lt.Children.forEach(i,(f,g)=>{if(!lt.isValidElement(f))return;let y=[...s,g];if(f.type===lt.Fragment){h.push.apply(h,RT(f.props.children,y));return}f.type!==Ih&&Ei(!1),!f.props.index||!f.props.children||Ei(!1);let b={id:f.props.id||y.join("-"),caseSensitive:f.props.caseSensitive,element:f.props.element,Component:f.props.Component,index:f.props.index,path:f.props.path,loader:f.props.loader,action:f.props.action,errorElement:f.props.errorElement,ErrorBoundary:f.props.ErrorBoundary,hasErrorBoundary:f.props.ErrorBoundary!=null||f.props.errorElement!=null,shouldRevalidate:f.props.shouldRevalidate,handle:f.props.handle,lazy:f.props.lazy};f.props.children&&(b.children=RT(f.props.children,y)),h.push(b)}),h}/**
 * React Router DOM v6.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function kT(){return kT=Object.assign?Object.assign.bind():function(i){for(var s=1;s<arguments.length;s++){var h=arguments[s];for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(i[f]=h[f])}return i},kT.apply(this,arguments)}function sK(i,s){if(i==null)return{};var h={},f=Object.keys(i),g,y;for(y=0;y<f.length;y++)g=f[y],!(s.indexOf(g)>=0)&&(h[g]=i[g]);return h}function aK(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function lK(i,s){return i.button===0&&(!s||s==="_self")&&!aK(i)}const cK=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],uK="6";try{window.__reactRouterVersion=uK}catch{}const hK="startTransition",c3=ny[hK];function dK(i){let{basename:s,children:h,future:f,window:g}=i,y=lt.useRef();y.current==null&&(y.current=_X({window:g,v5Compat:!0}));let b=y.current,[M,E]=lt.useState({action:b.action,location:b.location}),{v7_startTransition:C}=f||{},L=lt.useCallback(B=>{C&&c3?c3(()=>E(B)):E(B)},[E,C]);return lt.useLayoutEffect(()=>b.listen(L),[b,L]),lt.createElement(oK,{basename:s,children:h,location:M.location,navigationType:M.action,navigator:b,future:f})}const fK=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",pK=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Gf=lt.forwardRef(function(s,h){let{onClick:f,relative:g,reloadDocument:y,replace:b,state:M,target:E,to:C,preventScrollReset:L,unstable_viewTransition:B}=s,z=sK(s,cK),{basename:H}=lt.useContext(bu),U,q=!1;if(typeof C=="string"&&pK.test(C)&&(U=C,fK))try{let D=new URL(window.location.href),$=C.startsWith("//")?new URL(D.protocol+C):new URL(C),J=dE($.pathname,H);$.origin===D.origin&&J!=null?C=J+$.search+$.hash:q=!0}catch{}let tt=GX(C,{relative:g}),V=mK(C,{replace:b,state:M,target:E,preventScrollReset:L,relative:g,unstable_viewTransition:B});function F(D){f&&f(D),D.defaultPrevented||V(D)}return lt.createElement("a",kT({},z,{href:U||tt,onClick:q||y?f:F,ref:h,target:E}))});var u3;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmit="useSubmit",i.UseSubmitFetcher="useSubmitFetcher",i.UseFetcher="useFetcher",i.useViewTransitionState="useViewTransitionState"})(u3||(u3={}));var h3;(function(i){i.UseFetcher="useFetcher",i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(h3||(h3={}));function mK(i,s){let{target:h,replace:f,state:g,preventScrollReset:y,relative:b,unstable_viewTransition:M}=s===void 0?{}:s,E=x5(),C=Q0(),L=b5(i,{relative:b});return lt.useCallback(B=>{if(lK(B,h)){B.preventDefault();let z=f!==void 0?f:Ly(C)===Ly(L);E(i,{replace:z,state:g,preventScrollReset:y,relative:b,unstable_viewTransition:M})}},[C,E,L,f,g,h,i,y,b,M])}const S5="/assets/UserIcon-B0grYou3.png";function E5({username:i}){const[s,h]=lt.useState(!1),f=()=>{h(!s)},g=()=>{h(!1)};return rt.jsxs("div",{className:"user-account-info-container",children:[rt.jsxs("span",{className:"username",onClick:f,children:["@",i]}),s&&rt.jsxs("div",{className:"user-account-info-popup",children:[rt.jsx("img",{src:S5,alt:"Profile",className:"profile-picture-popup"}),rt.jsxs("div",{className:"text-container",children:[rt.jsxs("p",{children:["Username: ",i]}),rt.jsx("p",{children:"Name: Goat Places "}),rt.jsx("p",{children:"Class: Freshman"}),rt.jsx("p",{children:"Major: CS "})]}),rt.jsx("button",{className:"close-button",onClick:g,children:"Close"})]})]})}function gK({username:i,title:s,image:h,description:f}){const[g,y]=lt.useState(!1),b=()=>{y(!g)},M=g?f:`${f.slice(0,70)}...`;return rt.jsxs("div",{className:"regular-post",children:[rt.jsx(E5,{username:i}),rt.jsx("h2",{children:s}),h&&rt.jsx("img",{src:h,alt:"Post"}),rt.jsxs("p",{children:[M,f.length>70&&rt.jsx("span",{className:"see-more",onClick:b,children:g?"Hide":"See More"})]})]})}function _K({username:i,title:s,when:h,where:f,what:g}){return rt.jsxs("div",{className:"event",children:[rt.jsx(E5,{username:i}),rt.jsx("h2",{children:s}),rt.jsxs("div",{className:"event-text",children:[rt.jsxs("p",{children:[rt.jsx("strong",{children:"When:"})," ",h]}),rt.jsxs("p",{children:[rt.jsx("strong",{children:"Where:"})," ",f]}),rt.jsxs("p",{children:[rt.jsx("strong",{children:"What:"})," ",g]})]})]})}const yK=[{id:1,type:"regular",username:"g0atplaces",title:"Checkout Our Posts!",image:"https://www.stedwards.edu/sites/default/files/2020-10/pres_gallery-main_south_horz.jpg",description:"Students and incoming freshman often face the challenge of staying informed on school events and navigating their way to class"},{id:2,type:"event",username:"g0atplaces",title:"Event 1 Title",when:"Date and Time",where:"Location",what:"Description about the event."},{id:3,type:"regular",username:"g0atplaces",title:"Another Regular Post",image:"https://rebeccafrostdavis.files.wordpress.com/2013/06/b40c0-steds.jpg",description:"This is another regular post with a different image."},{id:4,type:"event",username:"g0atplaces",title:"Event 2 Title",when:"Another Date and Time",where:"Another Location",what:"Description about another event."}];function vK(){return rt.jsx("div",{className:"home",children:rt.jsx("div",{className:"post-container",children:yK.map(i=>rt.jsx("div",{className:"post",children:i.type==="regular"?rt.jsx(gK,{username:i.username,title:i.title,image:i.image,description:i.description}):rt.jsx("div",{classname:"event-text",children:rt.jsx(_K,{username:i.username,title:i.title,when:i.when,where:i.where,what:i.what})})},i.id))})})}function Td(){const i=H0(K0);return i[Yp]||i}const d3=i=>{let s;return i<1?s=5.11916*i**2:s=4.5*Math.log(i+1)+2,(s/100).toFixed(2)};function OT(i,s){return OT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(f,g){return f.__proto__=g,f},OT(i,s)}function C5(i,s){i.prototype=Object.create(s.prototype),i.prototype.constructor=i,OT(i,s)}const f3={disabled:!1},Dy=Xr.createContext(null);var xK=function(s){return s.scrollTop},np="unmounted",Kc="exited",Yc="entering",Ah="entered",LT="exiting",rl=function(i){C5(s,i);function s(f,g){var y;y=i.call(this,f,g)||this;var b=g,M=b&&!b.isMounting?f.enter:f.appear,E;return y.appearStatus=null,f.in?M?(E=Kc,y.appearStatus=Yc):E=Ah:f.unmountOnExit||f.mountOnEnter?E=np:E=Kc,y.state={status:E},y.nextCallback=null,y}s.getDerivedStateFromProps=function(g,y){var b=g.in;return b&&y.status===np?{status:Kc}:null};var h=s.prototype;return h.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},h.componentDidUpdate=function(g){var y=null;if(g!==this.props){var b=this.state.status;this.props.in?b!==Yc&&b!==Ah&&(y=Yc):(b===Yc||b===Ah)&&(y=LT)}this.updateStatus(!1,y)},h.componentWillUnmount=function(){this.cancelNextCallback()},h.getTimeouts=function(){var g=this.props.timeout,y,b,M;return y=b=M=g,g!=null&&typeof g!="number"&&(y=g.exit,b=g.enter,M=g.appear!==void 0?g.appear:b),{exit:y,enter:b,appear:M}},h.updateStatus=function(g,y){if(g===void 0&&(g=!1),y!==null)if(this.cancelNextCallback(),y===Yc){if(this.props.unmountOnExit||this.props.mountOnEnter){var b=this.props.nodeRef?this.props.nodeRef.current:b_.findDOMNode(this);b&&xK(b)}this.performEnter(g)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Kc&&this.setState({status:np})},h.performEnter=function(g){var y=this,b=this.props.enter,M=this.context?this.context.isMounting:g,E=this.props.nodeRef?[M]:[b_.findDOMNode(this),M],C=E[0],L=E[1],B=this.getTimeouts(),z=M?B.appear:B.enter;if(!g&&!b||f3.disabled){this.safeSetState({status:Ah},function(){y.props.onEntered(C)});return}this.props.onEnter(C,L),this.safeSetState({status:Yc},function(){y.props.onEntering(C,L),y.onTransitionEnd(z,function(){y.safeSetState({status:Ah},function(){y.props.onEntered(C,L)})})})},h.performExit=function(){var g=this,y=this.props.exit,b=this.getTimeouts(),M=this.props.nodeRef?void 0:b_.findDOMNode(this);if(!y||f3.disabled){this.safeSetState({status:Kc},function(){g.props.onExited(M)});return}this.props.onExit(M),this.safeSetState({status:LT},function(){g.props.onExiting(M),g.onTransitionEnd(b.exit,function(){g.safeSetState({status:Kc},function(){g.props.onExited(M)})})})},h.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},h.safeSetState=function(g,y){y=this.setNextCallback(y),this.setState(g,y)},h.setNextCallback=function(g){var y=this,b=!0;return this.nextCallback=function(M){b&&(b=!1,y.nextCallback=null,g(M))},this.nextCallback.cancel=function(){b=!1},this.nextCallback},h.onTransitionEnd=function(g,y){this.setNextCallback(y);var b=this.props.nodeRef?this.props.nodeRef.current:b_.findDOMNode(this),M=g==null&&!this.props.addEndListener;if(!b||M){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var E=this.props.nodeRef?[this.nextCallback]:[b,this.nextCallback],C=E[0],L=E[1];this.props.addEndListener(C,L)}g!=null&&setTimeout(this.nextCallback,g)},h.render=function(){var g=this.state.status;if(g===np)return null;var y=this.props,b=y.children;y.in,y.mountOnEnter,y.unmountOnExit,y.appear,y.enter,y.exit,y.timeout,y.addEndListener,y.onEnter,y.onEntering,y.onEntered,y.onExit,y.onExiting,y.onExited,y.nodeRef;var M=cn(y,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Xr.createElement(Dy.Provider,{value:null},typeof b=="function"?b(g,M):Xr.cloneElement(Xr.Children.only(b),M))},s}(Xr.Component);rl.contextType=Dy;rl.propTypes={};function Ch(){}rl.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Ch,onEntering:Ch,onEntered:Ch,onExit:Ch,onExiting:Ch,onExited:Ch};rl.UNMOUNTED=np;rl.EXITED=Kc;rl.ENTERING=Yc;rl.ENTERED=Ah;rl.EXITING=LT;const pE=rl;function bK(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function mE(i,s){var h=function(y){return s&&lt.isValidElement(y)?s(y):y},f=Object.create(null);return i&&lt.Children.map(i,function(g){return g}).forEach(function(g){f[g.key]=h(g)}),f}function wK(i,s){i=i||{},s=s||{};function h(L){return L in s?s[L]:i[L]}var f=Object.create(null),g=[];for(var y in i)y in s?g.length&&(f[y]=g,g=[]):g.push(y);var b,M={};for(var E in s){if(f[E])for(b=0;b<f[E].length;b++){var C=f[E][b];M[f[E][b]]=h(C)}M[E]=h(E)}for(b=0;b<g.length;b++)M[g[b]]=h(g[b]);return M}function iu(i,s,h){return h[s]!=null?h[s]:i.props[s]}function TK(i,s){return mE(i.children,function(h){return lt.cloneElement(h,{onExited:s.bind(null,h),in:!0,appear:iu(h,"appear",i),enter:iu(h,"enter",i),exit:iu(h,"exit",i)})})}function SK(i,s,h){var f=mE(i.children),g=wK(s,f);return Object.keys(g).forEach(function(y){var b=g[y];if(lt.isValidElement(b)){var M=y in s,E=y in f,C=s[y],L=lt.isValidElement(C)&&!C.props.in;E&&(!M||L)?g[y]=lt.cloneElement(b,{onExited:h.bind(null,b),in:!0,exit:iu(b,"exit",i),enter:iu(b,"enter",i)}):!E&&M&&!L?g[y]=lt.cloneElement(b,{in:!1}):E&&M&&lt.isValidElement(C)&&(g[y]=lt.cloneElement(b,{onExited:h.bind(null,b),in:C.props.in,exit:iu(b,"exit",i),enter:iu(b,"enter",i)}))}}),g}var EK=Object.values||function(i){return Object.keys(i).map(function(s){return i[s]})},CK={component:"div",childFactory:function(s){return s}},gE=function(i){C5(s,i);function s(f,g){var y;y=i.call(this,f,g)||this;var b=y.handleExited.bind(bK(y));return y.state={contextValue:{isMounting:!0},handleExited:b,firstRender:!0},y}var h=s.prototype;return h.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},h.componentWillUnmount=function(){this.mounted=!1},s.getDerivedStateFromProps=function(g,y){var b=y.children,M=y.handleExited,E=y.firstRender;return{children:E?TK(g,M):SK(g,b,M),firstRender:!1}},h.handleExited=function(g,y){var b=mE(this.props.children);g.key in b||(g.props.onExited&&g.props.onExited(y),this.mounted&&this.setState(function(M){var E=xt({},M.children);return delete E[g.key],{children:E}}))},h.render=function(){var g=this.props,y=g.component,b=g.childFactory,M=cn(g,["component","childFactory"]),E=this.state.contextValue,C=EK(this.state.children).map(b);return delete M.appear,delete M.enter,delete M.exit,y===null?Xr.createElement(Dy.Provider,{value:E},C):Xr.createElement(Dy.Provider,{value:E},Xr.createElement(y,M,C))},s}(Xr.Component);gE.propTypes={};gE.defaultProps=CK;const MK=gE,_E=i=>i.scrollTop;function fd(i,s){var h,f;const{timeout:g,easing:y,style:b={}}=i;return{duration:(h=b.transitionDuration)!=null?h:typeof g=="number"?g:g[s.mode]||0,easing:(f=b.transitionTimingFunction)!=null?f:typeof y=="object"?y[s.mode]:y,delay:b.transitionDelay}}function IK(i){return yr("MuiPaper",i)}wr("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const AK=["className","component","elevation","square","variant"],PK=i=>{const{square:s,elevation:h,variant:f,classes:g}=i,y={root:["root",f,!s&&"rounded",f==="elevation"&&`elevation${h}`]};return br(y,IK,g)},RK=mn("div",{name:"MuiPaper",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.root,s[h.variant],!h.square&&s.rounded,h.variant==="elevation"&&s[`elevation${h.elevation}`]]}})(({theme:i,ownerState:s})=>{var h;return xt({backgroundColor:(i.vars||i).palette.background.paper,color:(i.vars||i).palette.text.primary,transition:i.transitions.create("box-shadow")},!s.square&&{borderRadius:i.shape.borderRadius},s.variant==="outlined"&&{border:`1px solid ${(i.vars||i).palette.divider}`},s.variant==="elevation"&&xt({boxShadow:(i.vars||i).shadows[s.elevation]},!i.vars&&i.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${Vh("#fff",d3(s.elevation))}, ${Vh("#fff",d3(s.elevation))})`},i.vars&&{backgroundImage:(h=i.vars.overlays)==null?void 0:h[s.elevation]}))}),kK=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiPaper"}),{className:g,component:y="div",elevation:b=1,square:M=!1,variant:E="elevation"}=f,C=cn(f,AK),L=xt({},f,{component:y,elevation:b,square:M,variant:E}),B=PK(L);return rt.jsx(RK,xt({as:y,ownerState:L,className:In(B.root,g),ref:h},C))}),J0=kK;function By(i){return typeof i=="string"}function OK(i,s,h){return i===void 0||By(i)?s:xt({},s,{ownerState:xt({},s.ownerState,h)})}function M5(i,s=[]){if(i===void 0)return{};const h={};return Object.keys(i).filter(f=>f.match(/^on[A-Z]/)&&typeof i[f]=="function"&&!s.includes(f)).forEach(f=>{h[f]=i[f]}),h}function LK(i,s,h){return typeof i=="function"?i(s,h):i}function p3(i){if(i===void 0)return{};const s={};return Object.keys(i).filter(h=>!(h.match(/^on[A-Z]/)&&typeof i[h]=="function")).forEach(h=>{s[h]=i[h]}),s}function zK(i){const{getSlotProps:s,additionalProps:h,externalSlotProps:f,externalForwardedProps:g,className:y}=i;if(!s){const H=In(h==null?void 0:h.className,y,g==null?void 0:g.className,f==null?void 0:f.className),U=xt({},h==null?void 0:h.style,g==null?void 0:g.style,f==null?void 0:f.style),q=xt({},h,g,f);return H.length>0&&(q.className=H),Object.keys(U).length>0&&(q.style=U),{props:q,internalRef:void 0}}const b=M5(xt({},g,f)),M=p3(f),E=p3(g),C=s(b),L=In(C==null?void 0:C.className,h==null?void 0:h.className,y,g==null?void 0:g.className,f==null?void 0:f.className),B=xt({},C==null?void 0:C.style,h==null?void 0:h.style,g==null?void 0:g.style,f==null?void 0:f.style),z=xt({},C,h,E,M);return L.length>0&&(z.className=L),Object.keys(B).length>0&&(z.style=B),{props:z,internalRef:C.ref}}const DK=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function pd(i){var s;const{elementType:h,externalSlotProps:f,ownerState:g,skipResolvingSlotProps:y=!1}=i,b=cn(i,DK),M=y?{}:LK(f,g),{props:E,internalRef:C}=zK(xt({},b,{externalSlotProps:M})),L=io(C,M==null?void 0:M.ref,(s=i.additionalProps)==null?void 0:s.ref);return OK(h,xt({},E,{ref:L}),g)}function BK(i){const{className:s,classes:h,pulsate:f=!1,rippleX:g,rippleY:y,rippleSize:b,in:M,onExited:E,timeout:C}=i,[L,B]=lt.useState(!1),z=In(s,h.ripple,h.rippleVisible,f&&h.ripplePulsate),H={width:b,height:b,top:-(b/2)+y,left:-(b/2)+g},U=In(h.child,L&&h.childLeaving,f&&h.childPulsate);return!M&&!L&&B(!0),lt.useEffect(()=>{if(!M&&E!=null){const q=setTimeout(E,C);return()=>{clearTimeout(q)}}},[E,M,C]),rt.jsx("span",{className:z,style:H,children:rt.jsx("span",{className:U})})}const gs=wr("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),FK=["center","classes","className"];let tv=i=>i,m3,g3,_3,y3;const zT=550,NK=80,jK=tE(m3||(m3=tv`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),UK=tE(g3||(g3=tv`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),$K=tE(_3||(_3=tv`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),VK=mn("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),GK=mn(BK,{name:"MuiTouchRipple",slot:"Ripple"})(y3||(y3=tv`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),gs.rippleVisible,jK,zT,({theme:i})=>i.transitions.easing.easeInOut,gs.ripplePulsate,({theme:i})=>i.transitions.duration.shorter,gs.child,gs.childLeaving,UK,zT,({theme:i})=>i.transitions.easing.easeInOut,gs.childPulsate,$K,({theme:i})=>i.transitions.easing.easeInOut),WK=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiTouchRipple"}),{center:g=!1,classes:y={},className:b}=f,M=cn(f,FK),[E,C]=lt.useState([]),L=lt.useRef(0),B=lt.useRef(null);lt.useEffect(()=>{B.current&&(B.current(),B.current=null)},[E]);const z=lt.useRef(!1),H=L4(),U=lt.useRef(null),q=lt.useRef(null),tt=lt.useCallback($=>{const{pulsate:J,rippleX:ct,rippleY:st,rippleSize:yt,cb:ut}=$;C(N=>[...N,rt.jsx(GK,{classes:{ripple:In(y.ripple,gs.ripple),rippleVisible:In(y.rippleVisible,gs.rippleVisible),ripplePulsate:In(y.ripplePulsate,gs.ripplePulsate),child:In(y.child,gs.child),childLeaving:In(y.childLeaving,gs.childLeaving),childPulsate:In(y.childPulsate,gs.childPulsate)},timeout:zT,pulsate:J,rippleX:ct,rippleY:st,rippleSize:yt},L.current)]),L.current+=1,B.current=ut},[y]),V=lt.useCallback(($={},J={},ct=()=>{})=>{const{pulsate:st=!1,center:yt=g||J.pulsate,fakeElement:ut=!1}=J;if(($==null?void 0:$.type)==="mousedown"&&z.current){z.current=!1;return}($==null?void 0:$.type)==="touchstart"&&(z.current=!0);const N=ut?null:q.current,et=N?N.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Mt,Lt,it;if(yt||$===void 0||$.clientX===0&&$.clientY===0||!$.clientX&&!$.touches)Mt=Math.round(et.width/2),Lt=Math.round(et.height/2);else{const{clientX:Tt,clientY:Vt}=$.touches&&$.touches.length>0?$.touches[0]:$;Mt=Math.round(Tt-et.left),Lt=Math.round(Vt-et.top)}if(yt)it=Math.sqrt((2*et.width**2+et.height**2)/3),it%2===0&&(it+=1);else{const Tt=Math.max(Math.abs((N?N.clientWidth:0)-Mt),Mt)*2+2,Vt=Math.max(Math.abs((N?N.clientHeight:0)-Lt),Lt)*2+2;it=Math.sqrt(Tt**2+Vt**2)}$!=null&&$.touches?U.current===null&&(U.current=()=>{tt({pulsate:st,rippleX:Mt,rippleY:Lt,rippleSize:it,cb:ct})},H.start(NK,()=>{U.current&&(U.current(),U.current=null)})):tt({pulsate:st,rippleX:Mt,rippleY:Lt,rippleSize:it,cb:ct})},[g,tt,H]),F=lt.useCallback(()=>{V({},{pulsate:!0})},[V]),D=lt.useCallback(($,J)=>{if(H.clear(),($==null?void 0:$.type)==="touchend"&&U.current){U.current(),U.current=null,H.start(0,()=>{D($,J)});return}U.current=null,C(ct=>ct.length>0?ct.slice(1):ct),B.current=J},[H]);return lt.useImperativeHandle(h,()=>({pulsate:F,start:V,stop:D}),[F,V,D]),rt.jsx(VK,xt({className:In(gs.root,y.root,b),ref:q},M,{children:rt.jsx(MK,{component:null,exit:!0,children:E})}))}),qK=WK;function HK(i){return yr("MuiButtonBase",i)}const ZK=wr("MuiButtonBase",["root","disabled","focusVisible"]),XK=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],KK=i=>{const{disabled:s,focusVisible:h,focusVisibleClassName:f,classes:g}=i,b=br({root:["root",s&&"disabled",h&&"focusVisible"]},HK,g);return h&&f&&(b.root+=` ${f}`),b},YK=mn("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(i,s)=>s.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${ZK.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),QK=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiButtonBase"}),{action:g,centerRipple:y=!1,children:b,className:M,component:E="button",disabled:C=!1,disableRipple:L=!1,disableTouchRipple:B=!1,focusRipple:z=!1,LinkComponent:H="a",onBlur:U,onClick:q,onContextMenu:tt,onDragLeave:V,onFocus:F,onFocusVisible:D,onKeyDown:$,onKeyUp:J,onMouseDown:ct,onMouseLeave:st,onMouseUp:yt,onTouchEnd:ut,onTouchMove:N,onTouchStart:et,tabIndex:Mt=0,TouchRippleProps:Lt,touchRippleRef:it,type:Tt}=f,Vt=cn(f,XK),ne=lt.useRef(null),Et=lt.useRef(null),$t=io(Et,it),{isFocusVisibleRef:ee,onFocus:Ee,onBlur:jt,ref:Le}=z4(),[we,kt]=lt.useState(!1);C&&we&&kt(!1),lt.useImperativeHandle(g,()=>({focusVisible:()=>{kt(!0),ne.current.focus()}}),[]);const[Xt,Ot]=lt.useState(!1);lt.useEffect(()=>{Ot(!0)},[]);const Pe=Xt&&!L&&!C;lt.useEffect(()=>{we&&z&&!L&&Xt&&Et.current.pulsate()},[L,z,we,Xt]);function ie(Me,zn,er=B){return ru(Fn=>(zn&&zn(Fn),!er&&Et.current&&Et.current[Me](Fn),!0))}const Ne=ie("start",ct),Fe=ie("stop",tt),je=ie("stop",V),De=ie("stop",yt),Ue=ie("stop",Me=>{we&&Me.preventDefault(),st&&st(Me)}),An=ie("start",et),vn=ie("stop",ut),Zt=ie("stop",N),Y=ie("stop",Me=>{jt(Me),ee.current===!1&&kt(!1),U&&U(Me)},!1),nt=ru(Me=>{ne.current||(ne.current=Me.currentTarget),Ee(Me),ee.current===!0&&(kt(!0),D&&D(Me)),F&&F(Me)}),dt=()=>{const Me=ne.current;return E&&E!=="button"&&!(Me.tagName==="A"&&Me.href)},Bt=lt.useRef(!1),Wt=ru(Me=>{z&&!Bt.current&&we&&Et.current&&Me.key===" "&&(Bt.current=!0,Et.current.stop(Me,()=>{Et.current.start(Me)})),Me.target===Me.currentTarget&&dt()&&Me.key===" "&&Me.preventDefault(),$&&$(Me),Me.target===Me.currentTarget&&dt()&&Me.key==="Enter"&&!C&&(Me.preventDefault(),q&&q(Me))}),ae=ru(Me=>{z&&Me.key===" "&&Et.current&&we&&!Me.defaultPrevented&&(Bt.current=!1,Et.current.stop(Me,()=>{Et.current.pulsate(Me)})),J&&J(Me),q&&Me.target===Me.currentTarget&&dt()&&Me.key===" "&&!Me.defaultPrevented&&q(Me)});let ce=E;ce==="button"&&(Vt.href||Vt.to)&&(ce=H);const qt={};ce==="button"?(qt.type=Tt===void 0?"button":Tt,qt.disabled=C):(!Vt.href&&!Vt.to&&(qt.role="button"),C&&(qt["aria-disabled"]=C));const Ce=io(h,Le,ne),Re=xt({},f,{centerRipple:y,component:E,disabled:C,disableRipple:L,disableTouchRipple:B,focusRipple:z,tabIndex:Mt,focusVisible:we}),be=KK(Re);return rt.jsxs(YK,xt({as:ce,className:In(be.root,M),ownerState:Re,onBlur:Y,onClick:q,onContextMenu:Fe,onFocus:nt,onKeyDown:Wt,onKeyUp:ae,onMouseDown:Ne,onMouseLeave:Ue,onMouseUp:De,onDragLeave:je,onTouchEnd:vn,onTouchMove:Zt,onTouchStart:An,ref:Ce,tabIndex:C?-1:Mt,type:Tt},qt,Vt,{children:[b,Pe?rt.jsx(qK,xt({ref:$t,center:y},Lt)):null]}))}),JK=QK;function tY(i){return yr("MuiTypography",i)}wr("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const eY=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],nY=i=>{const{align:s,gutterBottom:h,noWrap:f,paragraph:g,variant:y,classes:b}=i,M={root:["root",y,i.align!=="inherit"&&`align${Ln(s)}`,h&&"gutterBottom",f&&"noWrap",g&&"paragraph"]};return br(M,tY,b)},rY=mn("span",{name:"MuiTypography",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.root,h.variant&&s[h.variant],h.align!=="inherit"&&s[`align${Ln(h.align)}`],h.noWrap&&s.noWrap,h.gutterBottom&&s.gutterBottom,h.paragraph&&s.paragraph]}})(({theme:i,ownerState:s})=>xt({margin:0},s.variant==="inherit"&&{font:"inherit"},s.variant!=="inherit"&&i.typography[s.variant],s.align!=="inherit"&&{textAlign:s.align},s.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},s.gutterBottom&&{marginBottom:"0.35em"},s.paragraph&&{marginBottom:16})),v3={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},iY={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},oY=i=>iY[i]||i,sY=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiTypography"}),g=oY(f.color),y=Z0(xt({},f,{color:g})),{align:b="inherit",className:M,component:E,gutterBottom:C=!1,noWrap:L=!1,paragraph:B=!1,variant:z="body1",variantMapping:H=v3}=y,U=cn(y,eY),q=xt({},y,{align:b,color:g,className:M,component:E,gutterBottom:C,noWrap:L,paragraph:B,variant:z,variantMapping:H}),tt=E||(B?"p":H[z]||v3[z])||"span",V=nY(q);return rt.jsx(rY,xt({as:tt,ref:h,ownerState:q,className:In(V.root,M)},U))}),Vc=sY;function aY(i){return yr("MuiAppBar",i)}wr("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const lY=["className","color","enableColorOnDark","position"],cY=i=>{const{color:s,position:h,classes:f}=i,g={root:["root",`color${Ln(s)}`,`position${Ln(h)}`]};return br(g,aY,f)},C_=(i,s)=>i?`${i==null?void 0:i.replace(")","")}, ${s})`:s,uY=mn(J0,{name:"MuiAppBar",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.root,s[`position${Ln(h.position)}`],s[`color${Ln(h.color)}`]]}})(({theme:i,ownerState:s})=>{const h=i.palette.mode==="light"?i.palette.grey[100]:i.palette.grey[900];return xt({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},s.position==="fixed"&&{position:"fixed",zIndex:(i.vars||i).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},s.position==="absolute"&&{position:"absolute",zIndex:(i.vars||i).zIndex.appBar,top:0,left:"auto",right:0},s.position==="sticky"&&{position:"sticky",zIndex:(i.vars||i).zIndex.appBar,top:0,left:"auto",right:0},s.position==="static"&&{position:"static"},s.position==="relative"&&{position:"relative"},!i.vars&&xt({},s.color==="default"&&{backgroundColor:h,color:i.palette.getContrastText(h)},s.color&&s.color!=="default"&&s.color!=="inherit"&&s.color!=="transparent"&&{backgroundColor:i.palette[s.color].main,color:i.palette[s.color].contrastText},s.color==="inherit"&&{color:"inherit"},i.palette.mode==="dark"&&!s.enableColorOnDark&&{backgroundColor:null,color:null},s.color==="transparent"&&xt({backgroundColor:"transparent",color:"inherit"},i.palette.mode==="dark"&&{backgroundImage:"none"})),i.vars&&xt({},s.color==="default"&&{"--AppBar-background":s.enableColorOnDark?i.vars.palette.AppBar.defaultBg:C_(i.vars.palette.AppBar.darkBg,i.vars.palette.AppBar.defaultBg),"--AppBar-color":s.enableColorOnDark?i.vars.palette.text.primary:C_(i.vars.palette.AppBar.darkColor,i.vars.palette.text.primary)},s.color&&!s.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":s.enableColorOnDark?i.vars.palette[s.color].main:C_(i.vars.palette.AppBar.darkBg,i.vars.palette[s.color].main),"--AppBar-color":s.enableColorOnDark?i.vars.palette[s.color].contrastText:C_(i.vars.palette.AppBar.darkColor,i.vars.palette[s.color].contrastText)},{backgroundColor:"var(--AppBar-background)",color:s.color==="inherit"?"inherit":"var(--AppBar-color)"},s.color==="transparent"&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))}),hY=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiAppBar"}),{className:g,color:y="primary",enableColorOnDark:b=!1,position:M="fixed"}=f,E=cn(f,lY),C=xt({},f,{color:y,position:M,enableColorOnDark:b}),L=cY(C);return rt.jsx(uY,xt({square:!0,component:"header",ownerState:C,elevation:4,className:In(L.root,g,M==="fixed"&&"mui-fixed"),ref:h},E))}),dY=hY,fY=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function pY(i){const s=parseInt(i.getAttribute("tabindex")||"",10);return Number.isNaN(s)?i.contentEditable==="true"||(i.nodeName==="AUDIO"||i.nodeName==="VIDEO"||i.nodeName==="DETAILS")&&i.getAttribute("tabindex")===null?0:i.tabIndex:s}function mY(i){if(i.tagName!=="INPUT"||i.type!=="radio"||!i.name)return!1;const s=f=>i.ownerDocument.querySelector(`input[type="radio"]${f}`);let h=s(`[name="${i.name}"]:checked`);return h||(h=s(`[name="${i.name}"]`)),h!==i}function gY(i){return!(i.disabled||i.tagName==="INPUT"&&i.type==="hidden"||mY(i))}function _Y(i){const s=[],h=[];return Array.from(i.querySelectorAll(fY)).forEach((f,g)=>{const y=pY(f);y===-1||!gY(f)||(y===0?s.push(f):h.push({documentOrder:g,tabIndex:y,node:f}))}),h.sort((f,g)=>f.tabIndex===g.tabIndex?f.documentOrder-g.documentOrder:f.tabIndex-g.tabIndex).map(f=>f.node).concat(s)}function yY(){return!0}function vY(i){const{children:s,disableAutoFocus:h=!1,disableEnforceFocus:f=!1,disableRestoreFocus:g=!1,getTabbable:y=_Y,isEnabled:b=yY,open:M}=i,E=lt.useRef(!1),C=lt.useRef(null),L=lt.useRef(null),B=lt.useRef(null),z=lt.useRef(null),H=lt.useRef(!1),U=lt.useRef(null),q=io(s.ref,U),tt=lt.useRef(null);lt.useEffect(()=>{!M||!U.current||(H.current=!h)},[h,M]),lt.useEffect(()=>{if(!M||!U.current)return;const D=zo(U.current);return U.current.contains(D.activeElement)||(U.current.hasAttribute("tabIndex")||U.current.setAttribute("tabIndex","-1"),H.current&&U.current.focus()),()=>{g||(B.current&&B.current.focus&&(E.current=!0,B.current.focus()),B.current=null)}},[M]),lt.useEffect(()=>{if(!M||!U.current)return;const D=zo(U.current),$=st=>{tt.current=st,!(f||!b()||st.key!=="Tab")&&D.activeElement===U.current&&st.shiftKey&&(E.current=!0,L.current&&L.current.focus())},J=()=>{const st=U.current;if(st===null)return;if(!D.hasFocus()||!b()||E.current){E.current=!1;return}if(st.contains(D.activeElement)||f&&D.activeElement!==C.current&&D.activeElement!==L.current)return;if(D.activeElement!==z.current)z.current=null;else if(z.current!==null)return;if(!H.current)return;let yt=[];if((D.activeElement===C.current||D.activeElement===L.current)&&(yt=y(U.current)),yt.length>0){var ut,N;const et=!!((ut=tt.current)!=null&&ut.shiftKey&&((N=tt.current)==null?void 0:N.key)==="Tab"),Mt=yt[0],Lt=yt[yt.length-1];typeof Mt!="string"&&typeof Lt!="string"&&(et?Lt.focus():Mt.focus())}else st.focus()};D.addEventListener("focusin",J),D.addEventListener("keydown",$,!0);const ct=setInterval(()=>{D.activeElement&&D.activeElement.tagName==="BODY"&&J()},50);return()=>{clearInterval(ct),D.removeEventListener("focusin",J),D.removeEventListener("keydown",$,!0)}},[h,f,g,b,M,y]);const V=D=>{B.current===null&&(B.current=D.relatedTarget),H.current=!0,z.current=D.target;const $=s.props.onFocus;$&&$(D)},F=D=>{B.current===null&&(B.current=D.relatedTarget),H.current=!0};return rt.jsxs(lt.Fragment,{children:[rt.jsx("div",{tabIndex:M?0:-1,onFocus:F,ref:C,"data-testid":"sentinelStart"}),lt.cloneElement(s,{ref:q,onFocus:V}),rt.jsx("div",{tabIndex:M?0:-1,onFocus:F,ref:L,"data-testid":"sentinelEnd"})]})}function xY(i){return typeof i=="function"?i():i}const bY=lt.forwardRef(function(s,h){const{children:f,container:g,disablePortal:y=!1}=s,[b,M]=lt.useState(null),E=io(lt.isValidElement(f)?f.ref:null,h);if(cc(()=>{y||M(xY(g)||document.body)},[g,y]),cc(()=>{if(b&&!y)return Ry(h,b),()=>{Ry(h,null)}},[h,b,y]),y){if(lt.isValidElement(f)){const C={ref:E};return lt.cloneElement(f,C)}return rt.jsx(lt.Fragment,{children:f})}return rt.jsx(lt.Fragment,{children:b&&s0.createPortal(f,b)})});function wY(i){const s=zo(i);return s.body===i?Ta(i).innerWidth>s.documentElement.clientWidth:i.scrollHeight>i.clientHeight}function mp(i,s){s?i.setAttribute("aria-hidden","true"):i.removeAttribute("aria-hidden")}function x3(i){return parseInt(Ta(i).getComputedStyle(i).paddingRight,10)||0}function TY(i){const h=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(i.tagName)!==-1,f=i.tagName==="INPUT"&&i.getAttribute("type")==="hidden";return h||f}function b3(i,s,h,f,g){const y=[s,h,...f];[].forEach.call(i.children,b=>{const M=y.indexOf(b)===-1,E=!TY(b);M&&E&&mp(b,g)})}function dw(i,s){let h=-1;return i.some((f,g)=>s(f)?(h=g,!0):!1),h}function SY(i,s){const h=[],f=i.container;if(!s.disableScrollLock){if(wY(f)){const b=D4(zo(f));h.push({value:f.style.paddingRight,property:"padding-right",el:f}),f.style.paddingRight=`${x3(f)+b}px`;const M=zo(f).querySelectorAll(".mui-fixed");[].forEach.call(M,E=>{h.push({value:E.style.paddingRight,property:"padding-right",el:E}),E.style.paddingRight=`${x3(E)+b}px`})}let y;if(f.parentNode instanceof DocumentFragment)y=zo(f).body;else{const b=f.parentElement,M=Ta(f);y=(b==null?void 0:b.nodeName)==="HTML"&&M.getComputedStyle(b).overflowY==="scroll"?b:f}h.push({value:y.style.overflow,property:"overflow",el:y},{value:y.style.overflowX,property:"overflow-x",el:y},{value:y.style.overflowY,property:"overflow-y",el:y}),y.style.overflow="hidden"}return()=>{h.forEach(({value:y,el:b,property:M})=>{y?b.style.setProperty(M,y):b.style.removeProperty(M)})}}function EY(i){const s=[];return[].forEach.call(i.children,h=>{h.getAttribute("aria-hidden")==="true"&&s.push(h)}),s}class CY{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(s,h){let f=this.modals.indexOf(s);if(f!==-1)return f;f=this.modals.length,this.modals.push(s),s.modalRef&&mp(s.modalRef,!1);const g=EY(h);b3(h,s.mount,s.modalRef,g,!0);const y=dw(this.containers,b=>b.container===h);return y!==-1?(this.containers[y].modals.push(s),f):(this.containers.push({modals:[s],container:h,restore:null,hiddenSiblings:g}),f)}mount(s,h){const f=dw(this.containers,y=>y.modals.indexOf(s)!==-1),g=this.containers[f];g.restore||(g.restore=SY(g,h))}remove(s,h=!0){const f=this.modals.indexOf(s);if(f===-1)return f;const g=dw(this.containers,b=>b.modals.indexOf(s)!==-1),y=this.containers[g];if(y.modals.splice(y.modals.indexOf(s),1),this.modals.splice(f,1),y.modals.length===0)y.restore&&y.restore(),s.modalRef&&mp(s.modalRef,h),b3(y.container,s.mount,s.modalRef,y.hiddenSiblings,!1),this.containers.splice(g,1);else{const b=y.modals[y.modals.length-1];b.modalRef&&mp(b.modalRef,!1)}return f}isTopModal(s){return this.modals.length>0&&this.modals[this.modals.length-1]===s}}function MY(i){return typeof i=="function"?i():i}function IY(i){return i?i.props.hasOwnProperty("in"):!1}const AY=new CY;function PY(i){const{container:s,disableEscapeKeyDown:h=!1,disableScrollLock:f=!1,manager:g=AY,closeAfterTransition:y=!1,onTransitionEnter:b,onTransitionExited:M,children:E,onClose:C,open:L,rootRef:B}=i,z=lt.useRef({}),H=lt.useRef(null),U=lt.useRef(null),q=io(U,B),[tt,V]=lt.useState(!L),F=IY(E);let D=!0;(i["aria-hidden"]==="false"||i["aria-hidden"]===!1)&&(D=!1);const $=()=>zo(H.current),J=()=>(z.current.modalRef=U.current,z.current.mount=H.current,z.current),ct=()=>{g.mount(J(),{disableScrollLock:f}),U.current&&(U.current.scrollTop=0)},st=ru(()=>{const Vt=MY(s)||$().body;g.add(J(),Vt),U.current&&ct()}),yt=lt.useCallback(()=>g.isTopModal(J()),[g]),ut=ru(Vt=>{H.current=Vt,Vt&&(L&&yt()?ct():U.current&&mp(U.current,D))}),N=lt.useCallback(()=>{g.remove(J(),D)},[D,g]);lt.useEffect(()=>()=>{N()},[N]),lt.useEffect(()=>{L?st():(!F||!y)&&N()},[L,N,F,y,st]);const et=Vt=>ne=>{var Et;(Et=Vt.onKeyDown)==null||Et.call(Vt,ne),!(ne.key!=="Escape"||ne.which===229||!yt())&&(h||(ne.stopPropagation(),C&&C(ne,"escapeKeyDown")))},Mt=Vt=>ne=>{var Et;(Et=Vt.onClick)==null||Et.call(Vt,ne),ne.target===ne.currentTarget&&C&&C(ne,"backdropClick")};return{getRootProps:(Vt={})=>{const ne=M5(i);delete ne.onTransitionEnter,delete ne.onTransitionExited;const Et=xt({},ne,Vt);return xt({role:"presentation"},Et,{onKeyDown:et(Et),ref:q})},getBackdropProps:(Vt={})=>{const ne=Vt;return xt({"aria-hidden":!0},ne,{onClick:Mt(ne),open:L})},getTransitionProps:()=>{const Vt=()=>{V(!1),b&&b()},ne=()=>{V(!0),M&&M(),y&&N()};return{onEnter:TT(Vt,E==null?void 0:E.props.onEnter),onExited:TT(ne,E==null?void 0:E.props.onExited)}},rootRef:q,portalRef:ut,isTopModal:yt,exited:tt,hasTransition:F}}const RY=["onChange","maxRows","minRows","style","value"];function M_(i){return parseInt(i,10)||0}const kY={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function w3(i){return i==null||Object.keys(i).length===0||i.outerHeightStyle===0&&!i.overflow}const OY=lt.forwardRef(function(s,h){const{onChange:f,maxRows:g,minRows:y=1,style:b,value:M}=s,E=cn(s,RY),{current:C}=lt.useRef(M!=null),L=lt.useRef(null),B=io(h,L),z=lt.useRef(null),H=lt.useRef(0),[U,q]=lt.useState({outerHeightStyle:0}),tt=lt.useCallback(()=>{const $=L.current,ct=Ta($).getComputedStyle($);if(ct.width==="0px")return{outerHeightStyle:0};const st=z.current;st.style.width=ct.width,st.value=$.value||s.placeholder||"x",st.value.slice(-1)===`
`&&(st.value+=" ");const yt=ct.boxSizing,ut=M_(ct.paddingBottom)+M_(ct.paddingTop),N=M_(ct.borderBottomWidth)+M_(ct.borderTopWidth),et=st.scrollHeight;st.value="x";const Mt=st.scrollHeight;let Lt=et;y&&(Lt=Math.max(Number(y)*Mt,Lt)),g&&(Lt=Math.min(Number(g)*Mt,Lt)),Lt=Math.max(Lt,Mt);const it=Lt+(yt==="border-box"?ut+N:0),Tt=Math.abs(Lt-et)<=1;return{outerHeightStyle:it,overflow:Tt}},[g,y,s.placeholder]),V=($,J)=>{const{outerHeightStyle:ct,overflow:st}=J;return H.current<20&&(ct>0&&Math.abs(($.outerHeightStyle||0)-ct)>1||$.overflow!==st)?(H.current+=1,{overflow:st,outerHeightStyle:ct}):$},F=lt.useCallback(()=>{const $=tt();w3($)||q(J=>V(J,$))},[tt]);cc(()=>{const $=()=>{const et=tt();w3(et)||s0.flushSync(()=>{q(Mt=>V(Mt,et))})},J=()=>{H.current=0,$()};let ct;const st=T0(J),yt=L.current,ut=Ta(yt);ut.addEventListener("resize",st);let N;return typeof ResizeObserver<"u"&&(N=new ResizeObserver(J),N.observe(yt)),()=>{st.clear(),cancelAnimationFrame(ct),ut.removeEventListener("resize",st),N&&N.disconnect()}},[tt]),cc(()=>{F()}),lt.useEffect(()=>{H.current=0},[M]);const D=$=>{H.current=0,C||F(),f&&f($)};return rt.jsxs(lt.Fragment,{children:[rt.jsx("textarea",xt({value:M,onChange:D,ref:B,rows:y,style:xt({height:U.outerHeightStyle,overflow:U.overflow?"hidden":void 0},b)},E)),rt.jsx("textarea",{"aria-hidden":!0,className:s.className,readOnly:!0,ref:z,tabIndex:-1,style:xt({},kY.shadow,b,{paddingTop:0,paddingBottom:0})})]})});function Sd({props:i,states:s,muiFormControl:h}){return s.reduce((f,g)=>(f[g]=i[g],h&&typeof i[g]>"u"&&(f[g]=h[g]),f),{})}const LY=lt.createContext(void 0),yE=LY;function Ed(){return lt.useContext(yE)}function zY(i){return rt.jsx(UH,xt({},i,{defaultTheme:K0,themeId:Yp}))}function T3(i){return i!=null&&!(Array.isArray(i)&&i.length===0)}function Fy(i,s=!1){return i&&(T3(i.value)&&i.value!==""||s&&T3(i.defaultValue)&&i.defaultValue!=="")}function DY(i){return i.startAdornment}function BY(i){return yr("MuiInputBase",i)}const FY=wr("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),md=FY,NY=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],ev=(i,s)=>{const{ownerState:h}=i;return[s.root,h.formControl&&s.formControl,h.startAdornment&&s.adornedStart,h.endAdornment&&s.adornedEnd,h.error&&s.error,h.size==="small"&&s.sizeSmall,h.multiline&&s.multiline,h.color&&s[`color${Ln(h.color)}`],h.fullWidth&&s.fullWidth,h.hiddenLabel&&s.hiddenLabel]},nv=(i,s)=>{const{ownerState:h}=i;return[s.input,h.size==="small"&&s.inputSizeSmall,h.multiline&&s.inputMultiline,h.type==="search"&&s.inputTypeSearch,h.startAdornment&&s.inputAdornedStart,h.endAdornment&&s.inputAdornedEnd,h.hiddenLabel&&s.inputHiddenLabel]},jY=i=>{const{classes:s,color:h,disabled:f,error:g,endAdornment:y,focused:b,formControl:M,fullWidth:E,hiddenLabel:C,multiline:L,readOnly:B,size:z,startAdornment:H,type:U}=i,q={root:["root",`color${Ln(h)}`,f&&"disabled",g&&"error",E&&"fullWidth",b&&"focused",M&&"formControl",z&&z!=="medium"&&`size${Ln(z)}`,L&&"multiline",H&&"adornedStart",y&&"adornedEnd",C&&"hiddenLabel",B&&"readOnly"],input:["input",f&&"disabled",U==="search"&&"inputTypeSearch",L&&"inputMultiline",z==="small"&&"inputSizeSmall",C&&"inputHiddenLabel",H&&"inputAdornedStart",y&&"inputAdornedEnd",B&&"readOnly"]};return br(q,BY,s)},rv=mn("div",{name:"MuiInputBase",slot:"Root",overridesResolver:ev})(({theme:i,ownerState:s})=>xt({},i.typography.body1,{color:(i.vars||i).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${md.disabled}`]:{color:(i.vars||i).palette.text.disabled,cursor:"default"}},s.multiline&&xt({padding:"4px 0 5px"},s.size==="small"&&{paddingTop:1}),s.fullWidth&&{width:"100%"})),iv=mn("input",{name:"MuiInputBase",slot:"Input",overridesResolver:nv})(({theme:i,ownerState:s})=>{const h=i.palette.mode==="light",f=xt({color:"currentColor"},i.vars?{opacity:i.vars.opacity.inputPlaceholder}:{opacity:h?.42:.5},{transition:i.transitions.create("opacity",{duration:i.transitions.duration.shorter})}),g={opacity:"0 !important"},y=i.vars?{opacity:i.vars.opacity.inputPlaceholder}:{opacity:h?.42:.5};return xt({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":f,"&::-moz-placeholder":f,"&:-ms-input-placeholder":f,"&::-ms-input-placeholder":f,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${md.formControl} &`]:{"&::-webkit-input-placeholder":g,"&::-moz-placeholder":g,"&:-ms-input-placeholder":g,"&::-ms-input-placeholder":g,"&:focus::-webkit-input-placeholder":y,"&:focus::-moz-placeholder":y,"&:focus:-ms-input-placeholder":y,"&:focus::-ms-input-placeholder":y},[`&.${md.disabled}`]:{opacity:1,WebkitTextFillColor:(i.vars||i).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},s.size==="small"&&{paddingTop:1},s.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},s.type==="search"&&{MozAppearance:"textfield"})}),UY=rt.jsx(zY,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),$Y=lt.forwardRef(function(s,h){var f;const g=Sr({props:s,name:"MuiInputBase"}),{"aria-describedby":y,autoComplete:b,autoFocus:M,className:E,components:C={},componentsProps:L={},defaultValue:B,disabled:z,disableInjectingGlobalStyles:H,endAdornment:U,fullWidth:q=!1,id:tt,inputComponent:V="input",inputProps:F={},inputRef:D,maxRows:$,minRows:J,multiline:ct=!1,name:st,onBlur:yt,onChange:ut,onClick:N,onFocus:et,onKeyDown:Mt,onKeyUp:Lt,placeholder:it,readOnly:Tt,renderSuffix:Vt,rows:ne,slotProps:Et={},slots:$t={},startAdornment:ee,type:Ee="text",value:jt}=g,Le=cn(g,NY),we=F.value!=null?F.value:jt,{current:kt}=lt.useRef(we!=null),Xt=lt.useRef(),Ot=lt.useCallback(be=>{},[]),Pe=io(Xt,D,F.ref,Ot),[ie,Ne]=lt.useState(!1),Fe=Ed(),je=Sd({props:g,muiFormControl:Fe,states:["color","disabled","error","hiddenLabel","size","required","filled"]});je.focused=Fe?Fe.focused:ie,lt.useEffect(()=>{!Fe&&z&&ie&&(Ne(!1),yt&&yt())},[Fe,z,ie,yt]);const De=Fe&&Fe.onFilled,Ue=Fe&&Fe.onEmpty,An=lt.useCallback(be=>{Fy(be)?De&&De():Ue&&Ue()},[De,Ue]);cc(()=>{kt&&An({value:we})},[we,An,kt]);const vn=be=>{if(je.disabled){be.stopPropagation();return}et&&et(be),F.onFocus&&F.onFocus(be),Fe&&Fe.onFocus?Fe.onFocus(be):Ne(!0)},Zt=be=>{yt&&yt(be),F.onBlur&&F.onBlur(be),Fe&&Fe.onBlur?Fe.onBlur(be):Ne(!1)},Y=(be,...Me)=>{if(!kt){const zn=be.target||Xt.current;if(zn==null)throw new Error(lc(1));An({value:zn.value})}F.onChange&&F.onChange(be,...Me),ut&&ut(be,...Me)};lt.useEffect(()=>{An(Xt.current)},[]);const nt=be=>{Xt.current&&be.currentTarget===be.target&&Xt.current.focus(),N&&N(be)};let dt=V,Bt=F;ct&&dt==="input"&&(ne?Bt=xt({type:void 0,minRows:ne,maxRows:ne},Bt):Bt=xt({type:void 0,maxRows:$,minRows:J},Bt),dt=OY);const Wt=be=>{An(be.animationName==="mui-auto-fill-cancel"?Xt.current:{value:"x"})};lt.useEffect(()=>{Fe&&Fe.setAdornedStart(!!ee)},[Fe,ee]);const ae=xt({},g,{color:je.color||"primary",disabled:je.disabled,endAdornment:U,error:je.error,focused:je.focused,formControl:Fe,fullWidth:q,hiddenLabel:je.hiddenLabel,multiline:ct,size:je.size,startAdornment:ee,type:Ee}),ce=jY(ae),qt=$t.root||C.Root||rv,Ce=Et.root||L.root||{},Re=$t.input||C.Input||iv;return Bt=xt({},Bt,(f=Et.input)!=null?f:L.input),rt.jsxs(lt.Fragment,{children:[!H&&UY,rt.jsxs(qt,xt({},Ce,!By(qt)&&{ownerState:xt({},ae,Ce.ownerState)},{ref:h,onClick:nt},Le,{className:In(ce.root,Ce.className,E,Tt&&"MuiInputBase-readOnly"),children:[ee,rt.jsx(yE.Provider,{value:null,children:rt.jsx(Re,xt({ownerState:ae,"aria-invalid":je.error,"aria-describedby":y,autoComplete:b,autoFocus:M,defaultValue:B,disabled:je.disabled,id:tt,onAnimationStart:Wt,name:st,placeholder:it,readOnly:Tt,required:je.required,rows:ne,value:we,onKeyDown:Mt,onKeyUp:Lt,type:Ee},Bt,!By(Re)&&{as:dt,ownerState:xt({},ae,Bt.ownerState)},{ref:Pe,className:In(ce.input,Bt.className,Tt&&"MuiInputBase-readOnly"),onBlur:Zt,onChange:Y,onFocus:vn}))}),U,Vt?Vt(xt({},je,{startAdornment:ee})):null]}))]})}),vE=$Y;function VY(i){return yr("MuiInput",i)}const GY=xt({},md,wr("MuiInput",["root","underline","input"])),Wf=GY;function WY(i){return yr("MuiOutlinedInput",i)}const qY=xt({},md,wr("MuiOutlinedInput",["root","notchedOutline","input"])),jl=qY;function HY(i){return yr("MuiFilledInput",i)}const ZY=xt({},md,wr("MuiFilledInput",["root","underline","input"])),Gc=ZY,XY=c5(rt.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),KY=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],YY={entering:{opacity:1},entered:{opacity:1}},QY=lt.forwardRef(function(s,h){const f=Td(),g={enter:f.transitions.duration.enteringScreen,exit:f.transitions.duration.leavingScreen},{addEndListener:y,appear:b=!0,children:M,easing:E,in:C,onEnter:L,onEntered:B,onEntering:z,onExit:H,onExited:U,onExiting:q,style:tt,timeout:V=g,TransitionComponent:F=pE}=s,D=cn(s,KY),$=lt.useRef(null),J=io($,M.ref,h),ct=it=>Tt=>{if(it){const Vt=$.current;Tt===void 0?it(Vt):it(Vt,Tt)}},st=ct(z),yt=ct((it,Tt)=>{_E(it);const Vt=fd({style:tt,timeout:V,easing:E},{mode:"enter"});it.style.webkitTransition=f.transitions.create("opacity",Vt),it.style.transition=f.transitions.create("opacity",Vt),L&&L(it,Tt)}),ut=ct(B),N=ct(q),et=ct(it=>{const Tt=fd({style:tt,timeout:V,easing:E},{mode:"exit"});it.style.webkitTransition=f.transitions.create("opacity",Tt),it.style.transition=f.transitions.create("opacity",Tt),H&&H(it)}),Mt=ct(U),Lt=it=>{y&&y($.current,it)};return rt.jsx(F,xt({appear:b,in:C,nodeRef:$,onEnter:yt,onEntered:ut,onEntering:st,onExit:et,onExited:Mt,onExiting:N,addEndListener:Lt,timeout:V},D,{children:(it,Tt)=>lt.cloneElement(M,xt({style:xt({opacity:0,visibility:it==="exited"&&!C?"hidden":void 0},YY[it],tt,M.props.style),ref:J},Tt))}))}),JY=QY;function tQ(i){return yr("MuiBackdrop",i)}wr("MuiBackdrop",["root","invisible"]);const eQ=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],nQ=i=>{const{classes:s,invisible:h}=i;return br({root:["root",h&&"invisible"]},tQ,s)},rQ=mn("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.root,h.invisible&&s.invisible]}})(({ownerState:i})=>xt({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},i.invisible&&{backgroundColor:"transparent"})),iQ=lt.forwardRef(function(s,h){var f,g,y;const b=Sr({props:s,name:"MuiBackdrop"}),{children:M,className:E,component:C="div",components:L={},componentsProps:B={},invisible:z=!1,open:H,slotProps:U={},slots:q={},TransitionComponent:tt=JY,transitionDuration:V}=b,F=cn(b,eQ),D=xt({},b,{component:C,invisible:z}),$=nQ(D),J=(f=U.root)!=null?f:B.root;return rt.jsx(tt,xt({in:H,timeout:V},F,{children:rt.jsx(rQ,xt({"aria-hidden":!0},J,{as:(g=(y=q.root)!=null?y:L.Root)!=null?g:C,className:In($.root,E,J==null?void 0:J.className),ownerState:xt({},D,J==null?void 0:J.ownerState),classes:$,ref:h,children:M}))}))}),oQ=iQ,sQ=wr("MuiBox",["root"]),aQ=sQ,lQ=l5(),cQ=WH({themeId:Yp,defaultTheme:lQ,defaultClassName:aQ.root,generateClassName:WS.generate}),qf=cQ;function uQ(i){return yr("MuiButton",i)}const hQ=wr("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),I_=hQ,dQ=lt.createContext({}),fQ=dQ,pQ=lt.createContext(void 0),mQ=pQ,gQ=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],_Q=i=>{const{color:s,disableElevation:h,fullWidth:f,size:g,variant:y,classes:b}=i,M={root:["root",y,`${y}${Ln(s)}`,`size${Ln(g)}`,`${y}Size${Ln(g)}`,s==="inherit"&&"colorInherit",h&&"disableElevation",f&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${Ln(g)}`],endIcon:["endIcon",`iconSize${Ln(g)}`]},E=br(M,uQ,b);return xt({},b,E)},I5=i=>xt({},i.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},i.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},i.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),yQ=mn(JK,{shouldForwardProp:i=>Ms(i)||i==="classes",name:"MuiButton",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.root,s[h.variant],s[`${h.variant}${Ln(h.color)}`],s[`size${Ln(h.size)}`],s[`${h.variant}Size${Ln(h.size)}`],h.color==="inherit"&&s.colorInherit,h.disableElevation&&s.disableElevation,h.fullWidth&&s.fullWidth]}})(({theme:i,ownerState:s})=>{var h,f;const g=i.palette.mode==="light"?i.palette.grey[300]:i.palette.grey[800],y=i.palette.mode==="light"?i.palette.grey.A100:i.palette.grey[700];return xt({},i.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(i.vars||i).shape.borderRadius,transition:i.transitions.create(["background-color","box-shadow","border-color","color"],{duration:i.transitions.duration.short}),"&:hover":xt({textDecoration:"none",backgroundColor:i.vars?`rgba(${i.vars.palette.text.primaryChannel} / ${i.vars.palette.action.hoverOpacity})`:Vh(i.palette.text.primary,i.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},s.variant==="text"&&s.color!=="inherit"&&{backgroundColor:i.vars?`rgba(${i.vars.palette[s.color].mainChannel} / ${i.vars.palette.action.hoverOpacity})`:Vh(i.palette[s.color].main,i.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},s.variant==="outlined"&&s.color!=="inherit"&&{border:`1px solid ${(i.vars||i).palette[s.color].main}`,backgroundColor:i.vars?`rgba(${i.vars.palette[s.color].mainChannel} / ${i.vars.palette.action.hoverOpacity})`:Vh(i.palette[s.color].main,i.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},s.variant==="contained"&&{backgroundColor:i.vars?i.vars.palette.Button.inheritContainedHoverBg:y,boxShadow:(i.vars||i).shadows[4],"@media (hover: none)":{boxShadow:(i.vars||i).shadows[2],backgroundColor:(i.vars||i).palette.grey[300]}},s.variant==="contained"&&s.color!=="inherit"&&{backgroundColor:(i.vars||i).palette[s.color].dark,"@media (hover: none)":{backgroundColor:(i.vars||i).palette[s.color].main}}),"&:active":xt({},s.variant==="contained"&&{boxShadow:(i.vars||i).shadows[8]}),[`&.${I_.focusVisible}`]:xt({},s.variant==="contained"&&{boxShadow:(i.vars||i).shadows[6]}),[`&.${I_.disabled}`]:xt({color:(i.vars||i).palette.action.disabled},s.variant==="outlined"&&{border:`1px solid ${(i.vars||i).palette.action.disabledBackground}`},s.variant==="contained"&&{color:(i.vars||i).palette.action.disabled,boxShadow:(i.vars||i).shadows[0],backgroundColor:(i.vars||i).palette.action.disabledBackground})},s.variant==="text"&&{padding:"6px 8px"},s.variant==="text"&&s.color!=="inherit"&&{color:(i.vars||i).palette[s.color].main},s.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},s.variant==="outlined"&&s.color!=="inherit"&&{color:(i.vars||i).palette[s.color].main,border:i.vars?`1px solid rgba(${i.vars.palette[s.color].mainChannel} / 0.5)`:`1px solid ${Vh(i.palette[s.color].main,.5)}`},s.variant==="contained"&&{color:i.vars?i.vars.palette.text.primary:(h=(f=i.palette).getContrastText)==null?void 0:h.call(f,i.palette.grey[300]),backgroundColor:i.vars?i.vars.palette.Button.inheritContainedBg:g,boxShadow:(i.vars||i).shadows[2]},s.variant==="contained"&&s.color!=="inherit"&&{color:(i.vars||i).palette[s.color].contrastText,backgroundColor:(i.vars||i).palette[s.color].main},s.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},s.size==="small"&&s.variant==="text"&&{padding:"4px 5px",fontSize:i.typography.pxToRem(13)},s.size==="large"&&s.variant==="text"&&{padding:"8px 11px",fontSize:i.typography.pxToRem(15)},s.size==="small"&&s.variant==="outlined"&&{padding:"3px 9px",fontSize:i.typography.pxToRem(13)},s.size==="large"&&s.variant==="outlined"&&{padding:"7px 21px",fontSize:i.typography.pxToRem(15)},s.size==="small"&&s.variant==="contained"&&{padding:"4px 10px",fontSize:i.typography.pxToRem(13)},s.size==="large"&&s.variant==="contained"&&{padding:"8px 22px",fontSize:i.typography.pxToRem(15)},s.fullWidth&&{width:"100%"})},({ownerState:i})=>i.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${I_.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${I_.disabled}`]:{boxShadow:"none"}}),vQ=mn("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.startIcon,s[`iconSize${Ln(h.size)}`]]}})(({ownerState:i})=>xt({display:"inherit",marginRight:8,marginLeft:-4},i.size==="small"&&{marginLeft:-2},I5(i))),xQ=mn("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.endIcon,s[`iconSize${Ln(h.size)}`]]}})(({ownerState:i})=>xt({display:"inherit",marginRight:-4,marginLeft:8},i.size==="small"&&{marginRight:-2},I5(i))),bQ=lt.forwardRef(function(s,h){const f=lt.useContext(fQ),g=lt.useContext(mQ),y=GS(f,s),b=Sr({props:y,name:"MuiButton"}),{children:M,color:E="primary",component:C="button",className:L,disabled:B=!1,disableElevation:z=!1,disableFocusRipple:H=!1,endIcon:U,focusVisibleClassName:q,fullWidth:tt=!1,size:V="medium",startIcon:F,type:D,variant:$="text"}=b,J=cn(b,gQ),ct=xt({},b,{color:E,component:C,disabled:B,disableElevation:z,disableFocusRipple:H,fullWidth:tt,size:V,type:D,variant:$}),st=_Q(ct),yt=F&&rt.jsx(vQ,{className:st.startIcon,ownerState:ct,children:F}),ut=U&&rt.jsx(xQ,{className:st.endIcon,ownerState:ct,children:U}),N=g||"";return rt.jsxs(yQ,xt({ownerState:ct,className:In(f.className,st.root,L,N),component:C,disabled:B,focusRipple:!H,focusVisibleClassName:In(st.focusVisible,q),ref:h,type:D},J,{classes:st,children:[yt,M,ut]}))}),Hf=bQ;function wQ(i){return yr("MuiCard",i)}wr("MuiCard",["root"]);const TQ=["className","raised"],SQ=i=>{const{classes:s}=i;return br({root:["root"]},wQ,s)},EQ=mn(J0,{name:"MuiCard",slot:"Root",overridesResolver:(i,s)=>s.root})(()=>({overflow:"hidden"})),CQ=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiCard"}),{className:g,raised:y=!1}=f,b=cn(f,TQ),M=xt({},f,{raised:y}),E=SQ(M);return rt.jsx(EQ,xt({className:In(E.root,g),elevation:y?8:void 0,ref:h,ownerState:M},b))}),fw=CQ;function MQ(i){return yr("MuiCardContent",i)}wr("MuiCardContent",["root"]);const IQ=["className","component"],AQ=i=>{const{classes:s}=i;return br({root:["root"]},MQ,s)},PQ=mn("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(i,s)=>s.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),RQ=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiCardContent"}),{className:g,component:y="div"}=f,b=cn(f,IQ),M=xt({},f,{component:y}),E=AQ(M);return rt.jsx(PQ,xt({as:y,className:In(E.root,g),ownerState:M,ref:h},b))}),pw=RQ,kQ=hZ({createStyledComponent:mn("div",{name:"MuiContainer",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.root,s[`maxWidth${Ln(String(h.maxWidth))}`],h.fixed&&s.fixed,h.disableGutters&&s.disableGutters]}}),useThemeProps:i=>Sr({props:i,name:"MuiContainer"})}),A_=kQ;function OQ(i){return yr("MuiModal",i)}wr("MuiModal",["root","hidden","backdrop"]);const LQ=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],zQ=i=>{const{open:s,exited:h,classes:f}=i;return br({root:["root",!s&&h&&"hidden"],backdrop:["backdrop"]},OQ,f)},DQ=mn("div",{name:"MuiModal",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.root,!h.open&&h.exited&&s.hidden]}})(({theme:i,ownerState:s})=>xt({position:"fixed",zIndex:(i.vars||i).zIndex.modal,right:0,bottom:0,top:0,left:0},!s.open&&s.exited&&{visibility:"hidden"})),BQ=mn(oQ,{name:"MuiModal",slot:"Backdrop",overridesResolver:(i,s)=>s.backdrop})({zIndex:-1}),FQ=lt.forwardRef(function(s,h){var f,g,y,b,M,E;const C=Sr({name:"MuiModal",props:s}),{BackdropComponent:L=BQ,BackdropProps:B,className:z,closeAfterTransition:H=!1,children:U,container:q,component:tt,components:V={},componentsProps:F={},disableAutoFocus:D=!1,disableEnforceFocus:$=!1,disableEscapeKeyDown:J=!1,disablePortal:ct=!1,disableRestoreFocus:st=!1,disableScrollLock:yt=!1,hideBackdrop:ut=!1,keepMounted:N=!1,onBackdropClick:et,open:Mt,slotProps:Lt,slots:it}=C,Tt=cn(C,LQ),Vt=xt({},C,{closeAfterTransition:H,disableAutoFocus:D,disableEnforceFocus:$,disableEscapeKeyDown:J,disablePortal:ct,disableRestoreFocus:st,disableScrollLock:yt,hideBackdrop:ut,keepMounted:N}),{getRootProps:ne,getBackdropProps:Et,getTransitionProps:$t,portalRef:ee,isTopModal:Ee,exited:jt,hasTransition:Le}=PY(xt({},Vt,{rootRef:h})),we=xt({},Vt,{exited:jt}),kt=zQ(we),Xt={};if(U.props.tabIndex===void 0&&(Xt.tabIndex="-1"),Le){const{onEnter:De,onExited:Ue}=$t();Xt.onEnter=De,Xt.onExited=Ue}const Ot=(f=(g=it==null?void 0:it.root)!=null?g:V.Root)!=null?f:DQ,Pe=(y=(b=it==null?void 0:it.backdrop)!=null?b:V.Backdrop)!=null?y:L,ie=(M=Lt==null?void 0:Lt.root)!=null?M:F.root,Ne=(E=Lt==null?void 0:Lt.backdrop)!=null?E:F.backdrop,Fe=pd({elementType:Ot,externalSlotProps:ie,externalForwardedProps:Tt,getSlotProps:ne,additionalProps:{ref:h,as:tt},ownerState:we,className:In(z,ie==null?void 0:ie.className,kt==null?void 0:kt.root,!we.open&&we.exited&&(kt==null?void 0:kt.hidden))}),je=pd({elementType:Pe,externalSlotProps:Ne,additionalProps:B,getSlotProps:De=>Et(xt({},De,{onClick:Ue=>{et&&et(Ue),De!=null&&De.onClick&&De.onClick(Ue)}})),className:In(Ne==null?void 0:Ne.className,B==null?void 0:B.className,kt==null?void 0:kt.backdrop),ownerState:we});return!N&&!Mt&&(!Le||jt)?null:rt.jsx(bY,{ref:ee,container:q,disablePortal:ct,children:rt.jsxs(Ot,xt({},Fe,{children:[!ut&&L?rt.jsx(Pe,xt({},je)):null,rt.jsx(vY,{disableEnforceFocus:$,disableAutoFocus:D,disableRestoreFocus:st,isEnabled:Ee,open:Mt,children:lt.cloneElement(U,Xt)})]}))})}),A5=FQ,NQ=["addEndListener","appear","children","container","direction","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function jQ(i,s,h){const f=s.getBoundingClientRect(),g=h&&h.getBoundingClientRect(),y=Ta(s);let b;if(s.fakeTransform)b=s.fakeTransform;else{const C=y.getComputedStyle(s);b=C.getPropertyValue("-webkit-transform")||C.getPropertyValue("transform")}let M=0,E=0;if(b&&b!=="none"&&typeof b=="string"){const C=b.split("(")[1].split(")")[0].split(",");M=parseInt(C[4],10),E=parseInt(C[5],10)}return i==="left"?g?`translateX(${g.right+M-f.left}px)`:`translateX(${y.innerWidth+M-f.left}px)`:i==="right"?g?`translateX(-${f.right-g.left-M}px)`:`translateX(-${f.left+f.width-M}px)`:i==="up"?g?`translateY(${g.bottom+E-f.top}px)`:`translateY(${y.innerHeight+E-f.top}px)`:g?`translateY(-${f.top-g.top+f.height-E}px)`:`translateY(-${f.top+f.height-E}px)`}function UQ(i){return typeof i=="function"?i():i}function P_(i,s,h){const f=UQ(h),g=jQ(i,s,f);g&&(s.style.webkitTransform=g,s.style.transform=g)}const $Q=lt.forwardRef(function(s,h){const f=Td(),g={enter:f.transitions.easing.easeOut,exit:f.transitions.easing.sharp},y={enter:f.transitions.duration.enteringScreen,exit:f.transitions.duration.leavingScreen},{addEndListener:b,appear:M=!0,children:E,container:C,direction:L="down",easing:B=g,in:z,onEnter:H,onEntered:U,onEntering:q,onExit:tt,onExited:V,onExiting:F,style:D,timeout:$=y,TransitionComponent:J=pE}=s,ct=cn(s,NQ),st=lt.useRef(null),yt=io(E.ref,st,h),ut=Et=>$t=>{Et&&($t===void 0?Et(st.current):Et(st.current,$t))},N=ut((Et,$t)=>{P_(L,Et,C),_E(Et),H&&H(Et,$t)}),et=ut((Et,$t)=>{const ee=fd({timeout:$,style:D,easing:B},{mode:"enter"});Et.style.webkitTransition=f.transitions.create("-webkit-transform",xt({},ee)),Et.style.transition=f.transitions.create("transform",xt({},ee)),Et.style.webkitTransform="none",Et.style.transform="none",q&&q(Et,$t)}),Mt=ut(U),Lt=ut(F),it=ut(Et=>{const $t=fd({timeout:$,style:D,easing:B},{mode:"exit"});Et.style.webkitTransition=f.transitions.create("-webkit-transform",$t),Et.style.transition=f.transitions.create("transform",$t),P_(L,Et,C),tt&&tt(Et)}),Tt=ut(Et=>{Et.style.webkitTransition="",Et.style.transition="",V&&V(Et)}),Vt=Et=>{b&&b(st.current,Et)},ne=lt.useCallback(()=>{st.current&&P_(L,st.current,C)},[L,C]);return lt.useEffect(()=>{if(z||L==="down"||L==="right")return;const Et=T0(()=>{st.current&&P_(L,st.current,C)}),$t=Ta(st.current);return $t.addEventListener("resize",Et),()=>{Et.clear(),$t.removeEventListener("resize",Et)}},[L,z,C]),lt.useEffect(()=>{z||ne()},[z,ne]),rt.jsx(J,xt({nodeRef:st,onEnter:N,onEntered:Mt,onEntering:et,onExit:it,onExited:Tt,onExiting:Lt,addEndListener:Vt,appear:M,in:z,timeout:$},ct,{children:(Et,$t)=>lt.cloneElement(E,xt({ref:yt,style:xt({visibility:Et==="exited"&&!z?"hidden":void 0},D,E.props.style)},$t))}))}),VQ=$Q;function GQ(i){return yr("MuiDrawer",i)}wr("MuiDrawer",["root","docked","paper","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const WQ=["BackdropProps"],qQ=["anchor","BackdropProps","children","className","elevation","hideBackdrop","ModalProps","onClose","open","PaperProps","SlideProps","TransitionComponent","transitionDuration","variant"],P5=(i,s)=>{const{ownerState:h}=i;return[s.root,(h.variant==="permanent"||h.variant==="persistent")&&s.docked,s.modal]},HQ=i=>{const{classes:s,anchor:h,variant:f}=i,g={root:["root"],docked:[(f==="permanent"||f==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${Ln(h)}`,f!=="temporary"&&`paperAnchorDocked${Ln(h)}`]};return br(g,GQ,s)},ZQ=mn(A5,{name:"MuiDrawer",slot:"Root",overridesResolver:P5})(({theme:i})=>({zIndex:(i.vars||i).zIndex.drawer})),S3=mn("div",{shouldForwardProp:Ms,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:P5})({flex:"0 0 auto"}),XQ=mn(J0,{name:"MuiDrawer",slot:"Paper",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.paper,s[`paperAnchor${Ln(h.anchor)}`],h.variant!=="temporary"&&s[`paperAnchorDocked${Ln(h.anchor)}`]]}})(({theme:i,ownerState:s})=>xt({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(i.vars||i).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0},s.anchor==="left"&&{left:0},s.anchor==="top"&&{top:0,left:0,right:0,height:"auto",maxHeight:"100%"},s.anchor==="right"&&{right:0},s.anchor==="bottom"&&{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},s.anchor==="left"&&s.variant!=="temporary"&&{borderRight:`1px solid ${(i.vars||i).palette.divider}`},s.anchor==="top"&&s.variant!=="temporary"&&{borderBottom:`1px solid ${(i.vars||i).palette.divider}`},s.anchor==="right"&&s.variant!=="temporary"&&{borderLeft:`1px solid ${(i.vars||i).palette.divider}`},s.anchor==="bottom"&&s.variant!=="temporary"&&{borderTop:`1px solid ${(i.vars||i).palette.divider}`})),R5={left:"right",right:"left",top:"down",bottom:"up"};function KQ(i){return["left","right"].indexOf(i)!==-1}function YQ(i,s){return i.direction==="rtl"&&KQ(s)?R5[s]:s}const QQ=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiDrawer"}),g=Td(),y={enter:g.transitions.duration.enteringScreen,exit:g.transitions.duration.leavingScreen},{anchor:b="left",BackdropProps:M,children:E,className:C,elevation:L=16,hideBackdrop:B=!1,ModalProps:{BackdropProps:z}={},onClose:H,open:U=!1,PaperProps:q={},SlideProps:tt,TransitionComponent:V=VQ,transitionDuration:F=y,variant:D="temporary"}=f,$=cn(f.ModalProps,WQ),J=cn(f,qQ),ct=lt.useRef(!1);lt.useEffect(()=>{ct.current=!0},[]);const st=YQ(g,b),ut=xt({},f,{anchor:b,elevation:L,open:U,variant:D},J),N=HQ(ut),et=rt.jsx(XQ,xt({elevation:D==="temporary"?L:0,square:!0},q,{className:In(N.paper,q.className),ownerState:ut,children:E}));if(D==="permanent")return rt.jsx(S3,xt({className:In(N.root,N.docked,C),ownerState:ut,ref:h},J,{children:et}));const Mt=rt.jsx(V,xt({in:U,direction:R5[st],timeout:F,appear:ct.current},tt,{children:et}));return D==="persistent"?rt.jsx(S3,xt({className:In(N.root,N.docked,C),ownerState:ut,ref:h},J,{children:Mt})):rt.jsx(ZQ,xt({BackdropProps:xt({},M,z,{transitionDuration:F}),className:In(N.root,N.modal,C),open:U,ownerState:ut,onClose:H,hideBackdrop:B,ref:h},J,$,{children:Mt}))}),JQ=QQ,tJ=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],eJ=i=>{const{classes:s,disableUnderline:h}=i,g=br({root:["root",!h&&"underline"],input:["input"]},HY,s);return xt({},s,g)},nJ=mn(rv,{shouldForwardProp:i=>Ms(i)||i==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[...ev(i,s),!h.disableUnderline&&s.underline]}})(({theme:i,ownerState:s})=>{var h;const f=i.palette.mode==="light",g=f?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",y=f?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",b=f?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",M=f?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return xt({position:"relative",backgroundColor:i.vars?i.vars.palette.FilledInput.bg:y,borderTopLeftRadius:(i.vars||i).shape.borderRadius,borderTopRightRadius:(i.vars||i).shape.borderRadius,transition:i.transitions.create("background-color",{duration:i.transitions.duration.shorter,easing:i.transitions.easing.easeOut}),"&:hover":{backgroundColor:i.vars?i.vars.palette.FilledInput.hoverBg:b,"@media (hover: none)":{backgroundColor:i.vars?i.vars.palette.FilledInput.bg:y}},[`&.${Gc.focused}`]:{backgroundColor:i.vars?i.vars.palette.FilledInput.bg:y},[`&.${Gc.disabled}`]:{backgroundColor:i.vars?i.vars.palette.FilledInput.disabledBg:M}},!s.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(h=(i.vars||i).palette[s.color||"primary"])==null?void 0:h.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:i.transitions.create("transform",{duration:i.transitions.duration.shorter,easing:i.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Gc.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Gc.error}`]:{"&::before, &::after":{borderBottomColor:(i.vars||i).palette.error.main}},"&::before":{borderBottom:`1px solid ${i.vars?`rgba(${i.vars.palette.common.onBackgroundChannel} / ${i.vars.opacity.inputUnderline})`:g}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:i.transitions.create("border-bottom-color",{duration:i.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Gc.disabled}, .${Gc.error}):before`]:{borderBottom:`1px solid ${(i.vars||i).palette.text.primary}`},[`&.${Gc.disabled}:before`]:{borderBottomStyle:"dotted"}},s.startAdornment&&{paddingLeft:12},s.endAdornment&&{paddingRight:12},s.multiline&&xt({padding:"25px 12px 8px"},s.size==="small"&&{paddingTop:21,paddingBottom:4},s.hiddenLabel&&{paddingTop:16,paddingBottom:17},s.hiddenLabel&&s.size==="small"&&{paddingTop:8,paddingBottom:9}))}),rJ=mn(iv,{name:"MuiFilledInput",slot:"Input",overridesResolver:nv})(({theme:i,ownerState:s})=>xt({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!i.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:i.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:i.palette.mode==="light"?null:"#fff",caretColor:i.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},i.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[i.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},s.size==="small"&&{paddingTop:21,paddingBottom:4},s.hiddenLabel&&{paddingTop:16,paddingBottom:17},s.startAdornment&&{paddingLeft:0},s.endAdornment&&{paddingRight:0},s.hiddenLabel&&s.size==="small"&&{paddingTop:8,paddingBottom:9},s.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})),k5=lt.forwardRef(function(s,h){var f,g,y,b;const M=Sr({props:s,name:"MuiFilledInput"}),{components:E={},componentsProps:C,fullWidth:L=!1,inputComponent:B="input",multiline:z=!1,slotProps:H,slots:U={},type:q="text"}=M,tt=cn(M,tJ),V=xt({},M,{fullWidth:L,inputComponent:B,multiline:z,type:q}),F=eJ(M),D={root:{ownerState:V},input:{ownerState:V}},$=H??C?Lo(D,H??C):D,J=(f=(g=U.root)!=null?g:E.Root)!=null?f:nJ,ct=(y=(b=U.input)!=null?b:E.Input)!=null?y:rJ;return rt.jsx(vE,xt({slots:{root:J,input:ct},componentsProps:$,fullWidth:L,inputComponent:B,multiline:z,ref:h,type:q},tt,{classes:F}))});k5.muiName="Input";const O5=k5;function iJ(i){return yr("MuiFormControl",i)}wr("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const oJ=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],sJ=i=>{const{classes:s,margin:h,fullWidth:f}=i,g={root:["root",h!=="none"&&`margin${Ln(h)}`,f&&"fullWidth"]};return br(g,iJ,s)},aJ=mn("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:i},s)=>xt({},s.root,s[`margin${Ln(i.margin)}`],i.fullWidth&&s.fullWidth)})(({ownerState:i})=>xt({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},i.margin==="normal"&&{marginTop:16,marginBottom:8},i.margin==="dense"&&{marginTop:8,marginBottom:4},i.fullWidth&&{width:"100%"})),lJ=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiFormControl"}),{children:g,className:y,color:b="primary",component:M="div",disabled:E=!1,error:C=!1,focused:L,fullWidth:B=!1,hiddenLabel:z=!1,margin:H="none",required:U=!1,size:q="medium",variant:tt="outlined"}=f,V=cn(f,oJ),F=xt({},f,{color:b,component:M,disabled:E,error:C,fullWidth:B,hiddenLabel:z,margin:H,required:U,size:q,variant:tt}),D=sJ(F),[$,J]=lt.useState(()=>{let Lt=!1;return g&&lt.Children.forEach(g,it=>{if(!K_(it,["Input","Select"]))return;const Tt=K_(it,["Select"])?it.props.input:it;Tt&&DY(Tt.props)&&(Lt=!0)}),Lt}),[ct,st]=lt.useState(()=>{let Lt=!1;return g&&lt.Children.forEach(g,it=>{K_(it,["Input","Select"])&&(Fy(it.props,!0)||Fy(it.props.inputProps,!0))&&(Lt=!0)}),Lt}),[yt,ut]=lt.useState(!1);E&&yt&&ut(!1);const N=L!==void 0&&!E?L:yt;let et;const Mt=lt.useMemo(()=>({adornedStart:$,setAdornedStart:J,color:b,disabled:E,error:C,filled:ct,focused:N,fullWidth:B,hiddenLabel:z,size:q,onBlur:()=>{ut(!1)},onEmpty:()=>{st(!1)},onFilled:()=>{st(!0)},onFocus:()=>{ut(!0)},registerEffect:et,required:U,variant:tt}),[$,b,E,C,ct,N,B,z,et,U,q,tt]);return rt.jsx(yE.Provider,{value:Mt,children:rt.jsx(aJ,xt({as:M,ownerState:F,className:In(D.root,y),ref:h},V,{children:g}))})}),cJ=lJ,uJ=vZ({createStyledComponent:mn("div",{name:"MuiStack",slot:"Root",overridesResolver:(i,s)=>s.root}),useThemeProps:i=>Sr({props:i,name:"MuiStack"})}),Mh=uJ;function hJ(i){return yr("MuiFormHelperText",i)}const dJ=wr("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),E3=dJ;var C3;const fJ=["children","className","component","disabled","error","filled","focused","margin","required","variant"],pJ=i=>{const{classes:s,contained:h,size:f,disabled:g,error:y,filled:b,focused:M,required:E}=i,C={root:["root",g&&"disabled",y&&"error",f&&`size${Ln(f)}`,h&&"contained",M&&"focused",b&&"filled",E&&"required"]};return br(C,hJ,s)},mJ=mn("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.root,h.size&&s[`size${Ln(h.size)}`],h.contained&&s.contained,h.filled&&s.filled]}})(({theme:i,ownerState:s})=>xt({color:(i.vars||i).palette.text.secondary},i.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${E3.disabled}`]:{color:(i.vars||i).palette.text.disabled},[`&.${E3.error}`]:{color:(i.vars||i).palette.error.main}},s.size==="small"&&{marginTop:4},s.contained&&{marginLeft:14,marginRight:14})),gJ=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiFormHelperText"}),{children:g,className:y,component:b="p"}=f,M=cn(f,fJ),E=Ed(),C=Sd({props:f,muiFormControl:E,states:["variant","size","disabled","error","filled","focused","required"]}),L=xt({},f,{component:b,contained:C.variant==="filled"||C.variant==="outlined",variant:C.variant,size:C.size,disabled:C.disabled,error:C.error,filled:C.filled,focused:C.focused,required:C.required}),B=pJ(L);return rt.jsx(mJ,xt({as:b,ownerState:L,className:In(B.root,y),ref:h},M,{children:g===" "?C3||(C3=rt.jsx("span",{className:"notranslate",children:""})):g}))}),_J=gJ;function yJ(i){return yr("MuiFormLabel",i)}const vJ=wr("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),gp=vJ,xJ=["children","className","color","component","disabled","error","filled","focused","required"],bJ=i=>{const{classes:s,color:h,focused:f,disabled:g,error:y,filled:b,required:M}=i,E={root:["root",`color${Ln(h)}`,g&&"disabled",y&&"error",b&&"filled",f&&"focused",M&&"required"],asterisk:["asterisk",y&&"error"]};return br(E,yJ,s)},wJ=mn("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:i},s)=>xt({},s.root,i.color==="secondary"&&s.colorSecondary,i.filled&&s.filled)})(({theme:i,ownerState:s})=>xt({color:(i.vars||i).palette.text.secondary},i.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${gp.focused}`]:{color:(i.vars||i).palette[s.color].main},[`&.${gp.disabled}`]:{color:(i.vars||i).palette.text.disabled},[`&.${gp.error}`]:{color:(i.vars||i).palette.error.main}})),TJ=mn("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(i,s)=>s.asterisk})(({theme:i})=>({[`&.${gp.error}`]:{color:(i.vars||i).palette.error.main}})),SJ=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiFormLabel"}),{children:g,className:y,component:b="label"}=f,M=cn(f,xJ),E=Ed(),C=Sd({props:f,muiFormControl:E,states:["color","required","focused","disabled","error","filled"]}),L=xt({},f,{color:C.color||"primary",component:b,disabled:C.disabled,error:C.error,filled:C.filled,focused:C.focused,required:C.required}),B=bJ(L);return rt.jsxs(wJ,xt({as:b,ownerState:L,className:In(B.root,y),ref:h},M,{children:[g,C.required&&rt.jsxs(TJ,{ownerState:L,"aria-hidden":!0,className:B.asterisk,children:["","*"]})]}))}),EJ=SJ,CJ=lt.createContext(),M3=CJ;function MJ(i){return yr("MuiGrid",i)}const IJ=[0,1,2,3,4,5,6,7,8,9,10],AJ=["column-reverse","column","row-reverse","row"],PJ=["nowrap","wrap-reverse","wrap"],Zf=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],Up=wr("MuiGrid",["root","container","item","zeroMinWidth",...IJ.map(i=>`spacing-xs-${i}`),...AJ.map(i=>`direction-xs-${i}`),...PJ.map(i=>`wrap-xs-${i}`),...Zf.map(i=>`grid-xs-${i}`),...Zf.map(i=>`grid-sm-${i}`),...Zf.map(i=>`grid-md-${i}`),...Zf.map(i=>`grid-lg-${i}`),...Zf.map(i=>`grid-xl-${i}`)]),RJ=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function Qh(i){const s=parseFloat(i);return`${s}${String(i).replace(String(s),"")||"px"}`}function kJ({theme:i,ownerState:s}){let h;return i.breakpoints.keys.reduce((f,g)=>{let y={};if(s[g]&&(h=s[g]),!h)return f;if(h===!0)y={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if(h==="auto")y={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const b=cu({values:s.columns,breakpoints:i.breakpoints.values}),M=typeof b=="object"?b[g]:b;if(M==null)return f;const E=`${Math.round(h/M*1e8)/1e6}%`;let C={};if(s.container&&s.item&&s.columnSpacing!==0){const L=i.spacing(s.columnSpacing);if(L!=="0px"){const B=`calc(${E} + ${Qh(L)})`;C={flexBasis:B,maxWidth:B}}}y=xt({flexBasis:E,flexGrow:0,maxWidth:E},C)}return i.breakpoints.values[g]===0?Object.assign(f,y):f[i.breakpoints.up(g)]=y,f},{})}function OJ({theme:i,ownerState:s}){const h=cu({values:s.direction,breakpoints:i.breakpoints.values});return Bo({theme:i},h,f=>{const g={flexDirection:f};return f.indexOf("column")===0&&(g[`& > .${Up.item}`]={maxWidth:"none"}),g})}function L5({breakpoints:i,values:s}){let h="";Object.keys(s).forEach(g=>{h===""&&s[g]!==0&&(h=g)});const f=Object.keys(i).sort((g,y)=>i[g]-i[y]);return f.slice(0,f.indexOf(h))}function LJ({theme:i,ownerState:s}){const{container:h,rowSpacing:f}=s;let g={};if(h&&f!==0){const y=cu({values:f,breakpoints:i.breakpoints.values});let b;typeof y=="object"&&(b=L5({breakpoints:i.breakpoints.values,values:y})),g=Bo({theme:i},y,(M,E)=>{var C;const L=i.spacing(M);return L!=="0px"?{marginTop:`-${Qh(L)}`,[`& > .${Up.item}`]:{paddingTop:Qh(L)}}:(C=b)!=null&&C.includes(E)?{}:{marginTop:0,[`& > .${Up.item}`]:{paddingTop:0}}})}return g}function zJ({theme:i,ownerState:s}){const{container:h,columnSpacing:f}=s;let g={};if(h&&f!==0){const y=cu({values:f,breakpoints:i.breakpoints.values});let b;typeof y=="object"&&(b=L5({breakpoints:i.breakpoints.values,values:y})),g=Bo({theme:i},y,(M,E)=>{var C;const L=i.spacing(M);return L!=="0px"?{width:`calc(100% + ${Qh(L)})`,marginLeft:`-${Qh(L)}`,[`& > .${Up.item}`]:{paddingLeft:Qh(L)}}:(C=b)!=null&&C.includes(E)?{}:{width:"100%",marginLeft:0,[`& > .${Up.item}`]:{paddingLeft:0}}})}return g}function DJ(i,s,h={}){if(!i||i<=0)return[];if(typeof i=="string"&&!Number.isNaN(Number(i))||typeof i=="number")return[h[`spacing-xs-${String(i)}`]];const f=[];return s.forEach(g=>{const y=i[g];Number(y)>0&&f.push(h[`spacing-${g}-${String(y)}`])}),f}const BJ=mn("div",{name:"MuiGrid",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i,{container:f,direction:g,item:y,spacing:b,wrap:M,zeroMinWidth:E,breakpoints:C}=h;let L=[];f&&(L=DJ(b,C,s));const B=[];return C.forEach(z=>{const H=h[z];H&&B.push(s[`grid-${z}-${String(H)}`])}),[s.root,f&&s.container,y&&s.item,E&&s.zeroMinWidth,...L,g!=="row"&&s[`direction-xs-${String(g)}`],M!=="wrap"&&s[`wrap-xs-${String(M)}`],...B]}})(({ownerState:i})=>xt({boxSizing:"border-box"},i.container&&{display:"flex",flexWrap:"wrap",width:"100%"},i.item&&{margin:0},i.zeroMinWidth&&{minWidth:0},i.wrap!=="wrap"&&{flexWrap:i.wrap}),OJ,LJ,zJ,kJ);function FJ(i,s){if(!i||i<=0)return[];if(typeof i=="string"&&!Number.isNaN(Number(i))||typeof i=="number")return[`spacing-xs-${String(i)}`];const h=[];return s.forEach(f=>{const g=i[f];if(Number(g)>0){const y=`spacing-${f}-${String(g)}`;h.push(y)}}),h}const NJ=i=>{const{classes:s,container:h,direction:f,item:g,spacing:y,wrap:b,zeroMinWidth:M,breakpoints:E}=i;let C=[];h&&(C=FJ(y,E));const L=[];E.forEach(z=>{const H=i[z];H&&L.push(`grid-${z}-${String(H)}`)});const B={root:["root",h&&"container",g&&"item",M&&"zeroMinWidth",...C,f!=="row"&&`direction-xs-${String(f)}`,b!=="wrap"&&`wrap-xs-${String(b)}`,...L]};return br(B,MJ,s)},jJ=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiGrid"}),{breakpoints:g}=Td(),y=Z0(f),{className:b,columns:M,columnSpacing:E,component:C="div",container:L=!1,direction:B="row",item:z=!1,rowSpacing:H,spacing:U=0,wrap:q="wrap",zeroMinWidth:tt=!1}=y,V=cn(y,RJ),F=H||U,D=E||U,$=lt.useContext(M3),J=L?M||12:$,ct={},st=xt({},V);g.keys.forEach(N=>{V[N]!=null&&(ct[N]=V[N],delete st[N])});const yt=xt({},y,{columns:J,container:L,direction:B,item:z,rowSpacing:F,columnSpacing:D,wrap:q,zeroMinWidth:tt,spacing:U},ct,{breakpoints:g.keys}),ut=NJ(yt);return rt.jsx(M3.Provider,{value:J,children:rt.jsx(BJ,xt({ownerState:yt,className:In(ut.root,b),as:C,ref:h},st))})}),pa=jJ,UJ=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function DT(i){return`scale(${i}, ${i**2})`}const $J={entering:{opacity:1,transform:DT(1)},entered:{opacity:1,transform:"none"}},mw=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),z5=lt.forwardRef(function(s,h){const{addEndListener:f,appear:g=!0,children:y,easing:b,in:M,onEnter:E,onEntered:C,onEntering:L,onExit:B,onExited:z,onExiting:H,style:U,timeout:q="auto",TransitionComponent:tt=pE}=s,V=cn(s,UJ),F=L4(),D=lt.useRef(),$=Td(),J=lt.useRef(null),ct=io(J,y.ref,h),st=Tt=>Vt=>{if(Tt){const ne=J.current;Vt===void 0?Tt(ne):Tt(ne,Vt)}},yt=st(L),ut=st((Tt,Vt)=>{_E(Tt);const{duration:ne,delay:Et,easing:$t}=fd({style:U,timeout:q,easing:b},{mode:"enter"});let ee;q==="auto"?(ee=$.transitions.getAutoHeightDuration(Tt.clientHeight),D.current=ee):ee=ne,Tt.style.transition=[$.transitions.create("opacity",{duration:ee,delay:Et}),$.transitions.create("transform",{duration:mw?ee:ee*.666,delay:Et,easing:$t})].join(","),E&&E(Tt,Vt)}),N=st(C),et=st(H),Mt=st(Tt=>{const{duration:Vt,delay:ne,easing:Et}=fd({style:U,timeout:q,easing:b},{mode:"exit"});let $t;q==="auto"?($t=$.transitions.getAutoHeightDuration(Tt.clientHeight),D.current=$t):$t=Vt,Tt.style.transition=[$.transitions.create("opacity",{duration:$t,delay:ne}),$.transitions.create("transform",{duration:mw?$t:$t*.666,delay:mw?ne:ne||$t*.333,easing:Et})].join(","),Tt.style.opacity=0,Tt.style.transform=DT(.75),B&&B(Tt)}),Lt=st(z),it=Tt=>{q==="auto"&&F.start(D.current||0,Tt),f&&f(J.current,Tt)};return rt.jsx(tt,xt({appear:g,in:M,nodeRef:J,onEnter:ut,onEntered:N,onEntering:yt,onExit:Mt,onExited:Lt,onExiting:et,addEndListener:it,timeout:q==="auto"?null:q},V,{children:(Tt,Vt)=>lt.cloneElement(y,xt({style:xt({opacity:0,transform:DT(.75),visibility:Tt==="exited"&&!M?"hidden":void 0},$J[Tt],U,y.props.style),ref:ct},Vt))}))});z5.muiSupportAuto=!0;const VJ=z5,GJ=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],WJ=i=>{const{classes:s,disableUnderline:h}=i,g=br({root:["root",!h&&"underline"],input:["input"]},VY,s);return xt({},s,g)},qJ=mn(rv,{shouldForwardProp:i=>Ms(i)||i==="classes",name:"MuiInput",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[...ev(i,s),!h.disableUnderline&&s.underline]}})(({theme:i,ownerState:s})=>{let f=i.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return i.vars&&(f=`rgba(${i.vars.palette.common.onBackgroundChannel} / ${i.vars.opacity.inputUnderline})`),xt({position:"relative"},s.formControl&&{"label + &":{marginTop:16}},!s.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(i.vars||i).palette[s.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:i.transitions.create("transform",{duration:i.transitions.duration.shorter,easing:i.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Wf.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Wf.error}`]:{"&::before, &::after":{borderBottomColor:(i.vars||i).palette.error.main}},"&::before":{borderBottom:`1px solid ${f}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:i.transitions.create("border-bottom-color",{duration:i.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Wf.disabled}, .${Wf.error}):before`]:{borderBottom:`2px solid ${(i.vars||i).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${f}`}},[`&.${Wf.disabled}:before`]:{borderBottomStyle:"dotted"}})}),HJ=mn(iv,{name:"MuiInput",slot:"Input",overridesResolver:nv})({}),D5=lt.forwardRef(function(s,h){var f,g,y,b;const M=Sr({props:s,name:"MuiInput"}),{disableUnderline:E,components:C={},componentsProps:L,fullWidth:B=!1,inputComponent:z="input",multiline:H=!1,slotProps:U,slots:q={},type:tt="text"}=M,V=cn(M,GJ),F=WJ(M),$={root:{ownerState:{disableUnderline:E}}},J=U??L?Lo(U??L,$):$,ct=(f=(g=q.root)!=null?g:C.Root)!=null?f:qJ,st=(y=(b=q.input)!=null?b:C.Input)!=null?y:HJ;return rt.jsx(vE,xt({slots:{root:ct,input:st},slotProps:J,fullWidth:B,inputComponent:z,multiline:H,ref:h,type:tt},V,{classes:F}))});D5.muiName="Input";const B5=D5;function ZJ(i){return yr("MuiInputLabel",i)}wr("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const XJ=["disableAnimation","margin","shrink","variant","className"],KJ=i=>{const{classes:s,formControl:h,size:f,shrink:g,disableAnimation:y,variant:b,required:M}=i,E={root:["root",h&&"formControl",!y&&"animated",g&&"shrink",f&&f!=="normal"&&`size${Ln(f)}`,b],asterisk:[M&&"asterisk"]},C=br(E,ZJ,s);return xt({},s,C)},YJ=mn(EJ,{shouldForwardProp:i=>Ms(i)||i==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[{[`& .${gp.asterisk}`]:s.asterisk},s.root,h.formControl&&s.formControl,h.size==="small"&&s.sizeSmall,h.shrink&&s.shrink,!h.disableAnimation&&s.animated,h.focused&&s.focused,s[h.variant]]}})(({theme:i,ownerState:s})=>xt({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},s.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},s.size==="small"&&{transform:"translate(0, 17px) scale(1)"},s.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!s.disableAnimation&&{transition:i.transitions.create(["color","transform","max-width"],{duration:i.transitions.duration.shorter,easing:i.transitions.easing.easeOut})},s.variant==="filled"&&xt({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},s.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},s.shrink&&xt({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},s.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),s.variant==="outlined"&&xt({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},s.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},s.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),QJ=lt.forwardRef(function(s,h){const f=Sr({name:"MuiInputLabel",props:s}),{disableAnimation:g=!1,shrink:y,className:b}=f,M=cn(f,XJ),E=Ed();let C=y;typeof C>"u"&&E&&(C=E.filled||E.focused||E.adornedStart);const L=Sd({props:f,muiFormControl:E,states:["size","variant","required","focused"]}),B=xt({},f,{disableAnimation:g,formControl:E,shrink:C,size:L.size,variant:L.variant,required:L.required,focused:L.focused}),z=KJ(B);return rt.jsx(YJ,xt({"data-shrink":C,ownerState:B,ref:h,className:In(z.root,b)},M,{classes:z}))}),JJ=QJ,t2=lt.createContext({}),e2=t2;function n2(i){return yr("MuiList",i)}wr("MuiList",["root","padding","dense","subheader"]);const r2=["children","className","component","dense","disablePadding","subheader"],i2=i=>{const{classes:s,disablePadding:h,dense:f,subheader:g}=i;return br({root:["root",!h&&"padding",f&&"dense",g&&"subheader"]},n2,s)},o2=mn("ul",{name:"MuiList",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.root,!h.disablePadding&&s.padding,h.dense&&s.dense,h.subheader&&s.subheader]}})(({ownerState:i})=>xt({listStyle:"none",margin:0,padding:0,position:"relative"},!i.disablePadding&&{paddingTop:8,paddingBottom:8},i.subheader&&{paddingTop:0})),s2=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiList"}),{children:g,className:y,component:b="ul",dense:M=!1,disablePadding:E=!1,subheader:C}=f,L=cn(f,r2),B=lt.useMemo(()=>({dense:M}),[M]),z=xt({},f,{component:b,dense:M,disablePadding:E}),H=i2(z);return rt.jsx(e2.Provider,{value:B,children:rt.jsxs(o2,xt({as:b,className:In(H.root,y),ref:h,ownerState:z},L,{children:[C,g]}))})}),a2=s2,l2=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function gw(i,s,h){return i===s?i.firstChild:s&&s.nextElementSibling?s.nextElementSibling:h?null:i.firstChild}function I3(i,s,h){return i===s?h?i.firstChild:i.lastChild:s&&s.previousElementSibling?s.previousElementSibling:h?null:i.lastChild}function F5(i,s){if(s===void 0)return!0;let h=i.innerText;return h===void 0&&(h=i.textContent),h=h.trim().toLowerCase(),h.length===0?!1:s.repeating?h[0]===s.keys[0]:h.indexOf(s.keys.join(""))===0}function Xf(i,s,h,f,g,y){let b=!1,M=g(i,s,s?h:!1);for(;M;){if(M===i.firstChild){if(b)return!1;b=!0}const E=f?!1:M.disabled||M.getAttribute("aria-disabled")==="true";if(!M.hasAttribute("tabindex")||!F5(M,y)||E)M=g(i,M,h);else return M.focus(),!0}return!1}const c2=lt.forwardRef(function(s,h){const{actions:f,autoFocus:g=!1,autoFocusItem:y=!1,children:b,className:M,disabledItemsFocusable:E=!1,disableListWrap:C=!1,onKeyDown:L,variant:B="selectedMenu"}=s,z=cn(s,l2),H=lt.useRef(null),U=lt.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});cc(()=>{g&&H.current.focus()},[g]),lt.useImperativeHandle(f,()=>({adjustStyleForScrollbar:(D,$)=>{const J=!H.current.style.width;if(D.clientHeight<H.current.clientHeight&&J){const ct=`${D4(zo(D))}px`;H.current.style[$.direction==="rtl"?"paddingLeft":"paddingRight"]=ct,H.current.style.width=`calc(100% + ${ct})`}return H.current}}),[]);const q=D=>{const $=H.current,J=D.key,ct=zo($).activeElement;if(J==="ArrowDown")D.preventDefault(),Xf($,ct,C,E,gw);else if(J==="ArrowUp")D.preventDefault(),Xf($,ct,C,E,I3);else if(J==="Home")D.preventDefault(),Xf($,null,C,E,gw);else if(J==="End")D.preventDefault(),Xf($,null,C,E,I3);else if(J.length===1){const st=U.current,yt=J.toLowerCase(),ut=performance.now();st.keys.length>0&&(ut-st.lastTime>500?(st.keys=[],st.repeating=!0,st.previousKeyMatched=!0):st.repeating&&yt!==st.keys[0]&&(st.repeating=!1)),st.lastTime=ut,st.keys.push(yt);const N=ct&&!st.repeating&&F5(ct,st);st.previousKeyMatched&&(N||Xf($,ct,!1,E,gw,st))?D.preventDefault():st.previousKeyMatched=!1}L&&L(D)},tt=io(H,h);let V=-1;lt.Children.forEach(b,(D,$)=>{if(!lt.isValidElement(D)){V===$&&(V+=1,V>=b.length&&(V=-1));return}D.props.disabled||(B==="selectedMenu"&&D.props.selected||V===-1)&&(V=$),V===$&&(D.props.disabled||D.props.muiSkipListHighlight||D.type.muiSkipListHighlight)&&(V+=1,V>=b.length&&(V=-1))});const F=lt.Children.map(b,(D,$)=>{if($===V){const J={};return y&&(J.autoFocus=!0),D.props.tabIndex===void 0&&B==="selectedMenu"&&(J.tabIndex=0),lt.cloneElement(D,J)}return D});return rt.jsx(a2,xt({role:"menu",ref:tt,className:M,onKeyDown:q,tabIndex:g?0:-1},z,{children:F}))}),u2=c2;function h2(i){return yr("MuiPopover",i)}wr("MuiPopover",["root","paper"]);const d2=["onEntering"],f2=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],p2=["slotProps"];function A3(i,s){let h=0;return typeof s=="number"?h=s:s==="center"?h=i.height/2:s==="bottom"&&(h=i.height),h}function P3(i,s){let h=0;return typeof s=="number"?h=s:s==="center"?h=i.width/2:s==="right"&&(h=i.width),h}function R3(i){return[i.horizontal,i.vertical].map(s=>typeof s=="number"?`${s}px`:s).join(" ")}function _w(i){return typeof i=="function"?i():i}const m2=i=>{const{classes:s}=i;return br({root:["root"],paper:["paper"]},h2,s)},g2=mn(A5,{name:"MuiPopover",slot:"Root",overridesResolver:(i,s)=>s.root})({}),N5=mn(J0,{name:"MuiPopover",slot:"Paper",overridesResolver:(i,s)=>s.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),_2=lt.forwardRef(function(s,h){var f,g,y;const b=Sr({props:s,name:"MuiPopover"}),{action:M,anchorEl:E,anchorOrigin:C={vertical:"top",horizontal:"left"},anchorPosition:L,anchorReference:B="anchorEl",children:z,className:H,container:U,elevation:q=8,marginThreshold:tt=16,open:V,PaperProps:F={},slots:D,slotProps:$,transformOrigin:J={vertical:"top",horizontal:"left"},TransitionComponent:ct=VJ,transitionDuration:st="auto",TransitionProps:{onEntering:yt}={},disableScrollLock:ut=!1}=b,N=cn(b.TransitionProps,d2),et=cn(b,f2),Mt=(f=$==null?void 0:$.paper)!=null?f:F,Lt=lt.useRef(),it=io(Lt,Mt.ref),Tt=xt({},b,{anchorOrigin:C,anchorReference:B,elevation:q,marginThreshold:tt,externalPaperSlotProps:Mt,transformOrigin:J,TransitionComponent:ct,transitionDuration:st,TransitionProps:N}),Vt=m2(Tt),ne=lt.useCallback(()=>{if(B==="anchorPosition")return L;const De=_w(E),An=(De&&De.nodeType===1?De:zo(Lt.current).body).getBoundingClientRect();return{top:An.top+A3(An,C.vertical),left:An.left+P3(An,C.horizontal)}},[E,C.horizontal,C.vertical,L,B]),Et=lt.useCallback(De=>({vertical:A3(De,J.vertical),horizontal:P3(De,J.horizontal)}),[J.horizontal,J.vertical]),$t=lt.useCallback(De=>{const Ue={width:De.offsetWidth,height:De.offsetHeight},An=Et(Ue);if(B==="none")return{top:null,left:null,transformOrigin:R3(An)};const vn=ne();let Zt=vn.top-An.vertical,Y=vn.left-An.horizontal;const nt=Zt+Ue.height,dt=Y+Ue.width,Bt=Ta(_w(E)),Wt=Bt.innerHeight-tt,ae=Bt.innerWidth-tt;if(tt!==null&&Zt<tt){const ce=Zt-tt;Zt-=ce,An.vertical+=ce}else if(tt!==null&&nt>Wt){const ce=nt-Wt;Zt-=ce,An.vertical+=ce}if(tt!==null&&Y<tt){const ce=Y-tt;Y-=ce,An.horizontal+=ce}else if(dt>ae){const ce=dt-ae;Y-=ce,An.horizontal+=ce}return{top:`${Math.round(Zt)}px`,left:`${Math.round(Y)}px`,transformOrigin:R3(An)}},[E,B,ne,Et,tt]),[ee,Ee]=lt.useState(V),jt=lt.useCallback(()=>{const De=Lt.current;if(!De)return;const Ue=$t(De);Ue.top!==null&&(De.style.top=Ue.top),Ue.left!==null&&(De.style.left=Ue.left),De.style.transformOrigin=Ue.transformOrigin,Ee(!0)},[$t]);lt.useEffect(()=>(ut&&window.addEventListener("scroll",jt),()=>window.removeEventListener("scroll",jt)),[E,ut,jt]);const Le=(De,Ue)=>{yt&&yt(De,Ue),jt()},we=()=>{Ee(!1)};lt.useEffect(()=>{V&&jt()}),lt.useImperativeHandle(M,()=>V?{updatePosition:()=>{jt()}}:null,[V,jt]),lt.useEffect(()=>{if(!V)return;const De=T0(()=>{jt()}),Ue=Ta(E);return Ue.addEventListener("resize",De),()=>{De.clear(),Ue.removeEventListener("resize",De)}},[E,V,jt]);let kt=st;st==="auto"&&!ct.muiSupportAuto&&(kt=void 0);const Xt=U||(E?zo(_w(E)).body:void 0),Ot=(g=D==null?void 0:D.root)!=null?g:g2,Pe=(y=D==null?void 0:D.paper)!=null?y:N5,ie=pd({elementType:Pe,externalSlotProps:xt({},Mt,{style:ee?Mt.style:xt({},Mt.style,{opacity:0})}),additionalProps:{elevation:q,ref:it},ownerState:Tt,className:In(Vt.paper,Mt==null?void 0:Mt.className)}),Ne=pd({elementType:Ot,externalSlotProps:($==null?void 0:$.root)||{},externalForwardedProps:et,additionalProps:{ref:h,slotProps:{backdrop:{invisible:!0}},container:Xt,open:V},ownerState:Tt,className:In(Vt.root,H)}),{slotProps:Fe}=Ne,je=cn(Ne,p2);return rt.jsx(Ot,xt({},je,!By(Ot)&&{slotProps:Fe,disableScrollLock:ut},{children:rt.jsx(ct,xt({appear:!0,in:V,onEntering:Le,onExited:we,timeout:kt},N,{children:rt.jsx(Pe,xt({},ie,{children:z}))}))}))}),y2=_2;function v2(i){return yr("MuiMenu",i)}wr("MuiMenu",["root","paper","list"]);const x2=["onEntering"],b2=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],w2={vertical:"top",horizontal:"right"},T2={vertical:"top",horizontal:"left"},S2=i=>{const{classes:s}=i;return br({root:["root"],paper:["paper"],list:["list"]},v2,s)},E2=mn(y2,{shouldForwardProp:i=>Ms(i)||i==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(i,s)=>s.root})({}),C2=mn(N5,{name:"MuiMenu",slot:"Paper",overridesResolver:(i,s)=>s.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),M2=mn(u2,{name:"MuiMenu",slot:"List",overridesResolver:(i,s)=>s.list})({outline:0}),I2=lt.forwardRef(function(s,h){var f,g;const y=Sr({props:s,name:"MuiMenu"}),{autoFocus:b=!0,children:M,className:E,disableAutoFocusItem:C=!1,MenuListProps:L={},onClose:B,open:z,PaperProps:H={},PopoverClasses:U,transitionDuration:q="auto",TransitionProps:{onEntering:tt}={},variant:V="selectedMenu",slots:F={},slotProps:D={}}=y,$=cn(y.TransitionProps,x2),J=cn(y,b2),ct=Td(),st=ct.direction==="rtl",yt=xt({},y,{autoFocus:b,disableAutoFocusItem:C,MenuListProps:L,onEntering:tt,PaperProps:H,transitionDuration:q,TransitionProps:$,variant:V}),ut=S2(yt),N=b&&!C&&z,et=lt.useRef(null),Mt=($t,ee)=>{et.current&&et.current.adjustStyleForScrollbar($t,ct),tt&&tt($t,ee)},Lt=$t=>{$t.key==="Tab"&&($t.preventDefault(),B&&B($t,"tabKeyDown"))};let it=-1;lt.Children.map(M,($t,ee)=>{lt.isValidElement($t)&&($t.props.disabled||(V==="selectedMenu"&&$t.props.selected||it===-1)&&(it=ee))});const Tt=(f=F.paper)!=null?f:C2,Vt=(g=D.paper)!=null?g:H,ne=pd({elementType:F.root,externalSlotProps:D.root,ownerState:yt,className:[ut.root,E]}),Et=pd({elementType:Tt,externalSlotProps:Vt,ownerState:yt,className:ut.paper});return rt.jsx(E2,xt({onClose:B,anchorOrigin:{vertical:"bottom",horizontal:st?"right":"left"},transformOrigin:st?w2:T2,slots:{paper:Tt,root:F.root},slotProps:{root:ne,paper:Et},open:z,ref:h,transitionDuration:q,TransitionProps:xt({onEntering:Mt},$),ownerState:yt},J,{classes:U,children:rt.jsx(M2,xt({onKeyDown:Lt,actions:et,autoFocus:b&&(it===-1||C),autoFocusItem:N,variant:V},L,{className:In(ut.list,L.className),children:M}))}))}),A2=I2;function P2(i){return yr("MuiNativeSelect",i)}const R2=wr("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),xE=R2,k2=["className","disabled","error","IconComponent","inputRef","variant"],O2=i=>{const{classes:s,variant:h,disabled:f,multiple:g,open:y,error:b}=i,M={select:["select",h,f&&"disabled",g&&"multiple",b&&"error"],icon:["icon",`icon${Ln(h)}`,y&&"iconOpen",f&&"disabled"]};return br(M,P2,s)},j5=({ownerState:i,theme:s})=>xt({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":xt({},s.vars?{backgroundColor:`rgba(${s.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:s.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${xE.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(s.vars||s).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},i.variant==="filled"&&{"&&&":{paddingRight:32}},i.variant==="outlined"&&{borderRadius:(s.vars||s).shape.borderRadius,"&:focus":{borderRadius:(s.vars||s).shape.borderRadius},"&&&":{paddingRight:32}}),L2=mn("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Ms,overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.select,s[h.variant],h.error&&s.error,{[`&.${xE.multiple}`]:s.multiple}]}})(j5),U5=({ownerState:i,theme:s})=>xt({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(s.vars||s).palette.action.active,[`&.${xE.disabled}`]:{color:(s.vars||s).palette.action.disabled}},i.open&&{transform:"rotate(180deg)"},i.variant==="filled"&&{right:7},i.variant==="outlined"&&{right:7}),z2=mn("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.icon,h.variant&&s[`icon${Ln(h.variant)}`],h.open&&s.iconOpen]}})(U5),D2=lt.forwardRef(function(s,h){const{className:f,disabled:g,error:y,IconComponent:b,inputRef:M,variant:E="standard"}=s,C=cn(s,k2),L=xt({},s,{disabled:g,variant:E,error:y}),B=O2(L);return rt.jsxs(lt.Fragment,{children:[rt.jsx(L2,xt({ownerState:L,className:In(B.select,f),disabled:g,ref:M||h},C)),s.multiple?null:rt.jsx(z2,{as:b,ownerState:L,className:B.icon})]})}),B2=D2;var k3;const F2=["children","classes","className","label","notched"],N2=mn("fieldset",{shouldForwardProp:Ms})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),j2=mn("legend",{shouldForwardProp:Ms})(({ownerState:i,theme:s})=>xt({float:"unset",width:"auto",overflow:"hidden"},!i.withLabel&&{padding:0,lineHeight:"11px",transition:s.transitions.create("width",{duration:150,easing:s.transitions.easing.easeOut})},i.withLabel&&xt({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:s.transitions.create("max-width",{duration:50,easing:s.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},i.notched&&{maxWidth:"100%",transition:s.transitions.create("max-width",{duration:100,easing:s.transitions.easing.easeOut,delay:50})})));function U2(i){const{className:s,label:h,notched:f}=i,g=cn(i,F2),y=h!=null&&h!=="",b=xt({},i,{notched:f,withLabel:y});return rt.jsx(N2,xt({"aria-hidden":!0,className:s,ownerState:b},g,{children:rt.jsx(j2,{ownerState:b,children:y?rt.jsx("span",{children:h}):k3||(k3=rt.jsx("span",{className:"notranslate",children:""}))})}))}const $2=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],V2=i=>{const{classes:s}=i,f=br({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},WY,s);return xt({},s,f)},G2=mn(rv,{shouldForwardProp:i=>Ms(i)||i==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:ev})(({theme:i,ownerState:s})=>{const h=i.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return xt({position:"relative",borderRadius:(i.vars||i).shape.borderRadius,[`&:hover .${jl.notchedOutline}`]:{borderColor:(i.vars||i).palette.text.primary},"@media (hover: none)":{[`&:hover .${jl.notchedOutline}`]:{borderColor:i.vars?`rgba(${i.vars.palette.common.onBackgroundChannel} / 0.23)`:h}},[`&.${jl.focused} .${jl.notchedOutline}`]:{borderColor:(i.vars||i).palette[s.color].main,borderWidth:2},[`&.${jl.error} .${jl.notchedOutline}`]:{borderColor:(i.vars||i).palette.error.main},[`&.${jl.disabled} .${jl.notchedOutline}`]:{borderColor:(i.vars||i).palette.action.disabled}},s.startAdornment&&{paddingLeft:14},s.endAdornment&&{paddingRight:14},s.multiline&&xt({padding:"16.5px 14px"},s.size==="small"&&{padding:"8.5px 14px"}))}),W2=mn(U2,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(i,s)=>s.notchedOutline})(({theme:i})=>{const s=i.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:i.vars?`rgba(${i.vars.palette.common.onBackgroundChannel} / 0.23)`:s}}),q2=mn(iv,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:nv})(({theme:i,ownerState:s})=>xt({padding:"16.5px 14px"},!i.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:i.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:i.palette.mode==="light"?null:"#fff",caretColor:i.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},i.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[i.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},s.size==="small"&&{padding:"8.5px 14px"},s.multiline&&{padding:0},s.startAdornment&&{paddingLeft:0},s.endAdornment&&{paddingRight:0})),$5=lt.forwardRef(function(s,h){var f,g,y,b,M;const E=Sr({props:s,name:"MuiOutlinedInput"}),{components:C={},fullWidth:L=!1,inputComponent:B="input",label:z,multiline:H=!1,notched:U,slots:q={},type:tt="text"}=E,V=cn(E,$2),F=V2(E),D=Ed(),$=Sd({props:E,muiFormControl:D,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),J=xt({},E,{color:$.color||"primary",disabled:$.disabled,error:$.error,focused:$.focused,formControl:D,fullWidth:L,hiddenLabel:$.hiddenLabel,multiline:H,size:$.size,type:tt}),ct=(f=(g=q.root)!=null?g:C.Root)!=null?f:G2,st=(y=(b=q.input)!=null?b:C.Input)!=null?y:q2;return rt.jsx(vE,xt({slots:{root:ct,input:st},renderSuffix:yt=>rt.jsx(W2,{ownerState:J,className:F.notchedOutline,label:z!=null&&z!==""&&$.required?M||(M=rt.jsxs(lt.Fragment,{children:[z,"","*"]})):z,notched:typeof U<"u"?U:!!(yt.startAdornment||yt.filled||yt.focused)}),fullWidth:L,inputComponent:B,multiline:H,ref:h,type:tt},V,{classes:xt({},F,{notchedOutline:null})}))});$5.muiName="Input";const V5=$5;function H2(i){return yr("MuiSelect",i)}const Kf=wr("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var O3;const Z2=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],X2=mn("div",{name:"MuiSelect",slot:"Select",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[{[`&.${Kf.select}`]:s.select},{[`&.${Kf.select}`]:s[h.variant]},{[`&.${Kf.error}`]:s.error},{[`&.${Kf.multiple}`]:s.multiple}]}})(j5,{[`&.${Kf.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),K2=mn("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.icon,h.variant&&s[`icon${Ln(h.variant)}`],h.open&&s.iconOpen]}})(U5),Y2=mn("input",{shouldForwardProp:i=>tX(i)&&i!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(i,s)=>s.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function L3(i,s){return typeof s=="object"&&s!==null?i===s:String(i)===String(s)}function Q2(i){return i==null||typeof i=="string"&&!i.trim()}const J2=i=>{const{classes:s,variant:h,disabled:f,multiple:g,open:y,error:b}=i,M={select:["select",h,f&&"disabled",g&&"multiple",b&&"error"],icon:["icon",`icon${Ln(h)}`,y&&"iconOpen",f&&"disabled"],nativeInput:["nativeInput"]};return br(M,H2,s)},ttt=lt.forwardRef(function(s,h){var f;const{"aria-describedby":g,"aria-label":y,autoFocus:b,autoWidth:M,children:E,className:C,defaultOpen:L,defaultValue:B,disabled:z,displayEmpty:H,error:U=!1,IconComponent:q,inputRef:tt,labelId:V,MenuProps:F={},multiple:D,name:$,onBlur:J,onChange:ct,onClose:st,onFocus:yt,onOpen:ut,open:N,readOnly:et,renderValue:Mt,SelectDisplayProps:Lt={},tabIndex:it,value:Tt,variant:Vt="standard"}=s,ne=cn(s,Z2),[Et,$t]=ST({controlled:Tt,default:B,name:"Select"}),[ee,Ee]=ST({controlled:N,default:L,name:"Select"}),jt=lt.useRef(null),Le=lt.useRef(null),[we,kt]=lt.useState(null),{current:Xt}=lt.useRef(N!=null),[Ot,Pe]=lt.useState(),ie=io(h,tt),Ne=lt.useCallback(ke=>{Le.current=ke,ke&&kt(ke)},[]),Fe=we==null?void 0:we.parentNode;lt.useImperativeHandle(ie,()=>({focus:()=>{Le.current.focus()},node:jt.current,value:Et}),[Et]),lt.useEffect(()=>{L&&ee&&we&&!Xt&&(Pe(M?null:Fe.clientWidth),Le.current.focus())},[we,M]),lt.useEffect(()=>{b&&Le.current.focus()},[b]),lt.useEffect(()=>{if(!V)return;const ke=zo(Le.current).getElementById(V);if(ke){const $e=()=>{getSelection().isCollapsed&&Le.current.focus()};return ke.addEventListener("click",$e),()=>{ke.removeEventListener("click",$e)}}},[V]);const je=(ke,$e)=>{ke?ut&&ut($e):st&&st($e),Xt||(Pe(M?null:Fe.clientWidth),Ee(ke))},De=ke=>{ke.button===0&&(ke.preventDefault(),Le.current.focus(),je(!0,ke))},Ue=ke=>{je(!1,ke)},An=lt.Children.toArray(E),vn=ke=>{const $e=An.find(Nn=>Nn.props.value===ke.target.value);$e!==void 0&&($t($e.props.value),ct&&ct(ke,$e))},Zt=ke=>$e=>{let Nn;if($e.currentTarget.hasAttribute("tabindex")){if(D){Nn=Array.isArray(Et)?Et.slice():[];const ar=Et.indexOf(ke.props.value);ar===-1?Nn.push(ke.props.value):Nn.splice(ar,1)}else Nn=ke.props.value;if(ke.props.onClick&&ke.props.onClick($e),Et!==Nn&&($t(Nn),ct)){const ar=$e.nativeEvent||$e,Gr=new ar.constructor(ar.type,ar);Object.defineProperty(Gr,"target",{writable:!0,value:{value:Nn,name:$}}),ct(Gr,ke)}D||je(!1,$e)}},Y=ke=>{et||[" ","ArrowUp","ArrowDown","Enter"].indexOf(ke.key)!==-1&&(ke.preventDefault(),je(!0,ke))},nt=we!==null&&ee,dt=ke=>{!nt&&J&&(Object.defineProperty(ke,"target",{writable:!0,value:{value:Et,name:$}}),J(ke))};delete ne["aria-invalid"];let Bt,Wt;const ae=[];let ce=!1;(Fy({value:Et})||H)&&(Mt?Bt=Mt(Et):ce=!0);const qt=An.map(ke=>{if(!lt.isValidElement(ke))return null;let $e;if(D){if(!Array.isArray(Et))throw new Error(lc(2));$e=Et.some(Nn=>L3(Nn,ke.props.value)),$e&&ce&&ae.push(ke.props.children)}else $e=L3(Et,ke.props.value),$e&&ce&&(Wt=ke.props.children);return lt.cloneElement(ke,{"aria-selected":$e?"true":"false",onClick:Zt(ke),onKeyUp:Nn=>{Nn.key===" "&&Nn.preventDefault(),ke.props.onKeyUp&&ke.props.onKeyUp(Nn)},role:"option",selected:$e,value:void 0,"data-value":ke.props.value})});ce&&(D?ae.length===0?Bt=null:Bt=ae.reduce((ke,$e,Nn)=>(ke.push($e),Nn<ae.length-1&&ke.push(", "),ke),[]):Bt=Wt);let Ce=Ot;!M&&Xt&&we&&(Ce=Fe.clientWidth);let Re;typeof it<"u"?Re=it:Re=z?null:0;const be=Lt.id||($?`mui-component-select-${$}`:void 0),Me=xt({},s,{variant:Vt,value:Et,open:nt,error:U}),zn=J2(Me),er=xt({},F.PaperProps,(f=F.slotProps)==null?void 0:f.paper),Fn=VS();return rt.jsxs(lt.Fragment,{children:[rt.jsx(X2,xt({ref:Ne,tabIndex:Re,role:"combobox","aria-controls":Fn,"aria-disabled":z?"true":void 0,"aria-expanded":nt?"true":"false","aria-haspopup":"listbox","aria-label":y,"aria-labelledby":[V,be].filter(Boolean).join(" ")||void 0,"aria-describedby":g,onKeyDown:Y,onMouseDown:z||et?null:De,onBlur:dt,onFocus:yt},Lt,{ownerState:Me,className:In(Lt.className,zn.select,C),id:be,children:Q2(Bt)?O3||(O3=rt.jsx("span",{className:"notranslate",children:""})):Bt})),rt.jsx(Y2,xt({"aria-invalid":U,value:Array.isArray(Et)?Et.join(","):Et,name:$,ref:jt,"aria-hidden":!0,onChange:vn,tabIndex:-1,disabled:z,className:zn.nativeInput,autoFocus:b,ownerState:Me},ne)),rt.jsx(K2,{as:q,className:zn.icon,ownerState:Me}),rt.jsx(A2,xt({id:`menu-${$||""}`,anchorEl:Fe,open:nt,onClose:Ue,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},F,{MenuListProps:xt({"aria-labelledby":V,role:"listbox","aria-multiselectable":D?"true":void 0,disableListWrap:!0,id:Fn},F.MenuListProps),slotProps:xt({},F.slotProps,{paper:xt({},er,{style:xt({minWidth:Ce},er!=null?er.style:null)})}),children:qt}))]})}),ett=ttt,ntt=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],rtt=["root"],itt=i=>{const{classes:s}=i;return s},bE={name:"MuiSelect",overridesResolver:(i,s)=>s.root,shouldForwardProp:i=>Ms(i)&&i!=="variant",slot:"Root"},ott=mn(B5,bE)(""),stt=mn(V5,bE)(""),att=mn(O5,bE)(""),G5=lt.forwardRef(function(s,h){const f=Sr({name:"MuiSelect",props:s}),{autoWidth:g=!1,children:y,classes:b={},className:M,defaultOpen:E=!1,displayEmpty:C=!1,IconComponent:L=XY,id:B,input:z,inputProps:H,label:U,labelId:q,MenuProps:tt,multiple:V=!1,native:F=!1,onClose:D,onOpen:$,open:J,renderValue:ct,SelectDisplayProps:st,variant:yt="outlined"}=f,ut=cn(f,ntt),N=F?B2:ett,et=Ed(),Mt=Sd({props:f,muiFormControl:et,states:["variant","error"]}),Lt=Mt.variant||yt,it=xt({},f,{variant:Lt,classes:b}),Tt=itt(it),Vt=cn(Tt,rtt),ne=z||{standard:rt.jsx(ott,{ownerState:it}),outlined:rt.jsx(stt,{label:U,ownerState:it}),filled:rt.jsx(att,{ownerState:it})}[Lt],Et=io(h,ne.ref);return rt.jsx(lt.Fragment,{children:lt.cloneElement(ne,xt({inputComponent:N,inputProps:xt({children:y,error:Mt.error,IconComponent:L,variant:Lt,type:void 0,multiple:V},F?{id:B}:{autoWidth:g,defaultOpen:E,displayEmpty:C,labelId:q,MenuProps:tt,onClose:D,onOpen:$,open:J,renderValue:ct,SelectDisplayProps:xt({id:B},st)},H,{classes:H?Lo(Vt,H.classes):Vt},z?z.props.inputProps:{})},(V&&F||C)&&Lt==="outlined"?{notched:!0}:{},{ref:Et,className:In(ne.props.className,M,Tt.root)},!z&&{variant:Lt},ut))})});G5.muiName="Select";const ltt=G5;function ctt(i){return yr("MuiToolbar",i)}wr("MuiToolbar",["root","gutters","regular","dense"]);const utt=["className","component","disableGutters","variant"],htt=i=>{const{classes:s,disableGutters:h,variant:f}=i;return br({root:["root",!h&&"gutters",f]},ctt,s)},dtt=mn("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:h}=i;return[s.root,!h.disableGutters&&s.gutters,s[h.variant]]}})(({theme:i,ownerState:s})=>xt({position:"relative",display:"flex",alignItems:"center"},!s.disableGutters&&{paddingLeft:i.spacing(2),paddingRight:i.spacing(2),[i.breakpoints.up("sm")]:{paddingLeft:i.spacing(3),paddingRight:i.spacing(3)}},s.variant==="dense"&&{minHeight:48}),({theme:i,ownerState:s})=>s.variant==="regular"&&i.mixins.toolbar),ftt=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiToolbar"}),{className:g,component:y="div",disableGutters:b=!1,variant:M="regular"}=f,E=cn(f,utt),C=xt({},f,{component:y,disableGutters:b,variant:M}),L=htt(C);return rt.jsx(dtt,xt({as:y,className:In(L.root,g),ref:h,ownerState:C},E))}),ptt=ftt;function mtt(i){return yr("MuiTextField",i)}wr("MuiTextField",["root"]);const gtt=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],_tt={standard:B5,filled:O5,outlined:V5},ytt=i=>{const{classes:s}=i;return br({root:["root"]},mtt,s)},vtt=mn(cJ,{name:"MuiTextField",slot:"Root",overridesResolver:(i,s)=>s.root})({}),xtt=lt.forwardRef(function(s,h){const f=Sr({props:s,name:"MuiTextField"}),{autoComplete:g,autoFocus:y=!1,children:b,className:M,color:E="primary",defaultValue:C,disabled:L=!1,error:B=!1,FormHelperTextProps:z,fullWidth:H=!1,helperText:U,id:q,InputLabelProps:tt,inputProps:V,InputProps:F,inputRef:D,label:$,maxRows:J,minRows:ct,multiline:st=!1,name:yt,onBlur:ut,onChange:N,onFocus:et,placeholder:Mt,required:Lt=!1,rows:it,select:Tt=!1,SelectProps:Vt,type:ne,value:Et,variant:$t="outlined"}=f,ee=cn(f,gtt),Ee=xt({},f,{autoFocus:y,color:E,disabled:L,error:B,fullWidth:H,multiline:st,required:Lt,select:Tt,variant:$t}),jt=ytt(Ee),Le={};$t==="outlined"&&(tt&&typeof tt.shrink<"u"&&(Le.notched=tt.shrink),Le.label=$),Tt&&((!Vt||!Vt.native)&&(Le.id=void 0),Le["aria-describedby"]=void 0);const we=VS(q),kt=U&&we?`${we}-helper-text`:void 0,Xt=$&&we?`${we}-label`:void 0,Ot=_tt[$t],Pe=rt.jsx(Ot,xt({"aria-describedby":kt,autoComplete:g,autoFocus:y,defaultValue:C,fullWidth:H,multiline:st,name:yt,rows:it,maxRows:J,minRows:ct,type:ne,value:Et,id:we,inputRef:D,onBlur:ut,onChange:N,onFocus:et,placeholder:Mt,inputProps:V},Le,F));return rt.jsxs(vtt,xt({className:In(jt.root,M),disabled:L,error:B,fullWidth:H,ref:h,required:Lt,color:E,variant:$t,ownerState:Ee},ee,{children:[$!=null&&$!==""&&rt.jsx(JJ,xt({htmlFor:we,id:Xt},tt,{children:$})),Tt?rt.jsx(ltt,xt({"aria-describedby":kt,id:we,labelId:Xt,value:Et,input:Pe},Vt,{children:b})):Pe,U&&rt.jsx(_J,xt({id:kt},z,{children:U}))]}))}),Wc=xtt;function btt(){const i=x5(),[s,h]=lt.useState(!1);lt.useEffect(()=>{sessionStorage.getItem("jwt")&&i("/homepage")});const[f,g]=lt.useState({usernameLogin:"",passwordLogin:""}),y=z=>{const{name:H,value:U}=z.target;g({...f,[H]:U})},b=async z=>{z.preventDefault();try{const H=await fetch("/User/credentials/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Username:f.usernameLogin,Password:f.passwordLogin})});H.ok?H.json().then(U=>{const q=U.token;sessionStorage.setItem("jwt",q),i("/homepage")}):console.log("Error")}catch{console.log("Error while registering form")}console.log(f)},[M,E]=lt.useState({usernameRegister:"",emailRegister:"",passwordRegister:"",firstnameRegister:"",lastnameRegister:""}),C=z=>{const{name:H,value:U}=z.target;E({...M,[H]:U})},L=async z=>{z.preventDefault();try{const H=await fetch("/User/credentials/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Id:"",Username:M.usernameRegister,Password:M.passwordRegister,Email:M.emailRegister,FirstName:M.firstnameRegister,LastName:M.lastnameRegister})});H.ok?H.json().then(U=>{const q=U.token;sessionStorage.setItem("jwt",q),i("/homepage")}):console.log("Error")}catch{console.log("Error while registering form")}},B=()=>{h(!s)};return rt.jsx(mW,{theme:{palette:{primary:{main:"#007FFF",dark:"#0066CC"}}},children:rt.jsxs(Mh,{children:[rt.jsx(dY,{position:"static",color:"inherit",elevation:0,children:rt.jsxs(ptt,{sx:{marginTop:"1%",marginRight:"11%",marginBottom:"1%"},children:["                        ",rt.jsx(qf,{sx:{flexGrow:1}}),rt.jsx(Hf,{onClick:B,children:"Login/Register"}),rt.jsx(Hf,{children:"Contact"})]})}),rt.jsxs(Mh,{spacing:8,direction:"column",justifyContent:"space-evenly",alignItems:"center",children:[rt.jsx(A_,{maxWidth:!1,className:"imgContainer",disableGutters:!0,xs:{width:"100%"},mt:10,children:rt.jsxs(pa,{container:!0,justifyContent:"center",children:[rt.jsx(pa,{item:!0,xs:3}),rt.jsxs(pa,{item:!0,xs:9,style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},children:[rt.jsx(qf,{sx:{position:"absolute",left:"-7.5%",top:"4%",background:"#223c75",color:"#fff",padding:2,zIndex:1},maxWidth:"sm",children:rt.jsxs(Mh,{spacing:4,children:[rt.jsx(Vc,{variant:"h2",sx:{fontSize:"55.2px",padding:"10px",color:"white"},children:"Welcome To Goatplaces!"}),rt.jsx(Vc,{variant:"h5",sx:{padding:"10px",m:5},children:"GOat Places is a simple and fast way to share campus experiences with friends. Whether you want to create them or simply let others know, sign up today to start!"}),rt.jsx(Hf,{variant:"contained",onClick:B,size:"large",sx:{backgroundColor:"#bcc922",color:"#223c75",borderRadius:"0px",left:"27%",width:"45%",height:"45px"},children:"Join Today!"}),rt.jsx(qf,{})]})}),rt.jsx("img",{className:"landingImg",src:d9,alt:"Image",style:{width:"60%",borderRadius:"5px"}})]})]})}),rt.jsx(A_,{maxWidth:!1,disableGutters:!0,xs:{width:"100%"},mt:10,children:rt.jsxs(pa,{container:!0,children:[rt.jsx(pa,{item:!0,xs:8}),rt.jsx(pa,{item:!0,xs:4,style:{background:"#2A296B"}})]})}),rt.jsx(A_,{}),rt.jsx(qf,{}),rt.jsx(qf,{}),rt.jsx(A_,{maxWidth:"md",className:"featureShowcase",children:rt.jsxs(pa,{container:!0,spacing:5,children:[rt.jsx(pa,{item:!0,xl:4,children:rt.jsx(fw,{elevation:0,children:rt.jsxs(pw,{sx:{textAlign:"center"},children:[rt.jsx(u5,{style:{fontSize:"5rem",marginBottom:"3rem"},mb:50}),rt.jsx(Vc,{variant:"h5",component:"h2",children:"Having trouble finding your class or finding events on campus? Our map will help you traverse our campus so you can get where you need to be!"})]})})}),rt.jsx(pa,{item:!0,xl:4,children:rt.jsx(fw,{elevation:0,children:rt.jsxs(pw,{sx:{textAlign:"center"},children:[rt.jsx(h5,{style:{fontSize:"5rem",marginBottom:"3rem"}}),rt.jsx(Vc,{variant:"h5",component:"h2",children:"Share events and posts with your friends, family, and the St. Edward's community to keep them in touch with what's going on at the Hilltop"})]})})}),rt.jsx(pa,{item:!0,xl:4,children:rt.jsx(fw,{elevation:0,children:rt.jsxs(pw,{sx:{textAlign:"center"},children:[rt.jsx(d5,{style:{fontSize:"5rem",marginBottom:"3rem"}}),rt.jsx(Vc,{variant:"h5",component:"h2",children:"Browse the events that are happening or going to happen on campus, or create your own! We'll make sure your events are seen on the map and shown for others to discover"})]})})})]})})]}),rt.jsx(JQ,{anchor:"right",open:s,onClose:B,PaperProps:{sx:{width:"40%"}},children:rt.jsxs(Mh,{spacing:8,direction:"column",justifyContent:"space-evenly",alignItems:"center",sx:{my:5},children:[rt.jsx("form",{children:rt.jsxs(Mh,{spacing:2,children:[rt.jsx(Vc,{variant:"h6",children:"Login"}),rt.jsx(Wc,{requied:!0,label:"Username",name:"usernameLogin",size:"small",value:f.usernameLogin,onChange:y,variant:"filled"}),rt.jsx(Wc,{required:!0,label:"Password",name:"passwordLogin",size:"small",value:f.passwordLogin,onChange:y,variant:"filled"}),rt.jsx(Hf,{onClick:b,children:"Login"})]})}),rt.jsx("form",{children:rt.jsxs(Mh,{spacing:2,children:[rt.jsx(Vc,{variant:"h6",children:"Register"}),rt.jsx(Wc,{required:!0,label:"Username",name:"usernameRegister",size:"small",value:M.usernameRegister,onChange:C,variant:"filled"}),rt.jsx(Wc,{required:!0,label:"Password",name:"passwordRegister",size:"small",value:M.passwordRegister,onChange:C,variant:"filled"}),rt.jsx(Wc,{required:!0,label:"Email",name:"emailRegister",size:"small",value:M.emailRegister,onChange:C,variant:"filled"}),rt.jsx(Wc,{required:!0,label:"FirstName",name:"firstnameRegister",size:"small",value:M.firstnameRegister,onChange:C,variant:"filled"}),rt.jsx(Wc,{required:!0,label:"LastName",name:"lastnameRegister",size:"small",value:M.lastnameRegister,onChange:C,variant:"filled"}),rt.jsx(Hf,{onClick:L,children:"Register"})]})})]})})]})})}var W5={exports:{}};(function(i,s){var h={};(function(f,g){i.exports=g()})(ki,function(){var f,g,y;function b(E,C){if(!f)f=C;else if(!g)g=C;else{var L="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+f+")(sharedChunk); ("+g+")(sharedChunk); self.onerror = null;",B={};f(B),y=C(B),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(y.workerUrl=window.URL.createObjectURL(new Blob([L],{type:"text/javascript"})))}}b(["exports"],function(E){var C=typeof self<"u"?self:{},L="3.1.2";let B;const z={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(B==null){const e=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{B=h.API_URL_REGEX!=null?new RegExp(h.API_URL_REGEX):e}catch{B=e}}return B},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!z.API_URL)return null;try{const e=new URL(z.API_URL);return e.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":e.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},H={supported:!1,testSupport:function(e){!tt&&q&&(V?F(e):U=e)}};let U,q,tt=!1,V=!1;function F(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,q),e.isContextLost())return;H.supported=!0}catch{}e.deleteTexture(t),tt=!0}C.document&&(q=C.document.createElement("img"),q.onload=function(){U&&F(U),U=null,V=!0},q.onerror=function(){tt=!0,U=null},q.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const D="01";function $(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var J=ct;function ct(e,t,n,r){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(r-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=n,this.p2y=r}ct.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(t===void 0&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var n=e,r=0;r<8;r++){var o=this.sampleCurveX(n)-e;if(Math.abs(o)<t)return n;var a=this.sampleCurveDerivativeX(n);if(Math.abs(a)<1e-6)break;n-=o/a}var c=0,u=1;for(n=e,r=0;r<20&&(o=this.sampleCurveX(n),!(Math.abs(o-e)<t));r++)e>o?c=n:u=n,n=.5*(u-c)+c;return n},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var st=$(J),yt=ut;function ut(e,t){this.x=e,this.y=t}ut.prototype={clone:function(){return new ut(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,n=e.y-this.y;return t*t+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=r,this},_rotateAround:function(e,t){var n=Math.cos(e),r=Math.sin(e),o=t.y+r*(this.x-t.x)+n*(this.y-t.y);return this.x=t.x+n*(this.x-t.x)-r*(this.y-t.y),this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ut.convert=function(e){return e instanceof ut?e:Array.isArray(e)?new ut(e[0],e[1]):e};var N=$(yt);function et(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!et(e[n],t[n]))return!1;return!0}if(typeof e=="object"&&e!==null&&t!==null){if(typeof t!="object"||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!et(e[n],t[n]))return!1;return!0}return e===t}const Mt=Math.PI/180,Lt=180/Math.PI;function it(e){return e*Mt}function Tt(e){return e*Lt}const Vt=[[0,0],[1,0],[1,1],[0,1]];function ne(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)}function Et(e){let t=1/0,n=1/0,r=-1/0,o=-1/0;for(const a of e)t=Math.min(t,a.x),n=Math.min(n,a.y),r=Math.max(r,a.x),o=Math.max(o,a.y);return{min:new N(t,n),max:new N(r,o)}}function $t(e,t,n=0,r=!0){const o=new N(n,n),a=e.sub(o),c=t.add(o),u=[a,new N(c.x,a.y),c,new N(a.x,c.y)];return r&&u.push(a.clone()),u}function ee(e,t,n,r){const o=new st(e,t,n,r);return function(a){return o.solve(a)}}const Ee=ee(.25,.1,.25,1);function jt(e,t,n){return Math.min(n,Math.max(t,e))}function Le(e,t,n){return(n=jt((n-e)/(t-e),0,1))*n*(3-2*n)}function we(e,t,n){const r=n-t,o=((e-t)%r+r)%r+t;return o===t?n:o}function kt(e,t,n){if(!e.length)return n(null,[]);let r=e.length;const o=new Array(e.length);let a=null;e.forEach((c,u)=>{t(c,(d,p)=>{d&&(a=d),o[u]=p,--r==0&&n(a,o)})})}function Xt(e){const t=[];for(const n in e)t.push(e[n]);return t}function Ot(e,...t){for(const n of t)for(const r in n)e[r]=n[r];return e}function Pe(e,t){const n={};for(let r=0;r<t.length;r++){const o=t[r];o in e&&(n[o]=e[o])}return n}let ie=1;function Ne(){return ie++}function Fe(){return function e(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function je(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function De(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Ue(e,t){e.forEach(n=>{t[n]&&(t[n]=t[n].bind(t))})}function An(e,t){return e.indexOf(t,e.length-t.length)!==-1}function vn(e,t,n){const r={};for(const o in e)r[o]=t.call(n||this,e[o],o,e);return r}function Zt(e,t,n){const r={};for(const o in e)t.call(n||this,e[o],o,e)&&(r[o]=e[o]);return r}function Y(e){return Array.isArray(e)?e.map(Y):typeof e=="object"&&e?vn(e,Y):e}const nt={};function dt(e){nt[e]||(typeof console<"u"&&console.warn(e),nt[e]=!0)}function Bt(e,t,n){return(n.y-e.y)*(t.x-e.x)>(t.y-e.y)*(n.x-e.x)}function Wt(e){let t=0;for(let n,r,o=0,a=e.length,c=a-1;o<a;c=o++)n=e[o],r=e[c],t+=(r.x-n.x)*(n.y+r.y);return t}function ae([e,t,n]){const r=it(t+90),o=it(n);return{x:e*Math.cos(r)*Math.sin(o),y:e*Math.sin(r)*Math.sin(o),z:e*Math.cos(o),azimuthal:t,polar:n}}function ce(e,t,n){const r=Math.sqrt(e*e+t*t+n*n),o=r>0?Math.acos(n/r)*Lt:0;let a=e!==0||t!==0?Math.atan2(-t,-e)*Lt+90:0;return a<0&&(a+=360),[r,a,o]}function qt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ce(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,r,o,a)=>{const c=o||a;return t[r]=!c||c.toLowerCase(),""}),t["max-age"]){const n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t}let Re=null;function be(){return!!C.document.fullscreenElement||!!C.document.webkitFullscreenElement}function Me(e){try{const t=C[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function zn(e,t){return[e[4*t],e[4*t+1],e[4*t+2],e[4*t+3]]}function er(e,t,n){e[4*t+0]=n[0],e[4*t+1]=n[1],e[4*t+2]=n[2],e[4*t+3]=n[3]}function Fn(e,t){return[Math.pow(e[0],2.2)*t,Math.pow(e[1],2.2)*t,Math.pow(e[2],2.2)*t]}function ke(e){return[Math.pow(e[0],1/2.2),Math.pow(e[1],1/2.2),Math.pow(e[2],1/2.2)]}const $e="mapbox-tiles";let Nn=500,ar=50,Gr,Ci;function Kr(){try{return C.caches}catch{}}function _i(){Kr()&&!Gr&&(Gr=C.caches.open($e))}function so(e){const t=e.indexOf("?");if(t<0)return e;const n=function(o){const a=o.indexOf("?");return a>0?o.slice(a+1).split("&"):[]}(e),r=n.filter(o=>{const a=o.split("=");return a[0]==="language"||a[0]==="worldview"});return r.length?`${e.slice(0,t)}?${r.join("&")}`:e.slice(0,t)}let is=1/0;function Hi(e){is++,is>ar&&(e.getActor().send("enforceCacheSizeLimit",Nn),is=0)}const Dt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Dt);class Gt extends Error{constructor(t,n,r){n===401&&Jn(r)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=n,this.url=r}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Yt=qt()?()=>self.worker&&self.worker.referrer:()=>(C.location.protocol==="blob:"?C.parent:C).location.href,re=function(e,t){if(!(/^file:/.test(n=e.url)||/^file:/.test(Yt())&&!/^\w+:/.test(n))){if(C.fetch&&C.Request&&C.AbortController&&C.Request.prototype.hasOwnProperty("signal"))return function(r,o){const a=new C.AbortController,c=new C.Request(r.url,{method:r.method||"GET",body:r.body,credentials:r.credentials,headers:r.headers,referrer:Yt(),referrerPolicy:r.referrerPolicy,signal:a.signal});let u=!1,d=!1;const p=(m=c.url).indexOf("sku=")>0&&Jn(m);var m;r.type==="json"&&c.headers.set("Accept","application/json");const _=(x,w,T)=>{if(d)return;if(x&&x.message!=="SecurityError"&&dt(x.toString()),w&&T)return v(w);const S=Date.now();C.fetch(c).then(I=>{if(I.ok){const A=p?I.clone():null;return v(I,A,S)}return o(new Gt(I.statusText,I.status,r.url))}).catch(I=>{I.name!=="AbortError"&&o(new Error(`${I.message} ${r.url}`))})},v=(x,w,T)=>{(r.type==="arrayBuffer"?x.arrayBuffer():r.type==="json"?x.json():x.text()).then(S=>{d||(w&&T&&function(I,A,R){if(_i(),!Gr)return;const k={status:A.status,statusText:A.statusText,headers:new C.Headers};A.headers.forEach((j,G)=>k.headers.set(G,j));const P=Ce(A.headers.get("Cache-Control")||"");if(P["no-store"])return;P["max-age"]&&k.headers.set("Expires",new Date(R+1e3*P["max-age"]).toUTCString());const O=k.headers.get("Expires");O&&(new Date(O).getTime()-R<42e4||function(j,G){if(Ci===void 0)try{new Response(new ReadableStream),Ci=!0}catch{Ci=!1}Ci?G(j.body):j.blob().then(G)}(A,j=>{const G=new C.Response(j,k);_i(),Gr&&Gr.then(W=>W.put(so(I.url),G)).catch(W=>dt(W.message))}))}(c,w,T),u=!0,o(null,S,x.headers.get("Cache-Control"),x.headers.get("Expires")))}).catch(S=>{d||o(new Error(S.message))})};return p?function(x,w){if(_i(),!Gr)return w(null);const T=so(x.url);Gr.then(S=>{S.match(T).then(I=>{const A=function(R){if(!R)return!1;const k=new Date(R.headers.get("Expires")||0),P=Ce(R.headers.get("Cache-Control")||"");return k>Date.now()&&!P["no-cache"]}(I);S.delete(T),A&&S.put(T,I.clone()),w(null,I,A)}).catch(w)}).catch(w)}(c,_):_(null,null),{cancel:()=>{d=!0,u||a.abort()}}}(e,t);if(qt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var n;return function(r,o){const a=new C.XMLHttpRequest;a.open(r.method||"GET",r.url,!0),r.type==="arrayBuffer"&&(a.responseType="arraybuffer");for(const c in r.headers)a.setRequestHeader(c,r.headers[c]);return r.type==="json"&&(a.responseType="text",a.setRequestHeader("Accept","application/json")),a.withCredentials=r.credentials==="include",a.onerror=()=>{o(new Error(a.statusText))},a.onload=()=>{if((a.status>=200&&a.status<300||a.status===0)&&a.response!==null){let c=a.response;if(r.type==="json")try{c=JSON.parse(a.response)}catch(u){return o(u)}o(null,c,a.getResponseHeader("Cache-Control"),a.getResponseHeader("Expires"))}else o(new Gt(a.statusText,a.status,r.url))},a.send(r.body),{cancel:()=>a.abort()}}(e,t)},Qt=function(e,t){return re(Ot(e,{type:"json"}),t)},le=function(e,t){return re(Ot(e,{type:"arrayBuffer"}),t)};function pe(e){const t=C.document.createElement("a");return t.href=e,t.protocol===C.document.location.protocol&&t.host===C.document.location.host}const oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ye,ue;ye=[],ue=0;const Qe=function(e,t){if(H.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),ue>=z.MAX_PARALLEL_IMAGE_REQUESTS){const a={requestParameters:e,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return ye.push(a),a}ue++;let n=!1;const r=()=>{if(!n)for(n=!0,ue--;ye.length&&ue<z.MAX_PARALLEL_IMAGE_REQUESTS;){const a=ye.shift(),{requestParameters:c,callback:u,cancelled:d}=a;d||(a.cancel=Qe(c,u).cancel)}},o=le(e,(a,c,u,d)=>{r(),a?t(a):c&&(C.createImageBitmap?function(p,m){const _=new C.Blob([new Uint8Array(p)],{type:"image/png"});C.createImageBitmap(_).then(v=>{m(null,v)}).catch(v=>{m(new Error(`Could not load image because of ${v.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(c,(p,m)=>t(p,m,u,d)):function(p,m){const _=new C.Image,v=C.URL;_.onload=()=>{m(null,_),v.revokeObjectURL(_.src),_.onload=null,C.requestAnimationFrame(()=>{_.src=oe})},_.onerror=()=>m(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const x=new C.Blob([new Uint8Array(p)],{type:"image/png"});_.src=p.byteLength?v.createObjectURL(x):oe}(c,(p,m)=>t(p,m,u,d)))});return{cancel:()=>{o.cancel(),r()}}},Rn="NO_ACCESS_TOKEN";class Oe{constructor(t,n,r){this._transformRequestFn=t,this._customAccessToken=n,this._silenceAuthErrors=!!r,this._createSkuToken()}_createSkuToken(){const t=function(){let n="";for(let r=0;r<10;r++)n+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",D,n].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,n){return this._transformRequestFn&&this._transformRequestFn(t,n)||{url:t}}normalizeStyleURL(t,n){if(!kn(t))return t;const r=Nr(t);return r.params.push(`sdk=js-${L}`),r.path=`/styles/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||n)}normalizeGlyphsURL(t,n){if(!kn(t))return t;const r=Nr(t);return r.path=`/fonts/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||n)}normalizeModelURL(t,n){if(!kn(t))return t;const r=Nr(t);return r.path=`/models/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||n)}normalizeSourceURL(t,n,r,o){if(!kn(t))return t;const a=Nr(t);return a.path=`/v4/${a.authority}.json`,a.params.push("secure"),r&&a.params.push(`language=${r}`),o&&a.params.push(`worldview=${o}`),this._makeAPIURL(a,this._customAccessToken||n)}normalizeSpriteURL(t,n,r,o){const a=Nr(t);return kn(t)?(a.path=`/styles/v1${a.path}/sprite${n}${r}`,this._makeAPIURL(a,this._customAccessToken||o)):(a.path+=`${n}${r}`,Mi(a))}normalizeTileURL(t,n,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!kn(t))return t;const o=Nr(t);o.path=o.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${n||r&&o.authority!=="raster"&&r===512?"@2x":""}${H.supported?".webp":"$1"}`),o.authority==="raster"?o.path=`/${z.RASTER_URL_PREFIX}${o.path}`:(o.path=o.path.replace(/^.+\/v4\//,"/"),o.path=`/${z.TILE_URL_VERSION}${o.path}`);const a=this._customAccessToken||function(c){for(const u of c){const d=u.match(/^access_token=(.*)$/);if(d)return d[1]}return null}(o.params)||z.ACCESS_TOKEN;return z.REQUIRE_ACCESS_TOKEN&&a&&this._skuToken&&o.params.push(`sku=${this._skuToken}`),this._makeAPIURL(o,a)}canonicalizeTileURL(t,n){const r=Nr(t);if(!r.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!r.path.match(/\.[\w]+$/))return t;let o="mapbox://";r.path.match(/^\/raster\/v1\//)?o+=`raster/${r.path.replace(`/${z.RASTER_URL_PREFIX}/`,"")}`:o+=`tiles/${r.path.replace(`/${z.TILE_URL_VERSION}/`,"")}`;let a=r.params;return n&&(a=a.filter(c=>!c.match(/^access_token=/))),a.length&&(o+=`?${a.join("&")}`),o}canonicalizeTileset(t,n){const r=!!n&&kn(n),o=[];for(const a of t.tiles||[])Jn(a)?o.push(this.canonicalizeTileURL(a,r)):o.push(a);return o}_makeAPIURL(t,n){const r="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",o=Nr(z.API_URL);if(t.protocol=o.protocol,t.authority=o.authority,t.protocol==="http"){const a=t.params.indexOf("secure");a>=0&&t.params.splice(a,1)}if(o.path!=="/"&&(t.path=`${o.path}${t.path}`),!z.REQUIRE_ACCESS_TOKEN)return Mi(t);if(n=n||z.ACCESS_TOKEN,!this._silenceAuthErrors){if(!n)throw new Error(`An API access token is required to use Mapbox GL. ${r}`);if(n[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${r}`)}return t.params=t.params.filter(a=>a.indexOf("access_token")===-1),t.params.push(`access_token=${n||""}`),Mi(t)}}function kn(e){return e.indexOf("mapbox:")===0}function Jn(e){return z.API_URL_REGEX.test(e)}function Xn(e){return z.API_CDN_URL_REGEX.test(e)}function tr(e){return z.API_STYLE_REGEX.test(e)&&!ci(e)}function ci(e){return z.API_SPRITE_REGEX.test(e)}const Zi=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Nr(e){const t=e.match(Zi);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Mi(e){const t=e.params.length?`?${e.params.join("&")}`:"";return`${e.protocol}://${e.authority}${e.path}${t}`}const ri="mapbox.eventData";function zi(e){if(!e)return null;const t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(C.atob(t[1]).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class No{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const n=zi(z.ACCESS_TOKEN);let r="";return r=n&&n.u?C.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(o,a)=>String.fromCharCode(+("0x"+a)))):z.ACCESS_TOKEN||"",t?`${ri}.${t}:${r}`:`${ri}:${r}`}fetchEventData(){const t=Me("localStorage"),n=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{const o=C.localStorage.getItem(n);o&&(this.eventData=JSON.parse(o));const a=C.localStorage.getItem(r);a&&(this.anonId=a)}catch{dt("Unable to read from LocalStorage")}}saveEventData(){const t=Me("localStorage"),n=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{C.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&C.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{dt("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,n,r,o){if(!z.EVENTS_URL)return;const a=Nr(z.EVENTS_URL);a.params.push(`access_token=${o||z.ACCESS_TOKEN||""}`);const c={event:this.type,created:new Date(t).toISOString()},u=n?Ot(c,n):c,d={url:Mi(a),headers:{"Content-Type":"text/plain"},body:JSON.stringify([u])};this.pendingRequest=function(p,m){return re(Ot(p,{method:"POST"}),m)}(d,p=>{this.pendingRequest=null,r(p),this.saveEventData(),this.processRequests(o)})}queueRequest(t,n){this.queue.push(t),this.processRequests(n)}}const Xs=new class extends No{constructor(e){super("appUserTurnstile"),this._customAccessToken=e}postTurnstileEvent(e,t){z.EVENTS_URL&&z.ACCESS_TOKEN&&Array.isArray(e)&&e.some(n=>kn(n)||Jn(n))&&this.queueRequest(Date.now(),t)}processRequests(e){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=zi(z.ACCESS_TOKEN),n=t?t.u:z.ACCESS_TOKEN;let r=n!==this.eventData.tokenU;De(this.anonId)||(this.anonId=Fe(),r=!0);const o=this.queue.shift();if(this.eventData.lastSuccess){const a=new Date(this.eventData.lastSuccess),c=new Date(o),u=(o-this.eventData.lastSuccess)/864e5;r=r||u>=1||u<-1||a.getDate()!==c.getDate()}else r=!0;r?this.postEvent(o,{sdkIdentifier:"mapbox-gl-js",sdkVersion:L,skuId:D,"enabled.telemetry":!1,userId:this.anonId},a=>{a||(this.eventData.lastSuccess=o,this.eventData.tokenU=n)},e):this.processRequests()}},mc=Xs.postTurnstileEvent.bind(Xs),gc=new class extends No{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(e,t,n,r){this.skuToken=t,this.errorCb=r,z.EVENTS_URL&&(n||z.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},n):this.errorCb(new Error(Rn)))}processRequests(e){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:n}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),De(this.anonId)||(this.anonId=Fe()),this.postEvent(n,{sdkIdentifier:"mapbox-gl-js",sdkVersion:L,skuId:D,skuToken:this.skuToken,userId:this.anonId},r=>{r?this.errorCb(r):t&&(this.success[t]=!0)},e))}},Md=gc.postMapLoadEvent.bind(gc),os=new class extends No{constructor(){super("gljs.performance")}postPerformanceEvent(e,t){z.EVENTS_URL&&(e||z.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},e)}processRequests(e){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,performanceData:n}=this.queue.shift(),r=function(o){const a=C.performance.getEntriesByType("resource"),c=C.performance.getEntriesByType("mark"),u=function(v){const x={};if(v){for(const w in v)if(w!=="other")for(const T of v[w]){const S=`${w}ResolveRangeMin`,I=`${w}ResolveRangeMax`,A=`${w}RequestCount`,R=`${w}RequestCachedCount`;x[S]=Math.min(x[S]||1/0,T.startTime),x[I]=Math.max(x[I]||-1/0,T.responseEnd);const k=P=>{x[P]===void 0&&(x[P]=0),++x[P]};T.transferSize!==void 0&&T.transferSize===0&&k(R),k(A)}}return x}(function(v,x){const w={};if(v)for(const T of v){const S=x(T);w[S]===void 0&&(w[S]=[]),w[S].push(T)}return w}(a,Ad)),d=C.devicePixelRatio,p=C.navigator.connection||C.navigator.mozConnection||C.navigator.webkitConnection,m={counters:[],metadata:[],attributes:[]},_=(v,x,w)=>{w!=null&&v.push({name:x,value:w.toString()})};for(const v in u)_(m.counters,v,u[v]);if(o.interactionRange[0]!==1/0&&o.interactionRange[1]!==-1/0&&(_(m.counters,"interactionRangeMin",o.interactionRange[0]),_(m.counters,"interactionRangeMax",o.interactionRange[1])),c)for(const v of Object.keys(Is)){const x=Is[v],w=c.find(T=>T.name===x);w&&_(m.counters,x,w.startTime)}return _(m.counters,"visibilityHidden",o.visibilityHidden),_(m.attributes,"style",function(v){if(v)for(const x of v){const w=x.name.split("?")[0];if(tr(w)){const T=w.split("/").slice(-2);if(T.length===2)return`mapbox://styles/${T[0]}/${T[1]}`}}}(a)),_(m.attributes,"terrainEnabled",o.terrainEnabled?"true":"false"),_(m.attributes,"fogEnabled",o.fogEnabled?"true":"false"),_(m.attributes,"projection",o.projection),_(m.attributes,"zoom",o.zoom),_(m.metadata,"devicePixelRatio",d),_(m.metadata,"connectionEffectiveType",p?p.effectiveType:void 0),_(m.metadata,"navigatorUserAgent",C.navigator.userAgent),_(m.metadata,"screenWidth",C.screen.width),_(m.metadata,"screenHeight",C.screen.height),_(m.metadata,"windowWidth",C.innerWidth),_(m.metadata,"windowHeight",C.innerHeight),_(m.metadata,"mapWidth",o.width/d),_(m.metadata,"mapHeight",o.height/d),_(m.metadata,"webglRenderer",o.renderer),_(m.metadata,"webglVendor",o.vendor),_(m.metadata,"sdkVersion",L),_(m.metadata,"sdkIdentifier","mapbox-gl-js"),m}(n);for(const o of r.metadata);for(const o of r.counters);for(const o of r.attributes);this.postEvent(t,r,()=>{},e)}},Su=os.postPerformanceEvent.bind(os),_c=new class extends No{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(e,t,n,r){if(!z.API_URL||!z.SESSION_PATH)return;const o=Nr(z.API_URL+z.SESSION_PATH);o.params.push(`sku=${t||""}`),o.params.push(`access_token=${r||z.ACCESS_TOKEN||""}`);const a={url:Mi(o),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(c,u){return re(Ot(c,{method:"GET"}),u)}(a,c=>{this.pendingRequest=null,n(c),this.saveEventData(),this.processRequests(r)})}getSessionAPI(e,t,n,r){this.skuToken=t,this.errorCb=r,z.SESSION_PATH&&z.API_URL&&(n||z.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},n):this.errorCb(new Error(Rn)))}processRequests(e){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:n}=this.queue.shift();t&&this.success[t]||this.getSession(n,this.skuToken,r=>{r?this.errorCb(r):t&&(this.success[t]=!0)},e)}},Id=_c.getSessionAPI.bind(_c),Sa=new Set;function Eu(e,t){t?Sa.add(e):Sa.delete(e)}const Is={create:"create",load:"load",fullLoad:"fullLoad"},Cu={mark(e){C.performance.mark(e)},measure(e,t,n){C.performance.measure(e,t,n)}};function Ad(e){const t=e.name.split("?")[0];return Xn(t)&&t.includes("mapbox-gl.js")?"javascript":Xn(t)&&t.includes("mapbox-gl.css")?"css":function(n){return z.API_FONTS_REGEX.test(n)}(t)?"fontRange":ci(t)?"sprite":tr(t)?"style":function(n){return z.API_TILEJSON_REGEX.test(n)}(t)?"tilejson":"other"}const ss=C.performance;function Mu(e){const t=e?e.url.toString():void 0;return ss.getEntriesByName(t)}var il=yc;function yc(e){return!function(t){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var r,o,a=new Blob([""],{type:"text/javascript"}),c=URL.createObjectURL(a);try{o=new Worker(c),r=!0}catch{r=!1}return o&&o.terminate(),URL.revokeObjectURL(c),r}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var r=document.createElement("canvas");r.width=r.height=1;var o=r.getContext("2d");if(!o)return!1;var a=o.getImageData(0,0,1,1);return a&&a.width===r.width}()?(ol[n=t&&t.failIfMajorPerformanceCaveat]===void 0&&(ol[n]=function(r){var o,a=function(c){var u=document.createElement("canvas"),d=Object.create(yc.webGLContextAttributes);return d.failIfMajorPerformanceCaveat=c,u.getContext("webgl",d)||u.getContext("experimental-webgl",d)}(r);if(!a)return!1;try{o=a.createShader(a.VERTEX_SHADER)}catch{return!1}return!(!o||a.isContextLost())&&(a.shaderSource(o,"void main() {}"),a.compileShader(o),a.getShaderParameter(o,a.COMPILE_STATUS)===!0)}(n)),ol[n]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var n}(e)}var ol={};let Ea,sl,As,Ca,Xi;function Ks(){return Ea==null&&(Ea=C.OffscreenCanvas&&new C.OffscreenCanvas(1,1).getContext("2d")&&typeof C.createImageBitmap=="function"),Ea}yc.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Ve={now:()=>Ca!==void 0?Ca:C.performance.now(),setNow(e){Ca=e},restoreNow(){Ca=void 0},frame(e){const t=C.requestAnimationFrame(e);return{cancel:()=>C.cancelAnimationFrame(t)}},getImageData(e,t=0){const{width:n,height:r}=e;Xi||(Xi=C.document.createElement("canvas"));const o=Xi.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return(n>Xi.width||r>Xi.height)&&(Xi.width=n,Xi.height=r),o.clearRect(-t,-t,n+2*t,r+2*t),o.drawImage(e,0,0,n,r),o.getImageData(-t,-t,n+2*t,r+2*t)},resolveURL:e=>(sl||(sl=C.document.createElement("a")),sl.href=e,sl.href),get devicePixelRatio(){return C.devicePixelRatio},get prefersReducedMotion(){return!!C.matchMedia&&(As==null&&(As=C.matchMedia("(prefers-reduced-motion: reduce)")),As.matches)},hasCanvasFingerprintNoise(){if(!Ks())return!1;const e=new C.OffscreenCanvas(85,1),t=e.getContext("2d",{willReadFrequently:!0});let n=0;for(let o=0;o<e.width;++o)t.fillStyle=`rgba(${n++},${n++},${n++}, 255)`,t.fillRect(o,0,1,1);const r=t.getImageData(0,0,e.width,e.height);n=0;for(let o=0;o<r.data.length;++o)if(o%4!=3&&n++!==r.data[o])return!0;return!1}};function $n(e,t,n){const r=C.document.createElement(e);return t!==void 0&&(r.className=t),n&&n.appendChild(r),r}function jo(e,t,n){const r=C.document.createElementNS("http://www.w3.org/2000/svg",e);for(const o of Object.keys(t))r.setAttributeNS(null,o,t[o]);return n&&n.appendChild(r),r}const Ps=C.document&&C.document.documentElement.style,Ma=Ps&&Ps.userSelect!==void 0?"userSelect":"WebkitUserSelect";let al;function Iu(){Ps&&Ma&&(al=Ps[Ma],Ps[Ma]="none")}function Au(){Ps&&Ma&&(Ps[Ma]=al)}function ll(e){e.preventDefault(),e.stopPropagation(),C.removeEventListener("click",ll,!0)}function Ys(){C.addEventListener("click",ll,!0),C.setTimeout(()=>{C.removeEventListener("click",ll,!0)},0)}function yo(e,t){const n=e.getBoundingClientRect();return St(e,n,t)}function Ia(e,t){const n=e.getBoundingClientRect(),r=[];for(let o=0;o<t.length;o++)r.push(St(e,n,t[o]));return r}function Pu(e){return C.InstallTrigger!==void 0&&e.button===2&&e.ctrlKey&&C.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button}function St(e,t,n){const r=e.offsetWidth===t.width?1:e.offsetWidth/t.width;return new N((n.clientX-t.left)*r,(n.clientY-t.top)*r)}function Jt(e,t,n){n[e]&&n[e].indexOf(t)!==-1||(n[e]=n[e]||[],n[e].push(t))}function ge(e,t,n){if(n&&n[e]){const r=n[e].indexOf(t);r!==-1&&n[e].splice(r,1)}}class Nt{constructor(t,n={}){Ot(this,n),this.type=t}}class ve extends Nt{constructor(t,n={}){super("error",Ot({error:t},n))}}class En{on(t,n){return this._listeners=this._listeners||{},Jt(t,n,this._listeners),this}off(t,n){return ge(t,n,this._listeners),ge(t,n,this._oneTimeListeners),this}once(t,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},Jt(t,n,this._oneTimeListeners),this):new Promise(r=>this.once(t,r))}fire(t,n){typeof t=="string"&&(t=new Nt(t,n||{}));const r=t.type;if(this.listens(r)){t.target=this;const o=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];for(const u of o)u.call(this,t);const a=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];for(const u of a)ge(r,u,this._oneTimeListeners),u.call(this,t);const c=this._eventedParent;c&&(Ot(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),c.fire(t))}else t instanceof ve&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,n){return this._eventedParent=t,this._eventedParentData=n,this}}var _t=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","default":[0,1],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class se{constructor(t,n,r,o){this.message=(t?`${t}: `:"")+r,o&&(this.identifier=o),n!=null&&n.__line__&&(this.line=n.__line__)}}class yi extends se{}function Pr(e,...t){for(const n of t)for(const r in n)e[r]=n[r];return e}function Er(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Cr(e){if(Array.isArray(e))return e.map(Cr);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const n in e)t[n]=Cr(e[n]);return t}return Er(e)}class Pd extends Error{constructor(t,n){super(n),this.message=n,this.key=t}}var ao=Pd;class Qs{constructor(t,n=[]){this.parent=t,this.bindings={};for(const[r,o]of n)this.bindings[r]=o}concat(t){return new Qs(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var Aa=Qs;const lo={kind:"null"},me={kind:"number"},gn={kind:"string"},Cn={kind:"boolean"},ji={kind:"color"},mt={kind:"object"},bt={kind:"value"},fe={kind:"collator"},Ge={kind:"formatted"},lr={kind:"resolvedImage"};function an(e,t){return{kind:"array",itemType:e,N:t}}function Tn(e){if(e.kind==="array"){const t=Tn(e.itemType);return typeof e.N=="number"?`array<${t}, ${e.N}>`:e.itemType.kind==="value"?"array":`array<${t}>`}return e.kind}const vi=[lo,me,gn,Cn,ji,Ge,mt,an(bt),lr];function Yr(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Yr(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(const n of vi)if(!Yr(n,t))return null}}return`Expected ${Tn(e)} but found ${Tn(t)} instead.`}function Rr(e,t){return t.some(n=>n.kind===e.kind)}function Ii(e,t){return t.some(n=>n==="null"?e===null:n==="array"?Array.isArray(e):n==="object"?e&&!Array.isArray(e)&&typeof e=="object":n===typeof e)}var co,Ai={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ui(e){return(e=Math.round(e))<0?0:e>255?255:e}function Ki(e){return Ui(e[e.length-1]==="%"?parseFloat(e)/100*255:parseInt(e))}function Uo(e){return(t=e[e.length-1]==="%"?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function $o(e,t,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}try{co={}.parseCSSColor=function(e){var t,n=e.replace(/ /g,"").toLowerCase();if(n in Ai)return Ai[n].slice();if(n[0]==="#")return n.length===4?(t=parseInt(n.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:n.length===7&&(t=parseInt(n.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var r=n.indexOf("("),o=n.indexOf(")");if(r!==-1&&o+1===n.length){var a=n.substr(0,r),c=n.substr(r+1,o-(r+1)).split(","),u=1;switch(a){case"rgba":if(c.length!==4)return null;u=Uo(c.pop());case"rgb":return c.length!==3?null:[Ki(c[0]),Ki(c[1]),Ki(c[2]),u];case"hsla":if(c.length!==4)return null;u=Uo(c.pop());case"hsl":if(c.length!==3)return null;var d=(parseFloat(c[0])%360+360)%360/360,p=Uo(c[1]),m=Uo(c[2]),_=m<=.5?m*(p+1):m+p-m*p,v=2*m-_;return[Ui(255*$o(v,_,d+1/3)),Ui(255*$o(v,_,d)),Ui(255*$o(v,_,d-1/3)),u];default:return null}}return null}}catch{}class ii{constructor(t,n,r,o=1){this.r=t,this.g=n,this.b=r,this.a=o}static parse(t){if(!t)return;if(t instanceof ii)return t;if(typeof t!="string")return;const n=co(t);return n?new ii(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){const[t,n,r,o]=this.toArray();return`rgba(${Math.round(t)},${Math.round(n)},${Math.round(r)},${o})`}toArray(){const{r:t,g:n,b:r,a:o}=this;return o===0?[0,0,0,0]:[255*t/o,255*n/o,255*r/o,o]}toArray01(){const{r:t,g:n,b:r,a:o}=this;return o===0?[0,0,0,0]:[t/o,n/o,r/o,o]}toArray01Scaled(t){const{r:n,g:r,b:o,a}=this;return a===0?[0,0,0]:[n/a*t,r/a*t,o/a*t]}toArray01PremultipliedAlpha(){const{r:t,g:n,b:r,a:o}=this;return[t,n,r,o]}toArray01Linear(){const{r:t,g:n,b:r,a:o}=this;return o===0?[0,0,0,0]:[Math.pow(t/o,2.2),Math.pow(n/o,2.2),Math.pow(r/o,2.2),o]}}ii.black=new ii(0,0,0,1),ii.white=new ii(1,1,1,1),ii.transparent=new ii(0,0,0,0),ii.red=new ii(1,0,0,1),ii.blue=new ii(0,0,1,1);var en=ii;class cl{constructor(t,n,r){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,n){return this.collator.compare(t,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ul{constructor(t,n,r,o,a){this.text=t.normalize?t.normalize():t,this.image=n,this.scale=r,this.fontStack=o,this.textColor=a}}class vo{constructor(t){this.sections=t}static fromString(t){return new vo([new ul(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.namePrimary.length!==0)}static factory(t){return t instanceof vo?t:vo.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const n of this.sections){if(n.image){t.push(["image",n.image.namePrimary]);continue}t.push(n.text);const r={};n.fontStack&&(r["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(r["font-scale"]=n.scale),n.textColor&&(r["text-color"]=["rgba"].concat(n.textColor.toArray())),t.push(r)}return t}}class as{constructor(t){this.namePrimary=t.namePrimary,t.nameSecondary&&(this.nameSecondary=t.nameSecondary),this.available=t.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(t,n){return t?new as({namePrimary:t,nameSecondary:n,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function ME(e,t,n,r){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof n=="number"&&n>=0&&n<=255?r===void 0||typeof r=="number"&&r>=0&&r<=1?null:`Invalid rgba value [${[e,t,n,r].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof r=="number"?[e,t,n,r]:[e,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ru(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof en||e instanceof cl||e instanceof vo||e instanceof as)return!0;if(Array.isArray(e)){for(const t of e)if(!Ru(t))return!1;return!0}if(typeof e=="object"){for(const t in e)if(!Ru(e[t]))return!1;return!0}return!1}function ui(e){if(e===null)return lo;if(typeof e=="string")return gn;if(typeof e=="boolean")return Cn;if(typeof e=="number")return me;if(e instanceof en)return ji;if(e instanceof cl)return fe;if(e instanceof vo)return Ge;if(e instanceof as)return lr;if(Array.isArray(e)){const t=e.length;let n;for(const r of e){const o=ui(r);if(n){if(n===o)continue;n=bt;break}n=o}return an(n||bt,t)}return mt}function Rd(e){const t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof en||e instanceof vo||e instanceof as?e.toString():JSON.stringify(e)}class av{constructor(t,n){this.type=t,this.value=n}static parse(t,n){if(t.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ru(t[1]))return n.error("invalid value");const r=t[1];let o=ui(r);const a=n.expectedType;return o.kind!=="array"||o.N!==0||!a||a.kind!=="array"||typeof a.N=="number"&&a.N!==0||(o=a),new av(o,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof en?["rgba"].concat(this.value.toArray()):this.value instanceof vo?this.value.serialize():this.value}}var kd=av,xi=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}};const lv={string:gn,number:me,boolean:Cn,object:mt};class cv{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let r,o=1;const a=t[0];if(a==="array"){let u,d;if(t.length>2){const p=t[1];if(typeof p!="string"||!(p in lv)||p==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);u=lv[p],o++}else u=bt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);d=t[2],o++}r=an(u,d)}else r=lv[a];const c=[];for(;o<t.length;o++){const u=n.parse(t[o],o,bt);if(!u)return null;c.push(u)}return new cv(r,c)}evaluate(t){for(let n=0;n<this.args.length;n++){const r=this.args[n].evaluate(t);if(!Yr(this.type,ui(r)))return r;if(n===this.args.length-1)throw new xi(`Expected value to be of type ${Tn(this.type)}, but found ${Tn(ui(r))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,n=[t.kind];if(t.kind==="array"){const r=t.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){n.push(r.kind);const o=t.N;(typeof o=="number"||this.args.length>1)&&n.push(o)}}return n.concat(this.args.map(r=>r.serialize()))}}var Pa=cv;class Od{constructor(t){this.type=Ge,this.sections=t}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const r=t[1];if(!Array.isArray(r)&&typeof r=="object")return n.error("First argument must be an image or text section.");const o=[];let a=!1;for(let c=1;c<=t.length-1;++c){const u=t[c];if(a&&typeof u=="object"&&!Array.isArray(u)){a=!1;let d=null;if(u["font-scale"]&&(d=n.parse(u["font-scale"],1,me),!d))return null;let p=null;if(u["text-font"]&&(p=n.parse(u["text-font"],1,an(gn)),!p))return null;let m=null;if(u["text-color"]&&(m=n.parse(u["text-color"],1,ji),!m))return null;const _=o[o.length-1];_.scale=d,_.font=p,_.textColor=m}else{const d=n.parse(t[c],1,bt);if(!d)return null;const p=d.type.kind;if(p!=="string"&&p!=="value"&&p!=="null"&&p!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,o.push({content:d,scale:null,font:null,textColor:null})}}return new Od(o)}evaluate(t){return new vo(this.sections.map(n=>{const r=n.content.evaluate(t);return ui(r)===lr?new ul("",r,null,null,null):new ul(Rd(r),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null)}))}eachChild(t){for(const n of this.sections)t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const n of this.sections){t.push(n.content.serialize());const r={};n.scale&&(r["font-scale"]=n.scale.serialize()),n.font&&(r["text-font"]=n.font.serialize()),n.textColor&&(r["text-color"]=n.textColor.serialize()),t.push(r)}return t}}class Ld{constructor(t,n){this.type=lr,this.inputPrimary=t,this.inputSecondary=n}static parse(t,n){if(t.length<2)return n.error("Expected two or more arguments.");const r=n.parse(t[1],1,gn);if(!r)return n.error("No image name provided.");if(t.length===2)return new Ld(r);const o=n.parse(t[2],1,gn);return o?new Ld(r,o):n.error("Secondary image variant is not a string.")}evaluate(t){const n=as.fromString(this.inputPrimary.evaluate(t),this.inputSecondary?this.inputSecondary.evaluate(t):void 0);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(n.namePrimary)>-1,n.nameSecondary&&n.available&&t.availableImages&&(n.available=t.availableImages.indexOf(n.nameSecondary)>-1)),n}eachChild(t){t(this.inputPrimary),this.inputSecondary&&t(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Vn(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}const RB={"to-boolean":Cn,"to-color":ji,"to-number":me,"to-string":gn};class uv{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const r=t[0],o=[];let a=lo;if(r==="to-array"){if(!Array.isArray(t[1]))return null;const c=t[1].length;if(n.expectedType){if(n.expectedType.kind!=="array")return n.error(`Expected ${n.expectedType.kind} but found array.`);a=an(n.expectedType.itemType,c)}else{if(!(c>0&&Ru(t[1][0])))return null;a=an(ui(t[1][0]),c)}for(let u=0;u<c;u++){const d=t[1][u];let p;if(Vn(d)==="array")p=n.parse(d,void 0,a.itemType);else{const m=Vn(d);if(m!==a.itemType.kind)return n.error(`Expected ${a.itemType.kind} but found ${m}.`);p=n.registry.literal.parse(["literal",d===void 0?null:d],n)}if(!p)return null;o.push(p)}}else{if((r==="to-boolean"||r==="to-string")&&t.length!==2)return n.error("Expected one argument.");a=RB[r];for(let c=1;c<t.length;c++){const u=n.parse(t[c],c,bt);if(!u)return null;o.push(u)}}return new uv(a,o)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let n,r;for(const o of this.args){if(n=o.evaluate(t),r=null,n instanceof en)return n;if(typeof n=="string"){const a=t.parseColor(n);if(a)return a}else if(Array.isArray(n)&&(r=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:ME(n[0],n[1],n[2],n[3]),!r))return new en(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new xi(r||`Could not parse color from value '${typeof n=="string"?n:String(JSON.stringify(n))}'`)}if(this.type.kind==="number"){let n=null;for(const r of this.args){if(n=r.evaluate(t),n===null)return 0;const o=Number(n);if(!isNaN(o))return o}throw new xi(`Could not convert ${JSON.stringify(n)} to number.`)}return this.type.kind==="formatted"?vo.fromString(Rd(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?as.fromString(Rd(this.args[0].evaluate(t))):this.type.kind==="array"?this.args.map(n=>n.evaluate(t)):Rd(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Od([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ld(this.args[0]).serialize();const t=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(n=>{t.push(n.serialize())}),t}}var vc=uv;const kB=["Unknown","Point","LineString","Polygon"];var IE=class{constructor(e){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.options=e}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?kB[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(e){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:n,y:r}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*t-e[0])+this.featureDistanceData.bearing[1]*(r*t-e[1])}return 0}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=en.parse(e)),t}getConfig(e){return this.options?this.options.get(e):null}};class xc{constructor(t,n,r,o,a){this.name=t,this.type=n,this._evaluate=r,this.args=o,this._overloadIndex=a}evaluate(t){if(!this._evaluate){const n=xc.definitions[this.name];this._evaluate=Array.isArray(n)?n[2]:n.overloads[this._overloadIndex][1]}return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,n){const r=t[0],o=xc.definitions[r];if(!o)return n.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);const a=Array.isArray(o)?o[0]:o.type,c=Array.isArray(o)?[[o[1],o[2]]]:o.overloads,u=[];let d=null,p=-1;for(const[m,_]of c){if(Array.isArray(m)&&m.length!==t.length-1)continue;u.push(m),p++,d=new WE(n.registry,n.path,null,n.scope,void 0,n.options);const v=[];let x=!1;for(let w=1;w<t.length;w++){const T=t[w],S=Array.isArray(m)?m[w-1]:m.type,I=d.parse(T,1+v.length,S);if(!I){x=!0;break}v.push(I)}if(!x)if(Array.isArray(m)&&m.length!==v.length)d.error(`Expected ${m.length} arguments, but found ${v.length} instead.`);else{for(let w=0;w<v.length;w++){const T=Array.isArray(m)?m[w]:m.type,S=v[w];d.concat(w+1).checkSubtype(T,S.type)}if(d.errors.length===0)return new xc(r,a,_,v,p)}}if(u.length===1)n.errors.push(...d.errors);else{const m=(u.length?u:c.map(([v])=>v)).map(OB).join(" | "),_=[];for(let v=1;v<t.length;v++){const x=n.parse(t[v],1+_.length);if(!x)return null;_.push(Tn(x.type))}n.error(`Expected arguments of type ${m}, but found (${_.join(", ")}) instead.`)}return null}static register(t,n){xc.definitions=n;for(const r in n)t[r]=xc}}function OB(e){return Array.isArray(e)?`(${e.map(Tn).join(", ")})`:`(${Tn(e.type)}...)`}var Js=xc;class Jp{constructor(t,n,r){this.type=fe,this.locale=r,this.caseSensitive=t,this.diacriticSensitive=n}static parse(t,n){if(t.length!==2)return n.error("Expected one argument.");const r=t[1];if(typeof r!="object"||Array.isArray(r))return n.error("Collator options argument must be an object.");const o=n.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,Cn);if(!o)return null;const a=n.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,Cn);if(!a)return null;let c=null;return r.locale&&(c=n.parse(r.locale,1,gn),!c)?null:new Jp(o,a,c)}evaluate(t){return new cl(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}var AE={exports:{}};AE.exports=function(){function e(r,o,a,c,u){for(;c>a;){if(c-a>600){var d=c-a+1,p=o-a+1,m=Math.log(d),_=.5*Math.exp(2*m/3),v=.5*Math.sqrt(m*_*(d-_)/d)*(p-d/2<0?-1:1);e(r,o,Math.max(a,Math.floor(o-p*_/d+v)),Math.min(c,Math.floor(o+(d-p)*_/d+v)),u)}var x=r[o],w=a,T=c;for(t(r,a,o),u(r[c],x)>0&&t(r,a,c);w<T;){for(t(r,w,T),w++,T--;u(r[w],x)<0;)w++;for(;u(r[T],x)>0;)T--}u(r[a],x)===0?t(r,a,T):t(r,++T,c),T<=o&&(a=T+1),o<=T&&(c=T-1)}}function t(r,o,a){var c=r[o];r[o]=r[a],r[a]=c}function n(r,o){return r<o?-1:r>o?1:0}return function(r,o,a,c,u){e(r,o,a||0,c||r.length-1,u||n)}}();var LB=$(AE.exports);function zB(e){let t=0;for(let n,r,o=0,a=e.length,c=a-1;o<a;c=o++)n=e[o],r=e[c],t+=(r.x-n.x)*(n.y+r.y);return t}function zd(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Dd(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function DB(e,t,n){const r=e[0]-t[0],o=e[1]-t[1],a=e[0]-n[0],c=e[1]-n[1];return r*c-a*o==0&&r*a<=0&&o*c<=0}function ku(e,t,n=!1){let r=!1;for(let u=0,d=t.length;u<d;u++){const p=t[u];for(let m=0,_=p.length,v=_-1;m<_;v=m++){const x=p[v],w=p[m];if(DB(e,x,w))return n;(a=x)[1]>(o=e)[1]!=(c=w)[1]>o[1]&&o[0]<(c[0]-a[0])*(o[1]-a[1])/(c[1]-a[1])+a[0]&&(r=!r)}}var o,a,c;return r}function PE(e,t,n,r){const o=r[0]-n[0],a=r[1]-n[1],c=(e[0]-n[0])*a-o*(e[1]-n[1]),u=(t[0]-n[0])*a-o*(t[1]-n[1]);return c>0&&u<0||c<0&&u>0}function tm(e,t,n,r){return(o=[r[0]-n[0],r[1]-n[1]])[0]*(a=[t[0]-e[0],t[1]-e[1]])[1]-o[1]*a[0]!=0&&!(!PE(e,t,n,r)||!PE(n,r,e,t));var o,a}const hl=8192;function BB(e,t){const n=(180+e[0])/360,r=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,o=Math.pow(2,t.z);return[Math.round(n*o*hl),Math.round(r*o*hl)]}function FB(e,t){for(let n=0;n<t.length;n++)if(ku(e,t[n]))return!0;return!1}function NB(e,t,n){for(const r of n)for(let o=0,a=r.length,c=a-1;o<a;c=o++)if(tm(e,t,r[c],r[o]))return!0;return!1}function RE(e,t){for(let n=0;n<e.length;++n)if(!ku(e[n],t))return!1;for(let n=0;n<e.length-1;++n)if(NB(e[n],e[n+1],t))return!1;return!0}function jB(e,t){for(let n=0;n<t.length;n++)if(RE(e,t[n]))return!0;return!1}function hv(e,t,n){const r=[];for(let o=0;o<e.length;o++){const a=[];for(let c=0;c<e[o].length;c++){const u=BB(e[o][c],n);zd(t,u),a.push(u)}r.push(a)}return r}function kE(e,t,n){const r=[];for(let o=0;o<e.length;o++){const a=hv(e[o],t,n);r.push(a)}return r}function OE(e,t,n,r){if(e[0]<n[0]||e[0]>n[2]){const o=.5*r;let a=e[0]-n[0]>o?-r:n[0]-e[0]>o?r:0;a===0&&(a=e[0]-n[2]>o?-r:n[2]-e[0]>o?r:0),e[0]+=a}zd(t,e)}function LE(e,t,n,r){const o=Math.pow(2,r.z)*hl,a=[r.x*hl,r.y*hl],c=[];if(!e)return c;for(const u of e)for(const d of u){const p=[d.x+a[0],d.y+a[1]];OE(p,t,n,o),c.push(p)}return c}function zE(e,t,n,r){const o=Math.pow(2,r.z)*hl,a=[r.x*hl,r.y*hl],c=[];if(!e)return c;for(const d of e){const p=[];for(const m of d){const _=[m.x+a[0],m.y+a[1]];zd(t,_),p.push(_)}c.push(p)}if(t[2]-t[0]<=o/2){(u=t)[0]=u[1]=1/0,u[2]=u[3]=-1/0;for(const d of c)for(const p of d)OE(p,t,n,o)}var u;return c}class Bd{constructor(t,n){this.type=Cn,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ru(t[1])){const r=t[1];if(r.type==="FeatureCollection")for(let o=0;o<r.features.length;++o){const a=r.features[o].geometry.type;if(a==="Polygon"||a==="MultiPolygon")return new Bd(r,r.features[o].geometry)}else if(r.type==="Feature"){const o=r.geometry.type;if(o==="Polygon"||o==="MultiPolygon")return new Bd(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new Bd(r,r)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,r){const o=[1/0,1/0,-1/0,-1/0],a=[1/0,1/0,-1/0,-1/0],c=n.canonicalID();if(!c)return!1;if(r.type==="Polygon"){const u=hv(r.coordinates,a,c),d=LE(n.geometry(),o,a,c);if(!Dd(o,a))return!1;for(const p of d)if(!ku(p,u))return!1}if(r.type==="MultiPolygon"){const u=kE(r.coordinates,a,c),d=LE(n.geometry(),o,a,c);if(!Dd(o,a))return!1;for(const p of d)if(!FB(p,u))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,r){const o=[1/0,1/0,-1/0,-1/0],a=[1/0,1/0,-1/0,-1/0],c=n.canonicalID();if(!c)return!1;if(r.type==="Polygon"){const u=hv(r.coordinates,a,c),d=zE(n.geometry(),o,a,c);if(!Dd(o,a))return!1;for(const p of d)if(!RE(p,u))return!1}if(r.type==="MultiPolygon"){const u=kE(r.coordinates,a,c),d=zE(n.geometry(),o,a,c);if(!Dd(o,a))return!1;for(const p of d)if(!jB(p,u))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var dv=Bd,DE={exports:{}};DE.exports=function(){var e={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},t=1/298.257223563,n=t*(2-t),r=Math.PI/180,o=function(p,m){if(p===void 0)throw new Error("No latitude given.");if(m&&!e[m])throw new Error("Unknown unit "+m+". Use one of: "+Object.keys(e).join(", "));var _=6378.137*r*(m?e[m]:1),v=Math.cos(p*r),x=1/(1-n*(1-v*v)),w=Math.sqrt(x);this.kx=_*w*v,this.ky=_*w*x*(1-n)},a={units:{configurable:!0}};function c(p,m){return p[0]===m[0]&&p[1]===m[1]}function u(p,m,_){var v=d(m[0]-p[0]);return[p[0]+v*_,p[1]+(m[1]-p[1])*_]}function d(p){for(;p<-180;)p+=360;for(;p>180;)p-=360;return p}return o.fromTile=function(p,m,_){var v=Math.PI*(1-2*(p+.5)/Math.pow(2,m)),x=Math.atan(.5*(Math.exp(v)-Math.exp(-v)))/r;return new o(x,_)},a.units.get=function(){return e},o.prototype.distance=function(p,m){var _=d(p[0]-m[0])*this.kx,v=(p[1]-m[1])*this.ky;return Math.sqrt(_*_+v*v)},o.prototype.bearing=function(p,m){var _=d(m[0]-p[0])*this.kx;return Math.atan2(_,(m[1]-p[1])*this.ky)/r},o.prototype.destination=function(p,m,_){var v=_*r;return this.offset(p,Math.sin(v)*m,Math.cos(v)*m)},o.prototype.offset=function(p,m,_){return[p[0]+m/this.kx,p[1]+_/this.ky]},o.prototype.lineDistance=function(p){for(var m=0,_=0;_<p.length-1;_++)m+=this.distance(p[_],p[_+1]);return m},o.prototype.area=function(p){for(var m=0,_=0;_<p.length;_++)for(var v=p[_],x=0,w=v.length,T=w-1;x<w;T=x++)m+=d(v[x][0]-v[T][0])*(v[x][1]+v[T][1])*(_?-1:1);return Math.abs(m)/2*this.kx*this.ky},o.prototype.along=function(p,m){var _=0;if(m<=0)return p[0];for(var v=0;v<p.length-1;v++){var x=p[v],w=p[v+1],T=this.distance(x,w);if((_+=T)>m)return u(x,w,(m-(_-T))/T)}return p[p.length-1]},o.prototype.pointToSegmentDistance=function(p,m,_){var v=m[0],x=m[1],w=d(_[0]-v)*this.kx,T=(_[1]-x)*this.ky,S=0;return w===0&&T===0||((S=(d(p[0]-v)*this.kx*w+(p[1]-x)*this.ky*T)/(w*w+T*T))>1?(v=_[0],x=_[1]):S>0&&(v+=w/this.kx*S,x+=T/this.ky*S)),w=d(p[0]-v)*this.kx,T=(p[1]-x)*this.ky,Math.sqrt(w*w+T*T)},o.prototype.pointOnLine=function(p,m){for(var _,v,x,w,T=1/0,S=0;S<p.length-1;S++){var I=p[S][0],A=p[S][1],R=d(p[S+1][0]-I)*this.kx,k=(p[S+1][1]-A)*this.ky,P=0;R===0&&k===0||((P=(d(m[0]-I)*this.kx*R+(m[1]-A)*this.ky*k)/(R*R+k*k))>1?(I=p[S+1][0],A=p[S+1][1]):P>0&&(I+=R/this.kx*P,A+=k/this.ky*P));var O=(R=d(m[0]-I)*this.kx)*R+(k=(m[1]-A)*this.ky)*k;O<T&&(T=O,_=I,v=A,x=S,w=P)}return{point:[_,v],index:x,t:Math.max(0,Math.min(1,w))}},o.prototype.lineSlice=function(p,m,_){var v=this.pointOnLine(_,p),x=this.pointOnLine(_,m);if(v.index>x.index||v.index===x.index&&v.t>x.t){var w=v;v=x,x=w}var T=[v.point],S=v.index+1,I=x.index;!c(_[S],T[0])&&S<=I&&T.push(_[S]);for(var A=S+1;A<=I;A++)T.push(_[A]);return c(_[I],x.point)||T.push(x.point),T},o.prototype.lineSliceAlong=function(p,m,_){for(var v=0,x=[],w=0;w<_.length-1;w++){var T=_[w],S=_[w+1],I=this.distance(T,S);if((v+=I)>p&&x.length===0&&x.push(u(T,S,(p-(v-I))/I)),v>=m)return x.push(u(T,S,(m-(v-I))/I)),x;v>p&&x.push(S)}return x},o.prototype.bufferPoint=function(p,m){var _=m/this.ky,v=m/this.kx;return[p[0]-v,p[1]-_,p[0]+v,p[1]+_]},o.prototype.bufferBBox=function(p,m){var _=m/this.ky,v=m/this.kx;return[p[0]-v,p[1]-_,p[2]+v,p[3]+_]},o.prototype.insideBBox=function(p,m){return d(p[0]-m[0])>=0&&d(p[0]-m[2])<=0&&p[1]>=m[1]&&p[1]<=m[3]},Object.defineProperties(o,a),o}();var fv=$(DE.exports),BE={exports:{}};BE.exports=function(){var e=function(n,r){if(n===void 0&&(n=[]),r===void 0&&(r=t),this.data=n,this.length=this.data.length,this.compare=r,this.length>0)for(var o=(this.length>>1)-1;o>=0;o--)this._down(o)};function t(n,r){return n<r?-1:n>r?1:0}return e.prototype.push=function(n){this.data.push(n),this.length++,this._up(this.length-1)},e.prototype.pop=function(){if(this.length!==0){var n=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),n}},e.prototype.peek=function(){return this.data[0]},e.prototype._up=function(n){for(var r=this.data,o=this.compare,a=r[n];n>0;){var c=n-1>>1,u=r[c];if(o(a,u)>=0)break;r[n]=u,n=c}r[n]=a},e.prototype._down=function(n){for(var r=this.data,o=this.compare,a=this.length>>1,c=r[n];n<a;){var u=1+(n<<1),d=r[u],p=u+1;if(p<this.length&&o(r[p],d)<0&&(u=p,d=r[p]),o(d,c)>=0)break;r[n]=d,n=u}r[n]=c},e}();var pv=$(BE.exports),Rt=8192;function FE(e,t){return t.dist-e.dist}const mv=100,gv=50;function NE(e){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function em(e){return e[1]-e[0]+1}function Ra(e,t){const n=e[1]>=e[0]&&e[1]<t;return n||console.warn("Distance Expression: Index is out of range"),n}function _v(e,t){if(e[0]>e[1])return[null,null];const n=em(e);if(t){if(n===2)return[e,null];const r=Math.floor(n/2);return[[e[0],e[0]+r],[e[0]+r,e[1]]]}{if(n===1)return[e,null];const r=Math.floor(n/2)-1;return[[e[0],e[0]+r],[e[0]+r+1,e[1]]]}}function bc(e,t){const n=[1/0,1/0,-1/0,-1/0];if(!Ra(t,e.length))return n;for(let r=t[0];r<=t[1];++r)zd(n,e[r]);return n}function nm(e){const t=[1/0,1/0,-1/0,-1/0];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)zd(t,e[n][r]);return t}function Ou(e,t,n){if(NE(e)||NE(t))return NaN;let r=0,o=0;return e[2]<t[0]&&(r=t[0]-e[2]),e[0]>t[2]&&(r=e[0]-t[2]),e[1]>t[3]&&(o=e[1]-t[3]),e[3]<t[1]&&(o=t[1]-e[3]),n.distance([0,0],[r,o])}function yv(e,t){const n=Math.pow(2,t.z);return[(o=(e.x/Rt+t.x)/n,360*o-180),(r=(e.y/Rt+t.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90)];var r,o}function UB(e,t){const n=[];for(let r=0;r<e.length;++r)n.push(yv(e[r],t));return n}function jE(e,t,n){const r=n.pointOnLine(t,e).point;return n.distance(e,r)}function UE(e,t,n,r,o){const a=n.slice(r[0],r[1]+1);let c=1/0;for(let u=t[0];u<=t[1];++u)if((c=Math.min(c,jE(e[u],a,o)))===0)return 0;return c}function vv(e,t,n,r,o){const a=Math.min(o.pointToSegmentDistance(e,n,r),o.pointToSegmentDistance(t,n,r)),c=Math.min(o.pointToSegmentDistance(n,e,t),o.pointToSegmentDistance(r,e,t));return Math.min(a,c)}function $B(e,t,n,r,o){if(!Ra(t,e.length)||!Ra(r,n.length))return NaN;let a=1/0;for(let c=t[0];c<t[1];++c)for(let u=r[0];u<r[1];++u){if(tm(e[c],e[c+1],n[u],n[u+1]))return 0;a=Math.min(a,vv(e[c],e[c+1],n[u],n[u+1],o))}return a}function VB(e,t,n,r,o){if(!Ra(t,e.length)||!Ra(r,n.length))return NaN;let a=1/0;for(let c=t[0];c<=t[1];++c)for(let u=r[0];u<=r[1];++u)if((a=Math.min(a,o.distance(e[c],n[u])))===0)return a;return a}function GB(e,t,n){if(ku(e,t,!0))return 0;let r=1/0;for(const o of t){const a=o.length;if(a<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(o[0]!==o[a-1]&&(r=Math.min(r,n.pointToSegmentDistance(e,o[a-1],o[0])))===0||(r=Math.min(r,jE(e,o,n)))===0)return r}return r}function WB(e,t,n,r){if(!Ra(t,e.length))return NaN;for(let a=t[0];a<=t[1];++a)if(ku(e[a],n,!0))return 0;let o=1/0;for(let a=t[0];a<t[1];++a)for(const c of n)for(let u=0,d=c.length,p=d-1;u<d;p=u++){if(tm(e[a],e[a+1],c[p],c[u]))return 0;o=Math.min(o,vv(e[a],e[a+1],c[p],c[u],r))}return o}function $E(e,t){for(const n of e)for(let r=0;r<=n.length-1;++r)if(ku(n[r],t,!0))return!0;return!1}function qB(e,t,n,r=1/0){const o=nm(e),a=nm(t);if(r!==1/0&&Ou(o,a,n)>=r)return r;if(Dd(o,a)){if($E(e,t))return 0}else if($E(t,e))return 0;let c=r;for(const u of e)for(let d=0,p=u.length,m=p-1;d<p;m=d++)for(const _ of t)for(let v=0,x=_.length,w=x-1;v<x;w=v++){if(tm(u[m],u[d],_[w],_[v]))return 0;c=Math.min(c,vv(u[m],u[d],_[w],_[v],n))}return c}function rm(e,t,n,r,o,a,c){if(a===null||c===null)return;const u=Ou(bc(r,a),bc(o,c),n);u<t&&e.push({dist:u,range1:a,range2:c})}function HB(e,t,n,r,o=1/0){let a=Math.min(r.distance(e[0],n[0][0]),o);if(a===0)return a;const c=new pv([{dist:0,range1:[0,e.length-1],range2:[0,0]}],FE),u=t?gv:mv,d=nm(n);for(;c.length;){const p=c.pop();if(p.dist>=a)continue;const m=p.range1;if(em(m)<=u){if(!Ra(m,e.length))return NaN;if(t){const _=WB(e,m,n,r);if((a=Math.min(a,_))===0)return a}else for(let _=m[0];_<=m[1];++_){const v=GB(e[_],n,r);if((a=Math.min(a,v))===0)return a}}else{const _=_v(m,t);if(_[0]!==null){const v=Ou(bc(e,_[0]),d,r);v<a&&c.push({dist:v,range1:_[0],range2:[0,0]})}if(_[1]!==null){const v=Ou(bc(e,_[1]),d,r);v<a&&c.push({dist:v,range1:_[1],range2:[0,0]})}}}return a}function VE(e,t,n,r,o,a=1/0){let c=Math.min(a,o.distance(e[0],n[0]));if(c===0)return c;const u=new pv([{dist:0,range1:[0,e.length-1],range2:[0,n.length-1]}],FE),d=t?gv:mv,p=r?gv:mv;for(;u.length;){const m=u.pop();if(m.dist>=c)continue;const _=m.range1,v=m.range2;if(em(_)<=d&&em(v)<=p){if(!Ra(_,e.length)||!Ra(v,n.length))return NaN;if(t&&r?c=Math.min(c,$B(e,_,n,v,o)):t||r?t&&!r?c=Math.min(c,UE(n,v,e,_,o)):!t&&r&&(c=Math.min(c,UE(e,_,n,v,o))):c=Math.min(c,VB(e,_,n,v,o)),c===0)return c}else{const x=_v(_,t),w=_v(v,r);rm(u,c,o,e,n,x[0],w[0]),rm(u,c,o,e,n,x[0],w[1]),rm(u,c,o,e,n,x[1],w[0]),rm(u,c,o,e,n,x[1],w[1])}}return c}function xv(e,t,n,r,o=1/0){let a=o;const c=bc(e,[0,e.length-1]);for(const u of n)if(!(a!==1/0&&Ou(c,bc(u,[0,u.length-1]),r)>=a)&&(a=Math.min(a,VE(e,t,u,!0,r,a)),a===0))return a;return a}function im(e,t,n,r,o=1/0){let a=o;const c=bc(e,[0,e.length-1]);for(const u of n){if(a!==1/0&&Ou(c,nm(u),r)>=a)continue;const d=HB(e,t,u,r,a);if(isNaN(d))return d;if((a=Math.min(a,d))===0)return a}return a}function bv(e){return e==="Point"||e==="MultiPoint"||e==="LineString"||e==="MultiLineString"||e==="Polygon"||e==="MultiPolygon"}class Fd{constructor(t,n){this.type=me,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(Ru(t[1])){const r=t[1];if(r.type==="FeatureCollection"){for(let o=0;o<r.features.length;++o)if(bv(r.features[o].geometry.type))return new Fd(r,r.features[o].geometry)}else if(r.type==="Feature"){if(bv(r.geometry.type))return new Fd(r,r.geometry)}else if(bv(r.type))return new Fd(r,r)}return n.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const n=t.geometry(),r=t.canonicalID();if(n!=null&&r!=null){if(t.geometryType()==="Point")return function(o,a,c){const u=[];for(const p of o)for(const m of p)u.push(yv(m,a));const d=new fv(u[0][1],"meters");return c.type==="Point"||c.type==="MultiPoint"||c.type==="LineString"?VE(u,!1,c.type==="Point"?[c.coordinates]:c.coordinates,c.type==="LineString",d):c.type==="MultiLineString"?xv(u,!1,c.coordinates,d):c.type==="Polygon"||c.type==="MultiPolygon"?im(u,!1,c.type==="Polygon"?[c.coordinates]:c.coordinates,d):null}(n,r,this.geometries);if(t.geometryType()==="LineString")return function(o,a,c){const u=[];for(const p of o){const m=[];for(const _ of p)m.push(yv(_,a));u.push(m)}const d=new fv(u[0][0][1],"meters");if(c.type==="Point"||c.type==="MultiPoint"||c.type==="LineString")return xv(c.type==="Point"?[c.coordinates]:c.coordinates,c.type==="LineString",u,d);if(c.type==="MultiLineString"){let p=1/0;for(let m=0;m<c.coordinates.length;m++){const _=xv(c.coordinates[m],!0,u,d,p);if(isNaN(_))return _;if((p=Math.min(p,_))===0)return p}return p}if(c.type==="Polygon"||c.type==="MultiPolygon"){let p=1/0;for(let m=0;m<u.length;m++){const _=im(u[m],!0,c.type==="Polygon"?[c.coordinates]:c.coordinates,d,p);if(isNaN(_))return _;if((p=Math.min(p,_))===0)return p}return p}return null}(n,r,this.geometries);if(t.geometryType()==="Polygon")return function(o,a,c){const u=[];for(const p of function(m,_){const v=m.length;if(v<=1)return[m];const x=[];let w,T;for(let S=0;S<v;S++){const I=zB(m[S]);I!==0&&(m[S].area=Math.abs(I),T===void 0&&(T=I<0),T===I<0?(w&&x.push(w),w=[m[S]]):w.push(m[S]))}return w&&x.push(w),x}(o)){const m=[];for(let _=0;_<p.length;++_)m.push(UB(p[_],a));u.push(m)}const d=new fv(u[0][0][0][1],"meters");if(c.type==="Point"||c.type==="MultiPoint"||c.type==="LineString")return im(c.type==="Point"?[c.coordinates]:c.coordinates,c.type==="LineString",u,d);if(c.type==="MultiLineString"){let p=1/0;for(let m=0;m<c.coordinates.length;m++){const _=im(c.coordinates[m],!0,u,d,p);if(isNaN(_))return _;if((p=Math.min(p,_))===0)return p}return p}return c.type==="Polygon"||c.type==="MultiPolygon"?function(p,m,_){let v=1/0;for(const x of p)for(const w of m){const T=qB(x,w,_,v);if(isNaN(T))return T;if((v=Math.min(v,T))===0)return v}return v}(c.type==="Polygon"?[c.coordinates]:c.coordinates,u,d):null}(n,r,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var wv=Fd;function Lu(e){if(e instanceof Js&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof dv||e instanceof wv)return!1;let t=!0;return e.eachChild(n=>{t&&!Lu(n)&&(t=!1)}),t}function Nd(e){if(e instanceof Js&&e.name==="feature-state")return!1;let t=!0;return e.eachChild(n=>{t&&!Nd(n)&&(t=!1)}),t}function Tv(e){if(e instanceof Js&&e.name==="config")return!1;let t=!0;return e.eachChild(n=>{t&&!Tv(n)&&(t=!1)}),t}function zu(e,t){if(e instanceof Js&&t.indexOf(e.name)>=0)return!1;let n=!0;return e.eachChild(r=>{n&&!zu(r,t)&&(n=!1)}),n}class Sv{constructor(t,n){this.type=n.type,this.name=t,this.boundExpression=n}static parse(t,n){if(t.length!==2||typeof t[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const r=t[1];return n.scope.has(r)?new Sv(r,n.scope.get(r)):n.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var GE=Sv;class Ev{constructor(t,n=[],r,o=new Aa,a=[],c){this.registry=t,this.path=n,this.key=n.map(u=>`[${u}]`).join(""),this.scope=o,this.errors=a,this.expectedType=r,this.options=c}parse(t,n,r,o,a={}){return n||r?this.concat(n,r,o)._parse(t,a):this._parse(t,a)}_parse(t,n){function r(o,a,c){return c==="assert"?new Pa(a,[o]):c==="coerce"?new vc(a,[o]):o}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const o=typeof t[0]=="string"?this.registry[t[0]]:void 0;if(o){let a=o.parse(t,this);if(!a)return null;if(this.expectedType){const c=this.expectedType,u=a.type;if(c.kind!=="string"&&c.kind!=="number"&&c.kind!=="boolean"&&c.kind!=="object"&&c.kind!=="array"||u.kind!=="value")if(c.kind!=="color"&&c.kind!=="formatted"&&c.kind!=="resolvedImage"||u.kind!=="value"&&u.kind!=="string"){if(this.checkSubtype(c,u))return null}else a=r(a,c,n.typeAnnotation||"coerce");else a=r(a,c,n.typeAnnotation||"assert")}if(!(a instanceof kd)&&a.type.kind!=="resolvedImage"&&Cv(a)){const c=new IE(this.options);try{a=new kd(a.type,a.evaluate(c))}catch(u){return this.error(u.message),null}}return a}return vc.parse(["to-array",t],this)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,n,r){const o=typeof t=="number"?this.path.concat(t):this.path,a=r?this.scope.concat(r):this.scope;return new Ev(this.registry,o,n||null,a,this.errors,this.options)}error(t,...n){const r=`${this.key}${n.map(o=>`[${o}]`).join("")}`;this.errors.push(new ao(r,t))}checkSubtype(t,n){const r=Yr(t,n);return r&&this.error(r),r}}var WE=Ev;function Cv(e){if(e instanceof GE)return Cv(e.boundExpression);if(e instanceof Js&&e.name==="error"||e instanceof Js&&e.name==="config"||e instanceof Jp||e instanceof dv||e instanceof wv)return!1;const t=e instanceof vc||e instanceof Pa;let n=!0;return e.eachChild(r=>{n=t?n&&Cv(r):n&&r instanceof kd}),!!n&&Lu(e)&&zu(e,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light"])}function om(e,t){const n=e.length-1;let r,o,a=0,c=n,u=0;for(;a<=c;)if(u=Math.floor((a+c)/2),r=e[u],o=e[u+1],r<=t){if(u===n||t<o)return u;a=u+1}else{if(!(r>t))throw new xi("Input is not a number.");c=u-1}return 0}class Mv{constructor(t,n,r){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(const[o,a]of r)this.labels.push(o),this.outputs.push(a)}static parse(t,n){if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");const r=n.parse(t[1],1,me);if(!r)return null;const o=[];let a=null;n.expectedType&&n.expectedType.kind!=="value"&&(a=n.expectedType);for(let c=1;c<t.length;c+=2){const u=c===1?-1/0:t[c],d=t[c+1],p=c,m=c+1;if(typeof u!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(o.length&&o[o.length-1][0]>=u)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',p);const _=n.parse(d,m,a);if(!_)return null;a=a||_.type,o.push([u,_])}return new Mv(a,r,o)}evaluate(t){const n=this.labels,r=this.outputs;if(n.length===1)return r[0].evaluate(t);const o=this.input.evaluate(t);if(o<=n[0])return r[0].evaluate(t);const a=n.length;return o>=n[a-1]?r[a-1].evaluate(t):r[om(n,o)].evaluate(t)}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&t.push(this.labels[n]),t.push(this.outputs[n].serialize());return t}}var Iv=Mv;function Xe(e,t,n){return e*(1-n)+t*n}function qE(e,t,n){return e.map((r,o)=>Xe(r,t[o],n))}var sm=Object.freeze({__proto__:null,array:qE,color:function(e,t,n){return new en(Xe(e.r,t.r,n),Xe(e.g,t.g,n),Xe(e.b,t.b,n),Xe(e.a,t.a,n))},number:Xe});const HE=.95047,ZE=1.08883,XE=4/29,Du=6/29,KE=3*Du*Du,ZB=Du*Du*Du,XB=Math.PI/180,KB=180/Math.PI;function Av(e){return e>ZB?Math.pow(e,1/3):e/KE+XE}function Pv(e){return e>Du?e*e*e:KE*(e-XE)}function Rv(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function kv(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function YE(e){const t=kv(e.r),n=kv(e.g),r=kv(e.b),o=Av((.4124564*t+.3575761*n+.1804375*r)/HE),a=Av((.2126729*t+.7151522*n+.072175*r)/1);return{l:116*a-16,a:500*(o-a),b:200*(a-Av((.0193339*t+.119192*n+.9503041*r)/ZE)),alpha:e.a}}function QE(e){let t=(e.l+16)/116,n=isNaN(e.a)?t:t+e.a/500,r=isNaN(e.b)?t:t-e.b/200;return t=1*Pv(t),n=HE*Pv(n),r=ZE*Pv(r),new en(Rv(3.2404542*n-1.5371385*t-.4985314*r),Rv(-.969266*n+1.8760108*t+.041556*r),Rv(.0556434*n-.2040259*t+1.0572252*r),e.alpha)}function YB(e,t,n){const r=t-e;return e+n*(r>180||r<-180?r-360*Math.round(r/360):r)}const jd={forward:YE,reverse:QE,interpolate:function(e,t,n){return{l:Xe(e.l,t.l,n),a:Xe(e.a,t.a,n),b:Xe(e.b,t.b,n),alpha:Xe(e.alpha,t.alpha,n)}}},Ud={forward:function(e){const{l:t,a:n,b:r}=YE(e),o=Math.atan2(r,n)*KB;return{h:o<0?o+360:o,c:Math.sqrt(n*n+r*r),l:t,alpha:e.a}},reverse:function(e){const t=e.h*XB,n=e.c;return QE({l:e.l,a:Math.cos(t)*n,b:Math.sin(t)*n,alpha:e.alpha})},interpolate:function(e,t,n){return{h:YB(e.h,t.h,n),c:Xe(e.c,t.c,n),l:Xe(e.l,t.l,n),alpha:Xe(e.alpha,t.alpha,n)}}};var JE=Object.freeze({__proto__:null,hcl:Ud,lab:jd});class am{constructor(t,n,r,o,a){this.type=t,this.operator=n,this.interpolation=r,this.input=o,this.labels=[],this.outputs=[];for(const[c,u]of a)this.labels.push(c),this.outputs.push(u)}static interpolationFactor(t,n,r,o){let a=0;if(t.name==="exponential")a=Ov(n,t.base,r,o);else if(t.name==="linear")a=Ov(n,1,r,o);else if(t.name==="cubic-bezier"){const c=t.controlPoints;a=new st(c[0],c[1],c[2],c[3]).solve(Ov(n,1,r,o))}return a}static parse(t,n){let[r,o,a,...c]=t;if(!Array.isArray(o)||o.length===0)return n.error("Expected an interpolation type expression.",1);if(o[0]==="linear")o={name:"linear"};else if(o[0]==="exponential"){const p=o[1];if(typeof p!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);o={name:"exponential",base:p}}else{if(o[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(o[0])}`,1,0);{const p=o.slice(1);if(p.length!==4||p.some(m=>typeof m!="number"||m<0||m>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);o={name:"cubic-bezier",controlPoints:p}}}if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(a=n.parse(a,2,me),!a)return null;const u=[];let d=null;r==="interpolate-hcl"||r==="interpolate-lab"?d=ji:n.expectedType&&n.expectedType.kind!=="value"&&(d=n.expectedType);for(let p=0;p<c.length;p+=2){const m=c[p],_=c[p+1],v=p+3,x=p+4;if(typeof m!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',v);if(u.length&&u[u.length-1][0]>=m)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',v);const w=n.parse(_,x,d);if(!w)return null;d=d||w.type,u.push([m,w])}return d.kind==="number"||d.kind==="color"||d.kind==="array"&&d.itemType.kind==="number"&&typeof d.N=="number"?new am(d,r,o,a,u):n.error(`Type ${Tn(d)} is not interpolatable.`)}evaluate(t){const n=this.labels,r=this.outputs;if(n.length===1)return r[0].evaluate(t);const o=this.input.evaluate(t);if(o<=n[0])return r[0].evaluate(t);const a=n.length;if(o>=n[a-1])return r[a-1].evaluate(t);const c=om(n,o),u=am.interpolationFactor(this.interpolation,o,n[c],n[c+1]),d=r[c].evaluate(t),p=r[c+1].evaluate(t);return this.operator==="interpolate"?sm[this.type.kind.toLowerCase()](d,p,u):this.operator==="interpolate-hcl"?Ud.reverse(Ud.interpolate(Ud.forward(d),Ud.forward(p),u)):jd.reverse(jd.interpolate(jd.forward(d),jd.forward(p),u))}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const n=[this.operator,t,this.input.serialize()];for(let r=0;r<this.labels.length;r++)n.push(this.labels[r],this.outputs[r].serialize());return n}}function Ov(e,t,n,r){const o=r-n,a=e-n;return o===0?0:t===1?a/o:(Math.pow(t,a)-1)/(Math.pow(t,o)-1)}var ta=am;class Lv{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expectected at least one argument.");let r=null;const o=n.expectedType;o&&o.kind!=="value"&&(r=o);const a=[];for(const u of t.slice(1)){const d=n.parse(u,1+a.length,r,void 0,{typeAnnotation:"omit"});if(!d)return null;r=r||d.type,a.push(d)}const c=o&&a.some(u=>Yr(o,u.type));return new Lv(c?bt:r,a)}evaluate(t){let n,r=null,o=0;for(const a of this.args){if(o++,r=a.evaluate(t),r&&r instanceof as&&!r.available&&(n||(n=r),r=null,o===this.args.length))return n;if(r!==null)break}return r}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(n=>{t.push(n.serialize())}),t}}var tC=Lv;class zv{constructor(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const n of this.bindings)t(n[1]);t(this.result)}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const r=[];for(let a=1;a<t.length-1;a+=2){const c=t[a];if(typeof c!="string")return n.error(`Expected string, but found ${typeof c} instead.`,a);if(/[^a-zA-Z0-9_]/.test(c))return n.error("Variable names must contain only alphanumeric characters or '_'.",a);const u=n.parse(t[a+1],a+1);if(!u)return null;r.push([c,u])}const o=n.parse(t[t.length-1],t.length-1,n.expectedType,r);return o?new zv(r,o):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[n,r]of this.bindings)t.push(n,r.serialize());return t.push(this.result.serialize()),t}}var eC=zv;class Dv{constructor(t,n,r){this.type=t,this.index=n,this.input=r}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const r=n.parse(t[1],1,me),o=n.parse(t[2],2,an(n.expectedType||bt));return r&&o?new Dv(o.type.itemType,r,o):null}evaluate(t){const n=this.index.evaluate(t),r=this.input.evaluate(t);if(n<0)throw new xi(`Array index out of bounds: ${n} < 0.`);if(n>=r.length)throw new xi(`Array index out of bounds: ${n} > ${r.length-1}.`);if(n!==Math.floor(n))throw new xi(`Array index must be an integer, but found ${n} instead.`);return r[n]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var QB=Dv;class Bv{constructor(t,n){this.type=Cn,this.needle=t,this.haystack=n}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const r=n.parse(t[1],1,bt),o=n.parse(t[2],2,bt);return r&&o?Rr(r.type,[Cn,gn,me,lo,bt])?new Bv(r,o):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Tn(r.type)} instead`):null}evaluate(t){const n=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(r==null)return!1;if(!Ii(n,["boolean","string","number","null"]))throw new xi(`Expected first argument to be of type boolean, string, number or null, but found ${Tn(ui(n))} instead.`);if(!Ii(r,["string","array"]))throw new xi(`Expected second argument to be of type array or string, but found ${Tn(ui(r))} instead.`);return r.indexOf(n)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var JB=Bv;class lm{constructor(t,n,r){this.type=me,this.needle=t,this.haystack=n,this.fromIndex=r}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const r=n.parse(t[1],1,bt),o=n.parse(t[2],2,bt);if(!r||!o)return null;if(!Rr(r.type,[Cn,gn,me,lo,bt]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Tn(r.type)} instead`);if(t.length===4){const a=n.parse(t[3],3,me);return a?new lm(r,o,a):null}return new lm(r,o)}evaluate(t){const n=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!Ii(n,["boolean","string","number","null"]))throw new xi(`Expected first argument to be of type boolean, string, number or null, but found ${Tn(ui(n))} instead.`);if(!Ii(r,["string","array"]))throw new xi(`Expected second argument to be of type array or string, but found ${Tn(ui(r))} instead.`);if(this.fromIndex){const o=this.fromIndex.evaluate(t);return r.indexOf(n,o)}return r.indexOf(n)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var tF=lm;class Fv{constructor(t,n,r,o,a,c){this.inputType=t,this.type=n,this.input=r,this.cases=o,this.outputs=a,this.otherwise=c}static parse(t,n){if(t.length<5)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return n.error("Expected an even number of arguments.");let r,o;n.expectedType&&n.expectedType.kind!=="value"&&(o=n.expectedType);const a={},c=[];for(let p=2;p<t.length-1;p+=2){let m=t[p];const _=t[p+1];Array.isArray(m)||(m=[m]);const v=n.concat(p);if(m.length===0)return v.error("Expected at least one branch label.");for(const w of m){if(typeof w!="number"&&typeof w!="string")return v.error("Branch labels must be numbers or strings.");if(typeof w=="number"&&Math.abs(w)>Number.MAX_SAFE_INTEGER)return v.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof w=="number"&&Math.floor(w)!==w)return v.error("Numeric branch labels must be integer values.");if(r){if(v.checkSubtype(r,ui(w)))return null}else r=ui(w);if(a[String(w)]!==void 0)return v.error("Branch labels must be unique.");a[String(w)]=c.length}const x=n.parse(_,p,o);if(!x)return null;o=o||x.type,c.push(x)}const u=n.parse(t[1],1,bt);if(!u)return null;const d=n.parse(t[t.length-1],t.length-1,o);return d?u.type.kind!=="value"&&n.concat(1).checkSubtype(r,u.type)?null:new Fv(r,o,u,a,c,d):null}evaluate(t){const n=this.input.evaluate(t);return(ui(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),r=[],o={};for(const c of n){const u=o[this.cases[c]];u===void 0?(o[this.cases[c]]=r.length,r.push([this.cases[c],[c]])):r[u][1].push(c)}const a=c=>this.inputType.kind==="number"?Number(c):c;for(const[c,u]of r)t.push(u.length===1?a(u[0]):u.map(a)),t.push(this.outputs[c].serialize());return t.push(this.otherwise.serialize()),t}}var eF=Fv;class Nv{constructor(t,n,r){this.type=t,this.branches=n,this.otherwise=r}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return n.error("Expected an odd number of arguments.");let r;n.expectedType&&n.expectedType.kind!=="value"&&(r=n.expectedType);const o=[];for(let c=1;c<t.length-1;c+=2){const u=n.parse(t[c],c,Cn);if(!u)return null;const d=n.parse(t[c+1],c+1,r);if(!d)return null;o.push([u,d]),r=r||d.type}const a=n.parse(t[t.length-1],t.length-1,r);return a?new Nv(r,o,a):null}evaluate(t){for(const[n,r]of this.branches)if(n.evaluate(t))return r.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[n,r]of this.branches)t(n),t(r);t(this.otherwise)}outputDefined(){return this.branches.every(([t,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(n=>{t.push(n.serialize())}),t}}var nF=Nv;class cm{constructor(t,n,r,o){this.type=t,this.input=n,this.beginIndex=r,this.endIndex=o}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const r=n.parse(t[1],1,bt),o=n.parse(t[2],2,me);if(!r||!o)return null;if(!Rr(r.type,[an(bt),gn,bt]))return n.error(`Expected first argument to be of type array or string, but found ${Tn(r.type)} instead`);if(t.length===4){const a=n.parse(t[3],3,me);return a?new cm(r.type,r,o,a):null}return new cm(r.type,r,o)}evaluate(t){const n=this.input.evaluate(t),r=this.beginIndex.evaluate(t);if(!Ii(n,["string","array"]))throw new xi(`Expected first argument to be of type array or string, but found ${Tn(ui(n))} instead.`);if(this.endIndex){const o=this.endIndex.evaluate(t);return n.slice(r,o)}return n.slice(r)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var rF=cm;function nC(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function rC(e,t,n,r){return r.compare(t,n)===0}function Bu(e,t,n){const r=e!=="=="&&e!=="!=";return class q5{constructor(a,c,u){this.type=Cn,this.lhs=a,this.rhs=c,this.collator=u,this.hasUntypedArgument=a.type.kind==="value"||c.type.kind==="value"}static parse(a,c){if(a.length!==3&&a.length!==4)return c.error("Expected two or three arguments.");const u=a[0];let d=c.parse(a[1],1,bt);if(!d)return null;if(!nC(u,d.type))return c.concat(1).error(`"${u}" comparisons are not supported for type '${Tn(d.type)}'.`);let p=c.parse(a[2],2,bt);if(!p)return null;if(!nC(u,p.type))return c.concat(2).error(`"${u}" comparisons are not supported for type '${Tn(p.type)}'.`);if(d.type.kind!==p.type.kind&&d.type.kind!=="value"&&p.type.kind!=="value")return c.error(`Cannot compare types '${Tn(d.type)}' and '${Tn(p.type)}'.`);r&&(d.type.kind==="value"&&p.type.kind!=="value"?d=new Pa(p.type,[d]):d.type.kind!=="value"&&p.type.kind==="value"&&(p=new Pa(d.type,[p])));let m=null;if(a.length===4){if(d.type.kind!=="string"&&p.type.kind!=="string"&&d.type.kind!=="value"&&p.type.kind!=="value")return c.error("Cannot use collator to compare non-string types.");if(m=c.parse(a[3],3,fe),!m)return null}return new q5(d,p,m)}evaluate(a){const c=this.lhs.evaluate(a),u=this.rhs.evaluate(a);if(r&&this.hasUntypedArgument){const d=ui(c),p=ui(u);if(d.kind!==p.kind||d.kind!=="string"&&d.kind!=="number")throw new xi(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${d.kind}, ${p.kind}) instead.`)}if(this.collator&&!r&&this.hasUntypedArgument){const d=ui(c),p=ui(u);if(d.kind!=="string"||p.kind!=="string")return t(a,c,u)}return this.collator?n(a,c,u,this.collator.evaluate(a)):t(a,c,u)}eachChild(a){a(this.lhs),a(this.rhs),this.collator&&a(this.collator)}outputDefined(){return!0}serialize(){const a=[e];return this.eachChild(c=>{a.push(c.serialize())}),a}}}const iF=Bu("==",function(e,t,n){return t===n},rC),oF=Bu("!=",function(e,t,n){return t!==n},function(e,t,n,r){return!rC(0,t,n,r)}),sF=Bu("<",function(e,t,n){return t<n},function(e,t,n,r){return r.compare(t,n)<0}),aF=Bu(">",function(e,t,n){return t>n},function(e,t,n,r){return r.compare(t,n)>0}),lF=Bu("<=",function(e,t,n){return t<=n},function(e,t,n,r){return r.compare(t,n)<=0}),cF=Bu(">=",function(e,t,n){return t>=n},function(e,t,n,r){return r.compare(t,n)>=0});class jv{constructor(t,n,r,o,a,c){this.type=gn,this.number=t,this.locale=n,this.currency=r,this.unit=o,this.minFractionDigits=a,this.maxFractionDigits=c}static parse(t,n){if(t.length!==3)return n.error("Expected two arguments.");const r=n.parse(t[1],1,me);if(!r)return null;const o=t[2];if(typeof o!="object"||Array.isArray(o))return n.error("NumberFormat options argument must be an object.");let a=null;if(o.locale&&(a=n.parse(o.locale,1,gn),!a))return null;let c=null;if(o.currency&&(c=n.parse(o.currency,1,gn),!c))return null;let u=null;if(o.unit&&(u=n.parse(o.unit,1,gn),!u))return null;let d=null;if(o["min-fraction-digits"]&&(d=n.parse(o["min-fraction-digits"],1,me),!d))return null;let p=null;return o["max-fraction-digits"]&&(p=n.parse(o["max-fraction-digits"],1,me),!p)?null:new jv(r,a,c,u,d,p)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class Uv{constructor(t){this.type=me,this.input=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const r=n.parse(t[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Tn(r.type)} instead.`):new Uv(r):null}evaluate(t){const n=this.input.evaluate(t);if(typeof n=="string"||Array.isArray(n))return n.length;throw new xi(`Expected value to be of type string or array, but found ${Tn(ui(n))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(n=>{t.push(n.serialize())}),t}}function $v(e){return function(){e=1831565813+(e|=0)|0;let t=Math.imul(e^e>>>15,1|e);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const iC={"==":iF,"!=":oF,">":aF,"<":sF,">=":cF,"<=":lF,array:Pa,at:QB,boolean:Pa,case:nF,coalesce:tC,collator:Jp,format:Od,image:Ld,in:JB,"index-of":tF,interpolate:ta,"interpolate-hcl":ta,"interpolate-lab":ta,length:Uv,let:eC,literal:kd,match:eF,number:Pa,"number-format":jv,object:Pa,slice:rF,step:Iv,string:Pa,"to-boolean":vc,"to-color":vc,"to-number":vc,"to-string":vc,var:GE,within:dv,distance:wv};function oC(e,[t,n,r,o]){t=t.evaluate(e),n=n.evaluate(e),r=r.evaluate(e);const a=o?o.evaluate(e):1,c=ME(t,n,r,a);if(c)throw new xi(c);return new en(t/255*a,n/255*a,r/255*a,a)}function sC(e,[t,n,r,o]){t=t.evaluate(e),n=n.evaluate(e),r=r.evaluate(e);const a=o?o.evaluate(e):1,c=function(p,m,_,v){return typeof p=="number"&&p>=0&&p<=360?typeof m=="number"&&m>=0&&m<=100&&typeof _=="number"&&_>=0&&_<=100?v===void 0||typeof v=="number"&&v>=0&&v<=1?null:`Invalid hsla value [${[p,m,_,v].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof v=="number"?[p,m,_,v]:[p,m,_]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof v=="number"?[p,m,_,v]:[p,m,_]).join(", ")}]: 'h' must be between 0 and 360.`}(t,n,r,a);if(c)throw new xi(c);const u=`hsla(${t}, ${n}%, ${r}%, ${a})`,d=en.parse(u);if(!d)throw new xi(`Failed to parse HSLA color: ${u}`);return d}function aC(e,t){return e in t}function Vv(e,t){const n=t[e];return n===void 0?null:n}function lC(e,t){switch(e){case"string":return String(t);case"number":return+t;case"boolean":return!!t;case"color":return en.parse(t)}return t}function cC(e,t,n,r){return r!==void 0&&(e=r*Math.round(e/r)),t!==void 0&&e<t&&(e=t),n!==void 0&&e>n&&(e=n),e}function uC(e,t,n){n.length&&(t+=`${n}`);const r=e.getConfig(t);if(!r)return null;const{type:o,value:a,values:c,minValue:u,maxValue:d,stepValue:p}=r,m=r.default.evaluate(e);let _=a?a.evaluate(e):m;return o&&(_=lC(o,_)),a!==void 0&&_!==void 0&&c&&!c.includes(_)&&(_=m,o&&(_=lC(o,_))),_===void 0||u===void 0&&d===void 0&&p===void 0||(typeof _=="number"?_=cC(_,u,d,p):Array.isArray(_)&&(_=_.map(v=>typeof v=="number"?cC(v,u,d,p):v))),_}function wc(e){return{type:e}}Js.register(iC,{error:[{kind:"error"},[gn],(e,[t])=>{throw new xi(t.evaluate(e))}],typeof:[gn,[bt],(e,[t])=>Tn(ui(t.evaluate(e)))],"to-rgba":[an(me,4),[ji],(e,[t])=>t.evaluate(e).toArray()],rgb:[ji,[me,me,me],oC],rgba:[ji,[me,me,me,me],oC],hsl:[ji,[me,me,me],sC],hsla:[ji,[me,me,me,me],sC],has:{type:Cn,overloads:[[[gn],(e,[t])=>aC(t.evaluate(e),e.properties())],[[gn,mt],(e,[t,n])=>aC(t.evaluate(e),n.evaluate(e))]]},get:{type:bt,overloads:[[[gn],(e,[t])=>Vv(t.evaluate(e),e.properties())],[[gn,mt],(e,[t,n])=>Vv(t.evaluate(e),n.evaluate(e))]]},config:{type:bt,overloads:[[[gn],(e,[t])=>uC(e,t.evaluate(e),"")],[[gn,gn],(e,[t,n])=>uC(e,t.evaluate(e),n.evaluate(e))]]},"feature-state":[bt,[gn],(e,[t])=>Vv(t.evaluate(e),e.featureState||{})],properties:[mt,[],e=>e.properties()],"geometry-type":[gn,[],e=>e.geometryType()],id:[bt,[],e=>e.id()],zoom:[me,[],e=>e.globals.zoom],pitch:[me,[],e=>e.globals.pitch||0],"distance-from-center":[me,[],e=>e.distanceFromCenter()],"measure-light":[me,[gn],(e,[t])=>e.measureLight(t.evaluate(e))],"heatmap-density":[me,[],e=>e.globals.heatmapDensity||0],"line-progress":[me,[],e=>e.globals.lineProgress||0],"raster-value":[me,[],e=>e.globals.rasterValue||0],"sky-radial-progress":[me,[],e=>e.globals.skyRadialProgress||0],accumulated:[bt,[],e=>e.globals.accumulated===void 0?null:e.globals.accumulated],"+":[me,wc(me),(e,t)=>{let n=0;for(const r of t)n+=r.evaluate(e);return n}],"*":[me,wc(me),(e,t)=>{let n=1;for(const r of t)n*=r.evaluate(e);return n}],"-":{type:me,overloads:[[[me,me],(e,[t,n])=>t.evaluate(e)-n.evaluate(e)],[[me],(e,[t])=>-t.evaluate(e)]]},"/":[me,[me,me],(e,[t,n])=>t.evaluate(e)/n.evaluate(e)],"%":[me,[me,me],(e,[t,n])=>t.evaluate(e)%n.evaluate(e)],ln2:[me,[],()=>Math.LN2],pi:[me,[],()=>Math.PI],e:[me,[],()=>Math.E],"^":[me,[me,me],(e,[t,n])=>Math.pow(t.evaluate(e),n.evaluate(e))],sqrt:[me,[me],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[me,[me],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[me,[me],(e,[t])=>Math.log(t.evaluate(e))],log2:[me,[me],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[me,[me],(e,[t])=>Math.sin(t.evaluate(e))],cos:[me,[me],(e,[t])=>Math.cos(t.evaluate(e))],tan:[me,[me],(e,[t])=>Math.tan(t.evaluate(e))],asin:[me,[me],(e,[t])=>Math.asin(t.evaluate(e))],acos:[me,[me],(e,[t])=>Math.acos(t.evaluate(e))],atan:[me,[me],(e,[t])=>Math.atan(t.evaluate(e))],min:[me,wc(me),(e,t)=>Math.min(...t.map(n=>n.evaluate(e)))],max:[me,wc(me),(e,t)=>Math.max(...t.map(n=>n.evaluate(e)))],abs:[me,[me],(e,[t])=>Math.abs(t.evaluate(e))],round:[me,[me],(e,[t])=>{const n=t.evaluate(e);return n<0?-Math.round(-n):Math.round(n)}],floor:[me,[me],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[me,[me],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[Cn,[gn,bt],(e,[t,n])=>e.properties()[t.value]===n.value],"filter-id-==":[Cn,[bt],(e,[t])=>e.id()===t.value],"filter-type-==":[Cn,[gn],(e,[t])=>e.geometryType()===t.value],"filter-<":[Cn,[gn,bt],(e,[t,n])=>{const r=e.properties()[t.value],o=n.value;return typeof r==typeof o&&r<o}],"filter-id-<":[Cn,[bt],(e,[t])=>{const n=e.id(),r=t.value;return typeof n==typeof r&&n<r}],"filter->":[Cn,[gn,bt],(e,[t,n])=>{const r=e.properties()[t.value],o=n.value;return typeof r==typeof o&&r>o}],"filter-id->":[Cn,[bt],(e,[t])=>{const n=e.id(),r=t.value;return typeof n==typeof r&&n>r}],"filter-<=":[Cn,[gn,bt],(e,[t,n])=>{const r=e.properties()[t.value],o=n.value;return typeof r==typeof o&&r<=o}],"filter-id-<=":[Cn,[bt],(e,[t])=>{const n=e.id(),r=t.value;return typeof n==typeof r&&n<=r}],"filter->=":[Cn,[gn,bt],(e,[t,n])=>{const r=e.properties()[t.value],o=n.value;return typeof r==typeof o&&r>=o}],"filter-id->=":[Cn,[bt],(e,[t])=>{const n=e.id(),r=t.value;return typeof n==typeof r&&n>=r}],"filter-has":[Cn,[bt],(e,[t])=>t.value in e.properties()],"filter-has-id":[Cn,[],e=>e.id()!==null&&e.id()!==void 0],"filter-type-in":[Cn,[an(gn)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[Cn,[an(bt)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[Cn,[gn,an(bt)],(e,[t,n])=>n.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[Cn,[gn,an(bt)],(e,[t,n])=>function(r,o,a,c){for(;a<=c;){const u=a+c>>1;if(o[u]===r)return!0;o[u]>r?c=u-1:a=u+1}return!1}(e.properties()[t.value],n.value,0,n.value.length-1)],all:{type:Cn,overloads:[[[Cn,Cn],(e,[t,n])=>t.evaluate(e)&&n.evaluate(e)],[wc(Cn),(e,t)=>{for(const n of t)if(!n.evaluate(e))return!1;return!0}]]},any:{type:Cn,overloads:[[[Cn,Cn],(e,[t,n])=>t.evaluate(e)||n.evaluate(e)],[wc(Cn),(e,t)=>{for(const n of t)if(n.evaluate(e))return!0;return!1}]]},"!":[Cn,[Cn],(e,[t])=>!t.evaluate(e)],"is-supported-script":[Cn,[gn],(e,[t])=>{const n=e.globals&&e.globals.isSupportedScript;return!n||n(t.evaluate(e))}],upcase:[gn,[gn],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[gn,[gn],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[gn,wc(bt),(e,t)=>t.map(n=>Rd(n.evaluate(e))).join("")],"resolved-locale":[gn,[fe],(e,[t])=>t.evaluate(e).resolvedLocale()],random:[me,[me,me,bt],(e,t)=>{const[n,r,o]=t.map(c=>c.evaluate(e));if(n>r||n===r)return n;let a;if(typeof o=="string")a=function(c){let u=0;if(c.length===0)return u;for(let d=0;d<c.length;d++)u=(u<<5)-u+c.charCodeAt(d),u&=u;return u}(o);else{if(typeof o!="number")throw new xi(`Invalid seed input: ${o}`);a=o}return n+$v(a)()*(r-n)}]});var $d=iC;function hC(e){return{result:"success",value:e}}function Tc(e){return{result:"error",value:e}}function dC(e,t){return!!e&&!!e.parameters&&e.parameters.indexOf(t)>-1}function Sc(e){return e["property-type"]==="data-driven"}function fC(e){return dC(e.expression,"measure-light")}function Gv(e){return dC(e.expression,"zoom")}function Wv(e){return!!e.expression&&e.expression.interpolated}function um(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function uF(e){return e}function pC(e,t){const n=t.type==="color",r=e.stops&&typeof e.stops[0][0]=="object",o=r||!(r||e.property!==void 0),a=e.type||(Wv(t)?"exponential":"interval");if(n&&((e=Pr({},e)).stops&&(e.stops=e.stops.map(p=>[p[0],en.parse(p[1])])),e.default=en.parse(e.default?e.default:t.default)),e.colorSpace&&e.colorSpace!=="rgb"&&!JE[e.colorSpace])throw new Error(`Unknown color space: ${e.colorSpace}`);let c,u,d;if(a==="exponential")c=mC;else if(a==="interval")c=dF;else if(a==="categorical"){c=hF,u=Object.create(null);for(const p of e.stops)u[p[0]]=p[1];d=typeof e.stops[0][0]}else{if(a!=="identity")throw new Error(`Unknown function type "${a}"`);c=fF}if(r){const p={},m=[];for(let x=0;x<e.stops.length;x++){const w=e.stops[x],T=w[0].zoom;p[T]===void 0&&(p[T]={zoom:T,type:e.type,property:e.property,default:e.default,stops:[]},m.push(T)),p[T].stops.push([w[0].value,w[1]])}const _=[];for(const x of m)_.push([p[x].zoom,pC(p[x],t)]);const v={name:"linear"};return{kind:"composite",interpolationType:v,interpolationFactor:ta.interpolationFactor.bind(void 0,v),zoomStops:_.map(x=>x[0]),evaluate:({zoom:x},w)=>mC({stops:_,base:e.base},t,x).evaluate(x,w)}}if(o){const p=a==="exponential"?{name:"exponential",base:e.base!==void 0?e.base:1}:null;return{kind:"camera",interpolationType:p,interpolationFactor:ta.interpolationFactor.bind(void 0,p),zoomStops:e.stops.map(m=>m[0]),evaluate:({zoom:m})=>c(e,t,m,u,d)}}return{kind:"source",evaluate(p,m){const _=m&&m.properties?m.properties[e.property]:void 0;return _===void 0?Vd(e.default,t.default):c(e,t,_,u,d)}}}function Vd(e,t,n){return e!==void 0?e:t!==void 0?t:n!==void 0?n:void 0}function hF(e,t,n,r,o){return Vd(typeof n===o?r[n]:void 0,e.default,t.default)}function dF(e,t,n){if(Vn(n)!=="number")return Vd(e.default,t.default);const r=e.stops.length;if(r===1||n<=e.stops[0][0])return e.stops[0][1];if(n>=e.stops[r-1][0])return e.stops[r-1][1];const o=om(e.stops.map(a=>a[0]),n);return e.stops[o][1]}function mC(e,t,n){const r=e.base!==void 0?e.base:1;if(Vn(n)!=="number")return Vd(e.default,t.default);const o=e.stops.length;if(o===1||n<=e.stops[0][0])return e.stops[0][1];if(n>=e.stops[o-1][0])return e.stops[o-1][1];const a=om(e.stops.map(m=>m[0]),n),c=function(m,_,v,x){const w=x-v,T=m-v;return w===0?0:_===1?T/w:(Math.pow(_,T)-1)/(Math.pow(_,w)-1)}(n,r,e.stops[a][0],e.stops[a+1][0]),u=e.stops[a][1],d=e.stops[a+1][1];let p=sm[t.type]||uF;if(e.colorSpace&&e.colorSpace!=="rgb"){const m=JE[e.colorSpace];p=(_,v)=>m.reverse(m.interpolate(m.forward(_),m.forward(v),c))}return typeof u.evaluate=="function"?{evaluate(...m){const _=u.evaluate.apply(void 0,m),v=d.evaluate.apply(void 0,m);if(_!==void 0&&v!==void 0)return p(_,v,c)}}:p(u,d,c)}function fF(e,t,n){return t.type==="color"?n=en.parse(n):t.type==="formatted"?n=vo.fromString(n.toString()):t.type==="resolvedImage"?n=as.fromString(n.toString()):Vn(n)===t.type||t.type==="enum"&&t.values[n]||(n=void 0),Vd(n,e.default,t.default)}class qv{constructor(t,n,r){this.expression=t,this._warningHistory={},this._evaluator=new IE(r),this._defaultValue=n?function(o){return o.type==="color"&&(um(o.default)||Array.isArray(o.default))?new en(0,0,0,0):o.type==="color"?en.parse(o.default)||null:o.default===void 0?null:o.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(t,n,r,o,a,c,u,d){return this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=r,this._evaluator.canonical=o||null,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=c,this._evaluator.featureTileCoord=u||null,this._evaluator.featureDistanceData=d||null,this.expression.evaluate(this._evaluator)}evaluate(t,n,r,o,a,c,u,d){this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=r||null,this._evaluator.canonical=o||null,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=c||null,this._evaluator.featureTileCoord=u||null,this._evaluator.featureDistanceData=d||null;try{const p=this.expression.evaluate(this._evaluator);if(p==null||typeof p=="number"&&p!=p)return this._defaultValue;if(this._enumValues&&!(p in this._enumValues))throw new xi(`Expected value to be one of ${Object.keys(this._enumValues).map(m=>JSON.stringify(m)).join(", ")}, but found ${JSON.stringify(p)} instead.`);return p}catch(p){return this._warningHistory[p.message]||(this._warningHistory[p.message]=!0,typeof console<"u"&&console.warn(p.message)),this._defaultValue}}}function hm(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in $d}function dl(e,t,n){const r=new WE($d,[],t?function(a){const c={color:ji,string:gn,number:me,enum:gn,boolean:Cn,formatted:Ge,resolvedImage:lr};return a.type==="array"?an(c[a.value]||bt,a.length):c[a.type]}(t):void 0,void 0,void 0,n),o=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return o?hC(new qv(o,t,n)):Tc(r.errors)}class Hv{constructor(t,n,r){this.kind=t,this._styleExpression=n,this.isLightConstant=r,this.isStateDependent=t!=="constant"&&!Nd(n.expression),this.isConfigDependent=!Tv(n.expression)}evaluateWithoutErrorHandling(t,n,r,o,a,c){return this._styleExpression.evaluateWithoutErrorHandling(t,n,r,o,a,c)}evaluate(t,n,r,o,a,c){return this._styleExpression.evaluate(t,n,r,o,a,c)}}class fl{constructor(t,n,r,o,a){this.kind=t,this.zoomStops=r,this._styleExpression=n,this.isStateDependent=t!=="camera"&&!Nd(n.expression),this.isLightConstant=a,this.isConfigDependent=!Tv(n.expression),this.interpolationType=o}evaluateWithoutErrorHandling(t,n,r,o,a,c){return this._styleExpression.evaluateWithoutErrorHandling(t,n,r,o,a,c)}evaluate(t,n,r,o,a,c){return this._styleExpression.evaluate(t,n,r,o,a,c)}interpolationFactor(t,n,r){return this.interpolationType?ta.interpolationFactor(this.interpolationType,t,n,r):0}}function Zv(e,t,n){if((e=dl(e,t,n)).result==="error")return e;const r=e.value.expression,o=Lu(r);if(!o&&!Sc(t))return Tc([new ao("","data expressions not supported")]);const a=zu(r,["zoom","pitch","distance-from-center"]);if(!a&&!Gv(t))return Tc([new ao("","zoom expressions not supported")]);const c=zu(r,["measure-light"]);if(!c&&!fC(t))return Tc([new ao("","measure-light expression not supported")]);const u=t.expression&&t.expression.relaxZoomRestriction,d=fm(r);return d||a||u?d instanceof ao?Tc([d]):d instanceof ta&&!Wv(t)?Tc([new ao("",'"interpolate" expressions cannot be used with this property')]):hC(d?new fl(o?"camera":"composite",e.value,d.labels,d instanceof ta?d.interpolation:void 0,c):new Hv(o?"constant":"source",e.value,c)):Tc([new ao("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class dm{constructor(t,n){this._parameters=t,this._specification=n,Pr(this,pC(this._parameters,this._specification))}static deserialize(t){return new dm(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function fm(e){let t=null;if(e instanceof eC)t=fm(e.result);else if(e instanceof tC){for(const n of e.args)if(t=fm(n),t)break}else(e instanceof Iv||e instanceof ta)&&e.input instanceof Js&&e.input.name==="zoom"&&(t=e);return t instanceof ao||e.eachChild(n=>{const r=fm(n);r instanceof ao?t=r:t&&r&&t!==r&&(t=new ao("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function ls(e){const t=e.key,n=e.value,r=e.valueSpec||{},o=e.objectElementValidators||{},a=e.style,c=e.styleSpec;let u=[];const d=Vn(n);if(d!=="object")return[new se(t,n,`object expected, ${d} found`)];for(const p in n){const m=p.split(".")[0];let _;o[m]?_=o[m]:r[m]?_=Pi:o["*"]?_=o["*"]:r["*"]&&(_=Pi),_?u=u.concat(_({key:(t&&`${t}.`)+p,value:n[p],valueSpec:r[m]||r["*"],style:a,styleSpec:c,object:n,objectKey:p},n)):u.push(new yi(t,n[p],`unknown property "${p}"`))}for(const p in r)o[p]||r[p].required&&r[p].default===void 0&&n[p]===void 0&&u.push(new se(t,n,`missing required property "${p}"`));return u}function gC(e){const t=e.value,n=e.valueSpec,r=e.style,o=e.styleSpec,a=e.key,c=e.arrayElementValidator||Pi;if(Vn(t)!=="array")return[new se(a,t,`array expected, ${Vn(t)} found`)];if(n.length&&t.length!==n.length)return[new se(a,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new se(a,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let u={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};o.$version<7&&(u.function=n.function),Vn(n.value)==="object"&&(u=n.value);let d=[];for(let p=0;p<t.length;p++)d=d.concat(c({array:t,arrayIndex:p,value:t[p],valueSpec:u,style:r,styleSpec:o,key:`${a}[${p}]`},!0));return d}function _C(e){const t=e.key,n=e.value,r=e.valueSpec;let o=Vn(n);if(o==="number"&&n!=n&&(o="NaN"),o!=="number")return[new se(t,n,`number expected, ${o} found`)];if("minimum"in r){let a=r.minimum;if(Vn(r.minimum)==="array"&&(a=r.minimum[e.arrayIndex]),n<a)return[new se(t,n,`${n} is less than the minimum value ${a}`)]}if("maximum"in r){let a=r.maximum;if(Vn(r.maximum)==="array"&&(a=r.maximum[e.arrayIndex]),n>a)return[new se(t,n,`${n} is greater than the maximum value ${a}`)]}return[]}function yC(e){const t=e.valueSpec,n=Er(e.value.type);let r,o,a,c={};const u=n!=="categorical"&&e.value.property===void 0,d=!u,p=Vn(e.value.stops)==="array"&&Vn(e.value.stops[0])==="array"&&Vn(e.value.stops[0][0])==="object",m=ls({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(x){if(n==="identity")return[new se(x.key,x.value,'identity function may not have a "stops" property')];let w=[];const T=x.value;return w=w.concat(gC({key:x.key,value:T,valueSpec:x.valueSpec,style:x.style,styleSpec:x.styleSpec,arrayElementValidator:_})),Vn(T)==="array"&&T.length===0&&w.push(new se(x.key,T,"array must have at least one stop")),w},default:function(x){return Pi({key:x.key,value:x.value,valueSpec:t,style:x.style,styleSpec:x.styleSpec})}}});return n==="identity"&&u&&m.push(new se(e.key,e.value,'missing required property "property"')),n==="identity"||e.value.stops||m.push(new se(e.key,e.value,'missing required property "stops"')),n==="exponential"&&e.valueSpec.expression&&!Wv(e.valueSpec)&&m.push(new se(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(d&&!Sc(e.valueSpec)?m.push(new se(e.key,e.value,"property functions not supported")):u&&!Gv(e.valueSpec)&&m.push(new se(e.key,e.value,"zoom functions not supported"))),n!=="categorical"&&!p||e.value.property!==void 0||m.push(new se(e.key,e.value,'"property" property is required')),m;function _(x){let w=[];const T=x.value,S=x.key;if(Vn(T)!=="array")return[new se(S,T,`array expected, ${Vn(T)} found`)];if(T.length!==2)return[new se(S,T,`array length 2 expected, length ${T.length} found`)];if(p){if(Vn(T[0])!=="object")return[new se(S,T,`object expected, ${Vn(T[0])} found`)];if(T[0].zoom===void 0)return[new se(S,T,"object stop key must have zoom")];if(T[0].value===void 0)return[new se(S,T,"object stop key must have value")];const I=Er(T[0].zoom);if(typeof I!="number")return[new se(S,T[0].zoom,"stop zoom values must be numbers")];if(a&&a>I)return[new se(S,T[0].zoom,"stop zoom values must appear in ascending order")];I!==a&&(a=I,o=void 0,c={}),w=w.concat(ls({key:`${S}[0]`,value:T[0],valueSpec:{zoom:{}},style:x.style,styleSpec:x.styleSpec,objectElementValidators:{zoom:_C,value:v}}))}else w=w.concat(v({key:`${S}[0]`,value:T[0],valueSpec:{},style:x.style,styleSpec:x.styleSpec},T));return hm(Cr(T[1]))?w.concat([new se(`${S}[1]`,T[1],"expressions are not allowed in function stops.")]):w.concat(Pi({key:`${S}[1]`,value:T[1],valueSpec:t,style:x.style,styleSpec:x.styleSpec}))}function v(x,w){const T=Vn(x.value),S=Er(x.value),I=x.value!==null?x.value:w;if(r){if(T!==r)return[new se(x.key,I,`${T} stop domain type must match previous stop domain type ${r}`)]}else r=T;if(T!=="number"&&T!=="string"&&T!=="boolean"&&typeof S!="number"&&typeof S!="string"&&typeof S!="boolean")return[new se(x.key,I,"stop domain value must be a number, string, or boolean")];if(T!=="number"&&n!=="categorical"){let A=`number expected, ${T} found`;return Sc(t)&&n===void 0&&(A+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new se(x.key,I,A)]}return n!=="categorical"||T!=="number"||typeof S=="number"&&isFinite(S)&&Math.floor(S)===S?n!=="categorical"&&T==="number"&&typeof S=="number"&&typeof o=="number"&&o!==void 0&&S<o?[new se(x.key,I,"stop domain values must appear in ascending order")]:(o=S,n==="categorical"&&S in c?[new se(x.key,I,"stop domain values must be unique")]:(c[S]=!0,[])):[new se(x.key,I,`integer expected, found ${String(S)}`)]}}function Ec(e){const t=(e.expressionContext==="property"?Zv:dl)(Cr(e.value),e.valueSpec);if(t.result==="error")return t.value.map(r=>new se(`${e.key}${r.key}`,e.value,r.message));const n=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!n.outputDefined())return[new se(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!Nd(n))return[new se(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter")return vC(n,e);if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!zu(n,["zoom","feature-state"]))return[new se(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Lu(n))return[new se(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function vC(e,t){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const o of t.valueSpec.expression.parameters)n.delete(o);if(n.size===0)return[];const r=[];return e instanceof Js&&n.has(e.name)?[new se(t.key,t.value,`["${e.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(e.eachChild(o=>{r.push(...vC(o,t))}),r)}function pm(e){const t=e.key,n=e.value,r=e.valueSpec,o=[];return Array.isArray(r.values)?r.values.indexOf(Er(n))===-1&&o.push(new se(t,n,`expected one of [${r.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(r.values).indexOf(Er(n))===-1&&o.push(new se(t,n,`expected one of [${Object.keys(r.values).join(", ")}], ${JSON.stringify(n)} found`)),o}function Xv(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!Xv(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function mm(e,t="fill"){if(e==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Xv(e)||(e=gm(e));const n=e;let r=!0;try{r=function(p){if(!Fu(p))return p;let m=Cr(p);return bC(m),m=xC(m),m}(n)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(n,null,2)}
        `)}const o=_t[`filter_${t}`],a=dl(r,o);let c=null;if(a.result==="error")throw new Error(a.value.map(p=>`${p.key}: ${p.message}`).join(", "));c=(p,m,_)=>a.value.evaluate(p,m,{},_);let u=null,d=null;if(r!==n){const p=dl(n,o);if(p.result==="error")throw new Error(p.value.map(m=>`${m.key}: ${m.message}`).join(", "));u=(m,_,v,x,w)=>p.value.evaluate(m,_,{},v,void 0,void 0,x,w),d=!Lu(p.value.expression)}return{filter:c,dynamicFilter:u||void 0,needGeometry:wC(r),needFeature:!!d}}function xC(e){if(!Array.isArray(e))return e;const t=function(n){if(pF.has(n[0])){for(let r=1;r<n.length;r++)if(Fu(n[r]))return!0}return n}(e);return t===!0?t:t.map(n=>xC(n))}function bC(e){let t=!1;const n=[];if(e[0]==="case"){for(let r=1;r<e.length-1;r+=2)t=t||Fu(e[r]),n.push(e[r+1]);n.push(e[e.length-1])}else if(e[0]==="match"){t=t||Fu(e[1]);for(let r=2;r<e.length-1;r+=2)n.push(e[r+1]);n.push(e[e.length-1])}else if(e[0]==="step"){t=t||Fu(e[1]);for(let r=1;r<e.length-1;r+=2)n.push(e[r+1])}t&&(e.length=0,e.push("any",...n));for(let r=1;r<e.length;r++)bC(e[r])}function Fu(e){if(!Array.isArray(e))return!1;if((t=e[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let n=1;n<e.length;n++)if(Fu(e[n]))return!0;return!1}const pF=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function mF(e,t){return e<t?-1:e>t?1:0}function wC(e){if(!Array.isArray(e))return!1;if(e[0]==="within"||e[0]==="distance")return!0;for(let t=1;t<e.length;t++)if(wC(e[t]))return!0;return!1}function gm(e){if(!e)return!0;const t=e[0];return e.length<=1?t!=="any":t==="=="?Kv(e[1],e[2],"=="):t==="!="?_m(Kv(e[1],e[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Kv(e[1],e[2],t):t==="any"?(n=e.slice(1),["any"].concat(n.map(gm))):t==="all"?["all"].concat(e.slice(1).map(gm)):t==="none"?["all"].concat(e.slice(1).map(gm).map(_m)):t==="in"?TC(e[1],e.slice(2)):t==="!in"?_m(TC(e[1],e.slice(2))):t==="has"?SC(e[1]):t!=="!has"||_m(SC(e[1]));var n}function Kv(e,t,n){switch(e){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,e,t]}}function TC(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(n=>typeof n!=typeof t[0])?["filter-in-large",e,["literal",t.sort(mF)]]:["filter-in-small",e,["literal",t]]}}function SC(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function _m(e){return["!",e]}function Yv(e){return Xv(Cr(e.value))?Ec(Pr({},e,{expressionContext:"filter",valueSpec:e.styleSpec[`filter_${e.layerType||"fill"}`]})):EC(e)}function EC(e){const t=e.value,n=e.key;if(Vn(t)!=="array")return[new se(n,t,`array expected, ${Vn(t)} found`)];const r=e.styleSpec;let o,a=[];if(t.length<1)return[new se(n,t,"filter array must have at least 1 element")];switch(a=a.concat(pm({key:`${n}[0]`,value:t[0],valueSpec:r.filter_operator,style:e.style,styleSpec:e.styleSpec})),Er(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Er(t[1])==="$type"&&a.push(new se(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&a.push(new se(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(o=Vn(t[1]),o!=="string"&&a.push(new se(`${n}[1]`,t[1],`string expected, ${o} found`)));for(let c=2;c<t.length;c++)o=Vn(t[c]),Er(t[1])==="$type"?a=a.concat(pm({key:`${n}[${c}]`,value:t[c],valueSpec:r.geometry_type,style:e.style,styleSpec:e.styleSpec})):o!=="string"&&o!=="number"&&o!=="boolean"&&a.push(new se(`${n}[${c}]`,t[c],`string, number, or boolean expected, ${o} found`));break;case"any":case"all":case"none":for(let c=1;c<t.length;c++)a=a.concat(EC({key:`${n}[${c}]`,value:t[c],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":o=Vn(t[1]),t.length!==2?a.push(new se(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):o!=="string"&&a.push(new se(`${n}[1]`,t[1],`string expected, ${o} found`))}return a}function CC(e,t){const n=e.key,r=e.style,o=e.layer,a=e.styleSpec,c=e.value,u=e.objectKey,d=a[`${t}_${e.layerType}`];if(!d)return[];const p=u.match(/^(.*)-transition$/);if(t==="paint"&&p&&d[p[1]]&&d[p[1]].transition)return Pi({key:n,value:c,valueSpec:a.transition,style:r,styleSpec:a});const m=e.valueSpec||d[u];if(!m)return[new yi(n,c,`unknown property "${u}"`)];let _;if(Vn(c)==="string"&&Sc(m)&&!m.tokens&&(_=/^{([^}]+)}$/.exec(c))){const x=`\`{ "type": "identity", "property": ${_?JSON.stringify(_[1]):'"_"'} }\``;return[new se(n,c,`"${u}" does not support interpolation syntax
Use an identity property function instead: ${x}.`)]}const v=[];if(e.layerType==="symbol")u!=="text-field"||!r||r.glyphs||r.imports||v.push(new se(n,c,'use of "text-field" requires a style "glyphs" property')),u==="text-font"&&um(Cr(c))&&Er(c.type)==="identity"&&v.push(new se(n,c,'"text-font" does not support identity functions'));else if(e.layerType==="model"&&t==="paint"&&o&&o.layout&&o.layout.hasOwnProperty("model-id")&&Sc(m)&&(fC(m)||Gv(m))){const x=Zv(Cr(c),m),w=x.value.expression||x.value._styleExpression.expression;w&&!zu(w,["measure-light"])&&(u==="model-emissive-strength"&&Lu(w)&&Nd(w)||v.push(new se(n,c,`${u} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return v.concat(Pi({key:e.key,value:c,valueSpec:m,style:r,styleSpec:a,expressionContext:"property",propertyType:t,propertyKey:u}))}function MC(e){return CC(e,"paint")}function IC(e){return CC(e,"layout")}function AC(e){let t=[];const n=e.value,r=e.key,o=e.style,a=e.styleSpec;n.type||n.ref||t.push(new se(r,n,'either "type" or "ref" is required'));let c=Er(n.type);const u=Er(n.ref);if(n.id){const d=Er(n.id);for(let p=0;p<e.arrayIndex;p++){const m=o.layers[p];Er(m.id)===d&&t.push(new se(r,n.id,`duplicate layer id "${n.id}", previously used at line ${m.id.__line__}`))}}if("ref"in n){let d;["type","source","source-layer","filter","layout"].forEach(p=>{p in n&&t.push(new se(r,n[p],`"${p}" is prohibited for ref layers`))}),o.layers.forEach(p=>{Er(p.id)===u&&(d=p)}),d?d.ref?t.push(new se(r,n.ref,"ref cannot reference another ref layer")):c=Er(d.type):typeof u=="string"&&t.push(new se(r,n.ref,`ref layer "${u}" not found`))}else if(c!=="background"&&c!=="sky"&&c!=="slot")if(n.source){const d=o.sources&&o.sources[n.source],p=d&&Er(d.type);d?p==="vector"&&c==="raster"?t.push(new se(r,n.source,`layer "${n.id}" requires a raster source`)):p==="raster"&&c!=="raster"?t.push(new se(r,n.source,`layer "${n.id}" requires a vector source`)):p!=="vector"||n["source-layer"]?p==="raster-dem"&&c!=="hillshade"?t.push(new se(r,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):c!=="line"||!n.paint||!n.paint["line-gradient"]&&!n.paint["line-trim-offset"]||p==="geojson"&&d.lineMetrics||t.push(new se(r,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new se(r,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new se(r,n.source,`source "${n.source}" not found`))}else t.push(new se(r,n,'missing required property "source"'));return t=t.concat(ls({key:r,value:n,valueSpec:a.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Pi({key:`${r}.type`,value:n.type,valueSpec:a.layer.type,style:e.style,styleSpec:e.styleSpec,object:n,objectKey:"type"}),filter:d=>Yv(Pr({layerType:c},d)),layout:d=>ls({layer:n,key:d.key,value:d.value,valueSpec:{},style:d.style,styleSpec:d.styleSpec,objectElementValidators:{"*":p=>IC(Pr({layerType:c},p))}}),paint:d=>ls({layer:n,key:d.key,value:d.value,valueSpec:{},style:d.style,styleSpec:d.styleSpec,objectElementValidators:{"*":p=>MC(Pr({layerType:c,layer:n},p))}})}})),t}function Nu(e){const t=e.value,n=e.key,r=Vn(t);return r!=="string"?[new se(n,t,`string expected, ${r} found`)]:[]}const PC={promoteId:function({key:e,value:t}){if(Vn(t)==="string")return Nu({key:e,value:t});{const n=[];for(const r in t)n.push(...Nu({key:`${e}.${r}`,value:t[r]}));return n}}};function RC(e){const t=e.value,n=e.key,r=e.styleSpec,o=e.style;if(!t.type)return[new se(n,t,'"type" is required')];const a=Er(t.type);let c=[];switch(["vector","raster","raster-dem"].includes(a)&&(t.url||t.tiles||c.push(new se(n,t,'Either "url" or "tiles" is required.'))),a){case"vector":case"raster":case"raster-dem":return c=c.concat(ls({key:n,value:t,valueSpec:r[`source_${a.replace("-","_")}`],style:e.style,styleSpec:r,objectElementValidators:PC})),c;case"geojson":if(c=ls({key:n,value:t,valueSpec:r.source_geojson,style:o,styleSpec:r,objectElementValidators:PC}),t.cluster)for(const u in t.clusterProperties){const[d,p]=t.clusterProperties[u],m=typeof d=="string"?[d,["accumulated"],["get",u]]:d;c.push(...Ec({key:`${n}.${u}.map`,value:p,expressionContext:"cluster-map"})),c.push(...Ec({key:`${n}.${u}.reduce`,value:m,expressionContext:"cluster-reduce"}))}return c;case"video":return ls({key:n,value:t,valueSpec:r.source_video,style:o,styleSpec:r});case"image":return ls({key:n,value:t,valueSpec:r.source_image,style:o,styleSpec:r});case"canvas":return[new se(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return pm({key:`${n}.type`,value:t.type,valueSpec:{values:gF(r)},style:o,styleSpec:r})}}function gF(e){return e.source.reduce((t,n)=>{const r=e[n];return r.type.type==="enum"&&(t=t.concat(Object.keys(r.type.values))),t},[])}function kC(e){const t=e.value;let n=[];if(!t)return n;const r=Vn(t);return r!=="string"?(n=n.concat([new se(e.key,t,`string expected, "${r}" found`)]),n):(function(o){const a=o.indexOf("://")===-1;try{return new URL(o,a?"http://example.com":void 0),!0}catch{return!1}}(t)||(n=n.concat([new se(e.key,t,`invalid url "${t}"`)])),n)}function OC(e){const t=e.value,n=e.styleSpec,r=n.light,o=e.style;let a=[];const c=Vn(t);if(t===void 0)return a;if(c!=="object")return a=a.concat([new se("light",t,`object expected, ${c} found`)]),a;for(const u in t){const d=u.match(/^(.*)-transition$/);a=a.concat(d&&r[d[1]]&&r[d[1]].transition?Pi({key:u,value:t[u],valueSpec:n.transition,style:o,styleSpec:n}):r[u]?Pi({key:u,value:t[u],valueSpec:r[u],style:o,styleSpec:n}):[new se(u,t[u],`unknown property "${u}"`)])}return a}function LC(e){const t=e.value;let n=[];if(!t)return n;const r=Vn(t);if(r!=="object")return n=n.concat([new se("light-3d",t,`object expected, ${r} found`)]),n;const o=e.styleSpec,a=o["light-3d"],c=e.key,u=e.style,d=e.style.lights;for(const _ of["type","id"])if(!(_ in t))return n=n.concat([new se("light-3d",t,`missing property ${_} on light`)]),n;if(t.type&&d)for(let _=0;_<e.arrayIndex;_++){const v=Er(t.type),x=d[_];Er(x.type)===v&&n.push(new se(c,t.id,`duplicate light type "${t.type}", previously defined at line ${x.id.__line__}`))}const p=`properties_light_${t.type}`;if(!(p in o))return n=n.concat([new se("light-3d",t,`Invalid light type ${t.type}`)]),n;const m=o[p];for(const _ in t)if(_==="properties"){const v=t[_],x=Vn(v);if(x!=="object")return n=n.concat([new se("properties",v,`object expected, ${x} found`)]),n;for(const w in v)n=n.concat(m[w]?Pi({key:w,value:v[w],valueSpec:m[w],style:u,styleSpec:o}):[new yi(e.key,v[w],`unknown property "${w}"`)])}else{const v=_.match(/^(.*)-transition$/);n=n.concat(v&&a[v[1]]&&a[v[1]].transition?Pi({key:_,value:t[_],valueSpec:o.transition,style:u,styleSpec:o}):a[_]?Pi({key:_,value:t[_],valueSpec:a[_],style:u,styleSpec:o}):[new yi(_,t[_],`unknown property "${_}"`)])}return n}function zC(e){const t=e.value,n=e.key,r=e.style,o=e.styleSpec,a=o.terrain;let c=[];const u=Vn(t);if(t===void 0||u==="null")return c;if(u!=="object")return c=c.concat([new se("terrain",t,`object expected, ${u} found`)]),c;for(const d in t){const p=d.match(/^(.*)-transition$/);c=c.concat(p&&a[p[1]]&&a[p[1]].transition?Pi({key:d,value:t[d],valueSpec:o.transition,style:r,styleSpec:o}):a[d]?Pi({key:d,value:t[d],valueSpec:a[d],style:r,styleSpec:o}):[new yi(d,t[d],`unknown property "${d}"`)])}if(t.source){const d=r.sources&&r.sources[t.source],p=d&&Er(d.type);d?p!=="raster-dem"&&c.push(new se(n,t.source,`terrain cannot be used with a source of type ${String(p)}, it only be used with a "raster-dem" source type`)):c.push(new se(n,t.source,`source "${t.source}" not found`))}else c.push(new se(n,t,'terrain is missing required property "source"'));return c}function DC(e){const t=e.value,n=e.style,r=e.styleSpec,o=r.fog;let a=[];const c=Vn(t);if(t===void 0)return a;if(c!=="object")return a=a.concat([new se("fog",t,`object expected, ${c} found`)]),a;for(const u in t){const d=u.match(/^(.*)-transition$/);a=a.concat(d&&o[d[1]]&&o[d[1]].transition?Pi({key:u,value:t[u],valueSpec:r.transition,style:n,styleSpec:r}):o[u]?Pi({key:u,value:t[u],valueSpec:o[u],style:n,styleSpec:r}):[new yi(u,t[u],`unknown property "${u}"`)])}return a}const BC={"*":()=>[],array:gC,boolean:function(e){const t=e.value,n=e.key,r=Vn(t);return r!=="boolean"?[new se(n,t,`boolean expected, ${r} found`)]:[]},number:_C,color:function(e){const t=e.key,n=e.value,r=Vn(n);return r!=="string"?[new se(t,n,`color expected, ${r} found`)]:co(n)===null?[new se(t,n,`color expected, "${n}" found`)]:[]},enum:pm,filter:Yv,function:yC,layer:AC,object:ls,source:RC,model:kC,light:OC,"light-3d":LC,terrain:zC,fog:DC,string:Nu,formatted:function(e){return Nu(e).length===0?[]:Ec(e)},resolvedImage:function(e){return Nu(e).length===0?[]:Ec(e)},projection:function(e){const t=e.value,n=e.styleSpec,r=n.projection,o=e.style;let a=[];const c=Vn(t);if(c==="object")for(const u in t)a=a.concat(Pi({key:u,value:t[u],valueSpec:r[u],style:o,styleSpec:n}));else c!=="string"&&(a=a.concat([new se("projection",t,`object or string expected, ${c} found`)]));return a},import:function(e){const{value:t,styleSpec:n}=e,{data:r,...o}=t;Object.defineProperty(o,"__line__",{value:t.__line__,enumerable:!1});let a=ls(Pr({},e,{value:o,valueSpec:n.import}));return Er(o.id)===""&&a.push(new se(`${e.key}.id`,o,"import id can't be an empty string")),r&&(a=a.concat(FC(r,n,{key:`${e.key}.data`}))),a}};function Pi(e,t=!1){const n=e.value,r=e.valueSpec,o=e.styleSpec;if(r.expression&&um(Er(n)))return yC(e);if(r.expression&&hm(Cr(n)))return Ec(e);if(r.type&&BC[r.type]){const a=BC[r.type](e);return t===!0&&a.length>0&&Vn(e.value)==="array"?Ec(e):a}return ls(Pr({},e,{valueSpec:r.type?o[r.type]:r}))}function _F(e){const t=e.value,n=e.key,r=Nu(e);return r.length||(t.indexOf("{fontstack}")===-1&&r.push(new se(n,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&r.push(new se(n,t,'"glyphs" url must include a "{range}" token'))),r}function FC(e,t=_t,n={}){return Pi({key:n.key||"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:_F,"*":()=>[]}})}function ju(e,t=_t){return Rs(FC(e,t))}const yF=e=>Rs(RC(e)),vF=e=>Rs(OC(e)),xF=e=>Rs(LC(e)),bF=e=>Rs(zC(e)),wF=e=>Rs(DC(e)),TF=e=>Rs(AC(e)),Qv=e=>Rs(Yv(e)),SF=e=>Rs(MC(e)),EF=e=>Rs(IC(e)),CF=e=>Rs(kC(e));function Rs(e){return e.slice().sort((t,n)=>t.line&&n.line?t.line-n.line:0)}function ym(e,t){let n=!1;if(t&&t.length)for(const r of t)r instanceof yi?dt(r.message):(e.fire(new ve(new Error(r.message))),n=!0);return n}var MF=ea,pl=3;function ea(e,t,n){var r=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var o=new Int32Array(this.arrayBuffer);e=o[0],this.d=(t=o[1])+2*(n=o[2]);for(var a=0;a<this.d*this.d;a++){var c=o[pl+a],u=o[pl+a+1];r.push(c===u?null:o.subarray(c,u))}var d=o[pl+r.length+1];this.keys=o.subarray(o[pl+r.length],d),this.bboxes=o.subarray(d),this.insert=this._insertReadonly}else{this.d=t+2*n;for(var p=0;p<this.d*this.d;p++)r.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=n,this.scale=t/e,this.uid=0;var m=n/t*e;this.min=-m,this.max=e+m}ea.prototype.insert=function(e,t,n,r,o){this._forEachCell(t,n,r,o,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(o)},ea.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ea.prototype._insertCell=function(e,t,n,r,o,a){this.cells[o].push(a)},ea.prototype.query=function(e,t,n,r,o){var a=this.min,c=this.max;if(e<=a&&t<=a&&c<=n&&c<=r&&!o)return Array.prototype.slice.call(this.keys);var u=[];return this._forEachCell(e,t,n,r,this._queryCell,u,{},o),u},ea.prototype._queryCell=function(e,t,n,r,o,a,c,u){var d=this.cells[o];if(d!==null)for(var p=this.keys,m=this.bboxes,_=0;_<d.length;_++){var v=d[_];if(c[v]===void 0){var x=4*v;(u?u(m[x+0],m[x+1],m[x+2],m[x+3]):e<=m[x+2]&&t<=m[x+3]&&n>=m[x+0]&&r>=m[x+1])?(c[v]=!0,a.push(p[v])):c[v]=!1}}},ea.prototype._forEachCell=function(e,t,n,r,o,a,c,u){for(var d=this._convertToCellCoord(e),p=this._convertToCellCoord(t),m=this._convertToCellCoord(n),_=this._convertToCellCoord(r),v=d;v<=m;v++)for(var x=p;x<=_;x++){var w=this.d*x+v;if((!u||u(this._convertFromCellCoord(v),this._convertFromCellCoord(x),this._convertFromCellCoord(v+1),this._convertFromCellCoord(x+1)))&&o.call(this,e,t,n,r,w,a,c,u))return}},ea.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},ea.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},ea.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=pl+this.cells.length+1+1,n=0,r=0;r<this.cells.length;r++)n+=this.cells[r].length;var o=new Int32Array(t+n+this.keys.length+this.bboxes.length);o[0]=this.extent,o[1]=this.n,o[2]=this.padding;for(var a=t,c=0;c<e.length;c++){var u=e[c];o[pl+c]=a,o.set(u,a),a+=u.length}return o[pl+e.length]=a,o.set(this.keys,a),o[pl+e.length+1]=a+=this.keys.length,o.set(this.bboxes,a),a+=this.bboxes.length,o.buffer};var Uu=$(MF);const vm={};function Te(e,t,n={}){Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),vm[t]={klass:e,omit:n.omit||[]}}Te(Object,"Object"),Uu.serialize=function(e,t){const n=e.toArrayBuffer();return t&&t.add(n),{buffer:n}},Uu.deserialize=function(e){return new Uu(e.buffer)},Object.defineProperty(Uu,"name",{value:"Grid"}),Te(Uu,"Grid"),Te(en,"Color"),Te(Error,"Error"),Te(Gt,"AJAXError"),Te(as,"ResolvedImage"),Te(dm,"StylePropertyFunction"),Te(qv,"StyleExpression",{omit:["_evaluator"]}),Te(fl,"ZoomDependentExpression"),Te(Hv,"ZoomConstantExpression"),Te(Js,"CompoundExpression",{omit:["_evaluate"]});for(const e in $d)vm[$d[e]._classRegistryKey]||Te($d[e],`Expression${e}`);function NC(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function jC(e){return C.ImageBitmap&&e instanceof C.ImageBitmap}function $u(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(NC(e)||jC(e))return t&&t.add(e),e;if(ArrayBuffer.isView(e)){const n=e;return t&&t.add(n.buffer),n}if(e instanceof C.ImageData)return t&&t.add(e.data.buffer),e;if(Array.isArray(e)){const n=[];for(const r of e)n.push($u(r,t));return n}if(e instanceof Map){const n={$name:"Map"};for(const[r,o]of e.entries())n[r]=$u(o);return n}if(typeof e=="object"){const n=e.constructor,r=n._classRegistryKey;if(!r)throw new Error(`can't serialize object of unregistered class ${r}`);const o=n.serialize?n.serialize(e,t):{};if(!n.serialize){for(const a in e)e.hasOwnProperty(a)&&(vm[r].omit.indexOf(a)>=0||(o[a]=$u(e[a],t)));e instanceof Error&&(o.message=e.message)}if(o.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(o.$name=r),o}throw new Error("can't serialize object of type "+typeof e)}function Vu(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||NC(e)||jC(e)||ArrayBuffer.isView(e)||e instanceof C.ImageData)return e;if(Array.isArray(e))return e.map(Vu);if(typeof e=="object"){const t=e.$name||"Object";if(t==="Map"){const o=new Map;for(const a of Object.keys(e))a!=="$name"&&o.set(a,Vu(e[a]));return o}const{klass:n}=vm[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(e);const r=Object.create(n.prototype);for(const o of Object.keys(e))o!=="$name"&&(r[o]=Vu(e[o]));return r}throw new Error("can't deserialize object of type "+typeof e)}const Ie={"Latin-1 Supplement":e=>e>=128&&e<=255,Arabic:e=>e>=1536&&e<=1791,"Arabic Supplement":e=>e>=1872&&e<=1919,"Arabic Extended-A":e=>e>=2208&&e<=2303,"Hangul Jamo":e=>e>=4352&&e<=4607,"Unified Canadian Aboriginal Syllabics":e=>e>=5120&&e<=5759,Khmer:e=>e>=6016&&e<=6143,"Unified Canadian Aboriginal Syllabics Extended":e=>e>=6320&&e<=6399,"General Punctuation":e=>e>=8192&&e<=8303,"Letterlike Symbols":e=>e>=8448&&e<=8527,"Number Forms":e=>e>=8528&&e<=8591,"Miscellaneous Technical":e=>e>=8960&&e<=9215,"Control Pictures":e=>e>=9216&&e<=9279,"Optical Character Recognition":e=>e>=9280&&e<=9311,"Enclosed Alphanumerics":e=>e>=9312&&e<=9471,"Geometric Shapes":e=>e>=9632&&e<=9727,"Miscellaneous Symbols":e=>e>=9728&&e<=9983,"Miscellaneous Symbols and Arrows":e=>e>=11008&&e<=11263,"CJK Radicals Supplement":e=>e>=11904&&e<=12031,"Kangxi Radicals":e=>e>=12032&&e<=12255,"Ideographic Description Characters":e=>e>=12272&&e<=12287,"CJK Symbols and Punctuation":e=>e>=12288&&e<=12351,Hiragana:e=>e>=12352&&e<=12447,Katakana:e=>e>=12448&&e<=12543,Bopomofo:e=>e>=12544&&e<=12591,"Hangul Compatibility Jamo":e=>e>=12592&&e<=12687,Kanbun:e=>e>=12688&&e<=12703,"Bopomofo Extended":e=>e>=12704&&e<=12735,"CJK Strokes":e=>e>=12736&&e<=12783,"Katakana Phonetic Extensions":e=>e>=12784&&e<=12799,"Enclosed CJK Letters and Months":e=>e>=12800&&e<=13055,"CJK Compatibility":e=>e>=13056&&e<=13311,"CJK Unified Ideographs Extension A":e=>e>=13312&&e<=19903,"Yijing Hexagram Symbols":e=>e>=19904&&e<=19967,"CJK Unified Ideographs":e=>e>=19968&&e<=40959,"Yi Syllables":e=>e>=40960&&e<=42127,"Yi Radicals":e=>e>=42128&&e<=42191,"Hangul Jamo Extended-A":e=>e>=43360&&e<=43391,"Hangul Syllables":e=>e>=44032&&e<=55215,"Hangul Jamo Extended-B":e=>e>=55216&&e<=55295,"Private Use Area":e=>e>=57344&&e<=63743,"CJK Compatibility Ideographs":e=>e>=63744&&e<=64255,"Arabic Presentation Forms-A":e=>e>=64336&&e<=65023,"Vertical Forms":e=>e>=65040&&e<=65055,"CJK Compatibility Forms":e=>e>=65072&&e<=65103,"Small Form Variants":e=>e>=65104&&e<=65135,"Arabic Presentation Forms-B":e=>e>=65136&&e<=65279,"Halfwidth and Fullwidth Forms":e=>e>=65280&&e<=65519,"CJK Unified Ideographs Extension B":e=>e>=131072&&e<=173791};function Jv(e){for(const t of e)if(tx(t.charCodeAt(0)))return!0;return!1}function IF(e){for(const t of e)if(!AF(t.charCodeAt(0)))return!1;return!0}function AF(e){return!(Ie.Arabic(e)||Ie["Arabic Supplement"](e)||Ie["Arabic Extended-A"](e)||Ie["Arabic Presentation Forms-A"](e)||Ie["Arabic Presentation Forms-B"](e))}function tx(e){return!(e!==746&&e!==747&&(e<4352||!(Ie["Bopomofo Extended"](e)||Ie.Bopomofo(e)||Ie["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Ie["CJK Compatibility Ideographs"](e)||Ie["CJK Compatibility"](e)||Ie["CJK Radicals Supplement"](e)||Ie["CJK Strokes"](e)||!(!Ie["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||Ie["CJK Unified Ideographs Extension A"](e)||Ie["CJK Unified Ideographs"](e)||Ie["Enclosed CJK Letters and Months"](e)||Ie["Hangul Compatibility Jamo"](e)||Ie["Hangul Jamo Extended-A"](e)||Ie["Hangul Jamo Extended-B"](e)||Ie["Hangul Jamo"](e)||Ie["Hangul Syllables"](e)||Ie.Hiragana(e)||Ie["Ideographic Description Characters"](e)||Ie.Kanbun(e)||Ie["Kangxi Radicals"](e)||Ie["Katakana Phonetic Extensions"](e)||Ie.Katakana(e)&&e!==12540||!(!Ie["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!Ie["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Ie["Unified Canadian Aboriginal Syllabics"](e)||Ie["Unified Canadian Aboriginal Syllabics Extended"](e)||Ie["Vertical Forms"](e)||Ie["Yijing Hexagram Symbols"](e)||Ie["Yi Syllables"](e)||Ie["Yi Radicals"](e))))}function UC(e){return!(tx(e)||function(t){return!!(Ie["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Ie["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Ie["Letterlike Symbols"](t)||Ie["Number Forms"](t)||Ie["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Ie["Control Pictures"](t)&&t!==9251||Ie["Optical Character Recognition"](t)||Ie["Enclosed Alphanumerics"](t)||Ie["Geometric Shapes"](t)||Ie["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Ie["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Ie["CJK Symbols and Punctuation"](t)||Ie.Katakana(t)||Ie["Private Use Area"](t)||Ie["CJK Compatibility Forms"](t)||Ie["Small Form Variants"](t)||Ie["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function $C(e){return e>=1424&&e<=2303||Ie["Arabic Presentation Forms-A"](e)||Ie["Arabic Presentation Forms-B"](e)}function PF(e,t){return!(!t&&$C(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Ie.Khmer(e))}function RF(e){for(const t of e)if($C(t.charCodeAt(0)))return!0;return!1}const ex="deferred",nx="loading",rx="loaded";let ix=null,xo="unavailable",ml=null;const VC=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(xo="error"),ix&&ix(e)};function ox(){sx.fire(new Nt("pluginStateChange",{pluginStatus:xo,pluginURL:ml}))}const sx=new En,ax=function(){return xo},GC=function(){if(xo!==ex||!ml)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");xo=nx,ox(),ml&&le({url:ml},e=>{e?VC(e):(xo=rx,ox())})},cs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>xo===rx||cs.applyArabicShaping!=null,isLoading:()=>xo===nx,setState(e){xo=e.pluginStatus,ml=e.pluginURL},isParsed:()=>cs.applyArabicShaping!=null&&cs.processBidirectionalText!=null&&cs.processStyledBidirectionalText!=null,getPluginURL:()=>ml};class fr{constructor(t,n){this.zoom=t,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.transition=n.transition,this.pitch=n.pitch,this.brightness=n.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(n,r){for(const o of n)if(!PF(o.charCodeAt(0),r))return!1;return!0}(t,cs.isLoaded())}}class xm{constructor(t,n,r){this.property=t,this.value=n,this.expression=function(o,a,c){if(um(o))return new dm(o,a);if(hm(o)||Array.isArray(o)&&o.length>0){const u=Zv(o,a,c);if(u.result==="error")throw new Error(u.value.map(d=>`${d.key}: ${d.message}`).join(", "));return u.value}{let u=o;return typeof o=="string"&&a.type==="color"&&(u=en.parse(o)),{kind:"constant",isConfigDependent:!1,evaluate:()=>u}}}(n===void 0?t.specification.default:n,t.specification,r)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,n,r){return this.property.possiblyEvaluate(this,t,n,r)}}class lx{constructor(t,n){this.property=t,this.value=new xm(t,void 0,n)}transitioned(t,n){return new WC(this.property,this.value,n,Ot({},t.transition,this.transition),t.now)}untransitioned(){return new WC(this.property,this.value,null,{},0)}}class Gd{constructor(t,n){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._options=n,this.isConfigDependent=!1}getValue(t){return Y(this._values[t].value.value)}setValue(t,n){this._values.hasOwnProperty(t)||(this._values[t]=new lx(this._values[t].property,this._options)),this._values[t].value=new xm(this._values[t].property,n===null?void 0:Y(n),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].value.expression.isConfigDependent}setTransitionOrValue(t,n){n&&(this._options=n);const r=this._properties.properties;if(t)for(const o in t){const a=t[o];if(An(o,"-transition")){const c=o.slice(0,-11);r[c]&&this.setTransition(c,a)}else r[o]&&this.setValue(o,a)}}getTransition(t){return Y(this._values[t].transition)}setTransition(t,n){this._values.hasOwnProperty(t)||(this._values[t]=new lx(this._values[t].property)),this._values[t].transition=Y(n)||void 0}serialize(){const t={};for(const n of Object.keys(this._values)){const r=this.getValue(n);r!==void 0&&(t[n]=r);const o=this.getTransition(n);o!==void 0&&(t[`${n}-transition`]=o)}return t}transitioned(t,n){const r=new qC(this._properties);for(const o of Object.keys(this._values))r._values[o]=this._values[o].transitioned(t,n._values[o]);return r}untransitioned(){const t=new qC(this._properties);for(const n of Object.keys(this._values))t._values[n]=this._values[n].untransitioned();return t}}class WC{constructor(t,n,r,o,a){const c=o.delay||0,u=o.duration||0;a=a||0,this.property=t,this.value=n,this.begin=a+c,this.end=this.begin+u,t.specification.transition&&(o.delay||o.duration)&&(this.prior=r)}possiblyEvaluate(t,n,r){const o=t.now||0,a=this.value.possiblyEvaluate(t,n,r),c=this.prior;if(c){if(o>this.end)return this.prior=null,a;if(this.value.isDataDriven())return this.prior=null,a;if(o<this.begin)return c.possiblyEvaluate(t,n,r);{const u=(o-this.begin)/(this.end-this.begin);return this.property.interpolate(c.possiblyEvaluate(t,n,r),a,ne(u))}}return a}}class qC{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,n,r){const o=new Wd(this._properties);for(const a of Object.keys(this._values))o._values[a]=this._values[a].possiblyEvaluate(t,n,r);return o}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class kF{constructor(t,n){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._options=n,this.isConfigDependent=!1}getValue(t){return Y(this._values[t].value)}setValue(t,n){this._values[t]=new xm(this._values[t].property,n===null?void 0:Y(n),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].expression.isConfigDependent}serialize(){const t={};for(const n of Object.keys(this._values)){const r=this.getValue(n);r!==void 0&&(t[n]=r)}return t}possiblyEvaluate(t,n,r){const o=new Wd(this._properties);for(const a of Object.keys(this._values))o._values[a]=this._values[a].possiblyEvaluate(t,n,r);return o}}class Gu{constructor(t,n,r){this.property=t,this.value=n,this.parameters=r}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,n,r,o){return this.property.evaluate(this.value,this.parameters,t,n,r,o)}}class Wd{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class te{constructor(t){this.specification=t}possiblyEvaluate(t,n){return t.expression.evaluate(n)}interpolate(t,n,r){const o=sm[this.specification.type];return o?o(t,n,r):t}}class Be{constructor(t,n){this.specification=t,this.overrides=n}possiblyEvaluate(t,n,r,o){return new Gu(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(n,null,{},r,o)}:t.expression,n)}interpolate(t,n,r){if(t.value.kind!=="constant"||n.value.kind!=="constant")return t;if(t.value.value===void 0||n.value.value===void 0)return new Gu(this,{kind:"constant",value:void 0},t.parameters);const o=sm[this.specification.type];return o?new Gu(this,{kind:"constant",value:o(t.value.value,n.value.value,r)},t.parameters):t}evaluate(t,n,r,o,a,c){return t.kind==="constant"?t.value:t.evaluate(n,r,o,a,c)}}class qd{constructor(t){this.specification=t}possiblyEvaluate(t,n,r,o){return!!t.expression.evaluate(n,null,{},r,o)}interpolate(){return!1}}class Mr{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const n=new fr(0,{});for(const r in t){const o=t[r];o.specification.overridable&&this.overridableProperties.push(r);const a=this.defaultPropertyValues[r]=new xm(o,void 0),c=this.defaultTransitionablePropertyValues[r]=new lx(o);this.defaultTransitioningPropertyValues[r]=c.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=a.possiblyEvaluate(n)}}}Te(Be,"DataDrivenProperty"),Te(te,"DataConstantProperty"),Te(qd,"ColorRampProperty");const bm="";function HC(e){return e.indexOf(bm)>=0}function $i(e,t){return t?`${e}${bm}${t}`:e}function wm(e){const t=e.indexOf(bm);return t>=0?e.slice(0,t):e}const ZC="-transition";class Vo extends En{constructor(t,n,r){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&t.type!=="slot"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),this.options=r,t.slot&&(this.slot=t.slot),n.layout&&(this._unevaluatedLayout=new kF(n.layout,r),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),n.paint)){this._transitionablePaint=new Gd(n.paint,r);for(const o in t.paint)this.setPaintProperty(o,t.paint[o],{validate:!1});for(const o in t.layout)this.setLayoutProperty(o,t.layout[o],{validate:!1});this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Wd(n.paint)}}setScope(t){this.scope=t,this.fqid=$i(this.id,t)}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,n,r={}){if(n!=null&&this._validate(EF,`layers.${this.id}.layout.${t}`,t,n,r))return;if(this.type==="custom"&&t==="visibility")return void(this.visibility=n);const o=this._unevaluatedLayout;o._properties.properties[t]&&(o.setValue(t,n),this.isConfigDependent=this.isConfigDependent||o.isConfigDependent,t==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(t){return An(t,ZC)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,n,r={}){if(n!=null&&this._validate(SF,`layers.${this.id}.paint.${t}`,t,n,r))return!1;const o=this._transitionablePaint,a=o._properties.properties;if(An(t,ZC)){const v=t.slice(0,-11);return a[v]&&o.setTransition(v,n||void 0),!1}if(!a[t])return!1;const c=o._values[t],u=c.value.isDataDriven(),d=c.value;o.setValue(t,n),this.isConfigDependent=this.isConfigDependent||o.isConfigDependent,this._handleSpecialPaintPropertyUpdate(t);const p=o._values[t].value,m=p.isDataDriven(),_=An(t,"pattern")||t==="line-dasharray";return m||u||_||this._handleOverridablePaintPropertyUpdate(t,d,p)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,n){return null}_handleOverridablePaintPropertyUpdate(t,n,r){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,n){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,n)}serialize(){return Zt({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(t,n)=>!(t===void 0||n==="layout"&&!Object.keys(t).length||n==="paint"&&!Object.keys(t).length))}_validate(t,n,r,o,a={}){return(!a||a.validate!==!1)&&ym(this,t.call(ju,{key:n,layerType:this.type,objectKey:r,value:o,styleSpec:_t,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const n=this.paint.get(t);if(n instanceof Gu&&Sc(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=mm(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(){this._stats&&(this._stats.numRenderedVerticesInShadowPass=0,this._stats.numRenderedVerticesInTransparentPass=0)}}class OF{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(t,n){this._updatedSourceCaches[t]=n,this.setDirty()}discardSourceCacheUpdate(t){delete this._updatedSourceCaches[t]}updateLayer(t){const n=t.scope;this._updatedLayers[n]=this._updatedLayers[n]||new Set,this._updatedLayers[n].add(t.id),this.setDirty()}removeLayer(t){const n=t.scope;this._removedLayers[n]=this._removedLayers[n]||{},this._updatedLayers[n]=this._updatedLayers[n]||new Set,this._removedLayers[n][t.id]=t,this._updatedLayers[n].delete(t.id),this._updatedPaintProps.delete(t.fqid),this.setDirty()}getRemovedLayer(t){return this._removedLayers[t.scope]?this._removedLayers[t.scope][t.id]:null}discardLayerRemoval(t){this._removedLayers[t.scope]&&delete this._removedLayers[t.scope][t.id]}getLayerUpdatesByScope(){const t={};for(const n in this._updatedLayers)t[n]=t[n]||{},t[n].updatedIds=Array.from(this._updatedLayers[n].values());for(const n in this._removedLayers)t[n]=t[n]||{},t[n].removedIds=Object.keys(this._removedLayers[n]);return t}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(t){this._updatedPaintProps.add(t.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(t){this._updatedImages.add(t),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}const LF={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Tm{constructor(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class pr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,n){return t._trim(),n&&(t.isTransferred=!0,n.add(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Dn(e,t=1){let n=0,r=0;return{members:e.map(o=>{const a=LF[o.type].BYTES_PER_ELEMENT,c=n=XC(n,Math.max(t,a)),u=o.components||1;return r=Math.max(r,a),n+=a*u,{name:o.name,type:o.type,components:u,offset:c}}),size:XC(n,Math.max(r,t)),alignment:t}}function XC(e,t){return Math.ceil(e/t)*t}class bo extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,n)}emplace(t,n,r){const o=2*t;return this.int16[o+0]=n,this.int16[o+1]=r,t}}bo.prototype.bytesPerElement=4,Te(bo,"StructArrayLayout2i4");class Sm extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,r){const o=this.length;return this.resize(o+1),this.emplace(o,t,n,r)}emplace(t,n,r,o){const a=3*t;return this.int16[a+0]=n,this.int16[a+1]=r,this.int16[a+2]=o,t}}Sm.prototype.bytesPerElement=6,Te(Sm,"StructArrayLayout3i6");class Cc extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,r,o){const a=this.length;return this.resize(a+1),this.emplace(a,t,n,r,o)}emplace(t,n,r,o,a){const c=4*t;return this.int16[c+0]=n,this.int16[c+1]=r,this.int16[c+2]=o,this.int16[c+3]=a,t}}Cc.prototype.bytesPerElement=8,Te(Cc,"StructArrayLayout4i8");class cx extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,r,o,a){const c=this.length;return this.resize(c+1),this.emplace(c,t,n,r,o,a)}emplace(t,n,r,o,a,c){const u=5*t;return this.int16[u+0]=n,this.int16[u+1]=r,this.int16[u+2]=o,this.int16[u+3]=a,this.int16[u+4]=c,t}}cx.prototype.bytesPerElement=10,Te(cx,"StructArrayLayout5i10");class ux extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,r,o,a,c,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,r,o,a,c,u)}emplace(t,n,r,o,a,c,u,d){const p=6*t,m=12*t,_=3*t;return this.int16[p+0]=n,this.int16[p+1]=r,this.uint8[m+4]=o,this.uint8[m+5]=a,this.uint8[m+6]=c,this.uint8[m+7]=u,this.float32[_+2]=d,t}}ux.prototype.bytesPerElement=12,Te(ux,"StructArrayLayout2i4ub1f12");class ka extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,r,o){const a=this.length;return this.resize(a+1),this.emplace(a,t,n,r,o)}emplace(t,n,r,o,a){const c=4*t;return this.float32[c+0]=n,this.float32[c+1]=r,this.float32[c+2]=o,this.float32[c+3]=a,t}}ka.prototype.bytesPerElement=16,Te(ka,"StructArrayLayout4f16");class gl extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,r,o,a){const c=this.length;return this.resize(c+1),this.emplace(c,t,n,r,o,a)}emplace(t,n,r,o,a,c){const u=6*t,d=3*t;return this.uint16[u+0]=n,this.uint16[u+1]=r,this.uint16[u+2]=o,this.uint16[u+3]=a,this.float32[d+2]=c,t}}gl.prototype.bytesPerElement=12,Te(gl,"StructArrayLayout4ui1f12");class Em extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,r,o){const a=this.length;return this.resize(a+1),this.emplace(a,t,n,r,o)}emplace(t,n,r,o,a){const c=4*t;return this.uint16[c+0]=n,this.uint16[c+1]=r,this.uint16[c+2]=o,this.uint16[c+3]=a,t}}Em.prototype.bytesPerElement=8,Te(Em,"StructArrayLayout4ui8");class Cm extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,r,o,a,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,n,r,o,a,c)}emplace(t,n,r,o,a,c,u){const d=6*t;return this.int16[d+0]=n,this.int16[d+1]=r,this.int16[d+2]=o,this.int16[d+3]=a,this.int16[d+4]=c,this.int16[d+5]=u,t}}Cm.prototype.bytesPerElement=12,Te(Cm,"StructArrayLayout6i12");class hx extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,r,o,a,c,u,d,p,m,_,v){const x=this.length;return this.resize(x+1),this.emplace(x,t,n,r,o,a,c,u,d,p,m,_,v)}emplace(t,n,r,o,a,c,u,d,p,m,_,v,x){const w=12*t;return this.int16[w+0]=n,this.int16[w+1]=r,this.int16[w+2]=o,this.int16[w+3]=a,this.uint16[w+4]=c,this.uint16[w+5]=u,this.uint16[w+6]=d,this.uint16[w+7]=p,this.int16[w+8]=m,this.int16[w+9]=_,this.int16[w+10]=v,this.int16[w+11]=x,t}}hx.prototype.bytesPerElement=24,Te(hx,"StructArrayLayout4i4ui4i24");class dx extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,r,o,a,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,n,r,o,a,c)}emplace(t,n,r,o,a,c,u){const d=10*t,p=5*t;return this.int16[d+0]=n,this.int16[d+1]=r,this.int16[d+2]=o,this.float32[p+2]=a,this.float32[p+3]=c,this.float32[p+4]=u,t}}dx.prototype.bytesPerElement=20,Te(dx,"StructArrayLayout3i3f20");class fx extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint32[1*t+0]=n,t}}fx.prototype.bytesPerElement=4,Te(fx,"StructArrayLayout1ul4");class _l extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,n)}emplace(t,n,r){const o=2*t;return this.uint16[o+0]=n,this.uint16[o+1]=r,t}}_l.prototype.bytesPerElement=4,Te(_l,"StructArrayLayout2ui4");class px extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,r,o,a,c,u,d,p,m,_,v,x){const w=this.length;return this.resize(w+1),this.emplace(w,t,n,r,o,a,c,u,d,p,m,_,v,x)}emplace(t,n,r,o,a,c,u,d,p,m,_,v,x,w){const T=20*t,S=10*t;return this.int16[T+0]=n,this.int16[T+1]=r,this.int16[T+2]=o,this.int16[T+3]=a,this.int16[T+4]=c,this.float32[S+3]=u,this.float32[S+4]=d,this.float32[S+5]=p,this.float32[S+6]=m,this.int16[T+14]=_,this.uint32[S+8]=v,this.uint16[T+18]=x,this.uint16[T+19]=w,t}}px.prototype.bytesPerElement=40,Te(px,"StructArrayLayout5i4f1i1ul2ui40");class Mm extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,r,o,a,c,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,r,o,a,c,u)}emplace(t,n,r,o,a,c,u,d){const p=8*t;return this.int16[p+0]=n,this.int16[p+1]=r,this.int16[p+2]=o,this.int16[p+4]=a,this.int16[p+5]=c,this.int16[p+6]=u,this.int16[p+7]=d,t}}Mm.prototype.bytesPerElement=16,Te(Mm,"StructArrayLayout3i2i2i16");class mx extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,r,o,a){const c=this.length;return this.resize(c+1),this.emplace(c,t,n,r,o,a)}emplace(t,n,r,o,a,c){const u=4*t,d=8*t;return this.float32[u+0]=n,this.float32[u+1]=r,this.float32[u+2]=o,this.int16[d+6]=a,this.int16[d+7]=c,t}}mx.prototype.bytesPerElement=16,Te(mx,"StructArrayLayout2f1f2i16");class gx extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,r,o){const a=this.length;return this.resize(a+1),this.emplace(a,t,n,r,o)}emplace(t,n,r,o,a){const c=12*t,u=3*t;return this.uint8[c+0]=n,this.uint8[c+1]=r,this.float32[u+1]=o,this.float32[u+2]=a,t}}gx.prototype.bytesPerElement=12,Te(gx,"StructArrayLayout2ub2f12");class Wr extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,r){const o=this.length;return this.resize(o+1),this.emplace(o,t,n,r)}emplace(t,n,r,o){const a=3*t;return this.uint16[a+0]=n,this.uint16[a+1]=r,this.uint16[a+2]=o,t}}Wr.prototype.bytesPerElement=6,Te(Wr,"StructArrayLayout3ui6");class _x extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S,I,A,R,k,P){const O=this.length;return this.resize(O+1),this.emplace(O,t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S,I,A,R,k,P)}emplace(t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S,I,A,R,k,P,O){const j=30*t,G=15*t,W=60*t;return this.int16[j+0]=n,this.int16[j+1]=r,this.int16[j+2]=o,this.float32[G+2]=a,this.float32[G+3]=c,this.uint16[j+8]=u,this.uint16[j+9]=d,this.uint32[G+5]=p,this.uint32[G+6]=m,this.uint32[G+7]=_,this.uint16[j+16]=v,this.uint16[j+17]=x,this.uint16[j+18]=w,this.float32[G+10]=T,this.float32[G+11]=S,this.uint8[W+48]=I,this.uint8[W+49]=A,this.uint8[W+50]=R,this.uint32[G+13]=k,this.int16[j+28]=P,this.uint8[W+58]=O,t}}_x.prototype.bytesPerElement=60,Te(_x,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class yx extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S,I,A,R,k,P,O,j,G,W,Z,K,Q,at,X,ft,gt){const vt=this.length;return this.resize(vt+1),this.emplace(vt,t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S,I,A,R,k,P,O,j,G,W,Z,K,Q,at,X,ft,gt)}emplace(t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S,I,A,R,k,P,O,j,G,W,Z,K,Q,at,X,ft,gt,vt){const ht=20*t,pt=40*t,Ct=80*t;return this.float32[ht+0]=n,this.float32[ht+1]=r,this.int16[pt+4]=o,this.int16[pt+5]=a,this.int16[pt+6]=c,this.int16[pt+7]=u,this.int16[pt+8]=d,this.int16[pt+9]=p,this.int16[pt+10]=m,this.int16[pt+11]=_,this.int16[pt+12]=v,this.uint16[pt+13]=x,this.uint16[pt+14]=w,this.uint16[pt+15]=T,this.uint16[pt+16]=S,this.uint16[pt+17]=I,this.uint16[pt+18]=A,this.uint16[pt+19]=R,this.uint16[pt+20]=k,this.uint16[pt+21]=P,this.uint16[pt+22]=O,this.uint16[pt+23]=j,this.uint16[pt+24]=G,this.uint16[pt+25]=W,this.uint16[pt+26]=Z,this.uint16[pt+27]=K,this.uint32[ht+14]=Q,this.float32[ht+15]=at,this.float32[ht+16]=X,this.float32[ht+17]=ft,this.float32[ht+18]=gt,this.uint8[Ct+76]=vt,t}}yx.prototype.bytesPerElement=80,Te(yx,"StructArrayLayout2f9i15ui1ul4f1ub80");class Hd extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.float32[1*t+0]=n,t}}Hd.prototype.bytesPerElement=4,Te(Hd,"StructArrayLayout1f4");class Mc extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,r,o,a){const c=this.length;return this.resize(c+1),this.emplace(c,t,n,r,o,a)}emplace(t,n,r,o,a,c){const u=5*t;return this.float32[u+0]=n,this.float32[u+1]=r,this.float32[u+2]=o,this.float32[u+3]=a,this.float32[u+4]=c,t}}Mc.prototype.bytesPerElement=20,Te(Mc,"StructArrayLayout5f20");class vx extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,r,o,a,c,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,r,o,a,c,u)}emplace(t,n,r,o,a,c,u,d){const p=7*t;return this.float32[p+0]=n,this.float32[p+1]=r,this.float32[p+2]=o,this.float32[p+3]=a,this.float32[p+4]=c,this.float32[p+5]=u,this.float32[p+6]=d,t}}vx.prototype.bytesPerElement=28,Te(vx,"StructArrayLayout7f28");class xx extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,r,o){const a=this.length;return this.resize(a+1),this.emplace(a,t,n,r,o)}emplace(t,n,r,o,a){const c=6*t;return this.uint32[3*t+0]=n,this.uint16[c+2]=r,this.uint16[c+3]=o,this.uint16[c+4]=a,t}}xx.prototype.bytesPerElement=12,Te(xx,"StructArrayLayout1ul3ui12");class Zd extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint16[1*t+0]=n,t}}Zd.prototype.bytesPerElement=2,Te(Zd,"StructArrayLayout1ui2");class Ic extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,r){const o=this.length;return this.resize(o+1),this.emplace(o,t,n,r)}emplace(t,n,r,o){const a=3*t;return this.float32[a+0]=n,this.float32[a+1]=r,this.float32[a+2]=o,t}}Ic.prototype.bytesPerElement=12,Te(Ic,"StructArrayLayout3f12");class Xd extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,n)}emplace(t,n,r){const o=2*t;return this.float32[o+0]=n,this.float32[o+1]=r,t}}Xd.prototype.bytesPerElement=8,Te(Xd,"StructArrayLayout2f8");class bx extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S){const I=this.length;return this.resize(I+1),this.emplace(I,t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S)}emplace(t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S,I){const A=16*t;return this.float32[A+0]=n,this.float32[A+1]=r,this.float32[A+2]=o,this.float32[A+3]=a,this.float32[A+4]=c,this.float32[A+5]=u,this.float32[A+6]=d,this.float32[A+7]=p,this.float32[A+8]=m,this.float32[A+9]=_,this.float32[A+10]=v,this.float32[A+11]=x,this.float32[A+12]=w,this.float32[A+13]=T,this.float32[A+14]=S,this.float32[A+15]=I,t}}bx.prototype.bytesPerElement=64,Te(bx,"StructArrayLayout16f64");class Im extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,r,o,a,c,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,r,o,a,c,u)}emplace(t,n,r,o,a,c,u,d){const p=10*t,m=5*t;return this.uint16[p+0]=n,this.uint16[p+1]=r,this.uint16[p+2]=o,this.uint16[p+3]=a,this.float32[m+2]=c,this.float32[m+3]=u,this.float32[m+4]=d,t}}Im.prototype.bytesPerElement=20,Te(Im,"StructArrayLayout4ui3f20");class wx extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint8[1*t+0]=n,t}}wx.prototype.bytesPerElement=1,Te(wx,"StructArrayLayout1ub1");class KC extends Tm{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}KC.prototype.size=40;class Tx extends px{get(t){return new KC(this,t)}}Te(Tx,"CollisionBoxArray");class YC extends Tm{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}YC.prototype.size=60;class QC extends _x{get(t){return new YC(this,t)}}Te(QC,"PlacedSymbolArray");class JC extends Tm{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}JC.prototype.size=80;class tM extends yx{get(t){return new JC(this,t)}}Te(tM,"SymbolInstanceArray");class eM extends Hd{getoffsetX(t){return this.float32[1*t+0]}}Te(eM,"GlyphOffsetArray");class nM extends bo{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}Te(nM,"SymbolLineVertexArray");class rM extends Tm{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}rM.prototype.size=12;class iM extends xx{get(t){return new rM(this,t)}}Te(iM,"FeatureIndexArray");class oM extends _l{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}Te(oM,"FillExtrusionCentroidArray");const zF=Dn([{name:"a_pos",components:2,type:"Int16"}],4),DF=Dn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Gn{constructor(t=[]){this.segments=t}_prepareSegment(t,n,r,o){let a=this.segments[this.segments.length-1];return t>Gn.MAX_VERTEX_ARRAY_LENGTH&&dt(`Max vertices per segment is ${Gn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!a||a.vertexLength+t>Gn.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==o)&&(a={vertexOffset:n,primitiveOffset:r,vertexLength:0,primitiveLength:0},o!==void 0&&(a.sortKey=o),this.segments.push(a)),a}prepareSegment(t,n,r,o){return this._prepareSegment(t,n.length,r.length,o)}get(){return this.segments}destroy(){for(const t of this.segments)for(const n in t.vaos)t.vaos[n].destroy()}static simpleSegment(t,n,r,o){return new Gn([{vertexOffset:t,primitiveOffset:n,vertexLength:r,primitiveLength:o,vaos:{},sortKey:0}])}}function sM(e,t){return 256*(e=jt(Math.floor(e),0,255))+jt(Math.floor(t),0,255)}Gn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Te(Gn,"SegmentVector");const BF=Dn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),FF=Dn([{name:"a_dash",components:4,type:"Uint16"}]);var Am={exports:{}},aM={exports:{}};(function(e){e.exports=function(t,n){var r,o,a,c,u,d,p,m;for(o=t.length-(r=3&t.length),a=n,u=3432918353,d=461845907,m=0;m<o;)p=255&t.charCodeAt(m)|(255&t.charCodeAt(++m))<<8|(255&t.charCodeAt(++m))<<16|(255&t.charCodeAt(++m))<<24,++m,a=27492+(65535&(c=5*(65535&(a=(a^=p=(65535&(p=(p=(65535&p)*u+(((p>>>16)*u&65535)<<16)&4294967295)<<15|p>>>17))*d+(((p>>>16)*d&65535)<<16)&4294967295)<<13|a>>>19))+((5*(a>>>16)&65535)<<16)&4294967295))+((58964+(c>>>16)&65535)<<16);switch(p=0,r){case 3:p^=(255&t.charCodeAt(m+2))<<16;case 2:p^=(255&t.charCodeAt(m+1))<<8;case 1:a^=p=(65535&(p=(p=(65535&(p^=255&t.charCodeAt(m)))*u+(((p>>>16)*u&65535)<<16)&4294967295)<<15|p>>>17))*d+(((p>>>16)*d&65535)<<16)&4294967295}return a^=t.length,a=2246822507*(65535&(a^=a>>>16))+((2246822507*(a>>>16)&65535)<<16)&4294967295,a=3266489909*(65535&(a^=a>>>13))+((3266489909*(a>>>16)&65535)<<16)&4294967295,(a^=a>>>16)>>>0}})(aM);var NF=aM.exports,lM={exports:{}};(function(e){e.exports=function(t,n){for(var r,o=t.length,a=n^o,c=0;o>=4;)r=1540483477*(65535&(r=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24))+((1540483477*(r>>>16)&65535)<<16),a=1540483477*(65535&a)+((1540483477*(a>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),o-=4,++c;switch(o){case 3:a^=(255&t.charCodeAt(c+2))<<16;case 2:a^=(255&t.charCodeAt(c+1))<<8;case 1:a=1540483477*(65535&(a^=255&t.charCodeAt(c)))+((1540483477*(a>>>16)&65535)<<16)}return a=1540483477*(65535&(a^=a>>>13))+((1540483477*(a>>>16)&65535)<<16),(a^=a>>>15)>>>0}})(lM);var cM=NF,jF=lM.exports;Am.exports=cM,Am.exports.murmur3=cM,Am.exports.murmur2=jF;var Sx=$(Am.exports);class Kd{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,n,r,o){this.ids.push(uM(t)),this.positions.push(n,r,o)}eachPosition(t,n){const r=uM(t);let o=0,a=this.ids.length-1;for(;o<a;){const c=o+a>>1;this.ids[c]>=r?a=c:o=c+1}for(;this.ids[o]===r;)n(this.positions[3*o],this.positions[3*o+1],this.positions[3*o+2]),o++}static serialize(t,n){const r=new Float64Array(t.ids),o=new Uint32Array(t.positions);return Ex(r,o,0,r.length-1),n&&(n.add(r.buffer),n.add(o.buffer)),{ids:r,positions:o}}static deserialize(t){const n=new Kd;let r;n.ids=t.ids,n.positions=t.positions;for(const o of n.ids)o!==r&&n.uniqueIds.push(o),r=o;return n.indexed=!0,n}}function uM(e){const t=+e;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:Sx(String(e))}function Ex(e,t,n,r){for(;n<r;){const o=e[n+r>>1];let a=n-1,c=r+1;for(;;){do a++;while(e[a]<o);do c--;while(e[c]>o);if(a>=c)break;Pm(e,a,c),Pm(t,3*a,3*c),Pm(t,3*a+1,3*c+1),Pm(t,3*a+2,3*c+2)}c-n<r-c?(Ex(e,t,n,c),n=c+1):(Ex(e,t,c+1,r),r=c)}}function Pm(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}Te(Kd,"FeaturePositionMap");class Oa{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,n){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,n),this.initialized=!0),!!this.location}}class dn extends Oa{constructor(t){super(t),this.current=0}set(t,n,r){this.fetchUniformLocation(t,n)&&this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}}class Kt extends Oa{constructor(t){super(t),this.current=0}set(t,n,r){this.fetchUniformLocation(t,n)&&this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class fn extends Oa{constructor(t){super(t),this.current=[0,0]}set(t,n,r){this.fetchUniformLocation(t,n)&&(r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1])))}}class nn extends Oa{constructor(t){super(t),this.current=[0,0,0]}set(t,n,r){this.fetchUniformLocation(t,n)&&(r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2])))}}class wo extends Oa{constructor(t){super(t),this.current=[0,0,0,0]}set(t,n,r){this.fetchUniformLocation(t,n)&&(r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3])))}}class Wu extends Oa{constructor(t){super(t),this.current=en.transparent}set(t,n,r){this.fetchUniformLocation(t,n)&&(r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a)))}}const UF=new Float32Array(16);class Je extends Oa{constructor(t){super(t),this.current=UF}set(t,n,r){if(this.fetchUniformLocation(t,n)){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let o=1;o<16;o++)if(r[o]!==this.current[o]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}}}const $F=new Float32Array(9);class Cx extends Oa{constructor(t){super(t),this.current=$F}set(t,n,r){if(this.fetchUniformLocation(t,n)){for(let o=0;o<9;o++)if(r[o]!==this.current[o]){this.current=r,this.gl.uniformMatrix3fv(this.location,!1,r);break}}}}const VF=new Float32Array(4);class Mx extends Oa{constructor(t){super(t),this.current=VF}set(t,n,r){if(this.fetchUniformLocation(t,n)){for(let o=0;o<4;o++)if(r[o]!==this.current[o]){this.current=r,this.gl.uniformMatrix2fv(this.location,!1,r);break}}}}function Ix(e){return[sM(255*e.r,255*e.g),sM(255*e.b,255*e.a)]}class Yd{constructor(t,n,r){this.value=t,this.uniformNames=n.map(o=>`u_${o}`),this.type=r}setUniform(t,n,r,o,a){n.set(t,a,o.constantOr(this.value))}getBinding(t,n){return this.type==="color"?new Wu(t):new Kt(t)}}class qu{constructor(t,n){this.uniformNames=n.map(r=>`u_${r}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,n,r,o,a){const c=a==="u_pattern"||a==="u_dash"?this.pattern:a==="u_pixel_ratio"?this.pixelRatio:null;c&&n.set(t,a,c)}getBinding(t,n){return n==="u_pattern"||n==="u_dash"?new wo(t):new Kt(t)}}class La{constructor(t,n,r,o){this.expression=t,this.type=r,this.maxValue=0,this.paintVertexAttributes=n.map(a=>({name:`a_${a}`,type:"Float32",components:r==="color"?2:1,offset:0})),this.paintVertexArray=new o}populatePaintArray(t,n,r,o,a,c,u){const d=this.paintVertexArray.length,p=this.expression.evaluate(new fr(0,{brightness:c}),n,{},a,o,u);this.paintVertexArray.resize(t),this._setPaintValue(d,t,p)}updatePaintArray(t,n,r,o,a,c,u){const d=this.expression.evaluate({zoom:0,brightness:u},r,o,void 0,a);this._setPaintValue(t,n,d)}_setPaintValue(t,n,r){if(this.type==="color"){const o=Ix(r);for(let a=t;a<n;a++)this.paintVertexArray.emplace(a,o[0],o[1])}else{for(let o=t;o<n;o++)this.paintVertexArray.emplace(o,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ks{constructor(t,n,r,o,a,c){this.expression=t,this.uniformNames=n.map(u=>`u_${u}_t`),this.type=r,this.useIntegerZoom=o,this.zoom=a,this.maxValue=0,this.paintVertexAttributes=n.map(u=>({name:`a_${u}`,type:"Float32",components:r==="color"?4:2,offset:0})),this.paintVertexArray=new c}populatePaintArray(t,n,r,o,a,c,u){const d=this.expression.evaluate(new fr(this.zoom,{brightness:c}),n,{},a,o,u),p=this.expression.evaluate(new fr(this.zoom+1,{brightness:c}),n,{},a,o,u),m=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(m,t,d,p)}updatePaintArray(t,n,r,o,a,c,u){const d=this.expression.evaluate({zoom:this.zoom,brightness:u},r,o,void 0,a),p=this.expression.evaluate({zoom:this.zoom+1,brightness:u},r,o,void 0,a);this._setPaintValue(t,n,d,p)}_setPaintValue(t,n,r,o){if(this.type==="color"){const a=Ix(r),c=Ix(o);for(let u=t;u<n;u++)this.paintVertexArray.emplace(u,a[0],a[1],c[0],c[1])}else{for(let a=t;a<n;a++)this.paintVertexArray.emplace(a,r,o);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(o))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,n,r,o,a){const c=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,u=jt(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);n.set(t,a,u)}getBinding(t,n){return new Kt(t)}}class yl{constructor(t,n,r,o,a){this.expression=t,this.layerId=a,this.paintVertexAttributes=(r==="array"?FF:BF).members;for(let c=0;c<n.length;++c);this.paintVertexArray=new o}populatePaintArray(t,n,r){const o=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(o,t,n.patterns&&n.patterns[this.layerId],r)}updatePaintArray(t,n,r,o,a,c,u){this._setPaintValues(t,n,r.patterns&&r.patterns[this.layerId],c)}_setPaintValues(t,n,r,o){if(!o||!r)return;const a=o[r];if(!a)return;const{tl:c,br:u,pixelRatio:d}=a;for(let p=t;p<n;p++)this.paintVertexArray.emplace(p,c[0],c[1],u[0],u[1],d)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ac{constructor(t,n,r=()=>!0){this.binders={},this._buffers=[];const o=[];for(const a in t.paint._values){const c=t.paint.get(a);if(!r(a)||!(c instanceof Gu&&Sc(c.property.specification)))continue;const u=WF(a,t.type),d=c.value,p=c.property.specification.type,m=!!c.property.useIntegerZoom,_=a==="line-dasharray"||a.endsWith("pattern"),v=a==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(d.kind!=="constant"||v)if(d.kind==="source"||v||_){const x=hM(a,p,"source");this.binders[a]=_?new yl(d,u,p,x,t.id):new La(d,u,p,x),o.push(`/a_${a}`)}else{const x=hM(a,p,"composite");this.binders[a]=new ks(d,u,p,m,n,x),o.push(`/z_${a}`)}else this.binders[a]=_?new qu(d.value,u):new Yd(d.value,u,p),o.push(`/u_${a}`)}this.cacheKey=o.sort().join("")}getMaxValue(t){const n=this.binders[t];return n instanceof La||n instanceof ks?n.maxValue:0}populatePaintArrays(t,n,r,o,a,c,u){for(const d in this.binders){const p=this.binders[d];(p instanceof La||p instanceof ks||p instanceof yl)&&p.populatePaintArray(t,n,r,o,a,c,u)}}setConstantPatternPositions(t){for(const n in this.binders){const r=this.binders[n];r instanceof qu&&r.setConstantPatternPositions(t)}}updatePaintArrays(t,n,r,o,a,c,u,d){let p=!1;const m=Object.keys(t),_=m.length!==0,v=_?m:n.uniqueIds;for(const x in this.binders){const w=this.binders[x];if((w instanceof La||w instanceof ks||w instanceof yl)&&(w.expression.isStateDependent===!0||w.expression.isLightConstant===!1)){const T=a.paint.get(x);w.expression=T.value;for(const S of v){const I=t[S.toString()];n.eachPosition(S,(A,R,k)=>{const P=o.feature(A);w.updatePaintArray(R,k,P,I,c,u,d)})}if(!_)for(const S of r.uniqueIds){const I=t[S.toString()];r.eachPosition(S,(A,R,k)=>{const P=o.feature(A);w.updatePaintArray(R,k,P,I,c,u,d)})}p=!0}}return p}defines(){const t=[];for(const n in this.binders){const r=this.binders[n];(r instanceof Yd||r instanceof qu)&&t.push(...r.uniformNames.map(o=>`#define HAS_UNIFORM_${o}`))}return t}getBinderAttributes(){const t=[];for(const n in this.binders){const r=this.binders[n];if(r instanceof La||r instanceof ks||r instanceof yl)for(let o=0;o<r.paintVertexAttributes.length;o++)t.push(r.paintVertexAttributes[o].name)}return t}getBinderUniforms(){const t=[];for(const n in this.binders){const r=this.binders[n];if(r instanceof Yd||r instanceof qu||r instanceof ks)for(const o of r.uniformNames)t.push(o)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const n=[];for(const r in this.binders){const o=this.binders[r];if(o instanceof Yd||o instanceof qu||o instanceof ks)for(const a of o.uniformNames)n.push({name:a,property:r,binding:o.getBinding(t,a)})}return n}setUniforms(t,n,r,o,a){for(const{name:c,property:u,binding:d}of r)this.binders[u].setUniform(t,d,a,o.get(u),c)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const n=this.binders[t];(n instanceof La||n instanceof ks||n instanceof yl)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(t){for(const n in this.binders){const r=this.binders[n];(r instanceof La||r instanceof ks||r instanceof yl)&&r.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const n=this.binders[t];(n instanceof La||n instanceof ks||n instanceof yl)&&n.destroy()}}}class vl{constructor(t,n,r=()=>!0){this.programConfigurations={};for(const o of t)this.programConfigurations[o.id]=new Ac(o,n,r);this.needsUpload=!1,this._featureMap=new Kd,this._featureMapWithoutIds=new Kd,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,n,r,o,a,c,u,d){for(const p in this.programConfigurations)this.programConfigurations[p].populatePaintArrays(t,n,o,a,c,u,d);n.id!==void 0?this._featureMap.add(n.id,r,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,r,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,n,r,o,a,c){for(const u of r)this.needsUpload=this.programConfigurations[u.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,n,u,o,a,c||0)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const GF={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function WF(e,t){return GF[e]||[e.replace(`${t}-`,"").replace(/-/g,"_")]}const qF={"line-pattern":{source:gl,composite:gl},"fill-pattern":{source:gl,composite:gl},"fill-extrusion-pattern":{source:gl,composite:gl},"line-dasharray":{source:Em,composite:Em}},HF={color:{source:Xd,composite:ka},number:{source:Hd,composite:Xd}};function hM(e,t,n){const r=qF[e];return r&&r[n]||HF[t][n]}Te(Yd,"ConstantBinder"),Te(qu,"PatternConstantBinder"),Te(La,"SourceExpressionBinder"),Te(yl,"PatternCompositeBinder"),Te(ks,"CompositeExpressionBinder"),Te(Ac,"ProgramConfiguration",{omit:["_buffers"]}),Te(vl,"ProgramConfigurationSet");class To{constructor(t,n){t&&(n?this.setSouthWest(t).setNorthEast(n):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Ke?new Ke(t.lng,t.lat):Ke.convert(t),this}setSouthWest(t){return this._sw=t instanceof Ke?new Ke(t.lng,t.lat):Ke.convert(t),this}extend(t){const n=this._sw,r=this._ne;let o,a;if(t instanceof Ke)o=t,a=t;else{if(!(t instanceof To))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(To.convert(t)):this.extend(Ke.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(Ke.convert(t)):this;if(o=t._sw,a=t._ne,!o||!a)return this}return n||r?(n.lng=Math.min(o.lng,n.lng),n.lat=Math.min(o.lat,n.lat),r.lng=Math.max(a.lng,r.lng),r.lat=Math.max(a.lat,r.lat)):(this._sw=new Ke(o.lng,o.lat),this._ne=new Ke(a.lng,a.lat)),this}getCenter(){return new Ke((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ke(this.getWest(),this.getNorth())}getSouthEast(){return new Ke(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:n,lat:r}=Ke.convert(t);let o=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(o=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&o}static convert(t){return!t||t instanceof To?t:new To(t)}}var hi={},di={};Object.defineProperty(di,"__esModule",{value:!0}),di.setMatrixArrayType=function(e){di.ARRAY_TYPE=fM=e},di.toRadian=function(e){return e*XF},di.equals=function(e,t){return Math.abs(e-t)<=dM*Math.max(1,Math.abs(e),Math.abs(t))},di.RANDOM=di.ARRAY_TYPE=di.EPSILON=void 0;var dM=1e-6;di.EPSILON=dM;var fM=typeof Float32Array<"u"?Float32Array:Array;di.ARRAY_TYPE=fM;var ZF=Math.random;di.RANDOM=ZF;var XF=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var mr={};function Ax(e){return Ax=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ax(e)}Object.defineProperty(mr,"__esModule",{value:!0}),mr.create=function(){var e=new xl.ARRAY_TYPE(4);return xl.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},mr.clone=function(e){var t=new xl.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},mr.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},mr.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},mr.fromValues=function(e,t,n,r){var o=new xl.ARRAY_TYPE(4);return o[0]=e,o[1]=t,o[2]=n,o[3]=r,o},mr.set=function(e,t,n,r,o){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e},mr.transpose=function(e,t){if(e===t){var n=t[1];e[1]=t[2],e[2]=n}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},mr.invert=function(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],c=n*a-o*r;return c?(e[0]=a*(c=1/c),e[1]=-r*c,e[2]=-o*c,e[3]=n*c,e):null},mr.adjoint=function(e,t){var n=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=n,e},mr.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},mr.multiply=mM,mr.rotate=function(e,t,n){var r=t[0],o=t[1],a=t[2],c=t[3],u=Math.sin(n),d=Math.cos(n);return e[0]=r*d+a*u,e[1]=o*d+c*u,e[2]=r*-u+a*d,e[3]=o*-u+c*d,e},mr.scale=function(e,t,n){var r=t[1],o=t[2],a=t[3],c=n[0],u=n[1];return e[0]=t[0]*c,e[1]=r*c,e[2]=o*u,e[3]=a*u,e},mr.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=-n,e[3]=r,e},mr.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},mr.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},mr.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3])},mr.LDU=function(e,t,n,r){return e[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-e[2]*n[1],[e,t,n]},mr.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},mr.subtract=gM,mr.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},mr.equals=function(e,t){var n=e[0],r=e[1],o=e[2],a=e[3],c=t[0],u=t[1],d=t[2],p=t[3];return Math.abs(n-c)<=xl.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(r-u)<=xl.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-d)<=xl.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-p)<=xl.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))},mr.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},mr.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e},mr.sub=mr.mul=void 0;var xl=function(e,t){if(e&&e.__esModule)return e;if(e===null||Ax(e)!=="object"&&typeof e!="function")return{default:e};var n=pM(void 0);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var c=o?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(di);function pM(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(pM=function(r){return r?n:t})(e)}function mM(e,t,n){var r=t[0],o=t[1],a=t[2],c=t[3],u=n[0],d=n[1],p=n[2],m=n[3];return e[0]=r*u+a*d,e[1]=o*u+c*d,e[2]=r*p+a*m,e[3]=o*p+c*m,e}function gM(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}mr.mul=mM,mr.sub=gM;var vr={};function Px(e){return Px=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Px(e)}Object.defineProperty(vr,"__esModule",{value:!0}),vr.create=function(){var e=new na.ARRAY_TYPE(6);return na.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e},vr.clone=function(e){var t=new na.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},vr.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},vr.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},vr.fromValues=function(e,t,n,r,o,a){var c=new na.ARRAY_TYPE(6);return c[0]=e,c[1]=t,c[2]=n,c[3]=r,c[4]=o,c[5]=a,c},vr.set=function(e,t,n,r,o,a,c){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e[4]=a,e[5]=c,e},vr.invert=function(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],c=t[4],u=t[5],d=n*a-r*o;return d?(e[0]=a*(d=1/d),e[1]=-r*d,e[2]=-o*d,e[3]=n*d,e[4]=(o*u-a*c)*d,e[5]=(r*c-n*u)*d,e):null},vr.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},vr.multiply=yM,vr.rotate=function(e,t,n){var r=t[0],o=t[1],a=t[2],c=t[3],u=t[4],d=t[5],p=Math.sin(n),m=Math.cos(n);return e[0]=r*m+a*p,e[1]=o*m+c*p,e[2]=r*-p+a*m,e[3]=o*-p+c*m,e[4]=u,e[5]=d,e},vr.scale=function(e,t,n){var r=t[1],o=t[2],a=t[3],c=t[4],u=t[5],d=n[0],p=n[1];return e[0]=t[0]*d,e[1]=r*d,e[2]=o*p,e[3]=a*p,e[4]=c,e[5]=u,e},vr.translate=function(e,t,n){var r=t[0],o=t[1],a=t[2],c=t[3],u=t[4],d=t[5],p=n[0],m=n[1];return e[0]=r,e[1]=o,e[2]=a,e[3]=c,e[4]=r*p+a*m+u,e[5]=o*p+c*m+d,e},vr.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=-n,e[3]=r,e[4]=0,e[5]=0,e},vr.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},vr.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},vr.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},vr.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)},vr.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e},vr.subtract=vM,vr.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e},vr.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e},vr.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},vr.equals=function(e,t){var n=e[0],r=e[1],o=e[2],a=e[3],c=e[4],u=e[5],d=t[0],p=t[1],m=t[2],_=t[3],v=t[4],x=t[5];return Math.abs(n-d)<=na.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(r-p)<=na.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(o-m)<=na.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-_)<=na.EPSILON*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(c-v)<=na.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(u-x)<=na.EPSILON*Math.max(1,Math.abs(u),Math.abs(x))},vr.sub=vr.mul=void 0;var na=function(e,t){if(e&&e.__esModule)return e;if(e===null||Px(e)!=="object"&&typeof e!="function")return{default:e};var n=_M(void 0);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var c=o?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(di);function _M(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(_M=function(r){return r?n:t})(e)}function yM(e,t,n){var r=t[0],o=t[1],a=t[2],c=t[3],u=t[4],d=t[5],p=n[0],m=n[1],_=n[2],v=n[3],x=n[4],w=n[5];return e[0]=r*p+a*m,e[1]=o*p+c*m,e[2]=r*_+a*v,e[3]=o*_+c*v,e[4]=r*x+a*w+u,e[5]=o*x+c*w+d,e}function vM(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e}vr.mul=yM,vr.sub=vM;var Kn={};function Rx(e){return Rx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rx(e)}Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.create=function(){var e=new Go.ARRAY_TYPE(9);return Go.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},Kn.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},Kn.clone=function(e){var t=new Go.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},Kn.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},Kn.fromValues=function(e,t,n,r,o,a,c,u,d){var p=new Go.ARRAY_TYPE(9);return p[0]=e,p[1]=t,p[2]=n,p[3]=r,p[4]=o,p[5]=a,p[6]=c,p[7]=u,p[8]=d,p},Kn.set=function(e,t,n,r,o,a,c,u,d,p){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e[4]=a,e[5]=c,e[6]=u,e[7]=d,e[8]=p,e},Kn.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},Kn.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],o=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=o}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},Kn.invert=function(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],c=t[4],u=t[5],d=t[6],p=t[7],m=t[8],_=m*c-u*p,v=-m*a+u*d,x=p*a-c*d,w=n*_+r*v+o*x;return w?(e[0]=_*(w=1/w),e[1]=(-m*r+o*p)*w,e[2]=(u*r-o*c)*w,e[3]=v*w,e[4]=(m*n-o*d)*w,e[5]=(-u*n+o*a)*w,e[6]=x*w,e[7]=(-p*n+r*d)*w,e[8]=(c*n-r*a)*w,e):null},Kn.adjoint=function(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],c=t[4],u=t[5],d=t[6],p=t[7],m=t[8];return e[0]=c*m-u*p,e[1]=o*p-r*m,e[2]=r*u-o*c,e[3]=u*d-a*m,e[4]=n*m-o*d,e[5]=o*a-n*u,e[6]=a*p-c*d,e[7]=r*d-n*p,e[8]=n*c-r*a,e},Kn.determinant=function(e){var t=e[3],n=e[4],r=e[5],o=e[6],a=e[7],c=e[8];return e[0]*(c*n-r*a)+e[1]*(-c*t+r*o)+e[2]*(a*t-n*o)},Kn.multiply=bM,Kn.translate=function(e,t,n){var r=t[0],o=t[1],a=t[2],c=t[3],u=t[4],d=t[5],p=t[6],m=t[7],_=t[8],v=n[0],x=n[1];return e[0]=r,e[1]=o,e[2]=a,e[3]=c,e[4]=u,e[5]=d,e[6]=v*r+x*c+p,e[7]=v*o+x*u+m,e[8]=v*a+x*d+_,e},Kn.rotate=function(e,t,n){var r=t[0],o=t[1],a=t[2],c=t[3],u=t[4],d=t[5],p=t[6],m=t[7],_=t[8],v=Math.sin(n),x=Math.cos(n);return e[0]=x*r+v*c,e[1]=x*o+v*u,e[2]=x*a+v*d,e[3]=x*c-v*r,e[4]=x*u-v*o,e[5]=x*d-v*a,e[6]=p,e[7]=m,e[8]=_,e},Kn.scale=function(e,t,n){var r=n[0],o=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=o*t[3],e[4]=o*t[4],e[5]=o*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},Kn.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},Kn.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},Kn.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},Kn.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},Kn.fromQuat=function(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],c=n+n,u=r+r,d=o+o,p=n*c,m=r*c,_=r*u,v=o*c,x=o*u,w=o*d,T=a*c,S=a*u,I=a*d;return e[0]=1-_-w,e[3]=m-I,e[6]=v+S,e[1]=m+I,e[4]=1-p-w,e[7]=x-T,e[2]=v-S,e[5]=x+T,e[8]=1-p-_,e},Kn.normalFromMat4=function(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],c=t[4],u=t[5],d=t[6],p=t[7],m=t[8],_=t[9],v=t[10],x=t[11],w=t[12],T=t[13],S=t[14],I=t[15],A=n*u-r*c,R=n*d-o*c,k=n*p-a*c,P=r*d-o*u,O=r*p-a*u,j=o*p-a*d,G=m*T-_*w,W=m*S-v*w,Z=m*I-x*w,K=_*S-v*T,Q=_*I-x*T,at=v*I-x*S,X=A*at-R*Q+k*K+P*Z-O*W+j*G;return X?(e[0]=(u*at-d*Q+p*K)*(X=1/X),e[1]=(d*Z-c*at-p*W)*X,e[2]=(c*Q-u*Z+p*G)*X,e[3]=(o*Q-r*at-a*K)*X,e[4]=(n*at-o*Z+a*W)*X,e[5]=(r*Z-n*Q-a*G)*X,e[6]=(T*j-S*O+I*P)*X,e[7]=(S*k-w*j-I*R)*X,e[8]=(w*O-T*k+I*A)*X,e):null},Kn.projection=function(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},Kn.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},Kn.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},Kn.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e},Kn.subtract=wM,Kn.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e},Kn.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e},Kn.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},Kn.equals=function(e,t){var n=e[0],r=e[1],o=e[2],a=e[3],c=e[4],u=e[5],d=e[6],p=e[7],m=e[8],_=t[0],v=t[1],x=t[2],w=t[3],T=t[4],S=t[5],I=t[6],A=t[7],R=t[8];return Math.abs(n-_)<=Go.EPSILON*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(r-v)<=Go.EPSILON*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(o-x)<=Go.EPSILON*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-w)<=Go.EPSILON*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(c-T)<=Go.EPSILON*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(u-S)<=Go.EPSILON*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(d-I)<=Go.EPSILON*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(p-A)<=Go.EPSILON*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(m-R)<=Go.EPSILON*Math.max(1,Math.abs(m),Math.abs(R))},Kn.sub=Kn.mul=void 0;var Go=function(e,t){if(e&&e.__esModule)return e;if(e===null||Rx(e)!=="object"&&typeof e!="function")return{default:e};var n=xM(void 0);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var c=o?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(di);function xM(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(xM=function(r){return r?n:t})(e)}function bM(e,t,n){var r=t[0],o=t[1],a=t[2],c=t[3],u=t[4],d=t[5],p=t[6],m=t[7],_=t[8],v=n[0],x=n[1],w=n[2],T=n[3],S=n[4],I=n[5],A=n[6],R=n[7],k=n[8];return e[0]=v*r+x*c+w*p,e[1]=v*o+x*u+w*m,e[2]=v*a+x*d+w*_,e[3]=T*r+S*c+I*p,e[4]=T*o+S*u+I*m,e[5]=T*a+S*d+I*_,e[6]=A*r+R*c+k*p,e[7]=A*o+R*u+k*m,e[8]=A*a+R*d+k*_,e}function wM(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}Kn.mul=bM,Kn.sub=wM;var on={};function kx(e){return kx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kx(e)}Object.defineProperty(on,"__esModule",{value:!0}),on.create=function(){var e=new kr.ARRAY_TYPE(16);return kr.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},on.clone=function(e){var t=new kr.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},on.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},on.fromValues=function(e,t,n,r,o,a,c,u,d,p,m,_,v,x,w,T){var S=new kr.ARRAY_TYPE(16);return S[0]=e,S[1]=t,S[2]=n,S[3]=r,S[4]=o,S[5]=a,S[6]=c,S[7]=u,S[8]=d,S[9]=p,S[10]=m,S[11]=_,S[12]=v,S[13]=x,S[14]=w,S[15]=T,S},on.set=function(e,t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e[4]=a,e[5]=c,e[6]=u,e[7]=d,e[8]=p,e[9]=m,e[10]=_,e[11]=v,e[12]=x,e[13]=w,e[14]=T,e[15]=S,e},on.identity=SM,on.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],o=t[3],a=t[6],c=t[7],u=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=a,e[11]=t[14],e[12]=o,e[13]=c,e[14]=u}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},on.invert=function(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],c=t[4],u=t[5],d=t[6],p=t[7],m=t[8],_=t[9],v=t[10],x=t[11],w=t[12],T=t[13],S=t[14],I=t[15],A=n*u-r*c,R=n*d-o*c,k=n*p-a*c,P=r*d-o*u,O=r*p-a*u,j=o*p-a*d,G=m*T-_*w,W=m*S-v*w,Z=m*I-x*w,K=_*S-v*T,Q=_*I-x*T,at=v*I-x*S,X=A*at-R*Q+k*K+P*Z-O*W+j*G;return X?(e[0]=(u*at-d*Q+p*K)*(X=1/X),e[1]=(o*Q-r*at-a*K)*X,e[2]=(T*j-S*O+I*P)*X,e[3]=(v*O-_*j-x*P)*X,e[4]=(d*Z-c*at-p*W)*X,e[5]=(n*at-o*Z+a*W)*X,e[6]=(S*k-w*j-I*R)*X,e[7]=(m*j-v*k+x*R)*X,e[8]=(c*Q-u*Z+p*G)*X,e[9]=(r*Z-n*Q-a*G)*X,e[10]=(w*O-T*k+I*A)*X,e[11]=(_*k-m*O-x*A)*X,e[12]=(u*W-c*K-d*G)*X,e[13]=(n*K-r*W+o*G)*X,e[14]=(T*R-w*P-S*A)*X,e[15]=(m*P-_*R+v*A)*X,e):null},on.adjoint=function(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],c=t[4],u=t[5],d=t[6],p=t[7],m=t[8],_=t[9],v=t[10],x=t[11],w=t[12],T=t[13],S=t[14],I=t[15];return e[0]=u*(v*I-x*S)-_*(d*I-p*S)+T*(d*x-p*v),e[1]=-(r*(v*I-x*S)-_*(o*I-a*S)+T*(o*x-a*v)),e[2]=r*(d*I-p*S)-u*(o*I-a*S)+T*(o*p-a*d),e[3]=-(r*(d*x-p*v)-u*(o*x-a*v)+_*(o*p-a*d)),e[4]=-(c*(v*I-x*S)-m*(d*I-p*S)+w*(d*x-p*v)),e[5]=n*(v*I-x*S)-m*(o*I-a*S)+w*(o*x-a*v),e[6]=-(n*(d*I-p*S)-c*(o*I-a*S)+w*(o*p-a*d)),e[7]=n*(d*x-p*v)-c*(o*x-a*v)+m*(o*p-a*d),e[8]=c*(_*I-x*T)-m*(u*I-p*T)+w*(u*x-p*_),e[9]=-(n*(_*I-x*T)-m*(r*I-a*T)+w*(r*x-a*_)),e[10]=n*(u*I-p*T)-c*(r*I-a*T)+w*(r*p-a*u),e[11]=-(n*(u*x-p*_)-c*(r*x-a*_)+m*(r*p-a*u)),e[12]=-(c*(_*S-v*T)-m*(u*S-d*T)+w*(u*v-d*_)),e[13]=n*(_*S-v*T)-m*(r*S-o*T)+w*(r*v-o*_),e[14]=-(n*(u*S-d*T)-c*(r*S-o*T)+w*(r*d-o*u)),e[15]=n*(u*v-d*_)-c*(r*v-o*_)+m*(r*d-o*u),e},on.determinant=function(e){var t=e[0],n=e[1],r=e[2],o=e[3],a=e[4],c=e[5],u=e[6],d=e[7],p=e[8],m=e[9],_=e[10],v=e[11],x=e[12],w=e[13],T=e[14],S=e[15];return(t*c-n*a)*(_*S-v*T)-(t*u-r*a)*(m*S-v*w)+(t*d-o*a)*(m*T-_*w)+(n*u-r*c)*(p*S-v*x)-(n*d-o*c)*(p*T-_*x)+(r*d-o*u)*(p*w-m*x)},on.multiply=EM,on.translate=function(e,t,n){var r,o,a,c,u,d,p,m,_,v,x,w,T=n[0],S=n[1],I=n[2];return t===e?(e[12]=t[0]*T+t[4]*S+t[8]*I+t[12],e[13]=t[1]*T+t[5]*S+t[9]*I+t[13],e[14]=t[2]*T+t[6]*S+t[10]*I+t[14],e[15]=t[3]*T+t[7]*S+t[11]*I+t[15]):(o=t[1],a=t[2],c=t[3],u=t[4],d=t[5],p=t[6],m=t[7],_=t[8],v=t[9],x=t[10],w=t[11],e[0]=r=t[0],e[1]=o,e[2]=a,e[3]=c,e[4]=u,e[5]=d,e[6]=p,e[7]=m,e[8]=_,e[9]=v,e[10]=x,e[11]=w,e[12]=r*T+u*S+_*I+t[12],e[13]=o*T+d*S+v*I+t[13],e[14]=a*T+p*S+x*I+t[14],e[15]=c*T+m*S+w*I+t[15]),e},on.scale=function(e,t,n){var r=n[0],o=n[1],a=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*o,e[5]=t[5]*o,e[6]=t[6]*o,e[7]=t[7]*o,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},on.rotate=function(e,t,n,r){var o,a,c,u,d,p,m,_,v,x,w,T,S,I,A,R,k,P,O,j,G,W,Z,K,Q=r[0],at=r[1],X=r[2],ft=Math.hypot(Q,at,X);return ft<kr.EPSILON?null:(Q*=ft=1/ft,at*=ft,X*=ft,o=Math.sin(n),a=Math.cos(n),d=t[1],p=t[2],m=t[3],v=t[5],x=t[6],w=t[7],S=t[9],I=t[10],A=t[11],O=Q*at*(c=1-a)-X*o,j=at*at*c+a,G=X*at*c+Q*o,W=Q*X*c+at*o,Z=at*X*c-Q*o,K=X*X*c+a,e[0]=(u=t[0])*(R=Q*Q*c+a)+(_=t[4])*(k=at*Q*c+X*o)+(T=t[8])*(P=X*Q*c-at*o),e[1]=d*R+v*k+S*P,e[2]=p*R+x*k+I*P,e[3]=m*R+w*k+A*P,e[4]=u*O+_*j+T*G,e[5]=d*O+v*j+S*G,e[6]=p*O+x*j+I*G,e[7]=m*O+w*j+A*G,e[8]=u*W+_*Z+T*K,e[9]=d*W+v*Z+S*K,e[10]=p*W+x*Z+I*K,e[11]=m*W+w*Z+A*K,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},on.rotateX=function(e,t,n){var r=Math.sin(n),o=Math.cos(n),a=t[4],c=t[5],u=t[6],d=t[7],p=t[8],m=t[9],_=t[10],v=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*o+p*r,e[5]=c*o+m*r,e[6]=u*o+_*r,e[7]=d*o+v*r,e[8]=p*o-a*r,e[9]=m*o-c*r,e[10]=_*o-u*r,e[11]=v*o-d*r,e},on.rotateY=function(e,t,n){var r=Math.sin(n),o=Math.cos(n),a=t[0],c=t[1],u=t[2],d=t[3],p=t[8],m=t[9],_=t[10],v=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*o-p*r,e[1]=c*o-m*r,e[2]=u*o-_*r,e[3]=d*o-v*r,e[8]=a*r+p*o,e[9]=c*r+m*o,e[10]=u*r+_*o,e[11]=d*r+v*o,e},on.rotateZ=function(e,t,n){var r=Math.sin(n),o=Math.cos(n),a=t[0],c=t[1],u=t[2],d=t[3],p=t[4],m=t[5],_=t[6],v=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*o+p*r,e[1]=c*o+m*r,e[2]=u*o+_*r,e[3]=d*o+v*r,e[4]=p*o-a*r,e[5]=m*o-c*r,e[6]=_*o-u*r,e[7]=v*o-d*r,e},on.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},on.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},on.fromRotation=function(e,t,n){var r,o,a,c=n[0],u=n[1],d=n[2],p=Math.hypot(c,u,d);return p<kr.EPSILON?null:(c*=p=1/p,u*=p,d*=p,r=Math.sin(t),o=Math.cos(t),e[0]=c*c*(a=1-o)+o,e[1]=u*c*a+d*r,e[2]=d*c*a-u*r,e[3]=0,e[4]=c*u*a-d*r,e[5]=u*u*a+o,e[6]=d*u*a+c*r,e[7]=0,e[8]=c*d*a+u*r,e[9]=u*d*a-c*r,e[10]=d*d*a+o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},on.fromXRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},on.fromYRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},on.fromZRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},on.fromRotationTranslation=CM,on.fromQuat2=function(e,t){var n=new kr.ARRAY_TYPE(3),r=-t[0],o=-t[1],a=-t[2],c=t[3],u=t[4],d=t[5],p=t[6],m=t[7],_=r*r+o*o+a*a+c*c;return _>0?(n[0]=2*(u*c+m*r+d*a-p*o)/_,n[1]=2*(d*c+m*o+p*r-u*a)/_,n[2]=2*(p*c+m*a+u*o-d*r)/_):(n[0]=2*(u*c+m*r+d*a-p*o),n[1]=2*(d*c+m*o+p*r-u*a),n[2]=2*(p*c+m*a+u*o-d*r)),CM(e,t,n),e},on.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},on.getScaling=MM,on.getRotation=function(e,t){var n=new kr.ARRAY_TYPE(3);MM(n,t);var r=1/n[0],o=1/n[1],a=1/n[2],c=t[0]*r,u=t[1]*o,d=t[2]*a,p=t[4]*r,m=t[5]*o,_=t[6]*a,v=t[8]*r,x=t[9]*o,w=t[10]*a,T=c+m+w,S=0;return T>0?(S=2*Math.sqrt(T+1),e[3]=.25*S,e[0]=(_-x)/S,e[1]=(v-d)/S,e[2]=(u-p)/S):c>m&&c>w?(S=2*Math.sqrt(1+c-m-w),e[3]=(_-x)/S,e[0]=.25*S,e[1]=(u+p)/S,e[2]=(v+d)/S):m>w?(S=2*Math.sqrt(1+m-c-w),e[3]=(v-d)/S,e[0]=(u+p)/S,e[1]=.25*S,e[2]=(_+x)/S):(S=2*Math.sqrt(1+w-c-m),e[3]=(u-p)/S,e[0]=(v+d)/S,e[1]=(_+x)/S,e[2]=.25*S),e},on.fromRotationTranslationScale=function(e,t,n,r){var o=t[0],a=t[1],c=t[2],u=t[3],d=o+o,p=a+a,m=c+c,_=o*d,v=o*p,x=o*m,w=a*p,T=a*m,S=c*m,I=u*d,A=u*p,R=u*m,k=r[0],P=r[1],O=r[2];return e[0]=(1-(w+S))*k,e[1]=(v+R)*k,e[2]=(x-A)*k,e[3]=0,e[4]=(v-R)*P,e[5]=(1-(_+S))*P,e[6]=(T+I)*P,e[7]=0,e[8]=(x+A)*O,e[9]=(T-I)*O,e[10]=(1-(_+w))*O,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},on.fromRotationTranslationScaleOrigin=function(e,t,n,r,o){var a=t[0],c=t[1],u=t[2],d=t[3],p=a+a,m=c+c,_=u+u,v=a*p,x=a*m,w=a*_,T=c*m,S=c*_,I=u*_,A=d*p,R=d*m,k=d*_,P=r[0],O=r[1],j=r[2],G=o[0],W=o[1],Z=o[2],K=(1-(T+I))*P,Q=(x+k)*P,at=(w-R)*P,X=(x-k)*O,ft=(1-(v+I))*O,gt=(S+A)*O,vt=(w+R)*j,ht=(S-A)*j,pt=(1-(v+T))*j;return e[0]=K,e[1]=Q,e[2]=at,e[3]=0,e[4]=X,e[5]=ft,e[6]=gt,e[7]=0,e[8]=vt,e[9]=ht,e[10]=pt,e[11]=0,e[12]=n[0]+G-(K*G+X*W+vt*Z),e[13]=n[1]+W-(Q*G+ft*W+ht*Z),e[14]=n[2]+Z-(at*G+gt*W+pt*Z),e[15]=1,e},on.fromQuat=function(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],c=n+n,u=r+r,d=o+o,p=n*c,m=r*c,_=r*u,v=o*c,x=o*u,w=o*d,T=a*c,S=a*u,I=a*d;return e[0]=1-_-w,e[1]=m+I,e[2]=v-S,e[3]=0,e[4]=m-I,e[5]=1-p-w,e[6]=x+T,e[7]=0,e[8]=v+S,e[9]=x-T,e[10]=1-p-_,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},on.frustum=function(e,t,n,r,o,a,c){var u=1/(n-t),d=1/(o-r),p=1/(a-c);return e[0]=2*a*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*d,e[6]=0,e[7]=0,e[8]=(n+t)*u,e[9]=(o+r)*d,e[10]=(c+a)*p,e[11]=-1,e[12]=0,e[13]=0,e[14]=c*a*2*p,e[15]=0,e},on.perspectiveNO=IM,on.perspectiveZO=function(e,t,n,r,o){var a,c=1/Math.tan(t/2);return e[0]=c/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,o!=null&&o!==1/0?(e[10]=o*(a=1/(r-o)),e[14]=o*r*a):(e[10]=-1,e[14]=-r),e},on.perspectiveFromFieldOfView=function(e,t,n,r){var o=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),c=Math.tan(t.leftDegrees*Math.PI/180),u=Math.tan(t.rightDegrees*Math.PI/180),d=2/(c+u),p=2/(o+a);return e[0]=d,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=p,e[6]=0,e[7]=0,e[8]=-(c-u)*d*.5,e[9]=(o-a)*p*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e},on.orthoNO=AM,on.orthoZO=function(e,t,n,r,o,a,c){var u=1/(t-n),d=1/(r-o),p=1/(a-c);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*d,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=p,e[11]=0,e[12]=(t+n)*u,e[13]=(o+r)*d,e[14]=a*p,e[15]=1,e},on.lookAt=function(e,t,n,r){var o,a,c,u,d,p,m,_,v,x,w=t[0],T=t[1],S=t[2],I=r[0],A=r[1],R=r[2],k=n[0],P=n[1],O=n[2];return Math.abs(w-k)<kr.EPSILON&&Math.abs(T-P)<kr.EPSILON&&Math.abs(S-O)<kr.EPSILON?SM(e):(m=w-k,_=T-P,v=S-O,o=A*(v*=x=1/Math.hypot(m,_,v))-R*(_*=x),a=R*(m*=x)-I*v,c=I*_-A*m,(x=Math.hypot(o,a,c))?(o*=x=1/x,a*=x,c*=x):(o=0,a=0,c=0),u=_*c-v*a,d=v*o-m*c,p=m*a-_*o,(x=Math.hypot(u,d,p))?(u*=x=1/x,d*=x,p*=x):(u=0,d=0,p=0),e[0]=o,e[1]=u,e[2]=m,e[3]=0,e[4]=a,e[5]=d,e[6]=_,e[7]=0,e[8]=c,e[9]=p,e[10]=v,e[11]=0,e[12]=-(o*w+a*T+c*S),e[13]=-(u*w+d*T+p*S),e[14]=-(m*w+_*T+v*S),e[15]=1,e)},on.targetTo=function(e,t,n,r){var o=t[0],a=t[1],c=t[2],u=r[0],d=r[1],p=r[2],m=o-n[0],_=a-n[1],v=c-n[2],x=m*m+_*_+v*v;x>0&&(m*=x=1/Math.sqrt(x),_*=x,v*=x);var w=d*v-p*_,T=p*m-u*v,S=u*_-d*m;return(x=w*w+T*T+S*S)>0&&(w*=x=1/Math.sqrt(x),T*=x,S*=x),e[0]=w,e[1]=T,e[2]=S,e[3]=0,e[4]=_*S-v*T,e[5]=v*w-m*S,e[6]=m*T-_*w,e[7]=0,e[8]=m,e[9]=_,e[10]=v,e[11]=0,e[12]=o,e[13]=a,e[14]=c,e[15]=1,e},on.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},on.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},on.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e},on.subtract=PM,on.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e},on.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e},on.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},on.equals=function(e,t){var n=e[0],r=e[1],o=e[2],a=e[3],c=e[4],u=e[5],d=e[6],p=e[7],m=e[8],_=e[9],v=e[10],x=e[11],w=e[12],T=e[13],S=e[14],I=e[15],A=t[0],R=t[1],k=t[2],P=t[3],O=t[4],j=t[5],G=t[6],W=t[7],Z=t[8],K=t[9],Q=t[10],at=t[11],X=t[12],ft=t[13],gt=t[14],vt=t[15];return Math.abs(n-A)<=kr.EPSILON*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(r-R)<=kr.EPSILON*Math.max(1,Math.abs(r),Math.abs(R))&&Math.abs(o-k)<=kr.EPSILON*Math.max(1,Math.abs(o),Math.abs(k))&&Math.abs(a-P)<=kr.EPSILON*Math.max(1,Math.abs(a),Math.abs(P))&&Math.abs(c-O)<=kr.EPSILON*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(u-j)<=kr.EPSILON*Math.max(1,Math.abs(u),Math.abs(j))&&Math.abs(d-G)<=kr.EPSILON*Math.max(1,Math.abs(d),Math.abs(G))&&Math.abs(p-W)<=kr.EPSILON*Math.max(1,Math.abs(p),Math.abs(W))&&Math.abs(m-Z)<=kr.EPSILON*Math.max(1,Math.abs(m),Math.abs(Z))&&Math.abs(_-K)<=kr.EPSILON*Math.max(1,Math.abs(_),Math.abs(K))&&Math.abs(v-Q)<=kr.EPSILON*Math.max(1,Math.abs(v),Math.abs(Q))&&Math.abs(x-at)<=kr.EPSILON*Math.max(1,Math.abs(x),Math.abs(at))&&Math.abs(w-X)<=kr.EPSILON*Math.max(1,Math.abs(w),Math.abs(X))&&Math.abs(T-ft)<=kr.EPSILON*Math.max(1,Math.abs(T),Math.abs(ft))&&Math.abs(S-gt)<=kr.EPSILON*Math.max(1,Math.abs(S),Math.abs(gt))&&Math.abs(I-vt)<=kr.EPSILON*Math.max(1,Math.abs(I),Math.abs(vt))},on.sub=on.mul=on.ortho=on.perspective=void 0;var kr=function(e,t){if(e&&e.__esModule)return e;if(e===null||kx(e)!=="object"&&typeof e!="function")return{default:e};var n=TM(void 0);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var c=o?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(di);function TM(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(TM=function(r){return r?n:t})(e)}function SM(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function EM(e,t,n){var r=t[0],o=t[1],a=t[2],c=t[3],u=t[4],d=t[5],p=t[6],m=t[7],_=t[8],v=t[9],x=t[10],w=t[11],T=t[12],S=t[13],I=t[14],A=t[15],R=n[0],k=n[1],P=n[2],O=n[3];return e[0]=R*r+k*u+P*_+O*T,e[1]=R*o+k*d+P*v+O*S,e[2]=R*a+k*p+P*x+O*I,e[3]=R*c+k*m+P*w+O*A,e[4]=(R=n[4])*r+(k=n[5])*u+(P=n[6])*_+(O=n[7])*T,e[5]=R*o+k*d+P*v+O*S,e[6]=R*a+k*p+P*x+O*I,e[7]=R*c+k*m+P*w+O*A,e[8]=(R=n[8])*r+(k=n[9])*u+(P=n[10])*_+(O=n[11])*T,e[9]=R*o+k*d+P*v+O*S,e[10]=R*a+k*p+P*x+O*I,e[11]=R*c+k*m+P*w+O*A,e[12]=(R=n[12])*r+(k=n[13])*u+(P=n[14])*_+(O=n[15])*T,e[13]=R*o+k*d+P*v+O*S,e[14]=R*a+k*p+P*x+O*I,e[15]=R*c+k*m+P*w+O*A,e}function CM(e,t,n){var r=t[0],o=t[1],a=t[2],c=t[3],u=r+r,d=o+o,p=a+a,m=r*u,_=r*d,v=r*p,x=o*d,w=o*p,T=a*p,S=c*u,I=c*d,A=c*p;return e[0]=1-(x+T),e[1]=_+A,e[2]=v-I,e[3]=0,e[4]=_-A,e[5]=1-(m+T),e[6]=w+S,e[7]=0,e[8]=v+I,e[9]=w-S,e[10]=1-(m+x),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function MM(e,t){var n=t[4],r=t[5],o=t[6],a=t[8],c=t[9],u=t[10];return e[0]=Math.hypot(t[0],t[1],t[2]),e[1]=Math.hypot(n,r,o),e[2]=Math.hypot(a,c,u),e}function IM(e,t,n,r,o){var a,c=1/Math.tan(t/2);return e[0]=c/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,o!=null&&o!==1/0?(e[10]=(o+r)*(a=1/(r-o)),e[14]=2*o*r*a):(e[10]=-1,e[14]=-2*r),e}function AM(e,t,n,r,o,a,c){var u=1/(t-n),d=1/(r-o),p=1/(a-c);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*d,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*p,e[11]=0,e[12]=(t+n)*u,e[13]=(o+r)*d,e[14]=(c+a)*p,e[15]=1,e}function PM(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}on.perspective=IM,on.ortho=AM,on.mul=EM,on.sub=PM;var tn={},rn={};function Ox(e){return Ox=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ox(e)}Object.defineProperty(rn,"__esModule",{value:!0}),rn.create=kM,rn.clone=function(e){var t=new za.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},rn.length=OM,rn.fromValues=function(e,t,n){var r=new za.ARRAY_TYPE(3);return r[0]=e,r[1]=t,r[2]=n,r},rn.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},rn.set=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e},rn.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e},rn.subtract=LM,rn.multiply=zM,rn.divide=DM,rn.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},rn.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},rn.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e},rn.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e},rn.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},rn.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},rn.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e},rn.distance=BM,rn.squaredDistance=FM,rn.squaredLength=NM,rn.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},rn.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},rn.normalize=function(e,t){var n=t[0],r=t[1],o=t[2],a=n*n+r*r+o*o;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e},rn.dot=jM,rn.cross=function(e,t,n){var r=t[0],o=t[1],a=t[2],c=n[0],u=n[1],d=n[2];return e[0]=o*d-a*u,e[1]=a*c-r*d,e[2]=r*u-o*c,e},rn.lerp=function(e,t,n,r){var o=t[0],a=t[1],c=t[2];return e[0]=o+r*(n[0]-o),e[1]=a+r*(n[1]-a),e[2]=c+r*(n[2]-c),e},rn.hermite=function(e,t,n,r,o,a){var c=a*a,u=c*(2*a-3)+1,d=c*(a-2)+a,p=c*(a-1),m=c*(3-2*a);return e[0]=t[0]*u+n[0]*d+r[0]*p+o[0]*m,e[1]=t[1]*u+n[1]*d+r[1]*p+o[1]*m,e[2]=t[2]*u+n[2]*d+r[2]*p+o[2]*m,e},rn.bezier=function(e,t,n,r,o,a){var c=1-a,u=c*c,d=a*a,p=u*c,m=3*a*u,_=3*d*c,v=d*a;return e[0]=t[0]*p+n[0]*m+r[0]*_+o[0]*v,e[1]=t[1]*p+n[1]*m+r[1]*_+o[1]*v,e[2]=t[2]*p+n[2]*m+r[2]*_+o[2]*v,e},rn.random=function(e,t){t=t||1;var n=2*za.RANDOM()*Math.PI,r=2*za.RANDOM()-1,o=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*o,e[1]=Math.sin(n)*o,e[2]=r*t,e},rn.transformMat4=function(e,t,n){var r=t[0],o=t[1],a=t[2],c=n[3]*r+n[7]*o+n[11]*a+n[15];return e[0]=(n[0]*r+n[4]*o+n[8]*a+n[12])/(c=c||1),e[1]=(n[1]*r+n[5]*o+n[9]*a+n[13])/c,e[2]=(n[2]*r+n[6]*o+n[10]*a+n[14])/c,e},rn.transformMat3=function(e,t,n){var r=t[0],o=t[1],a=t[2];return e[0]=r*n[0]+o*n[3]+a*n[6],e[1]=r*n[1]+o*n[4]+a*n[7],e[2]=r*n[2]+o*n[5]+a*n[8],e},rn.transformQuat=function(e,t,n){var r=n[0],o=n[1],a=n[2],c=t[0],u=t[1],d=t[2],p=o*d-a*u,m=a*c-r*d,_=r*u-o*c,v=o*_-a*m,x=a*p-r*_,w=r*m-o*p,T=2*n[3];return m*=T,_*=T,x*=2,w*=2,e[0]=c+(p*=T)+(v*=2),e[1]=u+m+x,e[2]=d+_+w,e},rn.rotateX=function(e,t,n,r){var o=[],a=[];return o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],a[0]=o[0],a[1]=o[1]*Math.cos(r)-o[2]*Math.sin(r),a[2]=o[1]*Math.sin(r)+o[2]*Math.cos(r),e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e},rn.rotateY=function(e,t,n,r){var o=[],a=[];return o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],a[0]=o[2]*Math.sin(r)+o[0]*Math.cos(r),a[1]=o[1],a[2]=o[2]*Math.cos(r)-o[0]*Math.sin(r),e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e},rn.rotateZ=function(e,t,n,r){var o=[],a=[];return o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],a[0]=o[0]*Math.cos(r)-o[1]*Math.sin(r),a[1]=o[0]*Math.sin(r)+o[1]*Math.cos(r),a[2]=o[2],e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e},rn.angle=function(e,t){var n=e[0],r=e[1],o=e[2],a=t[0],c=t[1],u=t[2],d=Math.sqrt(n*n+r*r+o*o)*Math.sqrt(a*a+c*c+u*u),p=d&&jM(e,t)/d;return Math.acos(Math.min(Math.max(p,-1),1))},rn.zero=function(e){return e[0]=0,e[1]=0,e[2]=0,e},rn.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},rn.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},rn.equals=function(e,t){var n=e[0],r=e[1],o=e[2],a=t[0],c=t[1],u=t[2];return Math.abs(n-a)<=za.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-c)<=za.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(o-u)<=za.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))},rn.forEach=rn.sqrLen=rn.len=rn.sqrDist=rn.dist=rn.div=rn.mul=rn.sub=void 0;var za=function(e,t){if(e&&e.__esModule)return e;if(e===null||Ox(e)!=="object"&&typeof e!="function")return{default:e};var n=RM(void 0);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var c=o?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(di);function RM(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(RM=function(r){return r?n:t})(e)}function kM(){var e=new za.ARRAY_TYPE(3);return za.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function OM(e){return Math.hypot(e[0],e[1],e[2])}function LM(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function zM(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function DM(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function BM(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2])}function FM(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return n*n+r*r+o*o}function NM(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function jM(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}rn.sub=LM,rn.mul=zM,rn.div=DM,rn.dist=BM,rn.sqrDist=FM,rn.len=OM,rn.sqrLen=NM;var Da,KF=(Da=kM(),function(e,t,n,r,o,a){var c,u;for(t||(t=3),n||(n=0),u=r?Math.min(r*t+n,e.length):e.length,c=n;c<u;c+=t)Da[0]=e[c],Da[1]=e[c+1],Da[2]=e[c+2],o(Da,Da,a),e[c]=Da[0],e[c+1]=Da[1],e[c+2]=Da[2];return e});rn.forEach=KF;var _n={};function Lx(e){return Lx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lx(e)}Object.defineProperty(_n,"__esModule",{value:!0}),_n.create=$M,_n.clone=function(e){var t=new us.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},_n.fromValues=function(e,t,n,r){var o=new us.ARRAY_TYPE(4);return o[0]=e,o[1]=t,o[2]=n,o[3]=r,o},_n.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},_n.set=function(e,t,n,r,o){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e},_n.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},_n.subtract=VM,_n.multiply=GM,_n.divide=WM,_n.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},_n.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},_n.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e},_n.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e},_n.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},_n.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},_n.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e},_n.distance=qM,_n.squaredDistance=HM,_n.length=ZM,_n.squaredLength=XM,_n.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},_n.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},_n.normalize=function(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],c=n*n+r*r+o*o+a*a;return c>0&&(c=1/Math.sqrt(c)),e[0]=n*c,e[1]=r*c,e[2]=o*c,e[3]=a*c,e},_n.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},_n.cross=function(e,t,n,r){var o=n[0]*r[1]-n[1]*r[0],a=n[0]*r[2]-n[2]*r[0],c=n[0]*r[3]-n[3]*r[0],u=n[1]*r[2]-n[2]*r[1],d=n[1]*r[3]-n[3]*r[1],p=n[2]*r[3]-n[3]*r[2],m=t[0],_=t[1],v=t[2],x=t[3];return e[0]=_*p-v*d+x*u,e[1]=-m*p+v*c-x*a,e[2]=m*d-_*c+x*o,e[3]=-m*u+_*a-v*o,e},_n.lerp=function(e,t,n,r){var o=t[0],a=t[1],c=t[2],u=t[3];return e[0]=o+r*(n[0]-o),e[1]=a+r*(n[1]-a),e[2]=c+r*(n[2]-c),e[3]=u+r*(n[3]-u),e},_n.random=function(e,t){var n,r,o,a,c,u;t=t||1;do c=(n=2*us.RANDOM()-1)*n+(r=2*us.RANDOM()-1)*r;while(c>=1);do u=(o=2*us.RANDOM()-1)*o+(a=2*us.RANDOM()-1)*a;while(u>=1);var d=Math.sqrt((1-c)/u);return e[0]=t*n,e[1]=t*r,e[2]=t*o*d,e[3]=t*a*d,e},_n.transformMat4=function(e,t,n){var r=t[0],o=t[1],a=t[2],c=t[3];return e[0]=n[0]*r+n[4]*o+n[8]*a+n[12]*c,e[1]=n[1]*r+n[5]*o+n[9]*a+n[13]*c,e[2]=n[2]*r+n[6]*o+n[10]*a+n[14]*c,e[3]=n[3]*r+n[7]*o+n[11]*a+n[15]*c,e},_n.transformQuat=function(e,t,n){var r=t[0],o=t[1],a=t[2],c=n[0],u=n[1],d=n[2],p=n[3],m=p*r+u*a-d*o,_=p*o+d*r-c*a,v=p*a+c*o-u*r,x=-c*r-u*o-d*a;return e[0]=m*p+x*-c+_*-d-v*-u,e[1]=_*p+x*-u+v*-c-m*-d,e[2]=v*p+x*-d+m*-u-_*-c,e[3]=t[3],e},_n.zero=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},_n.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},_n.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},_n.equals=function(e,t){var n=e[0],r=e[1],o=e[2],a=e[3],c=t[0],u=t[1],d=t[2],p=t[3];return Math.abs(n-c)<=us.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(r-u)<=us.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-d)<=us.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-p)<=us.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))},_n.forEach=_n.sqrLen=_n.len=_n.sqrDist=_n.dist=_n.div=_n.mul=_n.sub=void 0;var us=function(e,t){if(e&&e.__esModule)return e;if(e===null||Lx(e)!=="object"&&typeof e!="function")return{default:e};var n=UM(void 0);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var c=o?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(di);function UM(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(UM=function(r){return r?n:t})(e)}function $M(){var e=new us.ARRAY_TYPE(4);return us.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function VM(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function GM(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function WM(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function qM(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2],t[3]-e[3])}function HM(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2],a=t[3]-e[3];return n*n+r*r+o*o+a*a}function ZM(e){return Math.hypot(e[0],e[1],e[2],e[3])}function XM(e){var t=e[0],n=e[1],r=e[2],o=e[3];return t*t+n*n+r*r+o*o}_n.sub=VM,_n.mul=GM,_n.div=WM,_n.dist=qM,_n.sqrDist=HM,_n.len=ZM,_n.sqrLen=XM;var YF=function(){var e=$M();return function(t,n,r,o,a,c){var u,d;for(n||(n=4),r||(r=0),d=o?Math.min(o*n+r,t.length):t.length,u=r;u<d;u+=n)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],e[3]=t[u+3],a(e,e,c),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2],t[u+3]=e[3];return t}}();function zx(e){return zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zx(e)}_n.forEach=YF,Object.defineProperty(tn,"__esModule",{value:!0}),tn.create=Dx,tn.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},tn.setAxisAngle=YM,tn.getAxisAngle=function(e,t){var n=2*Math.acos(t[3]),r=Math.sin(n/2);return r>Pc.EPSILON?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n},tn.getAngle=function(e,t){var n=rI(e,t);return Math.acos(2*n*n-1)},tn.multiply=QM,tn.rotateX=function(e,t,n){n*=.5;var r=t[0],o=t[1],a=t[2],c=t[3],u=Math.sin(n),d=Math.cos(n);return e[0]=r*d+c*u,e[1]=o*d+a*u,e[2]=a*d-o*u,e[3]=c*d-r*u,e},tn.rotateY=function(e,t,n){n*=.5;var r=t[0],o=t[1],a=t[2],c=t[3],u=Math.sin(n),d=Math.cos(n);return e[0]=r*d-a*u,e[1]=o*d+c*u,e[2]=a*d+r*u,e[3]=c*d-o*u,e},tn.rotateZ=function(e,t,n){n*=.5;var r=t[0],o=t[1],a=t[2],c=t[3],u=Math.sin(n),d=Math.cos(n);return e[0]=r*d+o*u,e[1]=o*d-r*u,e[2]=a*d+c*u,e[3]=c*d-a*u,e},tn.calculateW=function(e,t){var n=t[0],r=t[1],o=t[2];return e[0]=n,e[1]=r,e[2]=o,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-o*o)),e},tn.exp=JM,tn.ln=tI,tn.pow=function(e,t,n){return tI(e,t),nI(e,e,n),JM(e,e),e},tn.slerp=km,tn.random=function(e){var t=Pc.RANDOM(),n=Pc.RANDOM(),r=Pc.RANDOM(),o=Math.sqrt(1-t),a=Math.sqrt(t);return e[0]=o*Math.sin(2*Math.PI*n),e[1]=o*Math.cos(2*Math.PI*n),e[2]=a*Math.sin(2*Math.PI*r),e[3]=a*Math.cos(2*Math.PI*r),e},tn.invert=function(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],c=n*n+r*r+o*o+a*a,u=c?1/c:0;return e[0]=-n*u,e[1]=-r*u,e[2]=-o*u,e[3]=a*u,e},tn.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},tn.fromMat3=eI,tn.fromEuler=function(e,t,n,r){var o=.5*Math.PI/180;t*=o,n*=o,r*=o;var a=Math.sin(t),c=Math.cos(t),u=Math.sin(n),d=Math.cos(n),p=Math.sin(r),m=Math.cos(r);return e[0]=a*d*m-c*u*p,e[1]=c*u*m+a*d*p,e[2]=c*d*p-a*u*m,e[3]=c*d*m+a*u*p,e},tn.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},tn.setAxes=tn.sqlerp=tn.rotationTo=tn.equals=tn.exactEquals=tn.normalize=tn.sqrLen=tn.squaredLength=tn.len=tn.length=tn.lerp=tn.dot=tn.scale=tn.mul=tn.add=tn.set=tn.copy=tn.fromValues=tn.clone=void 0;var Pc=Rm(di),QF=Rm(Kn),Ba=Rm(rn),Wo=Rm(_n);function KM(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(KM=function(r){return r?n:t})(e)}function Rm(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||zx(e)!=="object"&&typeof e!="function")return{default:e};var n=KM(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var c=o?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}function Dx(){var e=new Pc.ARRAY_TYPE(4);return Pc.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function YM(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function QM(e,t,n){var r=t[0],o=t[1],a=t[2],c=t[3],u=n[0],d=n[1],p=n[2],m=n[3];return e[0]=r*m+c*u+o*p-a*d,e[1]=o*m+c*d+a*u-r*p,e[2]=a*m+c*p+r*d-o*u,e[3]=c*m-r*u-o*d-a*p,e}function JM(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],c=Math.sqrt(n*n+r*r+o*o),u=Math.exp(a),d=c>0?u*Math.sin(c)/c:0;return e[0]=n*d,e[1]=r*d,e[2]=o*d,e[3]=u*Math.cos(c),e}function tI(e,t){var n=t[0],r=t[1],o=t[2],a=t[3],c=Math.sqrt(n*n+r*r+o*o),u=c>0?Math.atan2(c,a)/c:0;return e[0]=n*u,e[1]=r*u,e[2]=o*u,e[3]=.5*Math.log(n*n+r*r+o*o+a*a),e}function km(e,t,n,r){var o,a,c,u,d,p=t[0],m=t[1],_=t[2],v=t[3],x=n[0],w=n[1],T=n[2],S=n[3];return(a=p*x+m*w+_*T+v*S)<0&&(a=-a,x=-x,w=-w,T=-T,S=-S),1-a>Pc.EPSILON?(o=Math.acos(a),c=Math.sin(o),u=Math.sin((1-r)*o)/c,d=Math.sin(r*o)/c):(u=1-r,d=r),e[0]=u*p+d*x,e[1]=u*m+d*w,e[2]=u*_+d*T,e[3]=u*v+d*S,e}function eI(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,e[0]=(t[5]-t[7])*(n=.5/n),e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var o=0;t[4]>t[0]&&(o=1),t[8]>t[3*o+o]&&(o=2);var a=(o+1)%3,c=(o+2)%3;n=Math.sqrt(t[3*o+o]-t[3*a+a]-t[3*c+c]+1),e[o]=.5*n,e[3]=(t[3*a+c]-t[3*c+a])*(n=.5/n),e[a]=(t[3*a+o]+t[3*o+a])*n,e[c]=(t[3*c+o]+t[3*o+c])*n}return e}tn.clone=Wo.clone,tn.fromValues=Wo.fromValues,tn.copy=Wo.copy,tn.set=Wo.set,tn.add=Wo.add,tn.mul=QM;var nI=Wo.scale;tn.scale=nI;var rI=Wo.dot;tn.dot=rI,tn.lerp=Wo.lerp;var iI=Wo.length;tn.length=iI,tn.len=iI;var oI=Wo.squaredLength;tn.squaredLength=oI,tn.sqrLen=oI;var Bx=Wo.normalize;tn.normalize=Bx,tn.exactEquals=Wo.exactEquals,tn.equals=Wo.equals;var Os,sI,aI,JF=(Os=Ba.create(),sI=Ba.fromValues(1,0,0),aI=Ba.fromValues(0,1,0),function(e,t,n){var r=Ba.dot(t,n);return r<-.999999?(Ba.cross(Os,sI,t),Ba.len(Os)<1e-6&&Ba.cross(Os,aI,t),Ba.normalize(Os,Os),YM(e,Os,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(Ba.cross(Os,t,n),e[0]=Os[0],e[1]=Os[1],e[2]=Os[2],e[3]=1+r,Bx(e,e))});tn.rotationTo=JF;var Fx,Nx,tN=(Fx=Dx(),Nx=Dx(),function(e,t,n,r,o,a){return km(Fx,t,o,a),km(Nx,n,r,a),km(e,Fx,Nx,2*a*(1-a)),e});tn.sqlerp=tN;var Ls,eN=(Ls=QF.create(),function(e,t,n,r){return Ls[0]=n[0],Ls[3]=n[1],Ls[6]=n[2],Ls[1]=r[0],Ls[4]=r[1],Ls[7]=r[2],Ls[2]=-t[0],Ls[5]=-t[1],Ls[8]=-t[2],Bx(e,eI(e,Ls))});tn.setAxes=eN;var bn={};function jx(e){return jx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jx(e)}Object.defineProperty(bn,"__esModule",{value:!0}),bn.create=function(){var e=new uo.ARRAY_TYPE(8);return uo.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e},bn.clone=function(e){var t=new uo.ARRAY_TYPE(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t},bn.fromValues=function(e,t,n,r,o,a,c,u){var d=new uo.ARRAY_TYPE(8);return d[0]=e,d[1]=t,d[2]=n,d[3]=r,d[4]=o,d[5]=a,d[6]=c,d[7]=u,d},bn.fromRotationTranslationValues=function(e,t,n,r,o,a,c){var u=new uo.ARRAY_TYPE(8);u[0]=e,u[1]=t,u[2]=n,u[3]=r;var d=.5*o,p=.5*a,m=.5*c;return u[4]=d*r+p*n-m*t,u[5]=p*r+m*e-d*n,u[6]=m*r+d*t-p*e,u[7]=-d*e-p*t-m*n,u},bn.fromRotationTranslation=uI,bn.fromTranslation=function(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e},bn.fromRotation=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},bn.fromMat4=function(e,t){var n=Fa.create();lI.getRotation(n,t);var r=new uo.ARRAY_TYPE(3);return lI.getTranslation(r,t),uI(e,n,r),e},bn.copy=hI,bn.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},bn.set=function(e,t,n,r,o,a,c,u,d){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e[4]=a,e[5]=c,e[6]=u,e[7]=d,e},bn.getDual=function(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e},bn.setDual=function(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e},bn.getTranslation=function(e,t){var n=t[4],r=t[5],o=t[6],a=t[7],c=-t[0],u=-t[1],d=-t[2],p=t[3];return e[0]=2*(n*p+a*c+r*d-o*u),e[1]=2*(r*p+a*u+o*c-n*d),e[2]=2*(o*p+a*d+n*u-r*c),e},bn.translate=function(e,t,n){var r=t[0],o=t[1],a=t[2],c=t[3],u=.5*n[0],d=.5*n[1],p=.5*n[2],m=t[4],_=t[5],v=t[6],x=t[7];return e[0]=r,e[1]=o,e[2]=a,e[3]=c,e[4]=c*u+o*p-a*d+m,e[5]=c*d+a*u-r*p+_,e[6]=c*p+r*d-o*u+v,e[7]=-r*u-o*d-a*p+x,e},bn.rotateX=function(e,t,n){var r=-t[0],o=-t[1],a=-t[2],c=t[3],u=t[4],d=t[5],p=t[6],m=t[7],_=u*c+m*r+d*a-p*o,v=d*c+m*o+p*r-u*a,x=p*c+m*a+u*o-d*r,w=m*c-u*r-d*o-p*a;return Fa.rotateX(e,t,n),e[4]=_*(c=e[3])+w*(r=e[0])+v*(a=e[2])-x*(o=e[1]),e[5]=v*c+w*o+x*r-_*a,e[6]=x*c+w*a+_*o-v*r,e[7]=w*c-_*r-v*o-x*a,e},bn.rotateY=function(e,t,n){var r=-t[0],o=-t[1],a=-t[2],c=t[3],u=t[4],d=t[5],p=t[6],m=t[7],_=u*c+m*r+d*a-p*o,v=d*c+m*o+p*r-u*a,x=p*c+m*a+u*o-d*r,w=m*c-u*r-d*o-p*a;return Fa.rotateY(e,t,n),e[4]=_*(c=e[3])+w*(r=e[0])+v*(a=e[2])-x*(o=e[1]),e[5]=v*c+w*o+x*r-_*a,e[6]=x*c+w*a+_*o-v*r,e[7]=w*c-_*r-v*o-x*a,e},bn.rotateZ=function(e,t,n){var r=-t[0],o=-t[1],a=-t[2],c=t[3],u=t[4],d=t[5],p=t[6],m=t[7],_=u*c+m*r+d*a-p*o,v=d*c+m*o+p*r-u*a,x=p*c+m*a+u*o-d*r,w=m*c-u*r-d*o-p*a;return Fa.rotateZ(e,t,n),e[4]=_*(c=e[3])+w*(r=e[0])+v*(a=e[2])-x*(o=e[1]),e[5]=v*c+w*o+x*r-_*a,e[6]=x*c+w*a+_*o-v*r,e[7]=w*c-_*r-v*o-x*a,e},bn.rotateByQuatAppend=function(e,t,n){var r=n[0],o=n[1],a=n[2],c=n[3],u=t[0],d=t[1],p=t[2],m=t[3];return e[0]=u*c+m*r+d*a-p*o,e[1]=d*c+m*o+p*r-u*a,e[2]=p*c+m*a+u*o-d*r,e[3]=m*c-u*r-d*o-p*a,e[4]=(u=t[4])*c+(m=t[7])*r+(d=t[5])*a-(p=t[6])*o,e[5]=d*c+m*o+p*r-u*a,e[6]=p*c+m*a+u*o-d*r,e[7]=m*c-u*r-d*o-p*a,e},bn.rotateByQuatPrepend=function(e,t,n){var r=t[0],o=t[1],a=t[2],c=t[3],u=n[0],d=n[1],p=n[2],m=n[3];return e[0]=r*m+c*u+o*p-a*d,e[1]=o*m+c*d+a*u-r*p,e[2]=a*m+c*p+r*d-o*u,e[3]=c*m-r*u-o*d-a*p,e[4]=r*(m=n[7])+c*(u=n[4])+o*(p=n[6])-a*(d=n[5]),e[5]=o*m+c*d+a*u-r*p,e[6]=a*m+c*p+r*d-o*u,e[7]=c*m-r*u-o*d-a*p,e},bn.rotateAroundAxis=function(e,t,n,r){if(Math.abs(r)<uo.EPSILON)return hI(e,t);var o=Math.hypot(n[0],n[1],n[2]);r*=.5;var a=Math.sin(r),c=a*n[0]/o,u=a*n[1]/o,d=a*n[2]/o,p=Math.cos(r),m=t[0],_=t[1],v=t[2],x=t[3];e[0]=m*p+x*c+_*d-v*u,e[1]=_*p+x*u+v*c-m*d,e[2]=v*p+x*d+m*u-_*c,e[3]=x*p-m*c-_*u-v*d;var w=t[4],T=t[5],S=t[6],I=t[7];return e[4]=w*p+I*c+T*d-S*u,e[5]=T*p+I*u+S*c-w*d,e[6]=S*p+I*d+w*u-T*c,e[7]=I*p-w*c-T*u-S*d,e},bn.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e},bn.multiply=dI,bn.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e},bn.lerp=function(e,t,n,r){var o=1-r;return fI(t,n)<0&&(r=-r),e[0]=t[0]*o+n[0]*r,e[1]=t[1]*o+n[1]*r,e[2]=t[2]*o+n[2]*r,e[3]=t[3]*o+n[3]*r,e[4]=t[4]*o+n[4]*r,e[5]=t[5]*o+n[5]*r,e[6]=t[6]*o+n[6]*r,e[7]=t[7]*o+n[7]*r,e},bn.invert=function(e,t){var n=Om(t);return e[0]=-t[0]/n,e[1]=-t[1]/n,e[2]=-t[2]/n,e[3]=t[3]/n,e[4]=-t[4]/n,e[5]=-t[5]/n,e[6]=-t[6]/n,e[7]=t[7]/n,e},bn.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e},bn.normalize=function(e,t){var n=Om(t);if(n>0){n=Math.sqrt(n);var r=t[0]/n,o=t[1]/n,a=t[2]/n,c=t[3]/n,u=t[4],d=t[5],p=t[6],m=t[7],_=r*u+o*d+a*p+c*m;e[0]=r,e[1]=o,e[2]=a,e[3]=c,e[4]=(u-r*_)/n,e[5]=(d-o*_)/n,e[6]=(p-a*_)/n,e[7]=(m-c*_)/n}return e},bn.str=function(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"},bn.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]},bn.equals=function(e,t){var n=e[0],r=e[1],o=e[2],a=e[3],c=e[4],u=e[5],d=e[6],p=e[7],m=t[0],_=t[1],v=t[2],x=t[3],w=t[4],T=t[5],S=t[6],I=t[7];return Math.abs(n-m)<=uo.EPSILON*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(r-_)<=uo.EPSILON*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(o-v)<=uo.EPSILON*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(a-x)<=uo.EPSILON*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(c-w)<=uo.EPSILON*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(u-T)<=uo.EPSILON*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(d-S)<=uo.EPSILON*Math.max(1,Math.abs(d),Math.abs(S))&&Math.abs(p-I)<=uo.EPSILON*Math.max(1,Math.abs(p),Math.abs(I))},bn.sqrLen=bn.squaredLength=bn.len=bn.length=bn.dot=bn.mul=bn.setReal=bn.getReal=void 0;var uo=Ux(di),Fa=Ux(tn),lI=Ux(on);function cI(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(cI=function(r){return r?n:t})(e)}function Ux(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||jx(e)!=="object"&&typeof e!="function")return{default:e};var n=cI(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var c=o?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}function uI(e,t,n){var r=.5*n[0],o=.5*n[1],a=.5*n[2],c=t[0],u=t[1],d=t[2],p=t[3];return e[0]=c,e[1]=u,e[2]=d,e[3]=p,e[4]=r*p+o*d-a*u,e[5]=o*p+a*c-r*d,e[6]=a*p+r*u-o*c,e[7]=-r*c-o*u-a*d,e}function hI(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function dI(e,t,n){var r=t[0],o=t[1],a=t[2],c=t[3],u=n[4],d=n[5],p=n[6],m=n[7],_=t[4],v=t[5],x=t[6],w=t[7],T=n[0],S=n[1],I=n[2],A=n[3];return e[0]=r*A+c*T+o*I-a*S,e[1]=o*A+c*S+a*T-r*I,e[2]=a*A+c*I+r*S-o*T,e[3]=c*A-r*T-o*S-a*I,e[4]=r*m+c*u+o*p-a*d+_*A+w*T+v*I-x*S,e[5]=o*m+c*d+a*u-r*p+v*A+w*S+x*T-_*I,e[6]=a*m+c*p+r*d-o*u+x*A+w*I+_*S-v*T,e[7]=c*m-r*u-o*d-a*p+w*A-_*T-v*S-x*I,e}bn.getReal=Fa.copy,bn.setReal=Fa.copy,bn.mul=dI;var fI=Fa.dot;bn.dot=fI;var pI=Fa.length;bn.length=pI,bn.len=pI;var Om=Fa.squaredLength;bn.squaredLength=Om,bn.sqrLen=Om;var un={};function $x(e){return $x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$x(e)}Object.defineProperty(un,"__esModule",{value:!0}),un.create=gI,un.clone=function(e){var t=new Rc.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},un.fromValues=function(e,t){var n=new Rc.ARRAY_TYPE(2);return n[0]=e,n[1]=t,n},un.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},un.set=function(e,t,n){return e[0]=t,e[1]=n,e},un.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},un.subtract=_I,un.multiply=yI,un.divide=vI,un.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},un.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},un.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e},un.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e},un.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},un.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},un.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e},un.distance=xI,un.squaredDistance=bI,un.length=wI,un.squaredLength=TI,un.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},un.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},un.normalize=function(e,t){var n=t[0],r=t[1],o=n*n+r*r;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e},un.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},un.cross=function(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e},un.lerp=function(e,t,n,r){var o=t[0],a=t[1];return e[0]=o+r*(n[0]-o),e[1]=a+r*(n[1]-a),e},un.random=function(e,t){t=t||1;var n=2*Rc.RANDOM()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e},un.transformMat2=function(e,t,n){var r=t[0],o=t[1];return e[0]=n[0]*r+n[2]*o,e[1]=n[1]*r+n[3]*o,e},un.transformMat2d=function(e,t,n){var r=t[0],o=t[1];return e[0]=n[0]*r+n[2]*o+n[4],e[1]=n[1]*r+n[3]*o+n[5],e},un.transformMat3=function(e,t,n){var r=t[0],o=t[1];return e[0]=n[0]*r+n[3]*o+n[6],e[1]=n[1]*r+n[4]*o+n[7],e},un.transformMat4=function(e,t,n){var r=t[0],o=t[1];return e[0]=n[0]*r+n[4]*o+n[12],e[1]=n[1]*r+n[5]*o+n[13],e},un.rotate=function(e,t,n,r){var o=t[0]-n[0],a=t[1]-n[1],c=Math.sin(r),u=Math.cos(r);return e[0]=o*u-a*c+n[0],e[1]=o*c+a*u+n[1],e},un.angle=function(e,t){var n=e[0],r=e[1],o=t[0],a=t[1],c=Math.sqrt(n*n+r*r)*Math.sqrt(o*o+a*a);return Math.acos(Math.min(Math.max(c&&(n*o+r*a)/c,-1),1))},un.zero=function(e){return e[0]=0,e[1]=0,e},un.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},un.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},un.equals=function(e,t){var n=e[0],r=e[1],o=t[0],a=t[1];return Math.abs(n-o)<=Rc.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=Rc.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))},un.forEach=un.sqrLen=un.sqrDist=un.dist=un.div=un.mul=un.sub=un.len=void 0;var Rc=function(e,t){if(e&&e.__esModule)return e;if(e===null||$x(e)!=="object"&&typeof e!="function")return{default:e};var n=mI(void 0);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var c=o?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(di);function mI(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(mI=function(r){return r?n:t})(e)}function gI(){var e=new Rc.ARRAY_TYPE(2);return Rc.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0),e}function _I(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function yI(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function vI(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function xI(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1])}function bI(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function wI(e){return Math.hypot(e[0],e[1])}function TI(e){var t=e[0],n=e[1];return t*t+n*n}un.len=wI,un.sub=_I,un.mul=yI,un.div=vI,un.dist=xI,un.sqrDist=bI,un.sqrLen=TI;var nN=function(){var e=gI();return function(t,n,r,o,a,c){var u,d;for(n||(n=2),r||(r=0),d=o?Math.min(o*n+r,t.length):t.length,u=r;u<d;u+=n)e[0]=t[u],e[1]=t[u+1],a(e,e,c),t[u]=e[0],t[u+1]=e[1];return t}}();function Vx(e){return Vx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vx(e)}un.forEach=nN,Object.defineProperty(hi,"__esModule",{value:!0});var Wn=hi.vec4=ot=hi.vec3=hi.vec2=hi.quat2=Ri=hi.quat=wt=hi.mat4=ho=hi.mat3=hi.mat2d=Hu=hi.mat2=hi.glMatrix=void 0,rN=ra(di);hi.glMatrix=rN;var iN=ra(mr),Hu=hi.mat2=iN,oN=ra(vr);hi.mat2d=oN;var sN=ra(Kn),ho=hi.mat3=sN,aN=ra(on),wt=hi.mat4=aN,lN=ra(tn),Ri=hi.quat=lN,cN=ra(bn);hi.quat2=cN;var uN=ra(un);hi.vec2=uN;var hN=ra(rn),ot=hi.vec3=hN,dN=ra(_n);function SI(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(SI=function(r){return r?n:t})(e)}function ra(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||Vx(e)!=="object"&&typeof e!="function")return{default:e};var n=SI(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var c=o?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}Wn=hi.vec4=dN;const fN=Dn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Lm}=fN,EI=Dn([{name:"a_pos_3",components:3,type:"Int16"}]);var bl=Dn([{name:"a_pos",type:"Int16",components:2}]),CI={};(function(e,t){(function(n){function r(a,c,u){var d=o(256*a,256*(c=Math.pow(2,u)-c-1),u),p=o(256*(a+1),256*(c+1),u);return d[0]+","+d[1]+","+p[0]+","+p[1]}function o(a,c,u){var d=2*Math.PI*6378137/256/Math.pow(2,u);return[a*d-2*Math.PI*6378137/2,c*d-2*Math.PI*6378137/2]}n.getURL=function(a,c,u,d,p,m){return m=m||{},a+"?"+["bbox="+r(u,d,p),"format="+(m.format||"image/png"),"service="+(m.service||"WMS"),"version="+(m.version||"1.1.1"),"request="+(m.request||"GetMap"),"srs="+(m.srs||"EPSG:3857"),"width="+(m.width||256),"height="+(m.height||256),"layers="+c].join("&")},n.getTileBBox=r,n.getMercCoords=o,Object.defineProperty(n,"__esModule",{value:!0})})(t)})(0,CI);var pN=CI;class hs{constructor(t,n,r){this.z=t,this.x=n,this.y=r,this.key=Qd(0,t,t,n,r)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,n){const r=pN.getTileBBox(this.x,this.y,this.z),o=function(a,c,u){let d,p="";for(let m=a;m>0;m--)d=1<<m-1,p+=(c&d?1:0)+(u&d?2:0);return p}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",o).replace("{bbox-epsg-3857}",r)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Gx{constructor(t,n){this.wrap=t,this.canonical=n,this.key=Qd(t,n.z,n.z,n.x,n.y)}}class Pn{constructor(t,n,r,o,a){this.overscaledZ=t,this.wrap=n,this.canonical=new hs(r,+o,+a),this.key=n===0&&t===r?this.canonical.key:Qd(n,t,r,o,a)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const n=this.canonical.z-t;return t>this.canonical.z?new Pn(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Pn(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(t,n=!0){if(this.overscaledZ===t&&n)return this.key;if(t>this.canonical.z)return Qd(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y);{const r=this.canonical.z-t;return Qd(this.wrap*+n,t,t,this.canonical.x>>r,this.canonical.y>>r)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const n=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n}children(t){if(this.overscaledZ>=t)return[new Pn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,r=2*this.canonical.x,o=2*this.canonical.y;return[new Pn(n,this.wrap,n,r,o),new Pn(n,this.wrap,n,r+1,o),new Pn(n,this.wrap,n,r,o+1),new Pn(n,this.wrap,n,r+1,o+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Pn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Pn(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Gx(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Qd(e,t,n,r,o){const a=1<<Math.min(n,22);let c=a*(o%a)+r%a;return e&&n<22&&(c+=a*a*((e<0?-2*e-1:2*e)%(1<<2*(22-n)))),16*(32*c+n)+(t-n)}const MI=[e=>{let t=e.canonical.x-1,n=e.wrap;return t<0&&(t=(1<<e.canonical.z)-1,n--),new Pn(e.overscaledZ,n,e.canonical.z,t,e.canonical.y)},e=>{let t=e.canonical.x+1,n=e.wrap;return t===1<<e.canonical.z&&(t=0,n++),new Pn(e.overscaledZ,n,e.canonical.z,t,e.canonical.y)},e=>new Pn(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,(e.canonical.y===0?1<<e.canonical.z:e.canonical.y)-1),e=>new Pn(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y===(1<<e.canonical.z)-1?0:e.canonical.y+1)];Te(hs,"CanonicalTileID"),Te(Pn,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});class zm{constructor(t,n){this.pos=t,this.dir=n}intersectsPlane(t,n,r){const o=ot.dot(n,this.dir);if(Math.abs(o)<1e-6)return!1;const a=((t[0]-this.pos[0])*n[0]+(t[1]-this.pos[1])*n[1]+(t[2]-this.pos[2])*n[2])/o;return r[0]=this.pos[0]+this.dir[0]*a,r[1]=this.pos[1]+this.dir[1]*a,r[2]=this.pos[2]+this.dir[2]*a,!0}closestPointOnSphere(t,n,r){if(ot.equals(this.pos,t)||n===0)return r[0]=r[1]=r[2]=0,!1;const[o,a,c]=this.dir,u=this.pos[0]-t[0],d=this.pos[1]-t[1],p=this.pos[2]-t[2],m=o*o+a*a+c*c,_=2*(u*o+d*a+p*c),v=_*_-4*m*(u*u+d*d+p*p-n*n);if(v<0){const x=Math.max(-_/2,0),w=u+o*x,T=d+a*x,S=p+c*x,I=Math.hypot(w,T,S);return r[0]=w*n/I,r[1]=T*n/I,r[2]=S*n/I,!1}{const x=(-_-Math.sqrt(v))/(2*m);if(x<0){const w=Math.hypot(u,d,p);return r[0]=u*n/w,r[1]=d*n/w,r[2]=p*n/w,!1}return r[0]=u+o*x,r[1]=d+a*x,r[2]=p+c*x,!0}}}class Wx{constructor(t,n,r,o,a){this.TL=t,this.TR=n,this.BR=r,this.BL=o,this.horizon=a}static fromInvProjectionMatrix(t,n,r){const o=[-1,1,1],a=[1,1,1],c=[1,-1,1],u=[-1,-1,1],d=ot.transformMat4(o,o,t),p=ot.transformMat4(a,a,t),m=ot.transformMat4(c,c,t),_=ot.transformMat4(u,u,t);return new Wx(d,p,m,_,n/r)}}function Jd(e,t,n){let r=1/0,o=-1/0;const a=[];for(const c of e){ot.sub(a,c,t);const u=ot.dot(a,n);r=Math.min(r,u),o=Math.max(o,u)}return[r,o]}function II(e,t){let n=!0;for(let r=0;r<e.planes.length;r++){const o=e.planes[r];let a=0;for(let c=0;c<t.length;c++)a+=ot.dot(o,t[c])+o[3]>=0;if(a===0)return 0;a!==t.length&&(n=!1)}return n?2:1}function AI(e,t){for(const n of e.projections){const r=Jd(t,e.points[0],n.axis);if(n.projection[1]<r[0]||n.projection[0]>r[1])return 0}return 1}function PI(e,t){let n=0;const r=[0,0,0,0];for(let o=0;o<e.length;o++)r[0]=e[o][0],r[1]=e[o][1],r[2]=e[o][2],r[3]=1,Wn.dot(r,t)>=0&&n++;return n}class Na{constructor(t,n){this.points=t||new Array(8).fill([0,0,0]),this.planes=n||new Array(6).fill([0,0,0,0]),this.bounds=nr.fromPoints(this.points),this.projections=[],this.frustumEdges=[ot.sub([],this.points[2],this.points[3]),ot.sub([],this.points[0],this.points[3]),ot.sub([],this.points[4],this.points[0]),ot.sub([],this.points[5],this.points[1]),ot.sub([],this.points[6],this.points[2]),ot.sub([],this.points[7],this.points[3])];for(const r of this.frustumEdges){const o=[0,-r[2],r[1]],a=[r[2],0,-r[0]];this.projections.push({axis:o,projection:Jd(this.points,this.points[0],o)}),this.projections.push({axis:a,projection:Jd(this.points,this.points[0],a)})}}static fromInvProjectionMatrix(t,n,r,o){const a=Math.pow(2,r),c=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(p=>{const m=Wn.transformMat4([],p,t),_=1/m[3]/n*a;return Wn.mul(m,m,[_,_,o?1/m[3]:_,_])}),u=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(p=>{const m=ot.sub([],c[p[0]],c[p[1]]),_=ot.sub([],c[p[2]],c[p[1]]),v=ot.normalize([],ot.cross([],m,_)),x=-ot.dot(v,c[p[1]]);return v.concat(x)}),d=[];for(let p=0;p<c.length;p++)d.push([c[p][0],c[p][1],c[p][2]]);return new Na(d,u)}intersectsPrecise(t,n,r){for(let o=0;o<n.length;o++)if(!PI(t,n[o]))return 0;for(let o=0;o<this.planes.length;o++)if(!PI(t,this.planes[o]))return 0;for(const o of r)for(const a of this.frustumEdges){const c=ot.cross([],o,a),u=ot.length(c);if(u===0)continue;ot.scale(c,c,1/u);const d=Jd(this.points,this.points[0],c),p=Jd(t,this.points[0],c);if(d[0]>p[1]||p[0]>d[1])return 0}return 1}}class nr{static fromPoints(t){const n=[1/0,1/0,1/0],r=[-1/0,-1/0,-1/0];for(const o of t)ot.min(n,n,o),ot.max(r,r,o);return new nr(n,r)}static fromTileIdAndHeight(t,n,r){const o=1<<t.canonical.z,a=t.canonical.x,c=t.canonical.y;return new nr([a/o,c/o,n],[(a+1)/o,(c+1)/o,r])}static applyTransform(t,n){const r=t.getCorners();for(let o=0;o<r.length;++o)ot.transformMat4(r[o],r[o],n);return nr.fromPoints(r)}static projectAabbCorners(t,n){const r=t.getCorners();for(let o=0;o<r.length;++o)ot.transformMat4(r[o],r[o],n);return r}constructor(t,n){this.min=t,this.max=n,this.center=ot.scale([],ot.add([],this.min,this.max),.5)}quadrant(t){const n=[t%2==0,t<2],r=ot.clone(this.min),o=ot.clone(this.max);for(let a=0;a<n.length;a++)r[a]=n[a]?this.min[a]:this.center[a],o[a]=n[a]?this.center[a]:this.max[a];return o[2]=this.max[2],new nr(r,o)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,n=this.max;return[[t[0],t[1],t[2]],[n[0],t[1],t[2]],[n[0],n[1],t[2]],[t[0],n[1],t[2]],[t[0],t[1],n[2]],[n[0],t[1],n[2]],[n[0],n[1],n[2]],[t[0],n[1],n[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?II(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?II(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,n){return n||this.intersects(t)?AI(t,this.getCorners()):0}intersectsPreciseFlat(t,n){return n||this.intersectsFlat(t)?AI(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let n=0;n<3;++n)if(this.min[n]>t.max[n]||t.min[n]>this.max[n])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let n=0;n<3;n++)this.min[n]=Math.min(this.min[n],t.min[n]),this.max[n]=Math.max(this.max[n],t.max[n])}encapsulatePoint(t){for(let n=0;n<3;n++)this.min[n]=Math.min(this.min[n],t[n]),this.max[n]=Math.max(this.max[n],t[n])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}Te(nr,"Aabb");const tf=5,wl=6,Yi=Rt/Math.PI/2,mN=16383,Zu=64,qx=[Zu,32,16],ds=-Yi,fs=Yi,gN=[new nr([ds,ds,ds],[fs,fs,fs]),new nr([ds,ds,ds],[0,0,fs]),new nr([0,ds,ds],[fs,0,fs]),new nr([ds,0,ds],[0,fs,fs]),new nr([0,0,ds],[fs,fs,fs])];function Dm(e){return e*Yi/Ku}function RI(e,t,n,r=!0){const o=ot.scale([],e._camera.position,e.worldSize),a=[t,n,1,1];Wn.transformMat4(a,a,e.pixelMatrixInverse),Wn.scale(a,a,1/a[3]);const c=ot.sub([],a,o),u=ot.normalize([],c),d=e.globeMatrix,p=[d[12],d[13],d[14]],m=ot.sub([],p,o),_=ot.length(m),v=ot.normalize([],m),x=e.worldSize/(2*Math.PI),w=ot.dot(v,u),T=Math.asin(x/_);if(T<Math.acos(w)){if(!r)return null;const K=[],Q=[];ot.scale(K,u,_/w),ot.normalize(Q,ot.sub(Q,K,m)),ot.normalize(u,ot.add(u,m,ot.scale(u,Q,Math.tan(T)*_)))}const S=[];new zm(o,u).closestPointOnSphere(p,x,S);const I=ot.normalize([],zn(d,0)),A=ot.normalize([],zn(d,1)),R=ot.normalize([],zn(d,2)),k=ot.dot(I,S),P=ot.dot(A,S),O=ot.dot(R,S),j=Tt(Math.asin(-P/x));let G=Tt(Math.atan2(k,O));G=e.center.lng+function(K,Q){const at=(Q-K+180)%360-180;return at<-180?at+360:at}(e.center.lng,G);const W=Qr(G),Z=jt(oi(j),0,1);return new xn(W,Z)}class _N{constructor(t,n,r){this.a=ot.sub([],t,r),this.b=ot.sub([],n,r),this.center=r;const o=ot.normalize([],this.a),a=ot.normalize([],this.b);this.angle=Math.acos(ot.dot(o,a))}}function Hx(e,t){if(e.angle===0)return null;let n;return n=e.a[t]===0?1/e.angle*.5*Math.PI:1/e.angle*Math.atan(e.b[t]/e.a[t]/Math.sin(e.angle)-1/Math.tan(e.angle)),n<0||n>1?null:function(r,o,a,c){const u=Math.sin(a);return r*(Math.sin((1-c)*a)/u)+o*(Math.sin(c*a)/u)}(e.a[t],e.b[t],e.angle,jt(n,0,1))+e.center[t]}function qo(e){if(e.z<=1)return gN[e.z+2*e.y+e.x];const t=Xx(Bm(e));return nr.fromPoints(t)}function ja(e,t,n){return ot.scale(e,e,1-n),ot.scaleAndAdd(e,e,t,n)}function kI(e,t){const n=fi(t.zoom);if(n===0)return qo(e);const r=Bm(e),o=Xx(r),a=Qr(r.getWest())*t.worldSize,c=Qr(r.getEast())*t.worldSize,u=oi(r.getNorth())*t.worldSize,d=oi(r.getSouth())*t.worldSize,p=[a,u,0],m=[c,u,0],_=[a,d,0],v=[c,d,0],x=wt.invert([],t.globeMatrix);return ot.transformMat4(p,p,x),ot.transformMat4(m,m,x),ot.transformMat4(_,_,x),ot.transformMat4(v,v,x),o[0]=ja(o[0],_,n),o[1]=ja(o[1],v,n),o[2]=ja(o[2],m,n),o[3]=ja(o[3],p,n),nr.fromPoints(o)}function OI(e,t,n){for(const r of e)ot.transformMat4(r,r,t),ot.scale(r,r,n)}function Zx(e,t,n,r){const o=t/e.worldSize,a=e.globeMatrix;if(n.z<=1){const W=qo(n).getCorners();return OI(W,a,o),nr.fromPoints(W)}const c=Bm(n,r),u=Xx(c);OI(u,a,o);const d=Number.MAX_VALUE,p=[-d,-d,-d],m=[d,d,d];if(c.contains(e.center)){for(const K of u)ot.min(m,m,K),ot.max(p,p,K);p[2]=0;const W=e.point,Z=[W.x*o,W.y*o,0];return ot.min(m,m,Z),ot.max(p,p,Z),new nr(m,p)}const _=[a[12]*o,a[13]*o,a[14]*o],v=c.getCenter(),x=jt(e.center.lat,-Or,Or),w=jt(v.lat,-Or,Or),T=Qr(e.center.lng),S=oi(x);let I=T-Qr(v.lng);const A=S-oi(w);I>.5?I-=1:I<-.5&&(I+=1);let R=0;if(Math.abs(I)>Math.abs(A))R=I>=0?1:3;else{R=A>=0?0:2;const W=[a[4]*o,a[5]*o,a[6]*o],Z=-Math.sin(it(A>=0?c.getSouth():c.getNorth()))*Yi;ot.scaleAndAdd(_,_,W,Z)}const k=u[R],P=u[(R+1)%4],O=new _N(k,P,_),j=[Hx(O,0)||k[0],Hx(O,1)||k[1],Hx(O,2)||k[2]],G=fi(e.zoom);if(G>0){const W=function({x:K,y:Q,z:at},X,ft,gt,vt){const ht=1/(1<<at);let pt=K*ht,Ct=pt+ht,At=Q*ht,It=At+ht,zt=0;const Ft=(pt+Ct)/2-gt;return Ft>.5?zt=-1:Ft<-.5&&(zt=1),pt=((pt+zt)*X-(gt*=X))*ft+gt,Ct=((Ct+zt)*X-gt)*ft+gt,At=(At*X-(vt*=X))*ft+vt,It=(It*X-vt)*ft+vt,[[pt,It,0],[Ct,It,0],[Ct,At,0],[pt,At,0]]}(n,t,e._pixelsPerMercatorPixel,T,S);for(let K=0;K<u.length;K++)ja(u[K],W[K],G);const Z=ot.add([],W[R],W[(R+1)%4]);ot.scale(Z,Z,.5),ja(j,Z,G)}for(const W of u)ot.min(m,m,W),ot.max(p,p,W);return m[2]=Math.min(k[2],P[2]),ot.min(m,m,j),ot.max(p,p,j),new nr(m,p)}function Bm({x:e,y:t,z:n},r=!1){const o=1/(1<<n),a=new Ke(So(e*o),t===(1<<n)-1&&r?-90:qr((t+1)*o)),c=new Ke(So((e+1)*o),t===0&&r?90:qr(t*o));return new To(a,c)}function Xx(e){const t=it(e.getNorth()),n=it(e.getSouth()),r=Math.cos(t),o=Math.cos(n),a=Math.sin(t),c=Math.sin(n),u=e.getWest(),d=e.getEast();return[Xu(o,c,u),Xu(o,c,d),Xu(r,a,d),Xu(r,a,u)]}function Xu(e,t,n,r=Yi){return n=it(n),[e*Math.sin(n)*r,-t*r,e*Math.cos(n)*r]}function fo(e,t,n){return Xu(Math.cos(it(e)),Math.sin(it(e)),t,n)}function ef(e,t,n,r){const o=1<<n.z,a=(e/Rt+n.x)/o;return fo(qr((t/Rt+n.y)/o),So(a),r)}function Fm({min:e,max:t}){return mN/Math.max(t[0]-e[0],t[1]-e[1],t[2]-e[2])}const LI=new Float64Array(16);function Tl(e){const t=Fm(e),n=wt.fromScaling(LI,[t,t,t]);return wt.translate(n,n,ot.negate([],e.min))}function Kx(e){const t=wt.fromTranslation(LI,e.min),n=1/Fm(e);return wt.scale(t,t,[n,n,n])}function Yx(e){const t=Rt/(2*Math.PI);return e/(2*Math.PI)/t}function zI(e,t){return Rt/(512*Math.pow(2,e))*Fm(qo(t))}function DI(e,t,n,r,o){const a=Yx(n),c=[e,t,-n/(2*Math.PI)],u=wt.identity(new Float64Array(16));return wt.translate(u,u,c),wt.scale(u,u,[a,a,a]),wt.rotateX(u,u,it(-o)),wt.rotateY(u,u,it(-r)),u}function BI(e){const t=e.pixelsPerMeter,n=t/Hn(1,e.center.lat),r=wt.identity(new Float64Array(16));return wt.translate(r,r,[e.point.x,e.point.y,0]),wt.scale(r,r,[n,n,t]),Float32Array.from(r)}function fi(e){return Le(tf,wl,e)}function FI(e,t,n){const r=wt.identity(new Float64Array(16)),o=(t/(1<<e)-.5)*Math.PI*2;return wt.rotateY(r,n.globeMatrix,o),Float32Array.from(r)}function NI(e,t,n){const r=fi(n.zoom),o=e.style.map._antialias,a=t.options.extStandardDerivativesForceOff||e.terrain&&e.terrain.exaggeration()>0;return r===0&&!o&&!a}function jI(e,t,n,r){const o=t.getNorth(),a=t.getSouth(),c=t.getWest(),u=t.getEast(),d=1<<e.z,p=u-c,m=o-a,_=p/Zu,v=-m/qx[n],x=[0,_,0,v,0,0,o,c,0];if(e.z>0){const w=180/r;ho.multiply(x,x,[w/p+1,0,0,0,w/m+1,0,-.5*w/_,.5*w/v,1])}return x[2]=d,x[5]=e.x,x[8]=e.y,x}function yN(e){const t=Or-5;e=jt(e,-t,t)/t*90;const n=Math.pow(Math.abs(Math.sin(it(e))),3);return Math.round(n*(qx.length-1))}function UI(e){const t=[0,0,0],n=wt.identity(new Float64Array(16));return wt.multiply(n,e.pixelMatrix,e.globeMatrix),ot.transformMat4(t,t,n),new N(t[0],t[1])}function $I(e,t){const n=fo(t.lat,t.lng),r=function(a){const c=fo(a._center.lat,a._center.lng),u=ot.fromValues(0,1,0);let d=ot.cross([],u,c);const p=wt.fromRotation([],-a.angle,c);d=ot.transformMat4(d,d,p),wt.fromRotation(p,-a._pitch,d);const m=ot.normalize([],c);return ot.scale(m,m,Dm(a.cameraToCenterDistance/a.pixelsPerMeter)),ot.transformMat4(m,m,p),ot.add([],c,m)}(e),o=ot.subtract([],r,n);return ot.angle(o,n)}function Nm(e,t){return $I(e,t)>Math.PI/2*1.01}const VI=it(85),vN=Math.cos(VI),xN=Math.sin(VI);class bN{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy()}_fillGridMeshWithLods(t,n){const r=new bo,o=new Wr,a=[],c=t+1+2,u=n[0]+1,d=n[0]+1+(1+n.length),p=(m,_,v)=>{let x=m===c-1?m-2:m===0?m:m-1;return x+=v?24575:0,[x,_]};for(let m=0;m<c;++m)r.emplaceBack(...p(m,0,!0));for(let m=0;m<u;++m)for(let _=0;_<c;++_)r.emplaceBack(...p(_,m,(_===0||_===c-1)&&!0));for(let m=0;m<n.length;++m){const _=n[m];for(let v=0;v<c;++v)r.emplaceBack(...p(v,_,!0))}for(let m=0;m<n.length;++m){const _=o.length,v=n[m]+1+2,x=new Wr;for(let S=0;S<v-1;S++){const I=S===v-2,A=I?c*(d-n.length+m-S):c;for(let R=0;R<c-1;R++){const k=S*c+R;S===0||I||R===0||R===c-2?(x.emplaceBack(k+1,k,k+A),x.emplaceBack(k+A,k+A+1,k+1)):(o.emplaceBack(k+1,k,k+A),o.emplaceBack(k+A,k+A+1,k+1))}}const w=Gn.simpleSegment(0,_,r.length,o.length-_);for(let S=0;S<x.uint16.length;S+=3)o.emplaceBack(x.uint16[S],x.uint16[S+1],x.uint16[S+2]);const T=Gn.simpleSegment(0,_,r.length,o.length-_);a.push({withoutSkirts:w,withSkirts:T})}return{vertices:r,indices:o,segments:a}}_createGrid(t){const n=this._fillGridMeshWithLods(Zu,qx);this._gridSegments=n.segments,this._gridBuffer=t.createVertexBuffer(n.vertices,bl.members),this._gridIndexBuffer=t.createIndexBuffer(n.indices,!0)}_createPoles(t){const n=new Wr;for(let u=0;u<=Zu;u++)n.emplaceBack(0,u+1,u+2);this._poleIndexBuffer=t.createIndexBuffer(n,!0);const r=new Mc,o=new Mc,a=new Mc,c=new Mc;this._poleSegments=[];for(let u=0,d=0;u<tf;u++){const p=360/(1<<u);r.emplaceBack(0,-Yi,0,.5,0),o.emplaceBack(0,-Yi,0,.5,1),a.emplaceBack(0,-Yi,0,.5,.5),c.emplaceBack(0,-Yi,0,.5,.5);for(let m=0;m<=Zu;m++){let _=m/Zu,v=0;const x=Xe(0,p,_),[w,T,S]=Xu(vN,xN,x,Yi);r.emplaceBack(w,T,S,_,v),o.emplaceBack(w,T,S,_,1-v);const I=it(x);_=.5+.5*Math.sin(I),v=.5+.5*Math.cos(I),a.emplaceBack(w,T,S,_,v),c.emplaceBack(w,T,S,_,1-v)}this._poleSegments.push(Gn.simpleSegment(d,0,66,64)),d+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(r,Lm,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(o,Lm,!1),this._texturedPoleNorthVertexBuffer=t.createVertexBuffer(a,Lm,!1),this._texturedPoleSouthVertexBuffer=t.createVertexBuffer(c,Lm,!1)}getGridBuffers(t,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t,n){return[n?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,n?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}}const Ku=63710088e-1,Qx=2*Math.PI*Ku;class Sl{constructor(t,n){if(isNaN(t)||isNaN(n))throw new Error(`Invalid LngLat object: (${t}, ${n})`);if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Sl(we(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const n=Math.PI/180,r=this.lat*n,o=t.lat*n,a=Math.sin(r)*Math.sin(o)+Math.cos(r)*Math.cos(o)*Math.cos((t.lng-this.lng)*n);return Ku*Math.acos(Math.min(a,1))}toBounds(t=0){const n=360*t/40075017,r=n/Math.cos(Math.PI/180*this.lat);return new To(new Sl(this.lng-r,this.lat-n),new Sl(this.lng+r,this.lat+n))}toEcef(t){const n=Dm(t);return fo(this.lat,this.lng,Yi+n)}static convert(t){if(t instanceof Sl)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Sl(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Sl(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Ke=Sl;const wN=0,TN=25.5;function jm(e){return Qx*Math.cos(e*Math.PI/180)}function Qr(e){return(180+e)/360}function oi(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Hn(e,t){return e/jm(t)}function So(e){return 360*e-180}function qr(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function GI(e,t){return e*jm(qr(t))}const Or=85.051129;function WI(e){return Math.cos(it(jt(e,-Or,Or)))}function El(e,t){const n=jt(t,wN,TN),r=Math.pow(2,n);return WI(e)*Qx/(512*r)}function Jx(e){return 1/Math.cos(e*Math.PI/180)}function nf(e,t=0){const n=Math.exp(Math.PI*(1-(e.y+t/Rt)/(1<<e.z)*2));return 80150034*n/(n*n+1)/Rt/(1<<e.z)}class xn{constructor(t,n,r=0){this.x=+t,this.y=+n,this.z=+r}static fromLngLat(t,n=0){const r=Ke.convert(t);return new xn(Qr(r.lng),oi(r.lat),Hn(n,r.lat))}toLngLat(){return new Ke(So(this.x),qr(this.y))}toAltitude(){return GI(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Qx*Jx(qr(this.y))}}function t1(e,t,n,r,o,a,c,u,d){const p=(t+r)/2,m=(n+o)/2,_=new N(p,m);u(_),function(v,x,w,T,S,I){const A=w-S,R=T-I;return Math.abs((T-x)*A-(w-v)*R)/Math.hypot(A,R)}(_.x,_.y,a.x,a.y,c.x,c.y)>=d?(t1(e,t,n,p,m,a,_,u,d),t1(e,p,m,r,o,_,c,u,d)):e.push(c)}function qI(e,t,n){let r=e[0],o=r.x,a=r.y;t(r);const c=[r];for(let u=1;u<e.length;u++){const d=e[u],{x:p,y:m}=d;t(d),t1(c,o,a,p,m,r,d,t,n),o=p,a=m,r=d}return c}function e1(e,t,n,r){if(r(t,n)){const o=t.add(n)._mult(.5);e1(e,t,o,r),e1(e,o,n,r)}else e.push(n)}function SN(e,t){let n=e[0];const r=[n];for(let o=1;o<e.length;o++){const a=e[o];e1(r,n,a,t),n=a}return r}const n1=Math.pow(2,14)-1,HI=-n1-1;function EN(e,t){const n=Math.round(e.x*t),r=Math.round(e.y*t);return e.x=jt(n,HI,n1),e.y=jt(r,HI,n1),(n<e.x||n>e.x+1||r<e.y||r>e.y+1)&&dt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),e}function ia(e,t,n){const r=e.loadGeometry(),o=e.extent,a=Rt/o;if(t&&n&&n.projection.isReprojectedInTileSpace){const c=1<<t.z,{scale:u,x:d,y:p,projection:m}=n,_=v=>{const x=So((t.x+v.x/o)/c),w=qr((t.y+v.y/o)/c),T=m.project(x,w);v.x=(T.x*u-d)*o,v.y=(T.y*u-p)*o};for(let v=0;v<r.length;v++)if(e.type!==1)r[v]=qI(r[v],_,1);else{const x=[];for(const w of r[v])w.x<0||w.x>=o||w.y<0||w.y>=o||(_(w),x.push(w));r[v]=x}}for(const c of r)for(const u of c)EN(u,a);return r}function Cl(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?ia(e):[]}}function Um(e,t,n,r,o){e.emplaceBack(2*t+(r+1)/2,2*n+(o+1)/2)}function $m(e,t,n){e.emplaceBack(t.x,t.y,t.z,n[0]*16384,n[1]*16384,n[2]*16384)}class r1{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new bo,this.indexArray=new Wr,this.segments=new Gn,this.programConfigurations=new vl(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,r,o){const a=this.layers[0],c=[];let u=null;a.type==="circle"&&(u=a.layout.get("circle-sort-key"));for(const{feature:p,id:m,index:_,sourceLayerIndex:v}of t){const x=this.layers[0]._featureFilter.needGeometry,w=Cl(p,x);if(!this.layers[0]._featureFilter.filter(new fr(this.zoom),w,r))continue;const T=u?u.evaluate(w,{},r):void 0,S={id:m,properties:p.properties,type:p.type,sourceLayerIndex:v,index:_,geometry:x?w.geometry:ia(p,r,o),patterns:{},sortKey:T};c.push(S)}u&&c.sort((p,m)=>p.sortKey-m.sortKey);let d=null;o.projection.name==="globe"&&(this.globeExtVertexArray=new Cm,d=o.projection);for(const p of c){const{geometry:m,index:_,sourceLayerIndex:v}=p,x=t[_].feature;this.addFeature(p,m,_,n.availableImages,r,d,n.brightness),n.featureIndex.insert(x,m,_,v,this.index)}}update(t,n,r,o,a){const c=Object.keys(t).length!==0;c&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,n,c?this.stateDependentLayers:this.layers,r,o,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,zF.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,DF.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,n,r,o,a,c,u){for(const d of n)for(const p of d){const m=p.x,_=p.y;if(m<0||m>=Rt||_<0||_>=Rt)continue;if(c){const w=c.projectTilePoint(m,_,a),T=c.upVector(a,m,_),S=this.globeExtVertexArray;$m(S,w,T),$m(S,w,T),$m(S,w,T),$m(S,w,T)}const v=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),x=v.vertexLength;Um(this.layoutVertexArray,m,_,-1,-1),Um(this.layoutVertexArray,m,_,1,-1),Um(this.layoutVertexArray,m,_,1,1),Um(this.layoutVertexArray,m,_,-1,1),this.indexArray.emplaceBack(x,x+1,x+2),this.indexArray.emplaceBack(x,x+2,x+3),v.vertexLength+=4,v.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,{},o,a,u)}}function ZI(e,t){for(let n=0;n<e.length;n++)if(Ml(t,e[n]))return!0;for(let n=0;n<t.length;n++)if(Ml(e,t[n]))return!0;return!!i1(e,t)}function CN(e,t,n){return!!Ml(e,t)||!!o1(t,e,n)}function XI(e,t){if(e.length===1)return YI(t,e[0]);for(let n=0;n<t.length;n++){const r=t[n];for(let o=0;o<r.length;o++)if(Ml(e,r[o]))return!0}for(let n=0;n<e.length;n++)if(YI(t,e[n]))return!0;for(let n=0;n<t.length;n++)if(i1(e,t[n]))return!0;return!1}function MN(e,t,n){if(e.length>1){if(i1(e,t))return!0;for(let r=0;r<t.length;r++)if(o1(t[r],e,n))return!0}for(let r=0;r<e.length;r++)if(o1(e[r],t,n))return!0;return!1}function i1(e,t){if(e.length===0||t.length===0)return!1;for(let n=0;n<e.length-1;n++){const r=e[n],o=e[n+1];for(let a=0;a<t.length-1;a++)if(IN(r,o,t[a],t[a+1]))return!0}return!1}function IN(e,t,n,r){return Bt(e,n,r)!==Bt(t,n,r)&&Bt(e,t,n)!==Bt(e,t,r)}function o1(e,t,n){const r=n*n;if(t.length===1)return e.distSqr(t[0])<r;for(let o=1;o<t.length;o++)if(KI(e,t[o-1],t[o])<r)return!0;return!1}function KI(e,t,n){const r=t.distSqr(n);if(r===0)return e.distSqr(t);const o=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/r;return e.distSqr(o<0?t:o>1?n:n.sub(t)._mult(o)._add(t))}function YI(e,t){let n,r,o,a=!1;for(let c=0;c<e.length;c++){n=e[c];for(let u=0,d=n.length-1;u<n.length;d=u++)r=n[u],o=n[d],r.y>t.y!=o.y>t.y&&t.x<(o.x-r.x)*(t.y-r.y)/(o.y-r.y)+r.x&&(a=!a)}return a}function Ml(e,t){let n=!1;for(let r=0,o=e.length-1;r<e.length;o=r++){const a=e[r],c=e[o];a.y>t.y!=c.y>t.y&&t.x<(c.x-a.x)*(t.y-a.y)/(c.y-a.y)+a.x&&(n=!n)}return n}function QI(e,t,n,r,o){for(const c of e)if(t<=c.x&&n<=c.y&&r>=c.x&&o>=c.y)return!0;const a=[new N(t,n),new N(t,o),new N(r,o),new N(r,n)];if(e.length>2){for(const c of a)if(Ml(e,c))return!0}for(let c=0;c<e.length-1;c++)if(AN(e[c],e[c+1],a))return!0;return!1}function AN(e,t,n){const r=n[0],o=n[2];if(e.x<r.x&&t.x<r.x||e.x>o.x&&t.x>o.x||e.y<r.y&&t.y<r.y||e.y>o.y&&t.y>o.y)return!1;const a=Bt(e,t,n[0]);return a!==Bt(e,t,n[1])||a!==Bt(e,t,n[2])||a!==Bt(e,t,n[3])}function Yu(e,t,n,r,o,a){let c=t.y-e.y,u=e.x-t.x;if(a=a||0){const d=c*c+u*u;if(d===0)return!0;const p=Math.sqrt(d);c/=p,u/=p}return!((n.x-e.x)*c+(n.y-e.y)*u-a<0||(r.x-e.x)*c+(r.y-e.y)*u-a<0||(o.x-e.x)*c+(o.y-e.y)*u-a<0)}function s1(e,t,n,r,o,a,c){return!(Yu(e,t,r,o,a,c)||Yu(t,n,r,o,a,c)||Yu(n,e,r,o,a,c)||Yu(r,o,e,t,n,c)||Yu(o,a,e,t,n,c)||Yu(a,r,e,t,n,c))}function Qu(e,t,n){const r=t.paint.get(e).value;return r.kind==="constant"?r.value:n.programConfigurations.get(t.id).getMaxValue(e)}function Vm(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function JI(e,t,n,r,o){if(!t[0]&&!t[1])return e;const a=N.convert(t)._mult(o);n==="viewport"&&a._rotate(-r);const c=[];for(let u=0;u<e.length;u++)c.push(e[u].sub(a));return c}function tA(e,t,n,r){const o=N.convert(e)._mult(r);return t==="viewport"&&o._rotate(-n),o}Te(r1,"CircleBucket",{omit:["layers"]});const PN=new Mr({"circle-sort-key":new Be(_t.layout_circle["circle-sort-key"]),visibility:new te(_t.layout_circle.visibility)});var RN={paint:new Mr({"circle-radius":new Be(_t.paint_circle["circle-radius"]),"circle-color":new Be(_t.paint_circle["circle-color"]),"circle-blur":new Be(_t.paint_circle["circle-blur"]),"circle-opacity":new Be(_t.paint_circle["circle-opacity"]),"circle-translate":new te(_t.paint_circle["circle-translate"]),"circle-translate-anchor":new te(_t.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new te(_t.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new te(_t.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Be(_t.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Be(_t.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Be(_t.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new te(_t.paint_circle["circle-emissive-strength"])}),layout:PN};const kN=wt.create(),ON=(e,t,n,r,o,a)=>{const c=e.transform,u=c.projection.name==="globe";let d;if(a.paint.get("circle-pitch-alignment")==="map")if(u){const m=zI(c.zoom,t.canonical)*c._pixelsPerMercatorPixel;d=Float32Array.from([m,0,0,m])}else d=c.calculatePixelsToTileUnitsMatrix(n);else d=new Float32Array([c.pixelsToGLUnits[0],0,0,c.pixelsToGLUnits[1]]);const p={u_camera_to_center_distance:e.transform.getCameraToCenterDistance(c.projection),u_matrix:e.translatePosMatrix(t.projMatrix,n,a.paint.get("circle-translate"),a.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Ve.devicePixelRatio,u_extrude_scale:d,u_inv_rot_matrix:kN,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:a.paint.get("circle-emissive-strength")};if(u){p.u_inv_rot_matrix=r,p.u_merc_center=o,p.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],p.u_zoom_transition=fi(c.zoom);const m=o[0]*Rt,_=o[1]*Rt;p.u_up_dir=c.projection.upVector(new hs(0,0,0),m,_)}return p},eA=e=>{const t=[];return e.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),e.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t};function nA(e,t,n,r,o,a,c,u,d){if(a&&e.queryGeometry.isAboveHorizon)return!1;a&&(d*=e.pixelToTileUnitsFactor);const p=e.tileID.canonical,m=n.projection.upVectorScale(p,n.center.lat,n.worldSize).metersToTile;for(const _ of t)for(const v of _){const x=v.add(u),w=o&&n.elevation?n.elevation.exaggeration()*o.getElevationAt(x.x,x.y,!0):0,T=n.projection.projectTilePoint(x.x,x.y,p);if(w>0){const R=n.projection.upVector(p,x.x,x.y);T.x+=R[0]*m*w,T.y+=R[1]*m*w,T.z+=R[2]*m*w}const S=a?x:LN(T.x,T.y,T.z,r),I=a?e.tilespaceRays.map(R=>DN(R,w)):e.queryGeometry.screenGeometry,A=Wn.transformMat4([],[T.x,T.y,T.z,1],r);if(!c&&a?d*=A[3]/n.cameraToCenterDistance:c&&!a&&(d*=n.cameraToCenterDistance/A[3]),a){const R=qr((v.y/Rt+p.y)/(1<<p.z));d/=n.projection.pixelsPerMeter(R,1)/Hn(1,R)}if(CN(I,S,d))return!0}return!1}function LN(e,t,n,r){const o=Wn.transformMat4([],[e,t,n,1],r);return new N(o[0]/o[3],o[1]/o[3])}const rA=ot.fromValues(0,0,0),zN=ot.fromValues(0,0,1);function DN(e,t){const n=ot.create();return rA[2]=t,e.intersectsPlane(rA,zN,n),new N(n[0],n[1])}class iA extends r1{}function oA(e,{width:t,height:n},r,o){if(o){if(o instanceof Uint8ClampedArray)o=new Uint8Array(o.buffer);else if(o.length!==t*n*r)throw new RangeError("mismatched image size")}else o=new Uint8Array(t*n*r);return e.width=t,e.height=n,e.data=o,e}function sA(e,t,n){const{width:r,height:o}=t;r===e.width&&o===e.height||(a1(e,t,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,r),height:Math.min(e.height,o)},n),e.width=r,e.height=o,e.data=t.data)}function a1(e,t,n,r,o,a){if(o.width===0||o.height===0)return t;if(o.width>e.width||o.height>e.height||n.x>e.width-o.width||n.y>e.height-o.height)throw new RangeError("out of range source coordinates for image copy");if(o.width>t.width||o.height>t.height||r.x>t.width-o.width||r.y>t.height-o.height)throw new RangeError("out of range destination coordinates for image copy");const c=e.data,u=t.data;for(let d=0;d<o.height;d++){const p=((n.y+d)*e.width+n.x)*a,m=((r.y+d)*t.width+r.x)*a;for(let _=0;_<o.width*a;_++)u[m+_]=c[p+_]}return t}Te(iA,"HeatmapBucket",{omit:["layers"]});class Ua{constructor(t,n){oA(this,t,1,n)}resize(t){sA(this,new Ua(t),1)}clone(){return new Ua({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,r,o,a){a1(t,n,r,o,a,1)}}class jr{constructor(t,n){oA(this,t,4,n)}resize(t){sA(this,new jr(t),4)}replace(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new jr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,r,o,a){a1(t,n,r,o,a,4)}}class aA{constructor(t,n){this.width=t.width,this.height=t.height,this.data=n instanceof Uint8Array?new Float32Array(n.buffer):n}}Te(Ua,"AlphaImage"),Te(jr,"RGBAImage");const BN=new Mr({visibility:new te(_t.layout_heatmap.visibility)});var FN={paint:new Mr({"heatmap-radius":new Be(_t.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Be(_t.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new te(_t.paint_heatmap["heatmap-intensity"]),"heatmap-color":new qd(_t.paint_heatmap["heatmap-color"]),"heatmap-opacity":new te(_t.paint_heatmap["heatmap-opacity"])}),layout:BN};function Gm(e){const t={},n=e.resolution||256,r=e.clips?e.clips.length:1,o=e.image||new jr({width:n,height:r}),a=(c,u,d)=>{t[e.evaluationKey]=d;const p=e.expression.evaluate(t);p&&(o.data[c+u+0]=Math.floor(255*p.r/p.a),o.data[c+u+1]=Math.floor(255*p.g/p.a),o.data[c+u+2]=Math.floor(255*p.b/p.a),o.data[c+u+3]=Math.floor(255*p.a))};if(e.clips)for(let c=0,u=0;c<r;++c,u+=4*n)for(let d=0,p=0;d<n;d++,p+=4){const m=d/(n-1),{start:_,end:v}=e.clips[c];a(u,p,_*(1-m)+v*m)}else for(let c=0,u=0;c<n;c++,u+=4)a(0,u,c/(n-1));return o}const NN=new Mr({visibility:new te(_t.layout_hillshade.visibility)});var jN={paint:new Mr({"hillshade-illumination-direction":new te(_t.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new te(_t.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new te(_t.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new te(_t.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new te(_t.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new te(_t.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new te(_t.paint_hillshade["hillshade-emissive-strength"])}),layout:NN};const UN=Dn([{name:"a_pos",components:2,type:"Int16"}],4),{members:$N}=UN;var l1={exports:{}};function Wm(e,t,n){n=n||2;var r,o,a,c,u,d,p,m=t&&t.length,_=m?t[0]*n:e.length,v=lA(e,0,_,n,!0),x=[];if(!v||v.next===v.prev)return x;if(m&&(v=function(T,S,I,A){var R,k,P,O=[];for(R=0,k=S.length;R<k;R++)(P=lA(T,S[R]*A,R<k-1?S[R+1]*A:T.length,A,!1))===P.next&&(P.steiner=!0),O.push(KN(P));for(O.sort(HN),R=0;R<O.length;R++)I=ZN(O[R],I);return I}(e,t,v,n)),e.length>80*n){r=a=e[0],o=c=e[1];for(var w=n;w<_;w+=n)(u=e[w])<r&&(r=u),(d=e[w+1])<o&&(o=d),u>a&&(a=u),d>c&&(c=d);p=(p=Math.max(a-r,c-o))!==0?32767/p:0}return rf(v,x,n,r,o,p,0),x}function lA(e,t,n,r,o){var a,c;if(o===h1(e,t,n,r)>0)for(a=t;a<n;a+=r)c=hA(a,e[a],e[a+1],c);else for(a=n-r;a>=t;a-=r)c=hA(a,e[a],e[a+1],c);return c&&qm(c,c.next)&&(sf(c),c=c.next),c}function kc(e,t){if(!e)return e;t||(t=e);var n,r=e;do if(n=!1,r.steiner||!qm(r,r.next)&&Jr(r.prev,r,r.next)!==0)r=r.next;else{if(sf(r),(r=t=r.prev)===r.next)break;n=!0}while(n||r!==t);return t}function rf(e,t,n,r,o,a,c){if(e){!c&&a&&function(m,_,v,x){var w=m;do w.z===0&&(w.z=c1(w.x,w.y,_,v,x)),w.prevZ=w.prev,w.nextZ=w.next,w=w.next;while(w!==m);w.prevZ.nextZ=null,w.prevZ=null,function(T){var S,I,A,R,k,P,O,j,G=1;do{for(I=T,T=null,k=null,P=0;I;){for(P++,A=I,O=0,S=0;S<G&&(O++,A=A.nextZ);S++);for(j=G;O>0||j>0&&A;)O!==0&&(j===0||!A||I.z<=A.z)?(R=I,I=I.nextZ,O--):(R=A,A=A.nextZ,j--),k?k.nextZ=R:T=R,R.prevZ=k,k=R;I=A}k.nextZ=null,G*=2}while(P>1)}(w)}(e,r,o,a);for(var u,d,p=e;e.prev!==e.next;)if(u=e.prev,d=e.next,a?GN(e,r,o,a):VN(e))t.push(u.i/n|0),t.push(e.i/n|0),t.push(d.i/n|0),sf(e),e=d.next,p=d.next;else if((e=d)===p){c?c===1?rf(e=WN(kc(e),t,n),t,n,r,o,a,2):c===2&&qN(e,t,n,r,o,a):rf(kc(e),t,n,r,o,a,1);break}}}function VN(e){var t=e.prev,n=e,r=e.next;if(Jr(t,n,r)>=0)return!1;for(var o=t.x,a=n.x,c=r.x,u=t.y,d=n.y,p=r.y,m=o<a?o<c?o:c:a<c?a:c,_=u<d?u<p?u:p:d<p?d:p,v=o>a?o>c?o:c:a>c?a:c,x=u>d?u>p?u:p:d>p?d:p,w=r.next;w!==t;){if(w.x>=m&&w.x<=v&&w.y>=_&&w.y<=x&&Ju(o,u,a,d,c,p,w.x,w.y)&&Jr(w.prev,w,w.next)>=0)return!1;w=w.next}return!0}function GN(e,t,n,r){var o=e.prev,a=e,c=e.next;if(Jr(o,a,c)>=0)return!1;for(var u=o.x,d=a.x,p=c.x,m=o.y,_=a.y,v=c.y,x=u<d?u<p?u:p:d<p?d:p,w=m<_?m<v?m:v:_<v?_:v,T=u>d?u>p?u:p:d>p?d:p,S=m>_?m>v?m:v:_>v?_:v,I=c1(x,w,t,n,r),A=c1(T,S,t,n,r),R=e.prevZ,k=e.nextZ;R&&R.z>=I&&k&&k.z<=A;){if(R.x>=x&&R.x<=T&&R.y>=w&&R.y<=S&&R!==o&&R!==c&&Ju(u,m,d,_,p,v,R.x,R.y)&&Jr(R.prev,R,R.next)>=0||(R=R.prevZ,k.x>=x&&k.x<=T&&k.y>=w&&k.y<=S&&k!==o&&k!==c&&Ju(u,m,d,_,p,v,k.x,k.y)&&Jr(k.prev,k,k.next)>=0))return!1;k=k.nextZ}for(;R&&R.z>=I;){if(R.x>=x&&R.x<=T&&R.y>=w&&R.y<=S&&R!==o&&R!==c&&Ju(u,m,d,_,p,v,R.x,R.y)&&Jr(R.prev,R,R.next)>=0)return!1;R=R.prevZ}for(;k&&k.z<=A;){if(k.x>=x&&k.x<=T&&k.y>=w&&k.y<=S&&k!==o&&k!==c&&Ju(u,m,d,_,p,v,k.x,k.y)&&Jr(k.prev,k,k.next)>=0)return!1;k=k.nextZ}return!0}function WN(e,t,n){var r=e;do{var o=r.prev,a=r.next.next;!qm(o,a)&&cA(o,r,r.next,a)&&of(o,a)&&of(a,o)&&(t.push(o.i/n|0),t.push(r.i/n|0),t.push(a.i/n|0),sf(r),sf(r.next),r=e=a),r=r.next}while(r!==e);return kc(r)}function qN(e,t,n,r,o,a){var c=e;do{for(var u=c.next.next;u!==c.prev;){if(c.i!==u.i&&YN(c,u)){var d=uA(c,u);return c=kc(c,c.next),d=kc(d,d.next),rf(c,t,n,r,o,a,0),void rf(d,t,n,r,o,a,0)}u=u.next}c=c.next}while(c!==e)}function HN(e,t){return e.x-t.x}function ZN(e,t){var n=function(o,a){var c,u=a,d=o.x,p=o.y,m=-1/0;do{if(p<=u.y&&p>=u.next.y&&u.next.y!==u.y){var _=u.x+(p-u.y)*(u.next.x-u.x)/(u.next.y-u.y);if(_<=d&&_>m&&(m=_,c=u.x<u.next.x?u:u.next,_===d))return c}u=u.next}while(u!==a);if(!c)return null;var v,x=c,w=c.x,T=c.y,S=1/0;u=c;do d>=u.x&&u.x>=w&&d!==u.x&&Ju(p<T?d:m,p,w,T,p<T?m:d,p,u.x,u.y)&&(v=Math.abs(p-u.y)/(d-u.x),of(u,o)&&(v<S||v===S&&(u.x>c.x||u.x===c.x&&XN(c,u)))&&(c=u,S=v)),u=u.next;while(u!==x);return c}(e,t);if(!n)return t;var r=uA(n,e);return kc(r,r.next),kc(n,n.next)}function XN(e,t){return Jr(e.prev,e,t.prev)<0&&Jr(t.next,e,e.next)<0}function c1(e,t,n,r,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function KN(e){var t=e,n=e;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==e);return n}function Ju(e,t,n,r,o,a,c,u){return(o-c)*(t-u)>=(e-c)*(a-u)&&(e-c)*(r-u)>=(n-c)*(t-u)&&(n-c)*(a-u)>=(o-c)*(r-u)}function YN(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(n,r){var o=n;do{if(o.i!==n.i&&o.next.i!==n.i&&o.i!==r.i&&o.next.i!==r.i&&cA(o,o.next,n,r))return!0;o=o.next}while(o!==n);return!1}(e,t)&&(of(e,t)&&of(t,e)&&function(n,r){var o=n,a=!1,c=(n.x+r.x)/2,u=(n.y+r.y)/2;do o.y>u!=o.next.y>u&&o.next.y!==o.y&&c<(o.next.x-o.x)*(u-o.y)/(o.next.y-o.y)+o.x&&(a=!a),o=o.next;while(o!==n);return a}(e,t)&&(Jr(e.prev,e,t.prev)||Jr(e,t.prev,t))||qm(e,t)&&Jr(e.prev,e,e.next)>0&&Jr(t.prev,t,t.next)>0)}function Jr(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function qm(e,t){return e.x===t.x&&e.y===t.y}function cA(e,t,n,r){var o=Zm(Jr(e,t,n)),a=Zm(Jr(e,t,r)),c=Zm(Jr(n,r,e)),u=Zm(Jr(n,r,t));return o!==a&&c!==u||!(o!==0||!Hm(e,n,t))||!(a!==0||!Hm(e,r,t))||!(c!==0||!Hm(n,e,r))||!(u!==0||!Hm(n,t,r))}function Hm(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Zm(e){return e>0?1:e<0?-1:0}function of(e,t){return Jr(e.prev,e,e.next)<0?Jr(e,t,e.next)>=0&&Jr(e,e.prev,t)>=0:Jr(e,t,e.prev)<0||Jr(e,e.next,t)<0}function uA(e,t){var n=new u1(e.i,e.x,e.y),r=new u1(t.i,t.x,t.y),o=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function hA(e,t,n,r){var o=new u1(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function sf(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function u1(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function h1(e,t,n,r){for(var o=0,a=t,c=n-r;a<n;a+=r)o+=(e[c]-e[a])*(e[a+1]+e[c+1]),c=a;return o}l1.exports=Wm,l1.exports.default=Wm,Wm.deviation=function(e,t,n,r){var o=t&&t.length,a=Math.abs(h1(e,0,o?t[0]*n:e.length,n));if(o)for(var c=0,u=t.length;c<u;c++)a-=Math.abs(h1(e,t[c]*n,c<u-1?t[c+1]*n:e.length,n));var d=0;for(c=0;c<r.length;c+=3){var p=r[c]*n,m=r[c+1]*n,_=r[c+2]*n;d+=Math.abs((e[p]-e[_])*(e[m+1]-e[p+1])-(e[p]-e[m])*(e[_+1]-e[p+1]))}return a===0&&d===0?0:Math.abs((d-a)/a)},Wm.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var a=0;a<e[o].length;a++)for(var c=0;c<t;c++)n.vertices.push(e[o][a][c]);o>0&&n.holes.push(r+=e[o-1].length)}return n};var Xm=$(l1.exports);function d1(e,t){const n=e.length;if(n<=1)return[e];const r=[];let o,a;for(let c=0;c<n;c++){const u=Wt(e[c]);u!==0&&(e[c].area=Math.abs(u),a===void 0&&(a=u<0),a===u<0?(o&&r.push(o),o=[e[c]]):o.push(e[c]))}if(o&&r.push(o),t>1)for(let c=0;c<r.length;c++)r[c].length<=t||(LB(r[c],t,1,r[c].length-1,QN),r[c]=r[c].slice(0,t));return r}function QN(e,t){return t.area-e.area}function f1(e,t,n){const r=n.patternDependencies;let o=!1;for(const a of t){const c=a.paint.get(`${e}-pattern`);c.isConstant()||(o=!0);const u=c.constantOr(null);u&&(o=!0,r[u]=!0)}return o}function p1(e,t,n,r,o){const a=o.patternDependencies;for(const c of t){const u=c.paint.get(`${e}-pattern`).value;if(u.kind!=="constant"){let d=u.evaluate({zoom:r},n,{},o.availableImages);d=d&&d.name?d.name:d,a[d]=!0,n.patterns[c.id]=d}}return n}class Km{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new bo,this.indexArray=new Wr,this.indexArray2=new _l,this.programConfigurations=new vl(t.layers,t.zoom),this.segments=new Gn,this.segments2=new Gn,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.projection=t.projection}populate(t,n,r,o){this.hasPattern=f1("fill",this.layers,n);const a=this.layers[0].layout.get("fill-sort-key"),c=[];for(const{feature:u,id:d,index:p,sourceLayerIndex:m}of t){const _=this.layers[0]._featureFilter.needGeometry,v=Cl(u,_);if(!this.layers[0]._featureFilter.filter(new fr(this.zoom),v,r))continue;const x=a?a.evaluate(v,{},r,n.availableImages):void 0,w={id:d,properties:u.properties,type:u.type,sourceLayerIndex:m,index:p,geometry:_?v.geometry:ia(u,r,o),patterns:{},sortKey:x};c.push(w)}a&&c.sort((u,d)=>u.sortKey-d.sortKey);for(const u of c){const{geometry:d,index:p,sourceLayerIndex:m}=u;if(this.hasPattern){const _=p1("fill",this.layers,u,this.zoom,n);this.patternFeatures.push(_)}else this.addFeature(u,d,p,r,{},n.availableImages,n.brightness);n.featureIndex.insert(t[p].feature,d,p,m,this.index)}}update(t,n,r,o,a){const c=Object.keys(t).length!==0;c&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,n,c?this.stateDependentLayers:this.layers,r,o,a)}addFeatures(t,n,r,o,a,c){for(const u of this.patternFeatures)this.addFeature(u,u.geometry,u.index,n,r,o,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,$N),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,n,r,o,a,c=[],u){for(const d of d1(n,500)){let p=0;for(const T of d)p+=T.length;const m=this.segments.prepareSegment(p,this.layoutVertexArray,this.indexArray),_=m.vertexLength,v=[],x=[];for(const T of d){if(T.length===0)continue;T!==d[0]&&x.push(v.length/2);const S=this.segments2.prepareSegment(T.length,this.layoutVertexArray,this.indexArray2),I=S.vertexLength;this.layoutVertexArray.emplaceBack(T[0].x,T[0].y),this.indexArray2.emplaceBack(I+T.length-1,I),v.push(T[0].x),v.push(T[0].y);for(let A=1;A<T.length;A++)this.layoutVertexArray.emplaceBack(T[A].x,T[A].y),this.indexArray2.emplaceBack(I+A-1,I+A),v.push(T[A].x),v.push(T[A].y);S.vertexLength+=T.length,S.primitiveLength+=T.length}const w=Xm(v,x);for(let T=0;T<w.length;T+=3)this.indexArray.emplaceBack(_+w[T],_+w[T+1],_+w[T+2]);m.vertexLength+=p,m.primitiveLength+=w.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,a,c,o,u)}}Te(Km,"FillBucket",{omit:["layers","patternFeatures"]});const JN=new Mr({"fill-sort-key":new Be(_t.layout_fill["fill-sort-key"]),visibility:new te(_t.layout_fill.visibility)});var t6={paint:new Mr({"fill-antialias":new te(_t.paint_fill["fill-antialias"]),"fill-opacity":new Be(_t.paint_fill["fill-opacity"]),"fill-color":new Be(_t.paint_fill["fill-color"]),"fill-outline-color":new Be(_t.paint_fill["fill-outline-color"]),"fill-translate":new te(_t.paint_fill["fill-translate"]),"fill-translate-anchor":new te(_t.paint_fill["fill-translate-anchor"]),"fill-pattern":new Be(_t.paint_fill["fill-pattern"]),"fill-emissive-strength":new te(_t.paint_fill["fill-emissive-strength"])}),layout:JN};const e6=Dn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),n6=Dn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),r6=Dn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),i6=Dn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),o6=Dn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:s6}=e6;var Ym={},a6=yt,dA=th;function th(e,t,n,r,o){this.properties={},this.extent=n,this.type=0,this._pbf=e,this._geometry=-1,this._keys=r,this._values=o,e.readFields(l6,this,t)}function l6(e,t,n){e==1?t.id=n.readVarint():e==2?function(r,o){for(var a=r.readVarint()+r.pos;r.pos<a;){var c=o._keys[r.readVarint()],u=o._values[r.readVarint()];o.properties[c]=u}}(n,t):e==3?t.type=n.readVarint():e==4&&(t._geometry=n.pos)}function c6(e){for(var t,n,r=0,o=0,a=e.length,c=a-1;o<a;c=o++)r+=((n=e[c]).x-(t=e[o]).x)*(t.y+n.y);return r}th.types=["Unknown","Point","LineString","Polygon"],th.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,n=e.readVarint()+e.pos,r=1,o=0,a=0,c=0,u=[];e.pos<n;){if(o<=0){var d=e.readVarint();r=7&d,o=d>>3}if(o--,r===1||r===2)a+=e.readSVarint(),c+=e.readSVarint(),r===1&&(t&&u.push(t),t=[]),t.push(new a6(a,c));else{if(r!==7)throw new Error("unknown command "+r);t&&t.push(t[0].clone())}}return t&&u.push(t),u},th.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,n=1,r=0,o=0,a=0,c=1/0,u=-1/0,d=1/0,p=-1/0;e.pos<t;){if(r<=0){var m=e.readVarint();n=7&m,r=m>>3}if(r--,n===1||n===2)(o+=e.readSVarint())<c&&(c=o),o>u&&(u=o),(a+=e.readSVarint())<d&&(d=a),a>p&&(p=a);else if(n!==7)throw new Error("unknown command "+n)}return[c,d,u,p]},th.prototype.toGeoJSON=function(e,t,n){var r,o,a=this.extent*Math.pow(2,n),c=this.extent*e,u=this.extent*t,d=this.loadGeometry(),p=th.types[this.type];function m(x){for(var w=0;w<x.length;w++){var T=x[w];x[w]=[360*(T.x+c)/a-180,360/Math.PI*Math.atan(Math.exp((180-360*(T.y+u)/a)*Math.PI/180))-90]}}switch(this.type){case 1:var _=[];for(r=0;r<d.length;r++)_[r]=d[r][0];m(d=_);break;case 2:for(r=0;r<d.length;r++)m(d[r]);break;case 3:for(d=function(x){var w=x.length;if(w<=1)return[x];for(var T,S,I=[],A=0;A<w;A++){var R=c6(x[A]);R!==0&&(S===void 0&&(S=R<0),S===R<0?(T&&I.push(T),T=[x[A]]):T.push(x[A]))}return T&&I.push(T),I}(d),r=0;r<d.length;r++)for(o=0;o<d[r].length;o++)m(d[r][o])}d.length===1?d=d[0]:p="Multi"+p;var v={type:"Feature",geometry:{type:p,coordinates:d},properties:this.properties};return"id"in this&&(v.id=this.id),v};var u6=dA,fA=pA;function pA(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(h6,this,t),this.length=this._features.length}function h6(e,t,n){e===15?t.version=n.readVarint():e===1?t.name=n.readString():e===5?t.extent=n.readVarint():e===2?t._features.push(n.pos):e===3?t._keys.push(n.readString()):e===4&&t._values.push(function(r){for(var o=null,a=r.readVarint()+r.pos;r.pos<a;){var c=r.readVarint()>>3;o=c===1?r.readString():c===2?r.readFloat():c===3?r.readDouble():c===4?r.readVarint64():c===5?r.readVarint():c===6?r.readSVarint():c===7?r.readBoolean():null}return o}(n))}pA.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new u6(this._pbf,t,this.extent,this._keys,this._values)};var d6=fA;function f6(e,t,n){if(e===3){var r=new d6(n,n.readVarint()+n.pos);r.length&&(t[r.name]=r)}}var m1=Ym.VectorTile=function(e,t){this.layers=e.readFields(f6,{},t)},Qm=Ym.VectorTileFeature=dA;function Jm(e,t,n,r){const o=[],a=r===0?(c,u,d,p,m,_)=>{c.push(new N(_,d+(_-u)/(p-u)*(m-d)))}:(c,u,d,p,m,_)=>{c.push(new N(u+(_-d)/(m-d)*(p-u),_))};for(const c of e){const u=[];for(const d of c){if(d.length<=2)continue;const p=[];for(let v=0;v<d.length-1;v++){const x=d[v].x,w=d[v].y,T=d[v+1].x,S=d[v+1].y,I=r===0?x:w,A=r===0?T:S;I<t?A>t&&a(p,x,w,T,S,t):I>n?A<n&&a(p,x,w,T,S,n):p.push(d[v]),A<t&&I>=t&&a(p,x,w,T,S,t),A>n&&I<=n&&a(p,x,w,T,S,n)}let m=d[d.length-1];const _=r===0?m.x:m.y;_>=t&&_<=n&&p.push(m),p.length&&(m=p[p.length-1],p[0].x===m.x&&p[0].y===m.y||p.push(p[0]),u.push(p))}u.length&&o.push(u)}return o}Ym.VectorTileLayer=fA;class mA{constructor(t){this._stringToNumber={},this._numberToString=[];for(let n=0;n<t.length;n++){const r=t[n];this._stringToNumber[r]=n,this._numberToString[n]=r}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}var p6={read:function(e,t,n,r,o){var a,c,u=8*o-r-1,d=(1<<u)-1,p=d>>1,m=-7,_=n?o-1:0,v=n?-1:1,x=e[t+_];for(_+=v,a=x&(1<<-m)-1,x>>=-m,m+=u;m>0;a=256*a+e[t+_],_+=v,m-=8);for(c=a&(1<<-m)-1,a>>=-m,m+=r;m>0;c=256*c+e[t+_],_+=v,m-=8);if(a===0)a=1-p;else{if(a===d)return c?NaN:1/0*(x?-1:1);c+=Math.pow(2,r),a-=p}return(x?-1:1)*c*Math.pow(2,a-r)},write:function(e,t,n,r,o,a){var c,u,d,p=8*a-o-1,m=(1<<p)-1,_=m>>1,v=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,x=r?0:a-1,w=r?1:-1,T=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,c=m):(c=Math.floor(Math.log(t)/Math.LN2),t*(d=Math.pow(2,-c))<1&&(c--,d*=2),(t+=c+_>=1?v/d:v*Math.pow(2,1-_))*d>=2&&(c++,d/=2),c+_>=m?(u=0,c=m):c+_>=1?(u=(t*d-1)*Math.pow(2,o),c+=_):(u=t*Math.pow(2,_-1)*Math.pow(2,o),c=0));o>=8;e[n+x]=255&u,x+=w,u/=256,o-=8);for(c=c<<o|u,p+=o;p>0;e[n+x]=255&c,x+=w,c/=256,p-=8);e[n+x-w]|=128*T}},gA=cr,tg=p6;function cr(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}cr.Varint=0,cr.Fixed64=1,cr.Bytes=2,cr.Fixed32=5;var g1=4294967296,_A=1/g1,yA=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function $a(e){return e.type===cr.Bytes?e.readVarint()+e.pos:e.pos+1}function eh(e,t,n){return n?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function vA(e,t,n){var r=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(r);for(var o=n.pos-1;o>=e;o--)n.buf[o+r]=n.buf[o]}function m6(e,t){for(var n=0;n<e.length;n++)t.writeVarint(e[n])}function g6(e,t){for(var n=0;n<e.length;n++)t.writeSVarint(e[n])}function _6(e,t){for(var n=0;n<e.length;n++)t.writeFloat(e[n])}function y6(e,t){for(var n=0;n<e.length;n++)t.writeDouble(e[n])}function v6(e,t){for(var n=0;n<e.length;n++)t.writeBoolean(e[n])}function x6(e,t){for(var n=0;n<e.length;n++)t.writeFixed32(e[n])}function b6(e,t){for(var n=0;n<e.length;n++)t.writeSFixed32(e[n])}function w6(e,t){for(var n=0;n<e.length;n++)t.writeFixed64(e[n])}function T6(e,t){for(var n=0;n<e.length;n++)t.writeSFixed64(e[n])}function eg(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function nh(e,t,n){e[n]=t,e[n+1]=t>>>8,e[n+2]=t>>>16,e[n+3]=t>>>24}function xA(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}cr.prototype={destroy:function(){this.buf=null},readFields:function(e,t,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),o=r>>3,a=this.pos;this.type=7&r,e(o,t,this),this.pos===a&&this.skip(r)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=eg(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=xA(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=eg(this.buf,this.pos)+eg(this.buf,this.pos+4)*g1;return this.pos+=8,e},readSFixed64:function(){var e=eg(this.buf,this.pos)+xA(this.buf,this.pos+4)*g1;return this.pos+=8,e},readFloat:function(){var e=tg.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=tg.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,n,r=this.buf;return t=127&(n=r[this.pos++]),n<128?t:(t|=(127&(n=r[this.pos++]))<<7,n<128?t:(t|=(127&(n=r[this.pos++]))<<14,n<128?t:(t|=(127&(n=r[this.pos++]))<<21,n<128?t:function(o,a,c){var u,d,p=c.buf;if(u=(112&(d=p[c.pos++]))>>4,d<128||(u|=(127&(d=p[c.pos++]))<<3,d<128)||(u|=(127&(d=p[c.pos++]))<<10,d<128)||(u|=(127&(d=p[c.pos++]))<<17,d<128)||(u|=(127&(d=p[c.pos++]))<<24,d<128)||(u|=(1&(d=p[c.pos++]))<<31,d<128))return eh(o,u,a);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(n=r[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&yA?function(n,r,o){return yA.decode(n.subarray(r,o))}(this.buf,t,e):function(n,r,o){for(var a="",c=r;c<o;){var u,d,p,m=n[c],_=null,v=m>239?4:m>223?3:m>191?2:1;if(c+v>o)break;v===1?m<128&&(_=m):v===2?(192&(u=n[c+1]))==128&&(_=(31&m)<<6|63&u)<=127&&(_=null):v===3?(d=n[c+2],(192&(u=n[c+1]))==128&&(192&d)==128&&((_=(15&m)<<12|(63&u)<<6|63&d)<=2047||_>=55296&&_<=57343)&&(_=null)):v===4&&(d=n[c+2],p=n[c+3],(192&(u=n[c+1]))==128&&(192&d)==128&&(192&p)==128&&((_=(15&m)<<18|(63&u)<<12|(63&d)<<6|63&p)<=65535||_>=1114112)&&(_=null)),_===null?(_=65533,v=1):_>65535&&(_-=65536,a+=String.fromCharCode(_>>>10&1023|55296),_=56320|1023&_),a+=String.fromCharCode(_),c+=v}return a}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==cr.Bytes)return e.push(this.readVarint(t));var n=$a(this);for(e=e||[];this.pos<n;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==cr.Bytes)return e.push(this.readSVarint());var t=$a(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==cr.Bytes)return e.push(this.readBoolean());var t=$a(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==cr.Bytes)return e.push(this.readFloat());var t=$a(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==cr.Bytes)return e.push(this.readDouble());var t=$a(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==cr.Bytes)return e.push(this.readFixed32());var t=$a(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==cr.Bytes)return e.push(this.readSFixed32());var t=$a(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==cr.Bytes)return e.push(this.readFixed64());var t=$a(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==cr.Bytes)return e.push(this.readSFixed64());var t=$a(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===cr.Varint)for(;this.buf[this.pos++]>127;);else if(t===cr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===cr.Fixed32)this.pos+=4;else{if(t!==cr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),nh(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),nh(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),nh(this.buf,-1&e,this.pos),nh(this.buf,Math.floor(e*_A),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),nh(this.buf,-1&e,this.pos),nh(this.buf,Math.floor(e*_A),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,n){var r,o;if(t>=0?(r=t%4294967296|0,o=t/4294967296|0):(o=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:(r=0,o=o+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(a,c,u){u.buf[u.pos++]=127&a|128,a>>>=7,u.buf[u.pos++]=127&a|128,a>>>=7,u.buf[u.pos++]=127&a|128,a>>>=7,u.buf[u.pos++]=127&a|128,u.buf[u.pos]=127&(a>>>=7)}(r,0,n),function(a,c){var u=(7&a)<<4;c.buf[c.pos++]|=u|((a>>>=3)?128:0),a&&(c.buf[c.pos++]=127&a|((a>>>=7)?128:0),a&&(c.buf[c.pos++]=127&a|((a>>>=7)?128:0),a&&(c.buf[c.pos++]=127&a|((a>>>=7)?128:0),a&&(c.buf[c.pos++]=127&a|((a>>>=7)?128:0),a&&(c.buf[c.pos++]=127&a)))))}(o,n)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(r,o,a){for(var c,u,d=0;d<o.length;d++){if((c=o.charCodeAt(d))>55295&&c<57344){if(!u){c>56319||d+1===o.length?(r[a++]=239,r[a++]=191,r[a++]=189):u=c;continue}if(c<56320){r[a++]=239,r[a++]=191,r[a++]=189,u=c;continue}c=u-55296<<10|c-56320|65536,u=null}else u&&(r[a++]=239,r[a++]=191,r[a++]=189,u=null);c<128?r[a++]=c:(c<2048?r[a++]=c>>6|192:(c<65536?r[a++]=c>>12|224:(r[a++]=c>>18|240,r[a++]=c>>12&63|128),r[a++]=c>>6&63|128),r[a++]=63&c|128)}return a}(this.buf,e,this.pos);var n=this.pos-t;n>=128&&vA(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeFloat:function(e){this.realloc(4),tg.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),tg.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var n=0;n<t;n++)this.buf[this.pos++]=e[n]},writeRawMessage:function(e,t){this.pos++;var n=this.pos;e(t,this);var r=this.pos-n;r>=128&&vA(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(e,t,n){this.writeTag(e,cr.Bytes),this.writeRawMessage(t,n)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,m6,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,g6,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,v6,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,_6,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,y6,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,x6,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,b6,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,w6,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,T6,t)},writeBytesField:function(e,t){this.writeTag(e,cr.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,cr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,cr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,cr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,cr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,cr.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,cr.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,cr.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,cr.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,cr.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};var ng=$(gA);const S6=["tile","layer","source","sourceLayer","state"];class bA{constructor(t,n,r,o,a){this.type="Feature",this._vectorTileFeature=t,this._z=n,this._x=r,this._y=o,this.properties=t.properties,this.id=a}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(t.id=this.id);for(const n of S6)this[n]!==void 0&&(t[n]=this[n]);return t}}class E6{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,n,r){const o=String(n);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][o]=this.stateChanges[t][o]||{},Ot(this.stateChanges[t][o],r),this.deletedStates[t]===null){this.deletedStates[t]={};for(const a in this.state[t])a!==o&&(this.deletedStates[t][a]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][o]===null){this.deletedStates[t][o]={};for(const a in this.state[t][o])r[a]||(this.deletedStates[t][o][a]=null)}else for(const a in r)this.deletedStates[t]&&this.deletedStates[t][o]&&this.deletedStates[t][o][a]===null&&delete this.deletedStates[t][o][a]}removeFeatureState(t,n,r){if(this.deletedStates[t]===null)return;const o=String(n);if(this.deletedStates[t]=this.deletedStates[t]||{},r&&n!==void 0)this.deletedStates[t][o]!==null&&(this.deletedStates[t][o]=this.deletedStates[t][o]||{},this.deletedStates[t][o][r]=null);else if(n!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][o])for(r in this.deletedStates[t][o]={},this.stateChanges[t][o])this.deletedStates[t][o][r]=null;else this.deletedStates[t][o]=null;else this.deletedStates[t]=null}getState(t,n){const r=String(n),o=Ot({},(this.state[t]||{})[r],(this.stateChanges[t]||{})[r]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const a=this.deletedStates[t][n];if(a===null)return{};for(const c in a)delete o[c]}return o}initializeTileState(t,n){t.setFeatureState(this.state,n)}coalesceChanges(t,n){const r={};for(const o in this.stateChanges){this.state[o]=this.state[o]||{};const a={};for(const c in this.stateChanges[o])this.state[o][c]||(this.state[o][c]={}),Ot(this.state[o][c],this.stateChanges[o][c]),a[c]=this.state[o][c];r[o]=a}for(const o in this.deletedStates){this.state[o]=this.state[o]||{};const a={};if(this.deletedStates[o]===null)for(const c in this.state[o])a[c]={},this.state[o][c]={};else for(const c in this.deletedStates[o]){if(this.deletedStates[o][c]===null)this.state[o][c]={};else if(this.state[o][c])for(const u of Object.keys(this.deletedStates[o][c]))delete this.state[o][c][u];a[c]=this.state[o][c]}r[o]=r[o]||{},Ot(r[o],a)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(const o in t)t[o].setFeatureState(r,n)}}class wA{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,n){const r=this.toIdx(t,n);return{min:this.minimums[r],max:this.maximums[r]}}isLeaf(t,n){return this.leaves[this.toIdx(t,n)]}toIdx(t,n){return n*this.size+t}}function TA(e,t,n,r){let o=0,a=Number.MAX_VALUE;for(let c=0;c<3;c++)if(Math.abs(r[c])<1e-15){if(n[c]<e[c]||n[c]>t[c])return null}else{const u=1/r[c];let d=(e[c]-n[c])*u,p=(t[c]-n[c])*u;if(d>p){const m=d;d=p,p=m}if(d>o&&(o=d),p<a&&(a=p),o>a)return null}return o}function SA(e,t,n,r,o,a,c,u,d,p,m){const _=r-e,v=o-t,x=a-n,w=c-e,T=u-t,S=d-n,I=m[1]*S-m[2]*T,A=m[2]*w-m[0]*S,R=m[0]*T-m[1]*w,k=_*I+v*A+x*R;if(Math.abs(k)<1e-15)return null;const P=1/k,O=p[0]-e,j=p[1]-t,G=p[2]-n,W=(O*I+j*A+G*R)*P;if(W<0||W>1)return null;const Z=j*x-G*v,K=G*_-O*x,Q=O*v-j*_,at=(m[0]*Z+m[1]*K+m[2]*Q)*P;return at<0||W+at>1?null:(w*Z+T*K+S*Q)*P}function EA(e,t,n){return(e-t)/(n-t)}function CA(e,t,n,r,o,a,c,u,d){const p=1<<n,m=a-r,_=c-o,v=(e+1)/p*m+r,x=(t+0)/p*_+o,w=(t+1)/p*_+o;u[0]=(e+0)/p*m+r,u[1]=x,d[0]=v,d[1]=w}class MA{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const n=function(a){const c=Math.ceil(Math.log2(a.dim/8)),u=[];let d=Math.ceil(Math.pow(2,c));const p=1/d,m=(x,w,T,S,I)=>{const A=S?1:0,R=(x+1)*T-A,k=w*T,P=(w+1)*T-A;I[0]=x*T,I[1]=k,I[2]=R,I[3]=P};let _=new wA(d);const v=[];for(let x=0;x<d*d;x++){m(x%d,Math.floor(x/d),p,!1,v);const w=Il(v[0],v[1],a),T=Il(v[2],v[1],a),S=Il(v[2],v[3],a),I=Il(v[0],v[3],a);_.minimums.push(Math.min(w,T,S,I)),_.maximums.push(Math.max(w,T,S,I)),_.leaves.push(1)}for(u.push(_),d/=2;d>=1;d/=2){const x=u[u.length-1];_=new wA(d);for(let w=0;w<d*d;w++){m(w%d,Math.floor(w/d),2,!0,v);const T=x.getElevation(v[0],v[1]),S=x.getElevation(v[2],v[1]),I=x.getElevation(v[2],v[3]),A=x.getElevation(v[0],v[3]),R=x.isLeaf(v[0],v[1]),k=x.isLeaf(v[2],v[1]),P=x.isLeaf(v[2],v[3]),O=x.isLeaf(v[0],v[3]),j=Math.min(T.min,S.min,I.min,A.min),G=Math.max(T.max,S.max,I.max,A.max),W=R&&k&&P&&O;_.maximums.push(G),_.minimums.push(j),_.leaves.push(G-j<=5&&W?1:0)}u.push(_)}return u}(this.dem),r=n.length-1,o=n[r];this._addNode(o.minimums[0],o.maximums[0],o.leaves[0]),this._construct(n,0,0,r,0)}raycastRoot(t,n,r,o,a,c,u=1){return TA([t,n,-100],[r,o,this.maximums[0]*u],a,c)}raycast(t,n,r,o,a,c,u=1){if(!this.nodeCount)return null;const d=this.raycastRoot(t,n,r,o,a,c,u);if(d==null)return null;const p=[],m=[],_=[],v=[],x=[{idx:0,t:d,nodex:0,nodey:0,depth:0}];for(;x.length>0;){const{idx:w,t:T,nodex:S,nodey:I,depth:A}=x.pop();if(this.leaves[w]){CA(S,I,A,t,n,r,o,_,v);const k=1<<A,P=(S+0)/k,O=(S+1)/k,j=(I+0)/k,G=(I+1)/k,W=Il(P,j,this.dem)*u,Z=Il(O,j,this.dem)*u,K=Il(O,G,this.dem)*u,Q=Il(P,G,this.dem)*u,at=SA(_[0],_[1],W,v[0],_[1],Z,v[0],v[1],K,a,c),X=SA(v[0],v[1],K,_[0],v[1],Q,_[0],_[1],W,a,c),ft=Math.min(at!==null?at:Number.MAX_VALUE,X!==null?X:Number.MAX_VALUE);if(ft!==Number.MAX_VALUE)return ft;{const gt=ot.scaleAndAdd([],a,c,T);if(IA(W,Z,Q,K,EA(gt[0],_[0],v[0]),EA(gt[1],_[1],v[1]))>=gt[2])return T}continue}let R=0;for(let k=0;k<this._siblingOffset.length;k++){CA((S<<1)+this._siblingOffset[k][0],(I<<1)+this._siblingOffset[k][1],A+1,t,n,r,o,_,v),_[2]=-100,v[2]=this.maximums[this.childOffsets[w]+k]*u;const P=TA(_,v,a,c);if(P!=null){const O=P;p[k]=O;let j=!1;for(let G=0;G<R&&!j;G++)O>=p[m[G]]&&(m.splice(G,0,k),j=!0);j||(m[R]=k),R++}}for(let k=0;k<R;k++){const P=m[k];x.push({idx:this.childOffsets[w]+P,t:p[P],nodex:(S<<1)+this._siblingOffset[P][0],nodey:(I<<1)+this._siblingOffset[P][1],depth:A+1})}}return null}_addNode(t,n,r){return this.minimums.push(t),this.maximums.push(n),this.leaves.push(r),this.childOffsets.push(0),this.nodeCount++}_construct(t,n,r,o,a){if(t[o].isLeaf(n,r)===1)return;this.childOffsets[a]||(this.childOffsets[a]=this.nodeCount);const c=o-1,u=t[c];let d=0,p=0;for(let m=0;m<this._siblingOffset.length;m++){const _=2*n+this._siblingOffset[m][0],v=2*r+this._siblingOffset[m][1],x=u.getElevation(_,v),w=u.isLeaf(_,v),T=this._addNode(x.min,x.max,w);w&&(d|=1<<m),p||(p=T)}for(let m=0;m<this._siblingOffset.length;m++)d&1<<m||this._construct(t,2*n+this._siblingOffset[m][0],2*r+this._siblingOffset[m][1],c,p+m)}}function IA(e,t,n,r,o,a){return Xe(Xe(e,n,a),Xe(t,r,a),o)}function Il(e,t,n){const r=n.dim,o=jt(e*r-.5,0,r-1),a=jt(t*r-.5,0,r-1),c=Math.floor(o),u=Math.floor(a),d=Math.min(c+1,r-1),p=Math.min(u+1,r-1);return IA(n.get(c,u),n.get(d,u),n.get(c,p),n.get(d,p),o-c,a-u)}const C6={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function M6(e,t,n){return(256*e*256+256*t+n)/10-1e4}function I6(e,t,n){return 256*e+t+n/256-32768}class rg{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,n,r,o=!1){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(r&&r!=="mapbox"&&r!=="terrarium")return dt(`"${r}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;const a=this.dim=n.height-2,c=new Uint32Array(n.data.buffer);if(this.pixels=new Uint8Array(n.data.buffer),this.floatView=new Float32Array(n.data.buffer),this.borderReady=o,this._modifiedForSources={},!o){for(let d=0;d<a;d++)c[this._idx(-1,d)]=c[this._idx(0,d)],c[this._idx(a,d)]=c[this._idx(a-1,d)],c[this._idx(d,-1)]=c[this._idx(d,0)],c[this._idx(d,a)]=c[this._idx(d,a-1)];c[this._idx(-1,-1)]=c[this._idx(0,0)],c[this._idx(a,-1)]=c[this._idx(a-1,0)],c[this._idx(-1,a)]=c[this._idx(0,a-1)],c[this._idx(a,a)]=c[this._idx(a-1,a-1)]}const u=r==="terrarium"?I6:M6;for(let d=0;d<c.length;++d){const p=4*d;this.floatView[d]=u(this.pixels[p],this.pixels[p+1],this.pixels[p+2])}this._timestamp=Ve.now()}_buildQuadTree(){this._tree=new MA(this)}get(t,n,r=!1){r&&(t=jt(t,-1,this.dim),n=jt(n,-1,this.dim));const o=this._idx(t,n);return this.floatView[o]}set(t,n,r){const o=this._idx(t,n),a=this.floatView[o];return this.floatView[o]=r,r-a}static getUnpackVector(t){return C6[t]}_idx(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)}static pack(t,n){const r=[0,0,0,0],o=rg.getUnpackVector(n);let a=Math.floor((t+o[3])/o[2]);return r[2]=a%256,a=Math.floor(a/256),r[1]=a%256,a=Math.floor(a/256),r[0]=a,r}getPixels(){return new aA({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,n,r){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let o=n*this.dim,a=n*this.dim+this.dim,c=r*this.dim,u=r*this.dim+this.dim;switch(n){case-1:o=a-1;break;case 1:a=o+1}switch(r){case-1:c=u-1;break;case 1:u=c+1}const d=-n*this.dim,p=-r*this.dim;for(let m=c;m<u;m++)for(let _=o;_<a;_++){const v=4*this._idx(_,m),x=4*this._idx(_+d,m+p);this.pixels[v+0]=t.pixels[x+0],this.pixels[v+1]=t.pixels[x+1],this.pixels[v+2]=t.pixels[x+2],this.pixels[v+3]=t.pixels[x+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Te(rg,"DEMData"),Te(MA,"DemMinMaxQuadTree",{omit:["dem"]});class A6{isDataAvailableAtPoint(t){const n=this._source();if(this.isUsingMockSource()||!n||t.y<0||t.y>1)return!1;const r=n.getSource().maxzoom,o=1<<r,a=Math.floor(t.x),c=Math.floor((t.x-a)*o),u=Math.floor(t.y*o),d=this.findDEMTileFor(new Pn(r,a,r,c,u));return!(!d||!d.dem)}getAtPointOrZero(t,n=0){return this.getAtPoint(t,n)||0}getAtPoint(t,n,r=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const o=this._source();if(!o||t.y<0||t.y>1)return n;const a=o.getSource().maxzoom,c=1<<a,u=Math.floor(t.x),d=t.x-u,p=new Pn(a,u,a,Math.floor(d*c),Math.floor(t.y*c)),m=this.findDEMTileFor(p);if(!m||!m.dem)return n;const _=m.dem,v=1<<m.tileID.canonical.z,x=(d*v-m.tileID.canonical.x)*_.dim,w=(t.y*v-m.tileID.canonical.y)*_.dim,T=Math.floor(x),S=Math.floor(w);return(r?this.exaggeration():1)*Xe(Xe(_.get(T,S),_.get(T,S+1),w-S),Xe(_.get(T+1,S),_.get(T+1,S+1),w-S),x-T)}getAtTileOffset(t,n,r){const o=1<<t.canonical.z;return this.getAtPointOrZero(new xn(t.wrap+(t.canonical.x+n/Rt)/o,(t.canonical.y+r/Rt)/o))}getAtTileOffsetFunc(t,n,r,o){return a=>{const c=this.getAtTileOffset(t,a.x,a.y),u=o.upVector(t.canonical,a.x,a.y),d=o.upVectorScale(t.canonical,n,r).metersToTile;return ot.scale(u,u,c*d),u}}getForTilePoints(t,n,r,o){if(this.isUsingMockSource())return!1;const a=rh.create(this,t,o);return!!a&&(n.forEach(c=>{c[2]=this.exaggeration()*a.getElevationAt(c[0],c[1],r)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(t);if(!n||!n.dem)return null;const r=n.dem.tree,o=n.tileID,a=1<<t.canonical.z-o.canonical.z;let c=t.canonical.x/a-o.canonical.x,u=t.canonical.y/a-o.canonical.y,d=0;for(let p=0;p<t.canonical.z-o.canonical.z&&!r.leaves[d];p++){c*=2,u*=2;const m=2*Math.floor(u)+Math.floor(c);d=r.childOffsets[d]+m,c%=1,u%=1}return{min:this.exaggeration()*r.minimums[d],max:this.exaggeration()*r.maximums[d]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,n,r){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const t=this.visibleDemTiles;if(t.length===0)return null;let n=!1,r=Number.MAX_VALUE,o=Number.MIN_VALUE;for(const a of t){const c=this.getMinMaxForTile(a.tileID);c&&(r=Math.min(r,c.min),o=Math.max(o,c.max),n=!0)}return n?{min:r,max:o}:null}}class rh{constructor(t,n,r){this._demTile=t,this._dem=this._demTile.dem,this._scale=n,this._offset=r}static create(t,n,r){const o=r||t.findDEMTileFor(n);if(!o||!o.dem)return;const a=o.dem,c=o.tileID,u=1<<n.canonical.z-c.canonical.z;return new rh(o,a.dim/Rt/u,[(n.canonical.x/u-c.canonical.x)*a.dim,(n.canonical.y/u-c.canonical.y)*a.dim])}tileCoordToPixel(t,n){const r=n*this._scale+this._offset[1],o=Math.floor(t*this._scale+this._offset[0]),a=Math.floor(r);return new N(o,a)}getElevationAt(t,n,r,o){const a=t*this._scale+this._offset[0],c=n*this._scale+this._offset[1],u=Math.floor(a),d=Math.floor(c),p=this._dem;return o=!!o,r?Xe(Xe(p.get(u,d,o),p.get(u,d+1,o),c-d),Xe(p.get(u+1,d,o),p.get(u+1,d+1,o),c-d),a-u):p.get(u,d,o)}getElevationAtPixel(t,n,r){return this._dem.get(t,n,!!r)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*Hn(1,t)*this._dem.stride}}class _1{constructor(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Uu(Rt,16,0),this.featureIndexArray=new iM,this.promoteId=n}insert(t,n,r,o,a,c=0){const u=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,o,a,c);const d=this.grid;for(let p=0;p<n.length;p++){const m=n[p],_=[1/0,1/0,-1/0,-1/0];for(let v=0;v<m.length;v++){const x=m[v];_[0]=Math.min(_[0],x.x),_[1]=Math.min(_[1],x.y),_[2]=Math.max(_[2],x.x),_[3]=Math.max(_[3],x.y)}_[0]<Rt&&_[1]<Rt&&_[2]>=0&&_[3]>=0&&d.insert(u,_[0],_[1],_[2],_[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new m1(new ng(this.rawTileData)).layers,this.sourceLayerCoder=new mA(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,n,r,o){this.loadVTLayers();const a=t.params||{},c=mm(a.filter),u=t.tileResult,d=t.transform,p=u.bufferedTilespaceBounds,m=this.grid.query(p.min.x,p.min.y,p.max.x,p.max.y,(w,T,S,I)=>QI(u.bufferedTilespaceGeometry,w,T,S,I));m.sort(P6);let _=null;d.elevation&&m.length>0&&(_=rh.create(d.elevation,this.tileID));const v={};let x;for(let w=0;w<m.length;w++){const T=m[w];if(T===x)continue;x=T;const S=this.featureIndexArray.get(T);let I=null;this.loadMatchingFeature(v,S,c,a.layers,a.availableImages,n,r,o,(A,R,k,P=0)=>(I||(I=ia(A,this.tileID.canonical,t.tileTransform)),R.queryIntersectsFeature(u,A,k,I,this.z,t.transform,t.pixelPosMatrix,_,P)))}return v}loadMatchingFeature(t,n,r,o,a,c,u,d,p){const{featureIndex:m,bucketIndex:_,sourceLayerIndex:v,layoutVertexArrayOffset:x}=n,w=this.bucketLayerIDs[_];if(o&&!function(A,R){for(let k=0;k<A.length;k++)if(R.indexOf(A[k])>=0)return!0;return!1}(o,w))return;const T=this.sourceLayerCoder.decode(v),S=this.vtLayers[T].feature(m);if(r.needGeometry){const A=Cl(S,!0);if(!r.filter(new fr(this.tileID.overscaledZ),A,this.tileID.canonical))return}else if(!r.filter(new fr(this.tileID.overscaledZ),S))return;const I=this.getId(S,T);for(let A=0;A<w.length;A++){const R=w[A];if(o&&o.indexOf(R)<0)continue;const k=c[R];if(!k)continue;let P={};I!==void 0&&d&&(P=d.getState(k.sourceLayer||"_geojsonTileLayer",I));const O=Ot({},u[R]);O.paint=AA(O.paint,k.paint,S,P,a),O.layout=AA(O.layout,k.layout,S,P,a);const j=!p||p(S,k,P,x);if(!j)continue;const G=new bA(S,this.z,this.x,this.y,I);G.layer=O;let W=t[R];W===void 0&&(W=t[R]=[]),W.push({featureIndex:m,feature:G,intersectionZ:j})}}lookupSymbolFeatures(t,n,r,o,a,c,u,d){const p={};this.loadVTLayers();const m=mm(a);for(const _ of t)this.loadMatchingFeature(p,{bucketIndex:r,sourceLayerIndex:o,featureIndex:_,layoutVertexArrayOffset:0},m,c,u,d,n);return p}loadFeature(t){const{featureIndex:n,sourceLayerIndex:r}=t;this.loadVTLayers();const o=this.sourceLayerCoder.decode(r),a=this.vtFeatures[o];if(a[n])return a[n];const c=this.vtLayers[o].feature(n);return a[n]=c,c}hasLayer(t){for(const n of this.bucketLayerIDs)for(const r of n)if(t===r)return!0;return!1}getId(t,n){let r=t.id;if(this.promoteId){const o=typeof this.promoteId=="string"?this.promoteId:this.promoteId[n];o!=null&&(r=t.properties[o]),typeof r=="boolean"&&(r=Number(r))}return r}}function AA(e,t,n,r,o){return vn(e,(a,c)=>{const u=t instanceof Wd?t.get(c):null;return u&&u.evaluate?u.evaluate(n,r,o):u})}function P6(e,t){return t-e}Te(_1,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const R6=Dn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),k6=Dn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),O6=Dn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Dn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const L6=Dn([{name:"a_z_offset",components:1,type:"Float32"}],4),z6=Dn([{name:"a_texb",components:2,type:"Uint16"}]),D6=Dn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),B6=Dn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);Dn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const PA=Dn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),F6=Dn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Dn([{name:"triangle",components:3,type:"Uint16"}]),Dn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Dn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Dn([{type:"Float32",name:"offsetX"}]),Dn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var pi=24;const zs=128;function y1(e,t){const{expression:n}=t;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new fr(e+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:r,interpolationType:o}=n;let a=0;for(;a<r.length&&r[a]<=e;)a++;a=Math.max(0,a-1);let c=a;for(;c<r.length&&r[c]<e+1;)c++;c=Math.min(r.length-1,c);const u=r[a],d=r[c];return n.kind==="composite"?{kind:"composite",minZoom:u,maxZoom:d,interpolationType:o}:{kind:"camera",minZoom:u,maxZoom:d,minSize:n.evaluate(new fr(u)),maxSize:n.evaluate(new fr(d)),interpolationType:o}}}function af(e,{uSize:t,uSizeT:n},{lowerSize:r,upperSize:o}){return e.kind==="source"?r/zs:e.kind==="composite"?Xe(r/zs,o/zs,n):t}function oa(e,t){let n=0,r=0;if(e.kind==="constant")r=e.layoutSize;else if(e.kind!=="source"){const{interpolationType:o,minZoom:a,maxZoom:c}=e,u=o?jt(ta.interpolationFactor(o,t,a,c),0,1):0;e.kind==="camera"?r=Xe(e.minSize,e.maxSize,u):n=u}return{uSizeT:n,uSize:r}}var N6=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:zs,evaluateSizeForFeature:af,evaluateSizeForZoom:oa,getSizeData:y1});function j6(e,t,n){return e.sections.forEach(r=>{r.text=function(o,a,c){const u=a.layout.get("text-transform").evaluate(c,{});return u==="uppercase"?o=o.toLocaleUpperCase():u==="lowercase"&&(o=o.toLocaleLowerCase()),cs.applyArabicShaping&&(o=cs.applyArabicShaping(o)),o}(r.text,t,n)}),e}const lf={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function U6(e){return e===""||e===""||e===""||e===""||e===""||e===""||e===""||e===""||e===""||e===""||e===""||e===""||e===""||e===""||e===""||e===""||e===""}function $6(e){return e===""||e===""||e===""||e===""||e===""||e===""||e===""||e===""||e===""||e===""}const v1=3;function V6(e,t,n){t.glyphs=[],e===1&&n.readMessage(G6,t)}function G6(e,t,n){if(e===3){const{id:r,bitmap:o,width:a,height:c,left:u,top:d,advance:p}=n.readMessage(W6,{});t.glyphs.push({id:r,bitmap:new Ua({width:a+2*v1,height:c+2*v1},o),metrics:{width:a,height:c,left:u,top:d,advance:p}})}else e===4?t.ascender=n.readSVarint():e===5&&(t.descender=n.readSVarint())}function W6(e,t,n){e===1?t.id=n.readVarint():e===2?t.bitmap=n.readBytes():e===3?t.width=n.readVarint():e===4?t.height=n.readVarint():e===5?t.left=n.readSVarint():e===6?t.top=n.readSVarint():e===7&&(t.advance=n.readVarint())}const RA=v1,ur={horizontal:1,vertical:2,horizontalOnly:3},kA=-17;class cf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,n){const r=new cf;return r.scale=t||1,r.fontStack=n,r}static forImage(t){const n=new cf;return n.imageName=t,n}}class ih{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,n){const r=new ih;for(let o=0;o<t.sections.length;o++){const a=t.sections[o];a.image?r.addImageSection(a):r.addTextSection(a,n)}return r}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(n,r){let o="";for(let a=0;a<n.length;a++){const c=n.charCodeAt(a+1)||null,u=n.charCodeAt(a-1)||null;o+=!r&&(c&&UC(c)&&!lf[n[a+1]]||u&&UC(u)&&!lf[n[a-1]])||!lf[n[a]]?n[a]:lf[n[a]]}return o}(this.text,t)}trim(){let t=0;for(let r=0;r<this.text.length&&ig[this.text.charCodeAt(r)];r++)t++;let n=this.text.length;for(let r=this.text.length-1;r>=0&&r>=t&&ig[this.text.charCodeAt(r)];r--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)}substring(t,n){const r=new ih;return r.text=this.text.substring(t,n),r.sectionIndex=this.sectionIndex.slice(t,n),r.sections=this.sections,r}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,n)=>Math.max(t,this.sections[n].scale),0)}addTextSection(t,n){this.text+=t.text,this.sections.push(cf.forText(t.scale,t.fontStack||n));const r=this.sections.length-1;for(let o=0;o<t.text.length;++o)this.sectionIndex.push(r)}addImageSection(t){const n=t.image?t.image.namePrimary:"";if(n.length===0)return void dt("Can't add FormattedSection with an empty image.");const r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCodePoint(r),this.sections.push(cf.forImage(n)),this.sectionIndex.push(this.sections.length-1)):dt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function x1(e,t,n,r,o,a,c,u,d,p,m,_,v,x,w){const T=ih.fromFeature(e,o);_===ur.vertical&&T.verticalizePunctuation(v);let S=[];const I=function(O,j,G,W,Z,K){if(!O)return[];const Q=[],at=function(vt,ht,pt,Ct,At,It){let zt=0;for(let Ft=0;Ft<vt.length();Ft++){const Ut=vt.getSection(Ft);zt+=OA(vt.getCodePoint(Ft),Ut,Ct,At,ht,It)}return zt/Math.max(1,Math.ceil(zt/pt))}(O,j,G,W,Z,K),X=O.text.indexOf("")>=0;let ft=0;for(let vt=0;vt<O.length();vt++){const ht=O.getSection(vt),pt=O.getCodePoint(vt);if(ig[pt]||(ft+=OA(pt,ht,W,Z,j,K)),vt<O.length()-1){const Ct=!((gt=pt)<11904||!(Ie["Bopomofo Extended"](gt)||Ie.Bopomofo(gt)||Ie["CJK Compatibility Forms"](gt)||Ie["CJK Compatibility Ideographs"](gt)||Ie["CJK Compatibility"](gt)||Ie["CJK Radicals Supplement"](gt)||Ie["CJK Strokes"](gt)||Ie["CJK Symbols and Punctuation"](gt)||Ie["CJK Unified Ideographs Extension A"](gt)||Ie["CJK Unified Ideographs"](gt)||Ie["Enclosed CJK Letters and Months"](gt)||Ie["Halfwidth and Fullwidth Forms"](gt)||Ie.Hiragana(gt)||Ie["Ideographic Description Characters"](gt)||Ie["Kangxi Radicals"](gt)||Ie["Katakana Phonetic Extensions"](gt)||Ie.Katakana(gt)||Ie["Vertical Forms"](gt)||Ie["Yi Radicals"](gt)||Ie["Yi Syllables"](gt)));(q6[pt]||Ct||ht.imageName)&&Q.push(zA(vt+1,ft,at,Q,H6(pt,O.getCodePoint(vt+1),Ct&&X),!1))}}var gt;return DA(zA(O.length(),ft,at,Q,0,!0))}(T,p,a,t,r,x),{processBidirectionalText:A,processStyledBidirectionalText:R}=cs;if(A&&T.sections.length===1){const O=A(T.toString(),I);for(const j of O){const G=new ih;G.text=j,G.sections=T.sections;for(let W=0;W<j.length;W++)G.sectionIndex.push(0);S.push(G)}}else if(R){const O=R(T.text,T.sectionIndex,I);for(const j of O){const G=new ih;G.text=j[0],G.sectionIndex=j[1],G.sections=T.sections,S.push(G)}}else S=function(O,j){const G=[],W=O.text;let Z=0;for(const K of j)G.push(O.substring(Z,K)),Z=K;return Z<W.length&&G.push(O.substring(Z,W.length)),G}(T,I);const k=[],P={positionedLines:k,text:T.toString(),top:m[1],bottom:m[1],left:m[0],right:m[0],writingMode:_,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(O,j,G,W,Z,K,Q,at,X,ft,gt,vt){let ht=0,pt=0,Ct=0;const At=at==="right"?1:at==="left"?0:.5;let It=!1;for(const he of Z){const de=he.getSections();for(const _e of de){if(_e.imageName)continue;const xe=j[_e.fontStack];if(xe&&(It=xe.ascender!==void 0&&xe.descender!==void 0,!It))break}if(!It)break}let zt=0;for(const he of Z){he.trim();const de=he.getMaxScale(),_e=(de-1)*pi,xe={positionedGlyphs:[],lineOffset:0};O.positionedLines[zt]=xe;const He=xe.positionedGlyphs;let Ae=0;if(!he.length()){pt+=K,++zt;continue}let Sn=0,pn=0;for(let We=0;We<he.length();We++){const ze=he.getSection(We),yn=he.getSectionIndex(We),wn=he.getCodePoint(We);let sn=ze.scale,Zn=null,Lr=null,qn=null,rr=pi,Dr=0;const zr=!(X===ur.horizontal||!gt&&!tx(wn)||gt&&(ig[wn]||(Ft=wn,Ie.Arabic(Ft)||Ie["Arabic Supplement"](Ft)||Ie["Arabic Extended-A"](Ft)||Ie["Arabic Presentation Forms-A"](Ft)||Ie["Arabic Presentation Forms-B"](Ft))));if(ze.imageName){const sr=W[ze.imageName];if(!sr)continue;qn=ze.imageName,O.iconsInText=O.iconsInText||!0,Lr=sr.paddedRect;const jn=sr.displaySize;sn=sn*pi/vt,Zn={width:jn[0],height:jn[1],left:0,top:-RA,advance:zr?jn[1]:jn[0],localGlyph:!1},Dr=It?-Zn.height*sn:kA+de*pi-jn[1]*sn,rr=Zn.advance;const bi=(zr?jn[0]:jn[1])*sn-pi*de;bi>0&&bi>Ae&&(Ae=bi)}else{const sr=G[ze.fontStack];if(!sr)continue;sr[wn]&&(Lr=sr[wn]);const jn=j[ze.fontStack];if(!jn)continue;const bi=jn.glyphs[wn];if(!bi)continue;if(Zn=bi.metrics,rr=wn!==8203?pi:0,It){const ha=jn.ascender!==void 0?Math.abs(jn.ascender):0,Ga=jn.descender!==void 0?Math.abs(jn.descender):0,Wa=(ha+Ga)*sn;Sn<Wa&&(Sn=Wa,pn=(ha-Ga)/2*sn),Dr=-ha*sn}else Dr=kA+(de-sn)*pi}zr?(O.verticalizable=!0,He.push({glyph:wn,imageName:qn,x:ht,y:pt+Dr,vertical:zr,scale:sn,localGlyph:Zn.localGlyph,fontStack:ze.fontStack,sectionIndex:yn,metrics:Zn,rect:Lr}),ht+=rr*sn+ft):(He.push({glyph:wn,imageName:qn,x:ht,y:pt+Dr,vertical:zr,scale:sn,localGlyph:Zn.localGlyph,fontStack:ze.fontStack,sectionIndex:yn,metrics:Zn,rect:Lr}),ht+=Zn.advance*sn+ft)}He.length!==0&&(Ct=Math.max(ht-ft,Ct),It?BA(He,At,Ae,pn,K*de/2):BA(He,At,Ae,0,K/2)),ht=0;const Ze=K*de+Ae;xe.lineOffset=Math.max(Ae,_e),pt+=Ze,++zt}var Ft;const Ut=pt,{horizontalAlign:Pt,verticalAlign:Ht}=og(Q);(function(he,de,_e,xe,He,Ae){const Sn=(de-_e)*He,pn=-Ae*xe;for(const Ze of he)for(const We of Ze.positionedGlyphs)We.x+=Sn,We.y+=pn})(O.positionedLines,At,Pt,Ht,Ct,Ut),O.top+=-Ht*Ut,O.bottom=O.top+Ut,O.left+=-Pt*Ct,O.right=O.left+Ct,O.hasBaseline=It}(P,t,n,r,S,c,u,d,_,p,v,w),!function(O){for(const j of O)if(j.positionedGlyphs.length!==0)return!1;return!0}(k)&&P}const ig={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},q6={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function OA(e,t,n,r,o,a){if(t.imageName){const c=r[t.imageName];return c?c.displaySize[0]*t.scale*pi/a+o:0}{const c=n[t.fontStack],u=c&&c.glyphs[e];return u?u.metrics.advance*t.scale+o:0}}function LA(e,t,n,r){const o=Math.pow(e-t,2);return r?e<t?o/2:2*o:o+Math.abs(n)*n}function H6(e,t,n){let r=0;return e===10&&(r-=1e4),n&&(r+=150),e!==40&&e!==65288||(r+=50),t!==41&&t!==65289||(r+=50),r}function zA(e,t,n,r,o,a){let c=null,u=LA(t,n,o,a);for(const d of r){const p=LA(t-d.x,n,o,a)+d.badness;p<=u&&(c=d,u=p)}return{index:e,x:t,priorBreak:c,badness:u}}function DA(e){return e?DA(e.priorBreak).concat(e.index):[]}function og(e){let t=.5,n=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function BA(e,t,n,r,o){if(!(t||n||r||o))return;const a=e.length-1,c=e[a],u=(c.x+c.metrics.advance*c.scale)*t;for(let d=0;d<=a;d++)e[d].x-=u,e[d].y+=n+r+o}function Z6(e,t,n,r){const{horizontalAlign:o,verticalAlign:a}=og(r),c=n[0]-e.displaySize[0]*o,u=n[1]-e.displaySize[1]*a;return{imagePrimary:e,imageSecondary:t,top:u,bottom:u+e.displaySize[1],left:c,right:c+e.displaySize[0]}}function FA(e,t,n,r,o,a){const c=e.imagePrimary;let u;if(c.content){const S=c.content,I=c.pixelRatio||1;u=[S[0]/I,S[1]/I,c.displaySize[0]-S[2]/I,c.displaySize[1]-S[3]/I]}const d=t.left*a,p=t.right*a;let m,_,v,x;n==="width"||n==="both"?(x=o[0]+d-r[3],_=o[0]+p+r[1]):(x=o[0]+(d+p-c.displaySize[0])/2,_=x+c.displaySize[0]);const w=t.top*a,T=t.bottom*a;return n==="height"||n==="both"?(m=o[1]+w-r[0],v=o[1]+T+r[2]):(m=o[1]+(w+T-c.displaySize[1])/2,v=m+c.displaySize[1]),{imagePrimary:c,imageSecondary:void 0,top:m,right:_,bottom:v,left:x,collisionPadding:u}}class Va extends N{constructor(t,n,r,o,a){super(t,n),this.angle=o,this.z=r,a!==void 0&&(this.segment=a)}clone(){return new Va(this.x,this.y,this.z,this.angle,this.segment)}}function NA(e,t,n,r,o){if(t.segment===void 0)return!0;let a=t,c=t.segment+1,u=0;for(;u>-n/2;){if(c--,c<0)return!1;u-=e[c].dist(a),a=e[c]}u+=e[c].dist(e[c+1]),c++;const d=[];let p=0;for(;u<n/2;){const m=e[c],_=e[c+1];if(!_)return!1;let v=e[c-1].angleTo(m)-m.angleTo(_);for(v=Math.abs((v+3*Math.PI)%(2*Math.PI)-Math.PI),d.push({distance:u,angleDelta:v}),p+=v;u-d[0].distance>r;)p-=d.shift().angleDelta;if(p>o)return!1;c++,u+=m.dist(_)}return!0}function jA(e){let t=0;for(let n=0;n<e.length-1;n++)t+=e[n].dist(e[n+1]);return t}function UA(e,t,n){return e?.6*t*n:0}function $A(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function X6(e,t,n,r,o,a){const c=UA(n,o,a),u=$A(n,r)*a;let d=0;const p=jA(e)/2;for(let m=0;m<e.length-1;m++){const _=e[m],v=e[m+1],x=_.dist(v);if(d+x>p){const w=(p-d)/x,T=Xe(_.x,v.x,w),S=Xe(_.y,v.y,w),I=new Va(T,S,0,v.angleTo(_),m);return!c||NA(e,I,u,c,t)?I:void 0}d+=x}}function K6(e,t,n,r,o,a,c,u,d){const p=UA(r,a,c),m=$A(r,o),_=m*c,v=e[0].x===0||e[0].x===d||e[0].y===0||e[0].y===d;return t-_<t/4&&(t=_+t/4),VA(e,v?t/2*u%t:(m/2+2*a)*c*u%t,t,p,n,_,v,!1,d)}function VA(e,t,n,r,o,a,c,u,d){const p=a/2,m=jA(e);let _=0,v=t-n,x=[];for(let w=0;w<e.length-1;w++){const T=e[w],S=e[w+1],I=T.dist(S),A=S.angleTo(T);for(;v+n<_+I;){v+=n;const R=(v-_)/I,k=Xe(T.x,S.x,R),P=Xe(T.y,S.y,R);if(k>=0&&k<d&&P>=0&&P<d&&v-p>=0&&v+p<=m){const O=new Va(k,P,0,A,w);r&&!NA(e,O,a,r,o)||x.push(O)}}_+=I}return u||x.length||c||(x=VA(e,_/2,n,r,o,a,c,!0,d)),x}function GA(e,t,n,r,o){const a=[];for(let c=0;c<e.length;c++){const u=e[c];let d;for(let p=0;p<u.length-1;p++){let m=u[p],_=u[p+1];m.x<t&&_.x<t||(m.x<t?m=new N(t,m.y+(t-m.x)/(_.x-m.x)*(_.y-m.y))._round():_.x<t&&(_=new N(t,m.y+(t-m.x)/(_.x-m.x)*(_.y-m.y))._round()),m.y<n&&_.y<n||(m.y<n?m=new N(m.x+(n-m.y)/(_.y-m.y)*(_.x-m.x),n)._round():_.y<n&&(_=new N(m.x+(n-m.y)/(_.y-m.y)*(_.x-m.x),n)._round()),m.x>=r&&_.x>=r||(m.x>=r?m=new N(r,m.y+(r-m.x)/(_.x-m.x)*(_.y-m.y))._round():_.x>=r&&(_=new N(r,m.y+(r-m.x)/(_.x-m.x)*(_.y-m.y))._round()),m.y>=o&&_.y>=o||(m.y>=o?m=new N(m.x+(o-m.y)/(_.y-m.y)*(_.x-m.x),o)._round():_.y>=o&&(_=new N(m.x+(o-m.y)/(_.y-m.y)*(_.x-m.x),o)._round()),d&&m.equals(d[d.length-1])||(d=[m],a.push(d)),d.push(_)))))}}return a}function b1(e){let t=0,n=0;for(const c of e)t+=c.w*c.h,n=Math.max(n,c.w);e.sort((c,u)=>u.h-c.h);const r=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let o=0,a=0;for(const c of e)for(let u=r.length-1;u>=0;u--){const d=r[u];if(!(c.w>d.w||c.h>d.h)){if(c.x=d.x,c.y=d.y,a=Math.max(a,c.y+c.h),o=Math.max(o,c.x+c.w),c.w===d.w&&c.h===d.h){const p=r.pop();u<r.length&&(r[u]=p)}else c.h===d.h?(d.x+=c.w,d.w-=c.w):c.w===d.w?(d.y+=c.h,d.h-=c.h):(r.push({x:d.x+c.w,y:d.y,w:d.w-c.w,h:c.h}),d.y+=c.h,d.h-=c.h);break}}return{w:o,h:a,fill:t/(o*a)||0}}Te(Va,"Anchor");const Eo=1;class w1{constructor(t,{pixelRatio:n,version:r,stretchX:o,stretchY:a,content:c}){this.paddedRect=t,this.pixelRatio=n,this.stretchX=o,this.stretchY=a,this.content=c,this.version=r}get tl(){return[this.paddedRect.x+Eo,this.paddedRect.y+Eo]}get br(){return[this.paddedRect.x+this.paddedRect.w-Eo,this.paddedRect.y+this.paddedRect.h-Eo]}get displaySize(){return[(this.paddedRect.w-2*Eo)/this.pixelRatio,(this.paddedRect.h-2*Eo)/this.pixelRatio]}}class WA{constructor(t,n){const r={},o={};this.haveRenderCallbacks=[];const a=[];this.addImages(t,r,a),this.addImages(n,o,a);const{w:c,h:u}=b1(a),d=new jr({width:c||1,height:u||1});for(const p in t){const m=t[p],_=r[p].paddedRect;jr.copy(m.data,d,{x:0,y:0},{x:_.x+Eo,y:_.y+Eo},m.data)}for(const p in n){const m=n[p],_=o[p].paddedRect,v=_.x+Eo,x=_.y+Eo,w=m.data.width,T=m.data.height;jr.copy(m.data,d,{x:0,y:0},{x:v,y:x},m.data),jr.copy(m.data,d,{x:0,y:T-1},{x:v,y:x-1},{width:w,height:1}),jr.copy(m.data,d,{x:0,y:0},{x:v,y:x+T},{width:w,height:1}),jr.copy(m.data,d,{x:w-1,y:0},{x:v-1,y:x},{width:1,height:T}),jr.copy(m.data,d,{x:0,y:0},{x:v+w,y:x},{width:1,height:T})}this.image=d,this.iconPositions=r,this.patternPositions=o}addImages(t,n,r){for(const o in t){const a=t[o],c={x:0,y:0,w:a.data.width+2*Eo,h:a.data.height+2*Eo};r.push(c),n[o]=new w1(c,a),a.hasRenderCallback&&this.haveRenderCallbacks.push(o)}}patchUpdatedImages(t,n,r){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(o=>t.hasImage(o,r)),t.dispatchRenderCallbacks(this.haveRenderCallbacks,r);for(const o in t.getUpdatedImages(r))this.patchUpdatedImage(this.iconPositions[o],t.getImage(o,r),n),this.patchUpdatedImage(this.patternPositions[o],t.getImage(o,r),n)}patchUpdatedImage(t,n,r){if(!t||!n||t.version===n.version)return;t.version=n.version;const[o,a]=t.tl;r.update(n.data,void 0,{x:o,y:a})}}Te(w1,"ImagePosition"),Te(WA,"ImageAtlas");const uf=1e20;function qA(e,t,n,r,o,a,c,u,d){for(let p=t;p<t+r;p++)HA(e,n*a+p,a,o,c,u,d);for(let p=n;p<n+o;p++)HA(e,p*a+t,1,r,c,u,d)}function HA(e,t,n,r,o,a,c){a[0]=0,c[0]=-uf,c[1]=uf,o[0]=e[t];for(let u=1,d=0,p=0;u<r;u++){o[u]=e[t+u*n];const m=u*u;do{const _=a[d];p=(o[u]-o[_]+m-_*_)/(u-_)/2}while(p<=c[d]&&--d>-1);d++,a[d]=u,c[d]=p,c[d+1]=uf}for(let u=0,d=0;u<r;u++){for(;c[d+1]<u;)d++;const p=a[d],m=u-p;e[t+u*n]=o[p]+m*m}}const Ds=2;class oh{constructor(t,n,r){this.requestManager=t,this.localGlyphMode=n,this.localFontFamily=r,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,n){this.urls[n]=t}getGlyphs(t,n,r){const o=[],a=this.urls[n]||z.GLYPHS_URL;for(const c in t)for(const u of t[c])o.push({stack:c,id:u});kt(o,({stack:c,id:u},d)=>{let p=this.entries[c];p||(p=this.entries[c]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let m=p.glyphs[u];if(m!==void 0)return void d(null,{stack:c,id:u,glyph:m});if(m=this._tinySDF(p,c,u),m)return p.glyphs[u]=m,void d(null,{stack:c,id:u,glyph:m});const _=Math.floor(u/256);if(256*_>65535)return void d(new Error("glyphs > 65535 not supported"));if(p.ranges[_])return void d(null,{stack:c,id:u,glyph:m});let v=p.requests[_];v||(v=p.requests[_]=[],oh.loadGlyphRange(c,_,a,this.requestManager,(x,w)=>{if(w){p.ascender=w.ascender,p.descender=w.descender;for(const T in w.glyphs)this._doesCharSupportLocalGlyph(+T)||(p.glyphs[+T]=w.glyphs[+T]);p.ranges[_]=!0}for(const T of v)T(x,w);delete p.requests[_]})),v.push((x,w)=>{x?d(x):w&&d(null,{stack:c,id:u,glyph:w.glyphs[u]||null})})},(c,u)=>{if(c)r(c);else if(u){const d={};for(const{stack:p,id:m,glyph:_}of u)d[p]===void 0&&(d[p]={}),d[p].glyphs===void 0&&(d[p].glyphs={}),d[p].glyphs[m]=_&&{id:_.id,bitmap:_.bitmap.clone(),metrics:_.metrics},d[p].ascender=this.entries[p].ascender,d[p].descender=this.entries[p].descender;r(null,d)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==0&&(this.localGlyphMode===2?!!this.localFontFamily:!!this.localFontFamily&&(Ie["CJK Unified Ideographs"](t)||Ie["Hangul Syllables"](t)||Ie.Hiragana(t)||Ie.Katakana(t)||Ie["CJK Symbols and Punctuation"](t)||Ie["CJK Unified Ideographs Extension A"](t)||Ie["CJK Unified Ideographs Extension B"](t)))}_tinySDF(t,n,r){const o=this.localFontFamily;if(!o||!this._doesCharSupportLocalGlyph(r))return;let a=t.tinySDF;if(!a){let T="400";/bold/i.test(n)?T="900":/medium/i.test(n)?T="500":/light/i.test(n)&&(T="200"),a=t.tinySDF=new oh.TinySDF({fontFamily:o,fontWeight:T,fontSize:24*Ds,buffer:3*Ds,radius:8*Ds}),a.fontWeight=T}if(this.localGlyphs[a.fontWeight][r])return this.localGlyphs[a.fontWeight][r];const c=String.fromCodePoint(r),{data:u,width:d,height:p,glyphWidth:m,glyphHeight:_,glyphLeft:v,glyphTop:x,glyphAdvance:w}=a.draw(c);return this.localGlyphs[a.fontWeight][r]={id:r,bitmap:new Ua({width:d,height:p},u),metrics:{width:m/Ds,height:_/Ds,left:v/Ds,top:x/Ds-27,advance:w/Ds,localGlyph:!0}}}}oh.loadGlyphRange=function(e,t,n,r,o){const a=256*t,c=a+255,u=r.transformRequest(r.normalizeGlyphsURL(n).replace("{fontstack}",e).replace("{range}",`${a}-${c}`),Dt.Glyphs);le(u,(d,p)=>{if(d)o(d);else if(p){const m={},_=function(v){return new ng(v).readFields(V6,{})}(p);for(const v of _.glyphs)m[v.id]=v;o(null,{glyphs:m,ascender:_.ascender,descender:_.descender})}})},oh.TinySDF=class{constructor({fontSize:e=24,buffer:t=3,radius:n=8,cutoff:r=.25,fontFamily:o="sans-serif",fontWeight:a="normal",fontStyle:c="normal"}={}){this.buffer=t,this.cutoff=r,this.radius=n;const u=this.size=e+4*t,d=this._createCanvas(u),p=this.ctx=d.getContext("2d",{willReadFrequently:!0});p.font=`${c} ${a} ${e}px ${o}`,p.textBaseline="alphabetic",p.textAlign="left",p.fillStyle="black",this.gridOuter=new Float64Array(u*u),this.gridInner=new Float64Array(u*u),this.f=new Float64Array(u),this.z=new Float64Array(u+1),this.v=new Uint16Array(u)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:n,actualBoundingBoxDescent:r,actualBoundingBoxLeft:o,actualBoundingBoxRight:a}=this.ctx.measureText(e),c=Math.ceil(n),u=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(a-o))),d=Math.min(this.size-this.buffer,c+Math.ceil(r)),p=u+2*this.buffer,m=d+2*this.buffer,_=Math.max(p*m,0),v=new Uint8ClampedArray(_),x={data:v,width:p,height:m,glyphWidth:u,glyphHeight:d,glyphTop:c,glyphLeft:0,glyphAdvance:t};if(u===0||d===0)return x;const{ctx:w,buffer:T,gridInner:S,gridOuter:I}=this;w.clearRect(T,T,u,d),w.fillText(e,T,T+c);const A=w.getImageData(T,T,u,d);I.fill(uf,0,_),S.fill(0,0,_);for(let R=0;R<d;R++)for(let k=0;k<u;k++){const P=A.data[4*(R*u+k)+3]/255;if(P===0)continue;const O=(R+T)*p+k+T;if(P===1)I[O]=0,S[O]=uf;else{const j=.5-P;I[O]=j>0?j*j:0,S[O]=j<0?j*j:0}}qA(I,0,0,p,m,p,this.f,this.v,this.z),qA(S,T,T,u,d,p,this.f,this.v,this.z);for(let R=0;R<_;R++){const k=Math.sqrt(I[R])-Math.sqrt(S[R]);v[R]=Math.round(255-255*(k/this.radius+this.cutoff))}return x}};const Al=Eo;function ZA(e,t,n,r){const o=[],a=e.imagePrimary,c=a.pixelRatio,u=a.paddedRect.w-2*Al,d=a.paddedRect.h-2*Al,p=e.right-e.left,m=e.bottom-e.top,_=a.stretchX||[[0,u]],v=a.stretchY||[[0,d]],x=(K,Q)=>K+Q[1]-Q[0],w=_.reduce(x,0),T=v.reduce(x,0),S=u-w,I=d-T;let A=0,R=w,k=0,P=T,O=0,j=S,G=0,W=I;if(a.content&&r){const K=a.content;A=sg(_,0,K[0]),k=sg(v,0,K[1]),R=sg(_,K[0],K[2]),P=sg(v,K[1],K[3]),O=K[0]-A,G=K[1]-k,j=K[2]-K[0]-R,W=K[3]-K[1]-P}const Z=(K,Q,at,X)=>{const ft=ag(K.stretch-A,R,p,e.left),gt=lg(K.fixed-O,j,K.stretch,w),vt=ag(Q.stretch-k,P,m,e.top),ht=lg(Q.fixed-G,W,Q.stretch,T),pt=ag(at.stretch-A,R,p,e.left),Ct=lg(at.fixed-O,j,at.stretch,w),At=ag(X.stretch-k,P,m,e.top),It=lg(X.fixed-G,W,X.stretch,T),zt=new N(ft,vt),Ft=new N(pt,vt),Ut=new N(pt,At),Pt=new N(ft,At),Ht=new N(gt/c,ht/c),he=new N(Ct/c,It/c),de=t*Math.PI/180;if(de){const pn=Math.sin(de),Ze=Math.cos(de),We=[Ze,-pn,pn,Ze];zt._matMult(We),Ft._matMult(We),Pt._matMult(We),Ut._matMult(We)}const _e=K.stretch+K.fixed,xe=at.stretch+at.fixed,He=Q.stretch+Q.fixed,Ae=X.stretch+X.fixed,Sn=e.imageSecondary;return{tl:zt,tr:Ft,bl:Pt,br:Ut,texPrimary:{x:a.paddedRect.x+Al+_e,y:a.paddedRect.y+Al+He,w:xe-_e,h:Ae-He},texSecondary:Sn?{x:Sn.paddedRect.x+Al+_e,y:Sn.paddedRect.y+Al+He,w:xe-_e,h:Ae-He}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ht,pixelOffsetBR:he,minFontScaleX:j/c/p,minFontScaleY:W/c/m,isSDF:n}};if(r&&(a.stretchX||a.stretchY)){const K=XA(_,S,w),Q=XA(v,I,T);for(let at=0;at<K.length-1;at++){const X=K[at],ft=K[at+1];for(let gt=0;gt<Q.length-1;gt++)o.push(Z(X,Q[gt],ft,Q[gt+1]))}}else o.push(Z({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:u+1},{fixed:0,stretch:d+1}));return o}function sg(e,t,n){let r=0;for(const o of e)r+=Math.max(t,Math.min(n,o[1]))-Math.max(t,Math.min(n,o[0]));return r}function XA(e,t,n){const r=[{fixed:-Al,stretch:0}];for(const[o,a]of e){const c=r[r.length-1];r.push({fixed:o-c.stretch,stretch:c.stretch}),r.push({fixed:o-c.stretch,stretch:c.stretch+(a-o)})}return r.push({fixed:t+Al,stretch:n}),r}function ag(e,t,n,r){return e/t*n+r}function lg(e,t,n,r){return e-t*n/r}function Y6(e,t,n,r){const o=t+e.positionedLines[r].lineOffset;return r===0?n+o/2:n+(o+(t+e.positionedLines[r-1].lineOffset))/2}function Q6(e,t=1,n=!1){let r=1/0,o=1/0,a=-1/0,c=-1/0;const u=e[0];for(let x=0;x<u.length;x++){const w=u[x];(!x||w.x<r)&&(r=w.x),(!x||w.y<o)&&(o=w.y),(!x||w.x>a)&&(a=w.x),(!x||w.y>c)&&(c=w.y)}const d=Math.min(a-r,c-o);let p=d/2;const m=new pv([],J6);if(d===0)return new N(r,o);for(let x=r;x<a;x+=d)for(let w=o;w<c;w+=d)m.push(new sh(x+p,w+p,p,e));let _=function(x){let w=0,T=0,S=0;const I=x[0];for(let A=0,R=I.length,k=R-1;A<R;k=A++){const P=I[A],O=I[k],j=P.x*O.y-O.x*P.y;T+=(P.x+O.x)*j,S+=(P.y+O.y)*j,w+=3*j}return new sh(T/w,S/w,0,x)}(e),v=m.length;for(;m.length;){const x=m.pop();(x.d>_.d||!_.d)&&(_=x,n&&console.log("found best %d after %d probes",Math.round(1e4*x.d)/1e4,v)),x.max-_.d<=t||(p=x.h/2,m.push(new sh(x.p.x-p,x.p.y-p,p,e)),m.push(new sh(x.p.x+p,x.p.y-p,p,e)),m.push(new sh(x.p.x-p,x.p.y+p,p,e)),m.push(new sh(x.p.x+p,x.p.y+p,p,e)),v+=4)}return n&&(console.log(`num probes: ${v}`),console.log(`best distance: ${_.d}`)),_.p}function J6(e,t){return t.max-e.max}class sh{constructor(t,n,r,o){this.p=new N(t,n),this.h=r,this.d=function(a,c){let u=!1,d=1/0;for(let p=0;p<c.length;p++){const m=c[p];for(let _=0,v=m.length,x=v-1;_<v;x=_++){const w=m[_],T=m[x];w.y>a.y!=T.y>a.y&&a.x<(T.x-w.x)*(a.y-w.y)/(T.y-w.y)+w.x&&(u=!u),d=Math.min(d,KI(a,w,T))}}return(u?1:-1)*Math.sqrt(d)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}}const ah=7,T1=Number.POSITIVE_INFINITY,tj=Math.sqrt(2);function S1(e,[t,n]){let r=0,o=0;if(n===T1){t<0&&(t=0);const a=t/tj;switch(e){case"top-right":case"top-left":o=a-ah;break;case"bottom-right":case"bottom-left":o=-a+ah;break;case"bottom":o=-t+ah;break;case"top":o=t-ah}switch(e){case"top-right":case"bottom-right":r=-a;break;case"top-left":case"bottom-left":r=a;break;case"left":r=t;break;case"right":r=-t}}else{switch(t=Math.abs(t),n=Math.abs(n),e){case"top-right":case"top-left":case"top":o=n-ah;break;case"bottom-right":case"bottom-left":case"bottom":o=-n+ah}switch(e){case"top-right":case"bottom-right":case"right":r=-t;break;case"top-left":case"bottom-left":case"left":r=t}}return[r,o]}function ej(e,t,n,r,o,a,c,u,d,p,m){e.createArrays(),e.tilePixelRatio=Rt/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;const _=e.layers[0].layout,v=e.layers[0]._unevaluatedLayout._values,x={};if(e.textSizeData.kind==="composite"){const{minZoom:I,maxZoom:A}=e.textSizeData;x.compositeTextSizes=[v["text-size"].possiblyEvaluate(new fr(I),u),v["text-size"].possiblyEvaluate(new fr(A),u)]}if(e.iconSizeData.kind==="composite"){const{minZoom:I,maxZoom:A}=e.iconSizeData;x.compositeIconSizes=[v["icon-size"].possiblyEvaluate(new fr(I),u),v["icon-size"].possiblyEvaluate(new fr(A),u)]}x.layoutTextSize=v["text-size"].possiblyEvaluate(new fr(d+1),u),x.layoutIconSize=v["icon-size"].possiblyEvaluate(new fr(d+1),u),x.textMaxSize=v["text-size"].possiblyEvaluate(new fr(18),u);const w=_.get("text-rotation-alignment")==="map"&&_.get("symbol-placement")!=="point",T=_.get("text-size");let S=!1;for(const I of e.features)if(I.icon&&I.icon.nameSecondary){S=!0;break}for(const I of e.features){const A=_.get("text-font").evaluate(I,{},u).join(","),R=T.evaluate(I,{},u),k=x.layoutTextSize.evaluate(I,{},u),P=(x.layoutIconSize.evaluate(I,{},u),{horizontal:{},vertical:void 0}),O=I.text;let j,G=[0,0];if(O){const K=O.toString(),Q=_.get("text-letter-spacing").evaluate(I,{},u)*pi,at=_.get("text-line-height").evaluate(I,{},u)*pi,X=IF(K)?Q:0,ft=_.get("text-anchor").evaluate(I,{},u),gt=_.get("text-variable-anchor");if(!gt){const At=_.get("text-radial-offset").evaluate(I,{},u);G=At?S1(ft,[At*pi,T1]):_.get("text-offset").evaluate(I,{},u).map(It=>It*pi)}let vt=w?"center":_.get("text-justify").evaluate(I,{},u);const ht=_.get("symbol-placement")==="point",pt=ht?_.get("text-max-width").evaluate(I,{},u)*pi:1/0,Ct=At=>{e.allowVerticalPlacement&&Jv(K)&&(P.vertical=x1(O,t,n,o,A,pt,at,ft,At,X,G,ur.vertical,!0,k,R))};if(!w&&gt){const At=vt==="auto"?gt.map(zt=>E1(zt)):[vt];let It=!1;for(let zt=0;zt<At.length;zt++){const Ft=At[zt];if(!P.horizontal[Ft])if(It)P.horizontal[Ft]=P.horizontal[0];else{const Ut=x1(O,t,n,o,A,pt,at,"center",Ft,X,G,ur.horizontal,!1,k,R);Ut&&(P.horizontal[Ft]=Ut,It=Ut.positionedLines.length===1)}}Ct("left")}else{if(vt==="auto"&&(vt=E1(ft)),ht||_.get("text-writing-mode").indexOf("horizontal")>=0||!Jv(K)){const At=x1(O,t,n,o,A,pt,at,ft,vt,X,G,ur.horizontal,!1,k,R);At&&(P.horizontal[vt]=At)}Ct(ht?"left":vt)}}let W=!1;if(I.icon&&I.icon.namePrimary){const K=r[I.icon.namePrimary];K&&(j=Z6(o[I.icon.namePrimary],I.icon.nameSecondary?o[I.icon.nameSecondary]:void 0,_.get("icon-offset").evaluate(I,{},u),_.get("icon-anchor").evaluate(I,{},u)),W=K.sdf,e.sdfIcons===void 0?e.sdfIcons=K.sdf:e.sdfIcons!==K.sdf&&dt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(K.pixelRatio!==e.pixelRatio||_.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}const Z=YA(P.horizontal)||P.vertical;e.iconsInText||(e.iconsInText=!!Z&&Z.iconsInText),(Z||j)&&nj(e,I,P,j,r,x,k,0,G,W,c,u,p,m,S)}a&&e.generateCollisionDebugBuffers(d,e.collisionBoxArray)}function E1(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function nj(e,t,n,r,o,a,c,u,d,p,m,_,v,x,w){let T=a.textMaxSize.evaluate(t,{},_);T===void 0&&(T=c);const S=e.layers[0].layout,I=S.get("icon-offset").evaluate(t,{},_),A=YA(n.horizontal)||n.vertical,R=v.name==="globe",k=pi,P=c/k,O=e.tilePixelRatio*T/k,j=(ft=e.overscaling,e.zoom>18&&ft>2&&(ft>>=1),Math.max(Rt/(512*ft),1)*S.get("symbol-spacing")),G=S.get("text-padding")*e.tilePixelRatio,W=S.get("icon-padding")*e.tilePixelRatio,Z=it(S.get("text-max-angle")),K=S.get("text-rotation-alignment")==="map"&&S.get("symbol-placement")!=="point",Q=S.get("icon-rotation-alignment")==="map"&&S.get("symbol-placement")!=="point",at=S.get("symbol-placement"),X=j/2;var ft;const gt=S.get("icon-text-fit").evaluate(t,{},_),vt=S.get("icon-text-fit-padding").evaluate(t,{},_),ht=gt!=="none";let pt;e.hasAnyIconTextFit===!1&&ht&&(e.hasAnyIconTextFit=!0),r&&ht&&(e.allowVerticalPlacement&&n.vertical&&(pt=FA(r,n.vertical,gt,vt,I,P)),A&&(r=FA(r,A,gt,vt,I,P)));const Ct=(At,It,zt)=>{if(It.x<0||It.x>=Rt||It.y<0||It.y>=Rt)return;let Ft=null;if(R){const{x:Ut,y:Pt,z:Ht}=v.projectTilePoint(It.x,It.y,zt);Ft={anchor:new Va(Ut,Pt,Ht,0,void 0),up:v.upVector(zt,It.x,It.y)}}(function(Ut,Pt,Ht,he,de,_e,xe,He,Ae,Sn,pn,Ze,We,ze,yn,wn,sn,Zn,Lr,qn,rr,Dr,zr,sr,jn,bi,ha){const Ga=Ut.addToLineVertexArray(Pt,he);let Wa,kf,Of,r_,rO,iO,oO,sO=0,aO=0,lO=0,cO=0,Eb=-1,Cb=-1;const da={};let uO=Sx("");const Uc=Ht?Ht.anchor:Pt,Mb=Ae.layout.get("icon-text-fit").evaluate(rr,{},jn)!=="none";let Ib=0,Ab=0;if(Ae._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Ib,Ab]=Ae.layout.get("text-offset").evaluate(rr,{},jn).map(Mo=>Mo*pi):(Ib=Ae.layout.get("text-radial-offset").evaluate(rr,{},jn)*pi,Ab=T1),Ut.allowVerticalPlacement&&de.vertical){const Mo=de.vertical;if(yn)iO=C1(Mo),He&&(oO=C1(He));else{const Io=Ae.layout.get("text-rotate").evaluate(rr,{},jn)+90;Of=cg(Sn,Uc,Pt,pn,Ze,We,Mo,ze,Io,wn),He&&(r_=cg(Sn,Uc,Pt,pn,Ze,We,He,Zn,Io))}}if(_e){const Mo=Ae.layout.get("icon-rotate").evaluate(rr,{},jn),Io=ZA(_e,Mo,zr,Mb),yh=He?ZA(He,Mo,zr,Mb):void 0;kf=cg(Sn,Uc,Pt,pn,Ze,We,_e,Zn,Mo),sO=4*Io.length;const hO=Ut.iconSizeData;let $c=null;hO.kind==="source"?($c=[zs*Ae.layout.get("icon-size").evaluate(rr,{},jn)],$c[0]>Pl&&dt(`${Ut.layerIds[0]}: Value for "icon-size" is >= ${hf}. Reduce your "icon-size".`)):hO.kind==="composite"&&($c=[zs*Dr.compositeIconSizes[0].evaluate(rr,{},jn),zs*Dr.compositeIconSizes[1].evaluate(rr,{},jn)],($c[0]>Pl||$c[1]>Pl)&&dt(`${Ut.layerIds[0]}: Value for "icon-size" is >= ${hf}. Reduce your "icon-size".`)),Ut.addSymbols(Ut.icon,Io,$c,qn,Lr,rr,!1,Ht,Pt,Ga.lineStartIndex,Ga.lineLength,-1,sr,jn,bi,ha),Eb=Ut.icon.placedSymbolArray.length-1,yh&&(aO=4*yh.length,Ut.addSymbols(Ut.icon,yh,$c,qn,Lr,rr,ur.vertical,Ht,Pt,Ga.lineStartIndex,Ga.lineLength,-1,sr,jn,bi,ha),Cb=Ut.icon.placedSymbolArray.length-1)}for(const Mo in de.horizontal){const Io=de.horizontal[Mo];Wa||(uO=Sx(Io.text),yn?rO=C1(Io):Wa=cg(Sn,Uc,Pt,pn,Ze,We,Io,ze,Ae.layout.get("text-rotate").evaluate(rr,{},jn),wn));const yh=Io.positionedLines.length===1;if(lO+=KA(Ut,Ht,Pt,Io,xe,Ae,yn,rr,wn,Ga,de.vertical?ur.horizontal:ur.horizontalOnly,yh?Object.keys(de.horizontal):[Mo],da,Eb,Dr,sr,jn,bi),yh)break}de.vertical&&(cO+=KA(Ut,Ht,Pt,de.vertical,xe,Ae,yn,rr,wn,Ga,ur.vertical,["vertical"],da,Cb,Dr,sr,jn,bi));let Fl=-1;const Pb=(Mo,Io)=>Mo?Math.max(Mo,Io):Io;Fl=Pb(rO,Fl),Fl=Pb(iO,Fl),Fl=Pb(oO,Fl);const jV=Fl>-1?1:0;Ut.glyphOffsetArray.length>=gf.MAX_GLYPHS&&dt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),rr.sortKey!==void 0&&Ut.addToSortKeyRanges(Ut.symbolInstances.length,rr.sortKey),Ut.symbolInstances.emplaceBack(Pt.x,Pt.y,Uc.x,Uc.y,Uc.z,da.right>=0?da.right:-1,da.center>=0?da.center:-1,da.left>=0?da.left:-1,da.vertical>=0?da.vertical:-1,Eb,Cb,uO,Wa!==void 0?Wa:Ut.collisionBoxArray.length,Wa!==void 0?Wa+1:Ut.collisionBoxArray.length,Of!==void 0?Of:Ut.collisionBoxArray.length,Of!==void 0?Of+1:Ut.collisionBoxArray.length,kf!==void 0?kf:Ut.collisionBoxArray.length,kf!==void 0?kf+1:Ut.collisionBoxArray.length,r_||Ut.collisionBoxArray.length,r_?r_+1:Ut.collisionBoxArray.length,pn,lO,cO,sO,aO,jV,0,Ib,Ab,Fl,0,Mb?1:0)})(e,It,Ft,At,n,r,o,pt,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,G,K,d,0,W,Q,I,t,a,p,m,_,x,w)};if(at==="line")for(const At of GA(t.geometry,0,0,Rt,Rt)){const It=K6(At,j,Z,n.vertical||A,r,k,O,e.overscaling,Rt);for(const zt of It)A&&rj(e,A.text,X,zt)||Ct(At,zt,_)}else if(at==="line-center"){for(const At of t.geometry)if(At.length>1){const It=X6(At,Z,n.vertical||A,r,k,O);It&&Ct(At,It,_)}}else if(t.type==="Polygon")for(const At of d1(t.geometry,0)){const It=Q6(At,16);Ct(At[0],new Va(It.x,It.y,0,0,void 0),_)}else if(t.type==="LineString")for(const At of t.geometry)Ct(At,new Va(At[0].x,At[0].y,0,0,void 0),_);else if(t.type==="Point")for(const At of t.geometry)for(const It of At)Ct([It],new Va(It.x,It.y,0,0,void 0),_)}const hf=255,Pl=hf*zs;function KA(e,t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S,I){const A=function(P,O,j,G,W,Z,K,Q){const at=[];if(O.positionedLines.length===0)return at;const X=G.layout.get("text-rotate").evaluate(Z,{})*Math.PI/180,ft=function(Ct){const At=Ct[0],It=Ct[1],zt=At*It;return zt>0?[At,-It]:zt<0?[-At,It]:At===0?[It,At]:[It,-At]}(j);let gt=Math.abs(O.top-O.bottom);for(const Ct of O.positionedLines)gt-=Ct.lineOffset;const vt=O.positionedLines.length,ht=gt/vt;let pt=O.top-j[1];for(let Ct=0;Ct<vt;++Ct){const At=O.positionedLines[Ct];pt=Y6(O,ht,pt,Ct);for(const It of At.positionedGlyphs){if(!It.rect)continue;const zt=It.rect||{};let Ft=RA+1,Ut=!0,Pt=1,Ht=0;if(It.imageName){const qn=K[It.imageName];if(!qn)continue;if(qn.sdf){dt("SDF images are not supported in formatted text and will be ignored.");continue}Ut=!1,Pt=qn.pixelRatio,Ft=Eo/Pt}const he=(W||Q)&&It.vertical,de=It.metrics.advance*It.scale/2,_e=It.metrics,xe=It.rect;if(xe===null)continue;Q&&O.verticalizable&&(Ht=It.imageName?de-It.metrics.width*It.scale/2:0);const He=W?[It.x+de,It.y]:[0,0];let Ae=[0,0],Sn=[0,0],pn=!1;W||(he?(Sn=[It.x+de+ft[0],It.y+ft[1]-Ht],pn=!0):Ae=[It.x+de+j[0],It.y+j[1]-Ht]);const Ze=xe.w*It.scale/(Pt*(It.localGlyph?Ds:1)),We=xe.h*It.scale/(Pt*(It.localGlyph?Ds:1));let ze,yn,wn,sn;if(he){const qn=It.y-pt,rr=new N(-de,de-qn),Dr=-Math.PI/2,zr=new N(...Sn);ze=new N(-de+Ae[0],Ae[1]),ze._rotateAround(Dr,rr)._add(zr),ze.x+=-qn+de,ze.y-=(_e.left-Ft)*It.scale;const sr=It.imageName?_e.advance*It.scale:pi*It.scale,jn=String.fromCodePoint(It.glyph);U6(jn)?ze.x+=(1-Ft)*It.scale:$6(jn)?ze.x+=sr-_e.height*It.scale+(-Ft-1)*It.scale:ze.x+=It.imageName||_e.width+2*Ft===xe.w&&_e.height+2*Ft===xe.h?(sr-We)/2:(sr-(_e.height+2*Ft)*It.scale)/2,yn=new N(ze.x,ze.y-Ze),wn=new N(ze.x+We,ze.y),sn=new N(ze.x+We,ze.y-Ze)}else{const qn=(_e.left-Ft)*It.scale-de+Ae[0],rr=(-_e.top-Ft)*It.scale+Ae[1],Dr=qn+Ze,zr=rr+We;ze=new N(qn,rr),yn=new N(Dr,rr),wn=new N(qn,zr),sn=new N(Dr,zr)}if(X){let qn;qn=W?new N(0,0):pn?new N(ft[0],ft[1]):new N(j[0],j[1]),ze._rotateAround(X,qn),yn._rotateAround(X,qn),wn._rotateAround(X,qn),sn._rotateAround(X,qn)}const Zn=new N(0,0),Lr=new N(0,0);at.push({tl:ze,tr:yn,bl:wn,br:sn,texPrimary:zt,texSecondary:void 0,writingMode:O.writingMode,glyphOffset:He,sectionIndex:It.sectionIndex,isSDF:Ut,pixelOffsetTL:Zn,pixelOffsetBR:Lr,minFontScaleX:0,minFontScaleY:0})}}return at}(0,r,d,a,c,u,o,e.allowVerticalPlacement),R=e.textSizeData;let k=null;R.kind==="source"?(k=[zs*a.layout.get("text-size").evaluate(u,{},S)],k[0]>Pl&&dt(`${e.layerIds[0]}: Value for "text-size" is >= ${hf}. Reduce your "text-size".`)):R.kind==="composite"&&(k=[zs*w.compositeTextSizes[0].evaluate(u,{},S),zs*w.compositeTextSizes[1].evaluate(u,{},S)],(k[0]>Pl||k[1]>Pl)&&dt(`${e.layerIds[0]}: Value for "text-size" is >= ${hf}. Reduce your "text-size".`)),e.addSymbols(e.text,A,k,d,c,u,m,t,n,p.lineStartIndex,p.lineLength,x,T,S,I,!1);for(const P of _)v[P]=e.text.placedSymbolArray.length-1;return 4*A.length}function YA(e){for(const t in e)return e[t];return null}function cg(e,t,n,r,o,a,c,u,d,p){let m=c.top,_=c.bottom,v=c.left,x=c.right;const w=c.collisionPadding;if(w&&(v-=w[0],m-=w[1],x+=w[2],_+=w[3]),d){const T=new N(v,m),S=new N(x,m),I=new N(v,_),A=new N(x,_),R=it(d);let k=new N(0,0);p&&(k=new N(p[0],p[1])),T._rotateAround(R,k),S._rotateAround(R,k),I._rotateAround(R,k),A._rotateAround(R,k),v=Math.min(T.x,S.x,I.x,A.x),x=Math.max(T.x,S.x,I.x,A.x),m=Math.min(T.y,S.y,I.y,A.y),_=Math.max(T.y,S.y,I.y,A.y)}return e.emplaceBack(t.x,t.y,t.z,n.x,n.y,v,m,x,_,u,r,o,a),e.length-1}function C1(e){e.collisionPadding&&(e.top-=e.collisionPadding[1],e.bottom+=e.collisionPadding[3]);const t=e.bottom-e.top;return t>0?Math.max(10,t):null}function rj(e,t,n,r){const o=e.compareText;if(t in o){const a=o[t];for(let c=a.length-1;c>=0;c--)if(r.dist(a[c])<n)return!0}else o[t]=[];return o[t].push(r),!1}function QA(e,t){const n=e.fovAboveCenter,r=e.elevation?e.elevation.getMinElevationBelowMSL()*t:0,o=(e._camera.position[2]*e.worldSize-r)/Math.cos(e._pitch),a=Math.sin(n)*o/Math.sin(Math.max(Math.PI/2-e._pitch-n,.01)),c=Math.sin(e._pitch)*a+o;return Math.min(1.01*c,o*(1/e._horizonShift))}function Oc(e,t){if(!t.isReprojectedInTileSpace)return{scale:1<<e.z,x:e.x,y:e.y,x2:e.x+1,y2:e.y+1,projection:t};const n=Math.pow(2,-e.z),r=e.x*n,o=(e.x+1)*n,a=e.y*n,c=(e.y+1)*n,u=So(r),d=So(o),p=qr(a),m=qr(c),_=t.project(u,p),v=t.project(d,p),x=t.project(d,m),w=t.project(u,m);let T=Math.min(_.x,v.x,x.x,w.x),S=Math.min(_.y,v.y,x.y,w.y),I=Math.max(_.x,v.x,x.x,w.x),A=Math.max(_.y,v.y,x.y,w.y);const R=n/16;function k(O,j,G,W,Z,K){const Q=(G+Z)/2,at=(W+K)/2,X=t.project(So(Q),qr(at)),ft=Math.max(0,T-X.x,S-X.y,X.x-I,X.y-A);T=Math.min(T,X.x),I=Math.max(I,X.x),S=Math.min(S,X.y),A=Math.max(A,X.y),ft>R&&(k(O,X,G,W,Q,at),k(X,j,Q,at,Z,K))}k(_,v,r,a,o,a),k(v,x,o,a,o,c),k(x,w,o,c,r,c),k(w,_,r,c,r,a),T-=R,S-=R,I+=R,A+=R;const P=1/Math.max(I-T,A-S);return{scale:P,x:T*P,y:S*P,x2:I*P,y2:A*P,projection:t}}function JA(e,t,n,r,o,a,c,u,d){if(d.name==="globe")return Zx(e,t,new hs(n,r,o),!1);const p=Oc({z:n,x:r,y:o},d);return new nr([(a+p.x/p.scale)*t,t*(p.y/p.scale),c],[(a+p.x2/p.scale)*t,t*(p.y2/p.scale),u])}function tP(e,{x:t,y:n},r=0){return new N(((t-r)*e.scale-e.x)*Rt,(n*e.scale-e.y)*Rt)}function eP(e,t,n=0){return ot.fromValues(((t.x-n)*e.scale-e.x)*Rt,(t.y*e.scale-e.y)*Rt,GI(t.z,t.y))}const ij=wt.identity(new Float32Array(16));class Rl{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,n){return{x:0,y:0,z:0}}unproject(t,n){return new Ke(0,0)}projectTilePoint(t,n,r){return{x:t,y:n,z:0}}locationPoint(t,n,r=!0){return t._coordinatePoint(t.locationCoordinate(n),r)}pixelsPerMeter(t,n){return Hn(1,t)*n}pixelSpaceConversion(t,n,r){return 1}farthestPixelDistance(t){return QA(t,t.pixelsPerMeter)}pointCoordinate(t,n,r,o){const a=t.horizonLineFromTop(!1),c=new N(n,Math.max(a,r));return t.rayIntersectionCoordinate(t.pointRayIntersection(c,o))}pointCoordinate3D(t,n,r){const o=new N(n,r);if(t.elevation)return t.elevation.pointCoordinate(o);{const a=this.pointCoordinate(t,o.x,o.y,0);return[a.x,a.y,a.z]}}isPointAboveHorizon(t,n){if(t.elevation)return!this.pointCoordinate3D(t,n.x,n.y);const r=t.horizonLineFromTop();return n.y<r}createInversionMatrix(t,n){return ij}createTileMatrix(t,n,r){let o,a,c;const u=r.canonical,d=wt.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const p=Oc(u,this);o=1,a=p.x+r.wrap*p.scale,c=p.y,wt.scale(d,d,[o/p.scale,o/p.scale,t.pixelsPerMeter/n])}else o=n/t.zoomScale(u.z),a=(u.x+Math.pow(2,u.z)*r.wrap)*o,c=u.y*o;return wt.translate(d,d,[a,c,0]),wt.scale(d,d,[o/Rt,o/Rt,1]),d}upVector(t,n,r){return[0,0,1]}upVectorScale(t,n,r){return{metersToTile:1}}}class oj extends Rl{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[n,r]=this.parallels=t.parallels||[29.5,45.5],o=Math.sin(it(n));this.n=(o+Math.sin(it(r)))/2,this.c=1+o*(2*this.n-o),this.r0=Math.sqrt(this.c)/this.n}project(t,n){const{n:r,c:o,r0:a}=this,c=it(t-this.center[0]),u=it(n),d=Math.sqrt(o-2*r*Math.sin(u))/r;return{x:d*Math.sin(c*r),y:d*Math.cos(c*r)-a,z:0}}unproject(t,n){const{n:r,c:o,r0:a}=this,c=a+n;let u=Math.atan2(t,Math.abs(c))*Math.sign(c);c*r<0&&(u-=Math.PI*Math.sign(t)*Math.sign(c));const d=it(this.center[0])*r;u=we(u,-Math.PI-d,Math.PI-d);const p=jt(Tt(u/r)+this.center[0],-180,180),m=Math.asin(jt((o-(t*t+c*c)*r*r)/(2*r),-1,1)),_=jt(Tt(m),-Or,Or);return new Ke(p,_)}}const df=1.340264,ff=-.081106,pf=893e-6,mf=.003796,ug=Math.sqrt(3)/2;class sj extends Rl{project(t,n){n=n/180*Math.PI,t=t/180*Math.PI;const r=Math.asin(ug*Math.sin(n)),o=r*r,a=o*o*o;return{x:.5*(t*Math.cos(r)/(ug*(df+3*ff*o+a*(7*pf+9*mf*o)))/Math.PI+.5),y:1-.5*(r*(df+ff*o+a*(pf+mf*o))/Math.PI+1),z:0}}unproject(t,n){t=(2*t-.5)*Math.PI;let r=n=(2*(1-n)-1)*Math.PI,o=r*r,a=o*o*o;for(let m,_,v,x=0;x<12&&(_=r*(df+ff*o+a*(pf+mf*o))-n,v=df+3*ff*o+a*(7*pf+9*mf*o),m=_/v,r=jt(r-m,-Math.PI/3,Math.PI/3),o=r*r,a=o*o*o,!(Math.abs(m)<1e-12));++x);const c=ug*t*(df+3*ff*o+a*(7*pf+9*mf*o))/Math.cos(r),u=Math.asin(Math.sin(r)/ug),d=jt(180*c/Math.PI,-180,180),p=jt(180*u/Math.PI,-Or,Or);return new Ke(d,p)}}class aj extends Rl{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,n){return{x:.5+t/360,y:.5-n/360,z:0}}unproject(t,n){const r=360*(t-.5),o=jt(360*(.5-n),-Or,Or);return new Ke(r,o)}}const lh=Math.PI/2;function hg(e){return Math.tan((lh+e)/2)}class lj extends Rl{constructor(t){super(t),this.center=t.center||[0,30];const[n,r]=this.parallels=t.parallels||[30,30];let o=it(n),a=it(r);this.southernCenter=o+a<0,this.southernCenter&&(o=-o,a=-a);const c=Math.cos(o),u=hg(o);this.n=o===a?Math.sin(o):Math.log(c/Math.cos(a))/Math.log(hg(a)/u),this.f=c*Math.pow(hg(o),this.n)/this.n}project(t,n){n=it(n),this.southernCenter&&(n=-n),t=it(t-this.center[0]);const r=1e-6,{n:o,f:a}=this;a>0?n<-lh+r&&(n=-lh+r):n>lh-r&&(n=lh-r);const c=a/Math.pow(hg(n),o);let u=c*Math.sin(o*t),d=a-c*Math.cos(o*t);return u=.5*(u/Math.PI+.5),d=.5*(d/Math.PI+.5),{x:u,y:this.southernCenter?d:1-d,z:0}}unproject(t,n){t=(2*t-.5)*Math.PI,this.southernCenter&&(n=1-n),n=(2*(1-n)-.5)*Math.PI;const{n:r,f:o}=this,a=o-n,c=Math.sign(a),u=Math.sign(r)*Math.sqrt(t*t+a*a);let d=Math.atan2(t,Math.abs(a))*c;a*r<0&&(d-=Math.PI*Math.sign(t)*c);const p=jt(Tt(d/r)+this.center[0],-180,180),m=jt(Tt(2*Math.atan(Math.pow(o/u,1/r))-lh),-Or,Or);return new Ke(p,this.southernCenter?-m:m)}}class nP extends Rl{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,n){return{x:Qr(t),y:oi(n),z:0}}unproject(t,n){const r=So(t),o=qr(n);return new Ke(r,o)}}const rP=it(Or);class cj extends Rl{project(t,n){const r=(n=it(n))*n,o=r*r;return{x:.5*((t=it(t))*(.8707-.131979*r+o*(o*(.003971*r-.001529*o)-.013791))/Math.PI+.5),y:1-.5*(n*(1.007226+r*(.015085+o*(.028874*r-.044475-.005916*o)))/Math.PI+1),z:0}}unproject(t,n){t=(2*t-.5)*Math.PI;let r=n=(2*(1-n)-1)*Math.PI,o=25,a=0,c=r*r;do{c=r*r;const p=c*c;a=(r*(1.007226+c*(.015085+p*(.028874*c-.044475-.005916*p)))-n)/(1.007226+c*(.045255+p*(.259866*c-.311325-.005916*11*p))),r=jt(r-a,-rP,rP)}while(Math.abs(a)>1e-6&&--o>0);c=r*r;const u=jt(Tt(t/(.8707+c*(c*(c*c*c*(.003971-.001529*c)-.013791)-.131979))),-180,180),d=Tt(r);return new Ke(u,d)}}const iP=it(Or);class uj extends Rl{project(t,n){n=it(n),t=it(t);const r=Math.cos(n),o=2/Math.PI,a=Math.acos(r*Math.cos(t/2)),c=Math.sin(a)/a,u=.5*(t*o+2*r*Math.sin(t/2)/c)||0,d=.5*(n+Math.sin(n)/c)||0;return{x:.5*(u/Math.PI+.5),y:1-.5*(d/Math.PI+1),z:0}}unproject(t,n){let r=t=(2*t-.5)*Math.PI,o=n=(2*(1-n)-1)*Math.PI,a=25;const c=1e-6;let u=0,d=0;do{const p=Math.cos(o),m=Math.sin(o),_=2*m*p,v=m*m,x=p*p,w=Math.cos(r/2),T=Math.sin(r/2),S=2*w*T,I=T*T,A=1-x*w*w,R=A?1/A:0,k=A?Math.acos(p*w)*Math.sqrt(1/A):0,P=.5*(2*k*p*T+2*r/Math.PI)-t,O=.5*(k*m+o)-n,j=.5*R*(x*I+k*p*w*v)+1/Math.PI,G=R*(S*_/4-k*m*T),W=.125*R*(_*T-k*m*x*S),Z=.5*R*(v*w+k*I*p)+.5,K=G*W-Z*j;u=(O*G-P*Z)/K,d=(P*W-O*j)/K,r=jt(r-u,-Math.PI,Math.PI),o=jt(o-d,-iP,iP)}while((Math.abs(u)>c||Math.abs(d)>c)&&--a>0);return new Ke(Tt(r),Tt(o))}}class oP extends Rl{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(it(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,n){const{scale:r,cosPhi:o}=this;return{x:it(t)*o*r+.5,y:-Math.sin(it(n))/o*r+.5,z:0}}unproject(t,n){const{scale:r,cosPhi:o}=this,a=-(n-.5)/r,c=jt(Tt((t-.5)/r)/o,-180,180),u=Math.asin(jt(a*o,-1,1)),d=jt(Tt(u),-Or,Or);return new Ke(c,d)}}class hj extends nP{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,n,r){const o=ef(t,n,r),a=Tl(qo(r));return ot.transformMat4(o,o,a),{x:o[0],y:o[1],z:o[2]}}locationPoint(t,n){const r=fo(n.lat,n.lng),o=ot.normalize([],r),a=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(n),t._centerAltitude):t._centerAltitude,c=Hn(1,0)*Rt*a;ot.scaleAndAdd(r,r,o,c);const u=wt.identity(new Float64Array(16));return wt.multiply(u,t.pixelMatrix,t.globeMatrix),ot.transformMat4(r,r,u),new N(r[0],r[1])}pixelsPerMeter(t,n){return Hn(1,0)*n}pixelSpaceConversion(t,n,r){const o=Hn(1,t)*n,a=Xe(Hn(1,45)*n,o,r);return this.pixelsPerMeter(t,n)/a}createTileMatrix(t,n,r){const o=Kx(qo(r.canonical));return wt.multiply(new Float64Array(16),t.globeMatrix,o)}createInversionMatrix(t,n){const{center:r}=t,o=Tl(qo(n));return wt.rotateY(o,o,it(r.lng)),wt.rotateX(o,o,it(r.lat)),wt.scale(o,o,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(o)}pointCoordinate(t,n,r,o){return RI(t,n,r,!0)||new xn(0,0)}pointCoordinate3D(t,n,r){const o=this.pointCoordinate(t,n,r,0);return[o.x,o.y,o.z]}isPointAboveHorizon(t,n){return!RI(t,n.x,n.y,!1)}farthestPixelDistance(t){const n=function(o,a){const c=o.cameraToCenterDistance,u=o._centerAltitude*a,d=o._camera,p=o._camera.forward(),m=ot.add([],ot.scale([],p,-c),[0,0,u]),_=o.worldSize/(2*Math.PI),v=[0,0,-_],x=o.width/o.height,w=Math.tan(o.fovAboveCenter),T=ot.scale([],d.up(),w),S=ot.scale([],d.right(),w*x),I=ot.normalize([],ot.add([],ot.add([],p,T),S)),A=[];let R;if(new zm(m,I).closestPointOnSphere(v,_,A)){const k=ot.add([],A,v),P=ot.sub([],k,m);R=Math.cos(o.fovAboveCenter)*ot.length(P)}else{const k=ot.sub([],m,v),P=ot.sub([],v,m);ot.normalize(P,P);const O=ot.length(k)-_;R=Math.sqrt(O*(O+2*_));const j=Math.acos(R/(_+O))-Math.acos(ot.dot(p,P));R*=Math.cos(j)}return 1.01*R}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),r=fi(t.zoom);if(r>0){const o=QA(t,Hn(1,t.center.lat)*t.worldSize),a=t.worldSize/(2*Math.PI),c=Math.max(t.width,t.height)/t.worldSize*Math.PI;return Xe(n,o+a*(1-Math.cos(c)),Math.pow(r,10))}return n}upVector(t,n,r){return ef(n,r,t,1)}upVectorScale(t){return{metersToTile:Dm(Fm(qo(t)))}}}function dg(e){const t=e.parallels,n=!!t&&Math.abs(t[0]+t[1])<.01;switch(e.name){case"mercator":return new nP(e);case"equirectangular":return new aj(e);case"naturalEarth":return new cj(e);case"equalEarth":return new sj(e);case"winkelTripel":return new uj(e);case"albers":return n?new oP(e):new oj(e);case"lambertConformalConic":return n?new oP(e):new lj(e);case"globe":return new hj(e)}throw new Error(`Invalid projection name: ${e.name}`)}const dj=new Mr({"symbol-placement":new te(_t.layout_symbol["symbol-placement"]),"symbol-spacing":new te(_t.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new te(_t.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Be(_t.layout_symbol["symbol-sort-key"]),"symbol-z-order":new te(_t.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new te(_t.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new te(_t.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new te(_t.layout_symbol["icon-ignore-placement"]),"icon-optional":new te(_t.layout_symbol["icon-optional"]),"icon-rotation-alignment":new te(_t.layout_symbol["icon-rotation-alignment"]),"icon-size":new Be(_t.layout_symbol["icon-size"]),"icon-text-fit":new Be(_t.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Be(_t.layout_symbol["icon-text-fit-padding"]),"icon-image":new Be(_t.layout_symbol["icon-image"]),"icon-rotate":new Be(_t.layout_symbol["icon-rotate"]),"icon-padding":new te(_t.layout_symbol["icon-padding"]),"icon-keep-upright":new te(_t.layout_symbol["icon-keep-upright"]),"icon-offset":new Be(_t.layout_symbol["icon-offset"]),"icon-anchor":new Be(_t.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new te(_t.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new te(_t.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new te(_t.layout_symbol["text-rotation-alignment"]),"text-field":new Be(_t.layout_symbol["text-field"]),"text-font":new Be(_t.layout_symbol["text-font"]),"text-size":new Be(_t.layout_symbol["text-size"]),"text-max-width":new Be(_t.layout_symbol["text-max-width"]),"text-line-height":new Be(_t.layout_symbol["text-line-height"]),"text-letter-spacing":new Be(_t.layout_symbol["text-letter-spacing"]),"text-justify":new Be(_t.layout_symbol["text-justify"]),"text-radial-offset":new Be(_t.layout_symbol["text-radial-offset"]),"text-variable-anchor":new te(_t.layout_symbol["text-variable-anchor"]),"text-anchor":new Be(_t.layout_symbol["text-anchor"]),"text-max-angle":new te(_t.layout_symbol["text-max-angle"]),"text-writing-mode":new te(_t.layout_symbol["text-writing-mode"]),"text-rotate":new Be(_t.layout_symbol["text-rotate"]),"text-padding":new te(_t.layout_symbol["text-padding"]),"text-keep-upright":new te(_t.layout_symbol["text-keep-upright"]),"text-transform":new Be(_t.layout_symbol["text-transform"]),"text-offset":new Be(_t.layout_symbol["text-offset"]),"text-allow-overlap":new te(_t.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new te(_t.layout_symbol["text-ignore-placement"]),"text-optional":new te(_t.layout_symbol["text-optional"]),visibility:new te(_t.layout_symbol.visibility)});var M1={paint:new Mr({"icon-opacity":new Be(_t.paint_symbol["icon-opacity"]),"icon-emissive-strength":new Be(_t.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Be(_t.paint_symbol["text-emissive-strength"]),"icon-color":new Be(_t.paint_symbol["icon-color"]),"icon-halo-color":new Be(_t.paint_symbol["icon-halo-color"]),"icon-halo-width":new Be(_t.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Be(_t.paint_symbol["icon-halo-blur"]),"icon-translate":new te(_t.paint_symbol["icon-translate"]),"icon-translate-anchor":new te(_t.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Be(_t.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Be(_t.paint_symbol["text-opacity"]),"text-color":new Be(_t.paint_symbol["text-color"],{runtimeType:ji,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new Be(_t.paint_symbol["text-halo-color"]),"text-halo-width":new Be(_t.paint_symbol["text-halo-width"]),"text-halo-blur":new Be(_t.paint_symbol["text-halo-blur"]),"text-translate":new te(_t.paint_symbol["text-translate"]),"text-translate-anchor":new te(_t.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new te(_t.paint_symbol["icon-color-saturation"])}),layout:dj};class sP{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:lo,this.defaultValue=t}evaluate(t){if(t.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Te(sP,"FormatSectionOverride",{omit:["defaultValue"]});class fg extends Vo{constructor(t,n){super(t,M1,n)}recalculate(t,n){super.recalculate(t,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const r=this.layout.get("text-writing-mode");if(r){const o=[];for(const a of r)o.indexOf(a)<0&&o.push(a);this.layout._values["text-writing-mode"]=o}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,n,r,o){const a=this.layout.get(t).evaluate(n,{},r,o),c=this._unevaluatedLayout._values[t];return c.isDataDriven()||hm(c.value)||!a?a:function(u,d){return d.replace(/{([^{}]+)}/g,(p,m)=>m in u?String(u[m]):"")}(n.properties,a)}createBucket(t){return new gf(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of M1.paint.overridableProperties){if(!fg.hasPaintOverride(this.layout,t))continue;const n=this.paint.get(t),r=new sP(n),o=new qv(r,n.property.specification);let a=null;a=n.value.kind==="constant"||n.value.kind==="source"?new Hv("source",o):new fl("composite",o,n.value.zoomStops,n.value._interpolationType),this.paint._values[t]=new Gu(n.property,a,n.parameters)}}_handleOverridablePaintPropertyUpdate(t,n,r){return!(!this.layout||n.isDataDriven()||r.isDataDriven())&&fg.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,n){const r=t.get("text-field"),o=M1.paint.properties[n];let a=!1;const c=u=>{for(const d of u)if(o.overrides&&o.overrides.hasOverride(d))return void(a=!0)};if(r.value.kind==="constant"&&r.value.value instanceof vo)c(r.value.value.sections);else if(r.value.kind==="source"){const u=p=>{a||(p instanceof kd&&ui(p.value)===Ge?c(p.value.sections):p instanceof Od?c(p.sections):p.eachChild(u))},d=r.value;d._styleExpression&&u(d._styleExpression.expression)}return a}getProgramIds(){const t=this.paint.get("icon-opacity").constantOr(1)!==0,n=this.paint.get("text-opacity").constantOr(1)!==0,r=[];return t&&r.push("symbolIcon"),n&&r.push("symbolSDF"),r}getDefaultProgramParams(t,n){return{config:new Ac(this,n),overrideFog:!1}}}const fj=Qm.types,pj=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function pg(e,t,n,r,o,a,c,u,d,p,m,_,v){const x=u?Math.min(Pl,Math.round(u[0])):0,w=u?Math.min(Pl,Math.round(u[1])):0;e.emplaceBack(t,n,Math.round(32*r),Math.round(32*o),a,c,(x<<1)+(d?1:0),w,16*p,16*m,256*_,256*v)}function mg(e,t,n){e.emplaceBack(t,n)}function gg(e,t,n,r,o,a,c){e.emplaceBack(t,n,r,o,a,c)}function _g(e,t,n,r,o){const a=5*t+2;e.float32[a+0]=n,e.float32[a+1]=r,e.float32[a+2]=o}function ch(e,t,n,r,o){e.emplaceBack(t,n,r,o),e.emplaceBack(t,n,r,o),e.emplaceBack(t,n,r,o),e.emplaceBack(t,n,r,o)}function mj(e){for(const t of e.sections)if(RF(t.text))return!0;return!1}class I1{constructor(t){this.layoutVertexArray=new hx,this.indexArray=new Wr,this.programConfigurations=t,this.segments=new Gn,this.dynamicLayoutVertexArray=new ka,this.opacityVertexArray=new fx,this.placedSymbolArray=new QC,this.iconTransitioningVertexArray=new _l,this.globeExtVertexArray=new dx,this.zOffsetVertexArray=new Hd}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(t,n,r,o,a){this.isEmpty()||(r&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,R6.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,O6.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,pj,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,z6.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,k6.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||a)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,L6.members,!0)),this.opacityVertexBuffer.itemSize=1),(r||o)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Te(I1,"SymbolBuffers");class A1{constructor(t,n,r){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new r,this.segments=new Gn,this.collisionVertexArray=new gx,this.collisionVertexArrayExt=new ka}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,D6.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,B6.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Te(A1,"CollisionBuffers");class yg{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=wt.identity([]),this.placementViewportMatrix=wt.identity([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=y1(this.zoom,n["text-size"]),this.iconSizeData=y1(this.zoom,n["icon-size"]);const r=this.layers[0].layout,o=r.get("symbol-sort-key"),a=r.get("symbol-z-order");this.canOverlap=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey=a!=="viewport-y"&&o.constantOr(1)!==void 0,this.sortFeaturesByY=(a==="viewport-y"||a==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=r.get("text-writing-mode").map(c=>ur[c]),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=r.get("symbol-z-elevate")}createArrays(){this.text=new I1(new vl(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new I1(new vl(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new eM,this.lineVertexArray=new nM,this.symbolInstances=new tM}calculateGlyphDependencies(t,n,r,o,a){for(let c=0;c<t.length;c++){const u=t.codePointAt(c);if(u===void 0)break;if(n[u]=!0,o&&a&&u<=65535){const d=lf[t.charAt(c)];d&&(n[d.charCodeAt(0)]=!0)}}}populate(t,n,r,o){const a=this.layers[0],c=a.layout,u=this.projection.name==="globe",d=c.get("text-font"),p=c.get("text-field"),m=c.get("icon-image"),_=(p.value.kind!=="constant"||p.value.value instanceof vo&&!p.value.value.isEmpty()||p.value.value.toString().length>0)&&(d.value.kind!=="constant"||d.value.value.length>0),v=m.value.kind!=="constant"||!!m.value.value||Object.keys(m.parameters).length>0,x=c.get("symbol-sort-key");if(this.features=[],!_&&!v)return;const w=n.iconDependencies,T=n.glyphDependencies,S=n.availableImages,I=new fr(this.zoom);for(const{feature:A,id:R,index:k,sourceLayerIndex:P}of t){const O=a._featureFilter.needGeometry,j=Cl(A,O);if(!a._featureFilter.filter(I,j,r))continue;if(O||(j.geometry=ia(A,r,o)),u&&A.type!==1&&r.z<=5){const K=j.geometry,Q=.98078528056,at=(X,ft)=>{const gt=ef(X.x,X.y,r,1),vt=ef(ft.x,ft.y,r,1);return ot.dot(gt,vt)<Q};for(let X=0;X<K.length;X++)K[X]=SN(K[X],at)}let G,W;if(_){const K=a.getValueAndResolveTokens("text-field",j,r,S),Q=vo.factory(K);mj(Q)&&(this.hasRTLText=!0),(!this.hasRTLText||ax()==="unavailable"||this.hasRTLText&&cs.isParsed())&&(G=j6(Q,a,j))}if(v){const K=a.getValueAndResolveTokens("icon-image",j,r,S);W=K instanceof as?K:as.fromString(K)}if(!G&&!W)continue;const Z=this.sortFeaturesByKey?x.evaluate(j,{},r):void 0;if(this.features.push({id:R,text:G,icon:W,index:k,sourceLayerIndex:P,geometry:j.geometry,properties:A.properties,type:fj[A.type],sortKey:Z}),W&&(w[W.namePrimary]=!0,W.nameSecondary&&(w[W.nameSecondary]=!0)),G){const K=d.evaluate(j,{},r).join(","),Q=c.get("text-rotation-alignment")==="map"&&c.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ur.vertical)>=0;for(const at of G.sections)if(at.image)w[at.image.namePrimary]=!0;else{const X=Jv(G.toString()),ft=at.fontStack||K,gt=T[ft]=T[ft]||{};this.calculateGlyphDependencies(at.text,gt,Q,this.allowVerticalPlacement,X)}}}c.get("symbol-placement")==="line"&&(this.features=function(A){const R={},k={},P=[];let O=0;function j(K){P.push(A[K]),O++}function G(K,Q,at){const X=k[K];return delete k[K],k[Q]=X,P[X].geometry[0].pop(),P[X].geometry[0]=P[X].geometry[0].concat(at[0]),X}function W(K,Q,at){const X=R[Q];return delete R[Q],R[K]=X,P[X].geometry[0].shift(),P[X].geometry[0]=at[0].concat(P[X].geometry[0]),X}function Z(K,Q,at){const X=at?Q[0][Q[0].length-1]:Q[0][0];return`${K}:${X.x}:${X.y}`}for(let K=0;K<A.length;K++){const Q=A[K],at=Q.geometry,X=Q.text?Q.text.toString():null;if(!X){j(K);continue}const ft=Z(X,at),gt=Z(X,at,!0);if(ft in k&&gt in R&&k[ft]!==R[gt]){const vt=W(ft,gt,at),ht=G(ft,gt,P[vt].geometry);delete R[ft],delete k[gt],k[Z(X,P[ht].geometry,!0)]=ht,P[vt].geometry=null}else ft in k?G(ft,gt,at):gt in R?W(ft,gt,at):(j(K),R[ft]=O-1,k[gt]=O-1)}return P.filter(K=>K.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((A,R)=>A.sortKey-R.sortKey)}update(t,n,r,o,a){const c=Object.keys(t).length!==0;if(c&&!this.stateDependentLayers.length)return;const u=c?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(t,n,u,r,o,a),this.icon.programConfigurations.updatePaintArrays(t,n,u,r,o,a)}updateZOffset(){const t=(a,c,u)=>{r+=c,r>a.length&&a.resize(r);for(let d=-c;d<0;d++)a.emplace(d+r,u)},n=(a,c,u)=>{o+=c,o>a.length&&a.resize(o);for(let d=-c;d<0;d++)a.emplace(d+o,u)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let r=0,o=0;for(let a=0;a<this.symbolInstances.length;a++){const c=this.symbolInstances.get(a),{numHorizontalGlyphVertices:u,numVerticalGlyphVertices:d,numIconVertices:p}=c,m=c.zOffset,_=p>0;if((u>0||d>0)&&(t(this.text.zOffsetVertexArray,u,m),t(this.text.zOffsetVertexArray,d,m)),_){const{placedIconSymbolIndex:v,verticalPlacedIconSymbolIndex:x}=c;v>=0&&n(this.icon.zOffsetVertexArray,p,m),x>=0&&n(this.icon.zOffsetVertexArray,c.numVerticalIconVertices,m)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=dg(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,n){const r=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:o,y:a}of n)this.lineVertexArray.emplaceBack(o,a);return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S){const I=t.indexArray,A=t.layoutVertexArray,R=t.globeExtVertexArray,k=t.segments.prepareSegment(4*n.length,A,I,this.canOverlap?c.sortKey:void 0),P=this.glyphOffsetArray.length,O=k.vertexLength,j=this.allowVerticalPlacement&&u===ur.vertical?Math.PI/2:0,G=c.text&&c.text.sections;for(let Z=0;Z<n.length;Z++){const{tl:K,tr:Q,bl:at,br:X,texPrimary:ft,texSecondary:gt,pixelOffsetTL:vt,pixelOffsetBR:ht,minFontScaleX:pt,minFontScaleY:Ct,glyphOffset:At,isSDF:It,sectionIndex:zt}=n[Z],Ft=k.vertexLength,Ut=At[1];if(pg(A,p.x,p.y,K.x,Ut+K.y,ft.x,ft.y,r,It,vt.x,vt.y,pt,Ct),pg(A,p.x,p.y,Q.x,Ut+Q.y,ft.x+ft.w,ft.y,r,It,ht.x,vt.y,pt,Ct),pg(A,p.x,p.y,at.x,Ut+at.y,ft.x,ft.y+ft.h,r,It,vt.x,ht.y,pt,Ct),pg(A,p.x,p.y,X.x,Ut+X.y,ft.x+ft.w,ft.y+ft.h,r,It,ht.x,ht.y,pt,Ct),d){const{x:Pt,y:Ht,z:he}=d.anchor,[de,_e,xe]=d.up;gg(R,Pt,Ht,he,de,_e,xe),gg(R,Pt,Ht,he,de,_e,xe),gg(R,Pt,Ht,he,de,_e,xe),gg(R,Pt,Ht,he,de,_e,xe),ch(t.dynamicLayoutVertexArray,Pt,Ht,he,j)}else ch(t.dynamicLayoutVertexArray,p.x,p.y,p.z,j);if(S){const Pt=gt||ft;mg(t.iconTransitioningVertexArray,Pt.x,Pt.y),mg(t.iconTransitioningVertexArray,Pt.x+Pt.w,Pt.y),mg(t.iconTransitioningVertexArray,Pt.x,Pt.y+Pt.h),mg(t.iconTransitioningVertexArray,Pt.x+Pt.w,Pt.y+Pt.h)}I.emplaceBack(Ft,Ft+1,Ft+2),I.emplaceBack(Ft+1,Ft+2,Ft+3),k.vertexLength+=4,k.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(At[0]),Z!==n.length-1&&zt===n[Z+1].sectionIndex||t.programConfigurations.populatePaintArrays(A.length,c,c.index,{},x,w,T,G&&G[zt])}const W=d?d.anchor:p;t.placedSymbolArray.emplaceBack(W.x,W.y,W.z,p.x,p.y,P,this.glyphOffsetArray.length-P,O,m,_,p.segment,r?r[0]:0,r?r[1]:0,o[0],o[1],u,0,!1,0,v,0)}_commitLayoutVertex(t,n,r,o,a,c,u){t.emplaceBack(n,r,o,a,c,Math.round(u.x),Math.round(u.y))}_addCollisionDebugVertices(t,n,r,o,a,c,u){const d=r.segments.prepareSegment(4,r.layoutVertexArray,r.indexArray),p=d.vertexLength,m=u.tileAnchorX,_=u.tileAnchorY;for(let x=0;x<4;x++)r.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(r.collisionVertexArrayExt,n,t.padding,u.zOffset),this._commitLayoutVertex(r.layoutVertexArray,o,a,c,m,_,new N(t.x1,t.y1)),this._commitLayoutVertex(r.layoutVertexArray,o,a,c,m,_,new N(t.x2,t.y1)),this._commitLayoutVertex(r.layoutVertexArray,o,a,c,m,_,new N(t.x2,t.y2)),this._commitLayoutVertex(r.layoutVertexArray,o,a,c,m,_,new N(t.x1,t.y2)),d.vertexLength+=4;const v=r.indexArray;v.emplaceBack(p,p+1),v.emplaceBack(p+1,p+2),v.emplaceBack(p+2,p+3),v.emplaceBack(p+3,p),d.primitiveLength+=4}_addTextDebugCollisionBoxes(t,n,r,o,a,c){for(let u=o;u<a;u++){const d=r.get(u),p=this.getSymbolInstanceTextSize(t,c,n,u);this._addCollisionDebugVertices(d,p,this.textCollisionBox,d.projectedAnchorX,d.projectedAnchorY,d.projectedAnchorZ,c)}}_addIconDebugCollisionBoxes(t,n,r,o,a,c){for(let u=o;u<a;u++){const d=r.get(u),p=this.getSymbolInstanceIconSize(t,n,c.placedIconSymbolIndex);this._addCollisionDebugVertices(d,p,this.iconCollisionBox,d.projectedAnchorX,d.projectedAnchorY,d.projectedAnchorZ,c)}}generateCollisionDebugBuffers(t,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new A1(Mm,PA.members,_l),this.iconCollisionBox=new A1(Mm,PA.members,_l);const r=oa(this.iconSizeData,t),o=oa(this.textSizeData,t);for(let a=0;a<this.symbolInstances.length;a++){const c=this.symbolInstances.get(a);this._addTextDebugCollisionBoxes(o,t,n,c.textBoxStartIndex,c.textBoxEndIndex,c),this._addTextDebugCollisionBoxes(o,t,n,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c),this._addIconDebugCollisionBoxes(r,t,n,c.iconBoxStartIndex,c.iconBoxEndIndex,c),this._addIconDebugCollisionBoxes(r,t,n,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c)}}getSymbolInstanceTextSize(t,n,r,o){const a=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:o),c=af(this.textSizeData,t,a)/pi;return this.tilePixelRatio*c}getSymbolInstanceIconSize(t,n,r){const o=this.icon.placedSymbolArray.get(r),a=af(this.iconSizeData,t,o);return this.tilePixelRatio*a}_commitDebugCollisionVertexUpdate(t,n,r,o){t.emplaceBack(n,-r,-r,o),t.emplaceBack(n,r,-r,o),t.emplaceBack(n,r,r,o),t.emplaceBack(n,-r,r,o)}_updateTextDebugCollisionBoxes(t,n,r,o,a,c){for(let u=o;u<a;u++){const d=r.get(u),p=this.getSymbolInstanceTextSize(t,c,n,u);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,p,d.padding,c.zOffset)}}_updateIconDebugCollisionBoxes(t,n,r,o,a,c){for(let u=o;u<a;u++){const d=r.get(u),p=this.getSymbolInstanceIconSize(t,n,c.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,p,d.padding,c.zOffset)}}updateCollisionDebugBuffers(t,n){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const r=oa(this.iconSizeData,t),o=oa(this.textSizeData,t);for(let a=0;a<this.symbolInstances.length;a++){const c=this.symbolInstances.get(a);this._updateTextDebugCollisionBoxes(o,t,n,c.textBoxStartIndex,c.textBoxEndIndex,c),this._updateTextDebugCollisionBoxes(o,t,n,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c),this._updateIconDebugCollisionBoxes(r,t,n,c.iconBoxStartIndex,c.iconBoxEndIndex,c),this._updateIconDebugCollisionBoxes(r,t,n,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,n,r,o,a,c,u,d,p){const m={};if(n<r){const{x1:_,y1:v,x2:x,y2:w,padding:T,projectedAnchorX:S,projectedAnchorY:I,projectedAnchorZ:A,tileAnchorX:R,tileAnchorY:k,featureIndex:P}=t.get(n);m.textBox={x1:_,y1:v,x2:x,y2:w,padding:T,projectedAnchorX:S,projectedAnchorY:I,projectedAnchorZ:A,tileAnchorX:R,tileAnchorY:k},m.textFeatureIndex=P}if(o<a){const{x1:_,y1:v,x2:x,y2:w,padding:T,projectedAnchorX:S,projectedAnchorY:I,projectedAnchorZ:A,tileAnchorX:R,tileAnchorY:k,featureIndex:P}=t.get(o);m.verticalTextBox={x1:_,y1:v,x2:x,y2:w,padding:T,projectedAnchorX:S,projectedAnchorY:I,projectedAnchorZ:A,tileAnchorX:R,tileAnchorY:k},m.verticalTextFeatureIndex=P}if(c<u){const{x1:_,y1:v,x2:x,y2:w,padding:T,projectedAnchorX:S,projectedAnchorY:I,projectedAnchorZ:A,tileAnchorX:R,tileAnchorY:k,featureIndex:P}=t.get(c);m.iconBox={x1:_,y1:v,x2:x,y2:w,padding:T,projectedAnchorX:S,projectedAnchorY:I,projectedAnchorZ:A,tileAnchorX:R,tileAnchorY:k},m.iconFeatureIndex=P}if(d<p){const{x1:_,y1:v,x2:x,y2:w,padding:T,projectedAnchorX:S,projectedAnchorY:I,projectedAnchorZ:A,tileAnchorX:R,tileAnchorY:k,featureIndex:P}=t.get(d);m.verticalIconBox={x1:_,y1:v,x2:x,y2:w,padding:T,projectedAnchorX:S,projectedAnchorY:I,projectedAnchorZ:A,tileAnchorX:R,tileAnchorY:k},m.verticalIconFeatureIndex=P}return m}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const r=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,n){const r=t.placedSymbolArray.get(n),o=r.vertexStartIndex+4*r.numGlyphs;for(let a=r.vertexStartIndex;a<o;a+=4)t.indexArray.emplaceBack(a,a+1,a+2),t.indexArray.emplaceBack(a+1,a+2,a+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(t),r=Math.cos(t),o=[],a=[],c=[];for(let u=0;u<this.symbolInstances.length;++u){c.push(u);const d=this.symbolInstances.get(u);o.push(0|Math.round(n*d.tileAnchorX+r*d.tileAnchorY)),a.push(d.featureIndex)}return c.sort((u,d)=>o[u]-o[d]||a[d]-a[u]),c}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((t,n)=>this.symbolInstances.get(n).zOffset-this.symbolInstances.get(t).zOffset)}addToSortKeyRanges(t,n){const r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===n?r.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const r=this.symbolInstances.get(n);this.featureSortOrder.push(r.featureIndex);const{rightJustifiedTextSymbolIndex:o,centerJustifiedTextSymbolIndex:a,leftJustifiedTextSymbolIndex:c,verticalPlacedTextSymbolIndex:u,placedIconSymbolIndex:d,verticalPlacedIconSymbolIndex:p}=r;o>=0&&this.addIndicesForPlacedSymbol(this.text,o),a>=0&&a!==o&&this.addIndicesForPlacedSymbol(this.text,a),c>=0&&c!==a&&c!==o&&this.addIndicesForPlacedSymbol(this.text,c),u>=0&&this.addIndicesForPlacedSymbol(this.text,u),d>=0&&this.addIndicesForPlacedSymbol(this.icon,d),p>=0&&this.addIndicesForPlacedSymbol(this.icon,p)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Te(yg,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),yg.MAX_GLYPHS=65535,yg.addDynamicAttributes=ch;var gf=yg;const gj=Dn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:_j}=gj,yj=Dn([{name:"a_packed",components:4,type:"Float32"}]),{members:vj}=yj,xj=Qm.types,bj=Math.cos(Math.PI/180*37.5);class vg{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new ux,this.layoutVertexArray2=new ka,this.indexArray=new Wr,this.programConfigurations=new vl(t.layers,t.zoom),this.segments=new Gn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,r,o){this.hasPattern=f1("line",this.layers,n);const a=this.layers[0].layout.get("line-sort-key"),c=[];for(const{feature:m,id:_,index:v,sourceLayerIndex:x}of t){const w=this.layers[0]._featureFilter.needGeometry,T=Cl(m,w);if(!this.layers[0]._featureFilter.filter(new fr(this.zoom),T,r))continue;const S=a?a.evaluate(T,{},r):void 0,I={id:_,properties:m.properties,type:m.type,sourceLayerIndex:x,index:v,geometry:w?T.geometry:ia(m,r,o),patterns:{},sortKey:S};c.push(I)}a&&c.sort((m,_)=>m.sortKey-_.sortKey);const{lineAtlas:u,featureIndex:d}=n,p=this.addConstantDashes(u);for(const m of c){const{geometry:_,index:v,sourceLayerIndex:x}=m;if(p&&this.addFeatureDashes(m,u),this.hasPattern){const w=p1("line",this.layers,m,this.zoom,n);this.patternFeatures.push(w)}else this.addFeature(m,_,v,r,u.positions,n.availableImages,n.brightness);d.insert(t[v].feature,_,v,x,this.index)}}addConstantDashes(t){let n=!1;for(const r of this.layers){const o=r.paint.get("line-dasharray").value,a=r.layout.get("line-cap").value;if(o.kind!=="constant"||a.kind!=="constant")n=!0;else{const c=a.value,u=o.value;if(!u)continue;t.addDash(u,c)}}return n}addFeatureDashes(t,n){const r=this.zoom;for(const o of this.layers){const a=o.paint.get("line-dasharray").value,c=o.layout.get("line-cap").value;if(a.kind==="constant"&&c.kind==="constant")continue;let u,d;if(a.kind==="constant"){if(u=a.value,!u)continue}else u=a.evaluate({zoom:r},t);d=c.kind==="constant"?c.value:c.evaluate({zoom:r},t),n.addDash(u,d),t.patterns[o.id]=n.getKey(u,d)}}update(t,n,r,o,a){const c=Object.keys(t).length!==0;c&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,n,c?this.stateDependentLayers:this.layers,r,o,a)}addFeatures(t,n,r,o,a,c){for(const u of this.patternFeatures)this.addFeature(u,u.geometry,u.index,n,r,o,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,vj)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,_j),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,n,r,o,a,c,u){const d=this.layers[0].layout,p=d.get("line-join").evaluate(t,{}),m=d.get("line-cap").evaluate(t,{}),_=d.get("line-miter-limit"),v=d.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const x of n)this.addLine(x,t,p,m,_,v);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,a,c,o,u)}addLine(t,n,r,o,a,c){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let I=0;I<t.length-1;I++)this.totalDistance+=t[I].dist(t[I+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const u=xj[n.type]==="Polygon";let d=t.length;for(;d>=2&&t[d-1].equals(t[d-2]);)d--;let p=0;for(;p<d-1&&t[p].equals(t[p+1]);)p++;if(d<(u?3:2))return;r==="bevel"&&(a=1.05);const m=this.overscaling<=16?15*Rt/(512*this.overscaling):0,_=this.segments.prepareSegment(10*d,this.layoutVertexArray,this.indexArray);let v,x,w,T,S;this.e1=this.e2=-1,u&&(v=t[d-2],S=t[p].sub(v)._unit()._perp());for(let I=p;I<d;I++){if(w=I===d-1?u?t[p+1]:void 0:t[I+1],w&&t[I].equals(w))continue;S&&(T=S),v&&(x=v),v=t[I],S=w?w.sub(v)._unit()._perp():T,T=T||S;let A=T.add(S);A.x===0&&A.y===0||A._unit();const R=T.x*S.x+T.y*S.y,k=A.x*S.x+A.y*S.y,P=k!==0?1/k:1/0,O=2*Math.sqrt(2-2*k),j=k<bj&&x&&w,G=T.x*S.y-T.y*S.x>0;if(j&&I>p){const K=v.dist(x);if(K>2*m){const Q=v.sub(v.sub(x)._mult(m/K)._round());this.updateDistance(x,Q),this.addCurrentVertex(Q,T,0,0,_),x=Q}}const W=x&&w;let Z=W?r:u?"butt":o;if(W&&Z==="round"&&(P<c?Z="miter":P<=2&&(Z="fakeround")),Z==="miter"&&P>a&&(Z="bevel"),Z==="bevel"&&(P>2&&(Z="flipbevel"),P<a&&(Z="miter")),x&&this.updateDistance(x,v),Z==="miter")A._mult(P),this.addCurrentVertex(v,A,0,0,_);else if(Z==="flipbevel"){if(P>100)A=S.mult(-1);else{const K=P*T.add(S).mag()/T.sub(S).mag();A._perp()._mult(K*(G?-1:1))}this.addCurrentVertex(v,A,0,0,_),this.addCurrentVertex(v,A.mult(-1),0,0,_)}else if(Z==="bevel"||Z==="fakeround"){const K=-Math.sqrt(P*P-1),Q=G?K:0,at=G?0:K;if(x&&this.addCurrentVertex(v,T,Q,at,_),Z==="fakeround"){const X=Math.round(180*O/Math.PI/20);for(let ft=1;ft<X;ft++){let gt=ft/X;if(gt!==.5){const ht=gt-.5;gt+=gt*ht*(gt-1)*((1.0904+R*(R*(3.55645-1.43519*R)-3.2452))*ht*ht+(.848013+R*(.215638*R-1.06021)))}const vt=S.sub(T)._mult(gt)._add(T)._unit()._mult(G?-1:1);this.addHalfVertex(v,vt.x,vt.y,!1,G,0,_)}}w&&this.addCurrentVertex(v,S,-Q,-at,_)}else if(Z==="butt")this.addCurrentVertex(v,A,0,0,_);else if(Z==="square"){const K=x?1:-1;x||this.addCurrentVertex(v,A,K,K,_),this.addCurrentVertex(v,A,0,0,_),x&&this.addCurrentVertex(v,A,K,K,_)}else Z==="round"&&(x&&(this.addCurrentVertex(v,T,0,0,_),this.addCurrentVertex(v,T,1,1,_,!0)),w&&(this.addCurrentVertex(v,S,-1,-1,_,!0),this.addCurrentVertex(v,S,0,0,_)));if(j&&I<d-1){const K=v.dist(w);if(K>2*m){const Q=v.add(w.sub(v)._mult(m/K)._round());this.updateDistance(v,Q),this.addCurrentVertex(Q,S,0,0,_),v=Q}}}}addCurrentVertex(t,n,r,o,a,c=!1){const u=n.y*o-n.x,d=-n.y-n.x*o;this.addHalfVertex(t,n.x+n.y*r,n.y-n.x*r,c,!1,r,a),this.addHalfVertex(t,u,d,c,!0,-o,a)}addHalfVertex({x:t,y:n},r,o,a,c,u,d){this.layoutVertexArray.emplaceBack((t<<1)+(a?1:0),(n<<1)+(c?1:0),Math.round(63*r)+128,Math.round(63*o)+128,1+(u===0?0:u<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const p=d.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,p),d.primitiveLength++),c?this.e2=p:this.e1=p}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,n){this.distance+=t.dist(n),this.updateScaledDistance()}}Te(vg,"LineBucket",{omit:["layers","patternFeatures"]});class gr{constructor(t,n,r,o){this.context=t,this.format=r,this.texture=t.gl.createTexture(),this.update(n,o)}update(t,n,r){const{width:o,height:a}=t,{context:c}=this,{gl:u}=c,{HTMLImageElement:d,HTMLCanvasElement:p,HTMLVideoElement:m,ImageData:_,ImageBitmap:v}=C;if(u.bindTexture(u.TEXTURE_2D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(this.format===u.RGBA&&(!n||n.premultiply!==!1)),r||this.size&&this.size[0]===o&&this.size[1]===a){const{x,y:w}=r||{x:0,y:0};if(t instanceof d||t instanceof p||t instanceof m||t instanceof _||v&&t instanceof v)u.texSubImage2D(u.TEXTURE_2D,0,x,w,u.RGBA,u.UNSIGNED_BYTE,t);else{let T=this.format,S=u.UNSIGNED_BYTE;this.format===u.R32F&&(T=u.RED,S=u.FLOAT),u.texSubImage2D(u.TEXTURE_2D,0,x,w,o,a,T,S,t.data)}}else if(this.size=[o,a],t instanceof d||t instanceof p||t instanceof m||t instanceof _||v&&t instanceof v){let x=this.format;this.format===u.R8&&(x=u.RED),u.texImage2D(u.TEXTURE_2D,0,this.format,x,u.UNSIGNED_BYTE,t)}else{let x=this.format,w=this.format,T=u.UNSIGNED_BYTE;this.format===u.DEPTH_COMPONENT&&(x=u.DEPTH_COMPONENT16,T=u.UNSIGNED_SHORT),this.format===u.R32F&&(T=u.FLOAT,w=u.RED),u.texImage2D(u.TEXTURE_2D,0,x,o,a,0,w,T,t.data)}this.useMipmap=!!(n&&n.useMipmap),this.useMipmap&&u.generateMipmap(u.TEXTURE_2D)}bind(t,n){const{context:r}=this,{gl:o}=r;o.bindTexture(o.TEXTURE_2D,this.texture),t!==this.minFilter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,t),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,this.useMipmap?t===o.NEAREST?o.NEAREST_MIPMAP_NEAREST:o.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),n!==this.wrapS&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,n),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,n),this.wrapS=n)}bindExtraParam(t,n,r,o){const{context:a}=this,{gl:c}=a;c.bindTexture(c.TEXTURE_2D,this.texture),n!==this.magFilter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,n),this.magFilter=n),t!==this.minFilter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,this.useMipmap?t===c.NEAREST?c.NEAREST_MIPMAP_NEAREST:c.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),r!==this.wrapS&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,r),this.wrapS=r),o!==this.wrapT&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,o),this.wrapT=o)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class xg{constructor(t,n){this.context=t,this.texture=n}bind(t,n){const{context:r}=this,{gl:o}=r;o.bindTexture(o.TEXTURE_2D,this.texture),t!==this.minFilter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,t),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,t),this.minFilter=t),n!==this.wrapS&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,n),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,n),this.wrapS=n)}}const ps=32,sa=33,kl=new Uint16Array(8184);for(let e=0;e<2046;e++){let t=e+2,n=0,r=0,o=0,a=0,c=0,u=0;for(1&t?o=a=c=ps:n=r=u=ps;(t>>=1)>1;){const p=n+o>>1,m=r+a>>1;1&t?(o=n,a=r,n=c,r=u):(n=o,r=a,o=c,a=u),c=p,u=m}const d=4*e;kl[d+0]=n,kl[d+1]=r,kl[d+2]=o,kl[d+3]=a}const aa=new Uint16Array(2178),Ol=new Uint8Array(1089),bg=new Uint16Array(1089);function aP(e){return e===0?-.03125:e===32?.03125:0}var P1=Dn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const lP={type:2,extent:Rt,loadGeometry:()=>[[new N(0,0),new N(Rt+1,0),new N(Rt+1,Rt+1),new N(0,Rt+1),new N(0,0)]]};class _f{constructor(t,n,r,o,a){this.tileID=t,this.uid=Ne(),this.uses=0,this.tileSize=n,this.tileZoom=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=a,o&&o.style&&(this._lastUpdatedBrightness=o.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",o&&o.transform&&(this.projection=o.transform.projection)}registerFadeDuration(t){const n=t+this.timeAdded;n<Ve.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Oc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,n,r){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(o,a){const c={};if(!a)return c;for(const u of o){const d=u.layerIds.map(p=>a.getLayer(p)).filter(Boolean);if(d.length!==0){u.layers=d,u.stateDependentLayerIds&&(u.stateDependentLayers=u.stateDependentLayerIds.map(p=>d.filter(m=>m.id===p)[0]));for(const p of d)c[p.fqid]=u}}return c}(t.buckets,n.style),this.hasSymbolBuckets=!1;for(const o in this.buckets){const a=this.buckets[o];if(a instanceof gf){if(this.hasSymbolBuckets=!0,!r)break;a.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const o in this.buckets){const a=this.buckets[o];if(a instanceof gf&&a.hasRTLText){this.hasRTLText=!0,cs.isLoading()||cs.isLoaded()||ax()!=="deferred"||GC();break}}this.queryPadding=0;for(const o in this.buckets){const a=this.buckets[o],c=n.style.getOwnLayer(o);if(!c)continue;const u=c.queryRadius(a);this.queryPadding=Math.max(this.queryPadding,u)}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas),this._lastUpdatedBrightness=t.brightness}else this.collisionBoxArray=new Tx}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.fqid]}upload(t){for(const r in this.buckets){const o=this.buckets[r];o.uploadPending()&&o.upload(t)}const n=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new gr(t,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new gr(t,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new gr(t,this.lineAtlas.image,n.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t,n,r){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture,r),!n||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const o=n.style.getBrightness();(this._lastUpdatedBrightness||o)&&(this._lastUpdatedBrightness&&o&&Math.abs(this._lastUpdatedBrightness-o)<.001||(this._lastUpdatedBrightness=o,this.updateBuckets(void 0,n)))}queryRenderedFeatures(t,n,r,o,a,c,u,d){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:o,pixelPosMatrix:u,transform:c,params:a,tileTransform:this.tileTransform},t,n,r):{}}querySourceFeatures(t,n){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const o=r.loadVTLayers(),a=n?n.sourceLayer:"",c=o._geojsonTileLayer||o[a];if(!c)return;const u=mm(n&&n.filter),{z:d,x:p,y:m}=this.tileID.canonical,_={z:d,x:p,y:m};for(let v=0;v<c.length;v++){const x=c.feature(v);if(u.needGeometry){const S=Cl(x,!0);if(!u.filter(new fr(this.tileID.overscaledZ),S,this.tileID.canonical))continue}else if(!u.filter(new fr(this.tileID.overscaledZ),x))continue;const w=r.getId(x,a),T=new bA(x,d,p,m,w);T.tile=_,t.push(T)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const t in this.buckets)if(this.buckets[t].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const n=this.expirationTime;if(t.cacheControl){const r=Ce(t.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const r=Date.now();let o=!1;if(this.expirationTime>r)o=!1;else if(n)if(this.expirationTime<n)o=!0;else{const a=this.expirationTime-n;a?this.expirationTime=r+Math.max(a,3e4):o=!0}else o=!0;o?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,n){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(t).length!==0&&n&&this.updateBuckets(t,n)}updateBuckets(t,n){if(!this.latestFeatureIndex)return;const r=this.latestFeatureIndex.loadVTLayers(),o=n.style.listImages(),a=n.style.getBrightness();for(const c in this.buckets){if(!n.style.hasLayer(c))continue;const u=this.buckets[c],d=u.layers[0].sourceLayer||"_geojsonTileLayer",p=r[d];let m={};if(t&&(m=t[d],!p||!m||Object.keys(m).length===0))continue;if(u.update(m,p,o,this.imageAtlas&&this.imageAtlas.patternPositions||{},a),u instanceof vg||u instanceof Km){const v=n.style.getOwnSourceCache(u.layers[0].source);n._terrain&&n._terrain.enabled&&v&&u.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(v.id,this.tileID)}const _=n&&n.style&&n.style.getOwnLayer(c);_&&(this.queryPadding=Math.max(this.queryPadding,_.queryRadius(u)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ve.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Ve.now()+t}setTexture(t,n){const r=n.context,o=r.gl;this.texture=this.texture||n.getTileTexture(t.width),this.texture&&this.texture instanceof gr?this.texture.update(t,{useMipmap:!0}):(this.texture=new gr(r,t,o.RGBA,{useMipmap:!0}),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE))}setDependencies(t,n){const r={};for(const o of n)r[o]=!0;this.dependencies[t]=r}hasDependency(t,n){for(const r of t){const o=this.dependencies[r];if(o){for(const a of n)if(o[a])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,n){if(!n||n.name==="mercator"||this._tileDebugBuffer)return;const r=ia(lP,this.tileID.canonical,this.tileTransform)[0],o=new bo,a=new Zd;for(let c=0;c<r.length;c++){const{x:u,y:d}=r[c];o.emplaceBack(u,d),a.emplaceBack(c)}a.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(a),this._tileDebugBuffer=t.createVertexBuffer(o,bl.members),this._tileDebugSegments=Gn.simpleSegment(0,0,o.length,a.length)}_makeTileBoundsBuffers(t,n){if(this._tileBoundsBuffer||!n||n.name==="mercator")return;const r=ia(lP,this.tileID.canonical,this.tileTransform)[0];let o,a;if(this.isRaster){const c=function(u,d){const p=Oc(u,d),m=Math.pow(2,u.z);for(let S=0;S<sa;S++)for(let I=0;I<sa;I++){const A=So((u.x+(I+aP(I))/ps)/m),R=qr((u.y+(S+aP(S))/ps)/m),k=d.project(A,R),P=S*sa+I;aa[2*P+0]=Math.round((k.x*p.scale-p.x)*Rt),aa[2*P+1]=Math.round((k.y*p.scale-p.y)*Rt)}Ol.fill(0),bg.fill(0);for(let S=2045;S>=0;S--){const I=4*S,A=kl[I+0],R=kl[I+1],k=kl[I+2],P=kl[I+3],O=A+k>>1,j=R+P>>1,G=O+j-R,W=j+A-O,Z=R*sa+A,K=P*sa+k,Q=j*sa+O,at=Math.hypot((aa[2*Z+0]+aa[2*K+0])/2-aa[2*Q+0],(aa[2*Z+1]+aa[2*K+1])/2-aa[2*Q+1])>=16;Ol[Q]=Ol[Q]||(at?1:0),S<1022&&(Ol[Q]=Ol[Q]||Ol[(R+W>>1)*sa+(A+G>>1)]||Ol[(P+W>>1)*sa+(k+G>>1)])}const _=new Cc,v=new Wr;let x=0;function w(S,I){const A=I*sa+S;return bg[A]===0&&(_.emplaceBack(aa[2*A+0],aa[2*A+1],S*Rt/ps,I*Rt/ps),bg[A]=++x),bg[A]-1}function T(S,I,A,R,k,P){const O=S+A>>1,j=I+R>>1;if(Math.abs(S-k)+Math.abs(I-P)>1&&Ol[j*sa+O])T(k,P,S,I,O,j),T(A,R,k,P,O,j);else{const G=w(S,I),W=w(A,R),Z=w(k,P);v.emplaceBack(G,W,Z)}}return T(0,0,ps,ps,ps,0),T(ps,ps,0,0,0,ps),{vertices:_,indices:v}}(this.tileID.canonical,n);o=c.vertices,a=c.indices}else{o=new Cc,a=new Wr;for(const{x:u,y:d}of r)o.emplaceBack(u,d,0,0);const c=Xm(o.int16,void 0,4);for(let u=0;u<c.length;u+=3)a.emplaceBack(c[u],c[u+1],c[u+2])}this._tileBoundsBuffer=t.createVertexBuffer(o,P1.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(a),this._tileBoundsSegments=Gn.simpleSegment(0,0,o.length,a.length)}_makeGlobeTileDebugBuffers(t,n){const r=n.projection;if(!r||r.name!=="globe"||n.freezeTileCoverage)return;const o=this.tileID.canonical,a=Tl(kI(o,n)),c=fi(n.zoom);let u;c>0&&(u=wt.invert(new Float64Array(16),n.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,o,n,a,u,c),this._makeGlobeTileDebugTextBuffer(t,o,n,a,u,c)}_globePoint(t,n,r,o,a,c,u){let d=ef(t,n,r);if(c){const p=1<<r.z,m=Qr(o.center.lng),_=oi(o.center.lat),v=(r.x+.5)/p-m;let x=0;v>.5?x=-1:v<-.5&&(x=1);let w=(t/Rt+r.x)/p+x,T=(n/Rt+r.y)/p;w=(w-m)*o._pixelsPerMercatorPixel+m,T=(T-_)*o._pixelsPerMercatorPixel+_;const S=[w*o.worldSize,T*o.worldSize,0];ot.transformMat4(S,S,c),d=ja(d,S,u)}return ot.transformMat4(d,d,a)}_makeGlobeTileDebugBorderBuffer(t,n,r,o,a,c){const u=new bo,d=new Zd,p=new Sm,m=(v,x,w,T,S)=>{const I=(w-v)/(S-1),A=(T-x)/(S-1),R=u.length;for(let k=0;k<S;k++){const P=v+k*I,O=x+k*A;u.emplaceBack(P,O);const j=this._globePoint(P,O,n,r,o,a,c);p.emplaceBack(j[0],j[1],j[2]),d.emplaceBack(R+k)}},_=Rt;m(0,0,_,0,16),m(_,0,_,_,16),m(_,_,0,_,16),m(0,_,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(d),this._tileDebugBuffer=t.createVertexBuffer(u,bl.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(p,EI.members),this._tileDebugSegments=Gn.simpleSegment(0,0,u.length,d.length)}_makeGlobeTileDebugTextBuffer(t,n,r,o,a,c){const u=Rt/4,d=new bo,p=new Wr,m=new Sm,_=25;p.reserve(32),d.reserve(_),m.reserve(_);const v=(x,w)=>_*x+w;for(let x=0;x<_;x++){const w=x*u;for(let T=0;T<_;T++){const S=T*u;d.emplaceBack(S,w);const I=this._globePoint(S,w,n,r,o,a,c);m.emplaceBack(I[0],I[1],I[2])}}for(let x=0;x<4;x++)for(let w=0;w<4;w++){const T=v(x,w),S=v(x,w+1),I=v(x+1,w),A=v(x+1,w+1);p.emplaceBack(T,S,I),p.emplaceBack(I,S,A)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(p),this._tileDebugTextBuffer=t.createVertexBuffer(d,bl.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(m,EI.members),this._tileDebugTextSegments=Gn.simpleSegment(0,0,_,32)}destroy(t=!1){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!t&&this.texture&&this.texture instanceof gr&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.latestFeatureIndex=null,this.state="unloaded"}}class wj{constructor(t,n){this.max=t,this.onRemove=n,this.reset()}reset(){for(const t in this.data)for(const n of this.data[t])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(t,n,r){const o=t.wrapped().key;this.data[o]===void 0&&(this.data[o]=[]);const a={value:n,timeout:void 0};if(r!==void 0&&(a.timeout=setTimeout(()=>{this.remove(t,a)},r)),this.data[o].push(a),this.order.push(o),this.order.length>this.max){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const n=this.data[t].shift();return n.timeout&&clearTimeout(n.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),n.value}getByKey(t){const n=this.data[t];return n?n[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,n){if(!this.has(t))return this;const r=t.wrapped().key,o=n===void 0?0:this.data[r].indexOf(n),a=this.data[r][o];return this.data[r].splice(o,1),a.timeout&&clearTimeout(a.timeout),this.data[r].length===0&&delete this.data[r],this.onRemove(a.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(t){const n=[];for(const r in this.data)for(const o of this.data[r])t(o.value)||n.push(o);for(const r of n)this.remove(r.value.tileID,r)}}class Ll{constructor(t,n,r,o){this.id=Ll.uniqueIdxCounter,Ll.uniqueIdxCounter++,this.context=t;const a=t.gl;this.buffer=a.createBuffer(),this.dynamicDraw=!!r,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||o||n.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){this.id=Ll.uniqueIdxCounter,Ll.uniqueIdxCounter++;const n=this.context.gl;this.context.unbindVAO(),this.bind(),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Ll.uniqueIdxCounter=0;const Tj={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Sj{constructor(t,n,r,o,a,c){this.length=n.length,this.attributes=r,this.itemSize=n.bytesPerElement,this.dynamicDraw=o,this.instanceCount=c,this.context=t;const u=t.gl;this.buffer=u.createBuffer(),t.bindVertexBuffer.set(this.buffer),u.bufferData(u.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||a||n.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const n=this.context.gl;this.bind(),n.bufferSubData(n.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,n){for(let r=0;r<this.attributes.length;r++){const o=n.attributes[this.attributes[r].name];o!==void 0&&t.enableVertexAttribArray(o)}}setVertexAttribPointers(t,n,r){for(let o=0;o<this.attributes.length;o++){const a=this.attributes[o],c=n.attributes[a.name];c!==void 0&&t.vertexAttribPointer(c,a.components,t[Tj[a.type]],!1,this.itemSize,a.offset+this.itemSize*(r||0))}}setVertexAttribDivisor(t,n,r){for(let o=0;o<this.attributes.length;o++){const a=n.attributes[this.attributes[o].name];a!==void 0&&this.instanceCount&&this.instanceCount>0&&t.vertexAttribDivisor(a,r)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class or{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ej extends or{getDefault(){return en.transparent}set(t){const n=this.current;(t.r!==n.r||t.g!==n.g||t.b!==n.b||t.a!==n.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Cj extends or{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Mj extends or{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Ij extends or{getDefault(){return[!0,!0,!0,!0]}set(t){const n=this.current;(t[0]!==n[0]||t[1]!==n[1]||t[2]!==n[2]||t[3]!==n[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Aj extends or{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Pj extends or{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Rj extends or{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const n=this.current;(t.func!==n.func||t.ref!==n.ref||t.mask!==n.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class kj extends or{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const n=this.current;(t[0]!==n[0]||t[1]!==n[1]||t[2]!==n[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Oj extends or{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;t?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),this.current=t,this.dirty=!1}}class Lj extends or{getDefault(){return[0,1]}set(t){const n=this.current;(t[0]!==n[0]||t[1]!==n[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class zj extends or{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;t?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this.current=t,this.dirty=!1}}class Dj extends or{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Bj extends or{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;t?n.enable(n.BLEND):n.disable(n.BLEND),this.current=t,this.dirty=!1}}class Fj extends or{getDefault(){const t=this.gl;return[t.ONE,t.ZERO,t.ONE,t.ZERO]}set(t){const n=this.current;(t[0]!==n[0]||t[1]!==n[1]||t[2]!==n[2]||t[3]!==n[3]||this.dirty)&&(this.gl.blendFuncSeparate(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Nj extends or{getDefault(){return en.transparent}set(t){const n=this.current;(t.r!==n.r||t.g!==n.g||t.b!==n.b||t.a!==n.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class jj extends or{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(t,t),this.current=t,this.dirty=!1)}}class Uj extends or{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;t?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this.current=t,this.dirty=!1}}class $j extends or{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Vj extends or{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}let Gj=class extends or{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}};class Wj extends or{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class qj extends or{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const n=this.current;(t[0]!==n[0]||t[1]!==n[1]||t[2]!==n[2]||t[3]!==n[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Hj extends or{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Zj extends or{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.bindRenderbuffer(n.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Xj extends or{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.bindTexture(n.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Kj extends or{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Yj extends or{getDefault(){return null}set(t){const n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Qj extends or{getDefault(){return null}set(t){this.gl&&(t!==this.current||this.dirty)&&(this.gl.bindVertexArray(t),this.current=t,this.dirty=!1)}}class Jj extends or{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class tU extends or{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class eU extends or{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class R1 extends or{constructor(t,n){super(t),this.context=t,this.parent=n}getDefault(){return null}}class nU extends R1{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class cP extends R1{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,this.attachment(),n.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class rU extends R1{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,this.attachment(),n.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class iU extends cP{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class oU{constructor(t,n,r,o,a){this.context=t,this.width=n,this.height=r;const c=this.framebuffer=t.gl.createFramebuffer();o&&(this.colorAttachment=new nU(t,c)),a&&(this.depthAttachmentType=a,this.depthAttachment=a==="renderbuffer"?new cP(t,c):new rU(t,c))}destroy(){const t=this.context.gl;if(this.colorAttachment){const n=this.colorAttachment.get();n&&t.deleteTexture(n)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const n=this.depthAttachment.get();n&&t.deleteRenderbuffer(n)}else{const n=this.depthAttachment.get();n&&t.deleteTexture(n)}t.deleteFramebuffer(this.framebuffer)}}class qe{constructor(t,n,r){this.func=t,this.mask=n,this.range=r}}qe.ReadOnly=!1,qe.ReadWrite=!0,qe.disabled=new qe(519,qe.ReadOnly,[0,1]);const k1=7680;class ln{constructor(t,n,r,o,a,c){this.test=t,this.ref=n,this.mask=r,this.fail=o,this.depthFail=a,this.pass=c}}ln.disabled=new ln({func:519,mask:0},0,0,k1,k1,k1);const wg=771;class Mn{constructor(t,n,r,o){this.blendFunction=t,this.blendColor=n,this.mask=r,this.blendEquation=o}}Mn.Replace=[1,0,1,0],Mn.disabled=new Mn(Mn.Replace,en.transparent,[!1,!1,!1,!1]),Mn.unblended=new Mn(Mn.Replace,en.transparent,[!0,!0,!0,!0]),Mn.alphaBlended=new Mn([1,wg,1,wg],en.transparent,[!0,!0,!0,!0]),Mn.multiply=new Mn([774,0,774,0],en.transparent,[!0,!0,!0,!0]);const O1=1029,L1=2305;class hn{constructor(t,n,r){this.enable=t,this.mode=n,this.frontFace=r}}hn.disabled=new hn(!1,O1,L1),hn.backCCW=new hn(!0,O1,L1),hn.backCW=new hn(!0,O1,2304),hn.frontCW=new hn(!0,1028,2304),hn.frontCCW=new hn(!0,1028,L1);class sU{constructor(t,n){this.gl=t,this.clearColor=new Ej(this),this.clearDepth=new Cj(this),this.clearStencil=new Mj(this),this.colorMask=new Ij(this),this.depthMask=new Aj(this),this.stencilMask=new Pj(this),this.stencilFunc=new Rj(this),this.stencilOp=new kj(this),this.stencilTest=new Oj(this),this.depthRange=new Lj(this),this.depthTest=new zj(this),this.depthFunc=new Dj(this),this.blend=new Bj(this),this.blendFunc=new Fj(this),this.blendColor=new Nj(this),this.blendEquation=new jj(this),this.cullFace=new Uj(this),this.cullFaceSide=new $j(this),this.frontFace=new Vj(this),this.program=new Gj(this),this.activeTexture=new Wj(this),this.viewport=new qj(this),this.bindFramebuffer=new Hj(this),this.bindRenderbuffer=new Zj(this),this.bindTexture=new Xj(this),this.bindVertexBuffer=new Kj(this),this.bindElementBuffer=new Yj(this),this.bindVertexArrayOES=new Qj(this),this.pixelStoreUnpack=new Jj(this),this.pixelStoreUnpackPremultiplyAlpha=new tU(this),this.pixelStoreUnpackFlipY=new eU(this),this.options=n?{...n}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=t.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,n,r){return new Ll(this,t,n,r)}createVertexBuffer(t,n,r,o,a){return new Sj(this,t,n,r,o,a)}createRenderbuffer(t,n,r){const o=this.gl,a=o.createRenderbuffer();return this.bindRenderbuffer.set(a),o.renderbufferStorage(o.RENDERBUFFER,t,n,r),this.bindRenderbuffer.set(null),a}createFramebuffer(t,n,r,o){return new oU(this,t,n,r,o)}clear({color:t,depth:n,stencil:r,colorMask:o}){const a=this.gl;let c=0;t&&(c|=a.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set(o||[!0,!0,!0,!0])),n!==void 0&&(c|=a.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),r!==void 0&&(c|=a.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),a.clear(c)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){et(t.blendFunction,Mn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor),t.blendEquation?this.blendEquation.set(t.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(t.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class Bs extends En{constructor(t,n,r){super(),this.id=t,this._onlySymbols=r,n.on("data",o=>{o.dataType==="source"&&o.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&o.dataType==="source"&&o.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),n.on("error",()=>{this._sourceErrored=!0}),this._source=n,this._tiles={},this._cache=new wj(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=n.minTileCacheSize,this._maxTileCacheSize=n.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this._coveredTiles={},this._shadowCasterTiles={},this._state=new E6,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const n=this._tiles[t];if(n.state!=="errored"&&(n.state!=="loaded"||!n.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,n){return t.isSymbolTile=this._onlySymbols,t.isExtraShadowCaster=this._shadowCasterTiles[t.tileID.key],this._source.loadTile(t,n)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const r=this._tiles[n];r.upload(t),r.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Xt(this._tiles).map(t=>t.tileID).sort(uP).map(t=>t.key)}getRenderableIds(t,n){const r=[];for(const o in this._tiles)this._isIdRenderable(+o,t,n)&&r.push(this._tiles[o]);return t?r.sort((o,a)=>{const c=o.tileID,u=a.tileID,d=new N(c.canonical.x,c.canonical.y)._rotate(this.transform.angle),p=new N(u.canonical.x,u.canonical.y)._rotate(this.transform.angle);return c.overscaledZ-u.overscaledZ||p.y-d.y||p.x-d.x}).map(o=>o.tileID.key):r.map(o=>o.tileID).sort(uP).map(o=>o.key)}hasRenderableParent(t){const n=this.findLoadedParent(t,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(t,n,r){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(n||!this._tiles[t].holdingForFade())&&(r||!this._shadowCasterTiles[t])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,n){const r=this._tiles[t];r&&(r.state!=="loading"&&(r.state=n),this._loadTile(r,this._tileLoaded.bind(this,r,t,n)))}_tileLoaded(t,n,r,o){if(o)if(t.state="errored",o.status!==404)this._source.fire(new ve(o,{tile:t}));else{if(!(t.tileID.key in this._loadedParentTiles))return void this._source.fire(new Nt("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const a=this.map.painter.terrain;this.update(this.transform,a.getScaledDemTileSize(),!0),a.resetTileLookupCache(this.id)}else this.update(this.transform)}else t.timeAdded=Ve.now(),r==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(n,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new Nt("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const n=this.getRenderableIds();for(let o=0;o<n.length;o++){const a=n[o];if(t.neighboringTiles&&t.neighboringTiles[a]){const c=this.getTileByID(a);r(t,c),r(c,t)}}function r(o,a){if(!o.dem||o.dem.borderReady)return;o.needsHillshadePrepare=!0,o.needsDEMTextureUpload=!0;let c=a.tileID.canonical.x-o.tileID.canonical.x;const u=a.tileID.canonical.y-o.tileID.canonical.y,d=Math.pow(2,o.tileID.canonical.z),p=a.tileID.key;c===0&&u===0||Math.abs(u)>1||(Math.abs(c)>1&&(Math.abs(c+d)===1?c+=d:Math.abs(c-d)===1&&(c-=d)),a.dem&&o.dem&&(o.dem.backfillBorder(a.dem,c,u),o.neighboringTiles&&o.neighboringTiles[p]&&(o.neighboringTiles[p].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,n,r,o){for(const a in this._tiles){let c=this._tiles[a];if(o[a]||!c.hasData()||c.tileID.overscaledZ<=n||c.tileID.overscaledZ>r)continue;let u=c.tileID;for(;c&&c.tileID.overscaledZ>n+1;){const p=c.tileID.scaledTo(c.tileID.overscaledZ-1);c=this._tiles[p.key],c&&c.hasData()&&(u=p)}let d=u;for(;d.overscaledZ>n;)if(d=d.scaledTo(d.overscaledZ-1),t[d.key]){o[u.key]=u;break}}}findLoadedParent(t,n){if(t.key in this._loadedParentTiles){const r=this._loadedParentTiles[t.key];return r&&r.tileID.overscaledZ>=n?r:null}for(let r=t.overscaledZ-1;r>=n;r--){const o=t.scaledTo(r),a=this._getLoadedTile(o);if(a)return a}}_getLoadedTile(t){const n=this._tiles[t.key];return n&&n.hasData()?n:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,n){n=n||this._source.tileSize;const r=Math.ceil(t.width/n)+1,o=Math.ceil(t.height/n)+1,a=Math.floor(r*o*5),c=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,a):a,u=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,c):c;this._cache.setMaxSize(u)}handleWrapJump(t){const n=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,n){const r={};for(const o in this._tiles){const a=this._tiles[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+n),r[a.tileID.key]=a}this._tiles=r;for(const o in this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(const o in this._tiles)this._setTileReloadTimer(+o,this._tiles[o])}}update(t,n,r,o){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!r)return;let a;if(this.updateCacheSize(t,n),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?a=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(d=>new Pn(d.canonical.z,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y)):(a=t.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!r,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(a=a.filter(d=>this._source.hasTile(d)))):a=[],a.length>0&&this.castsShadows&&o&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!z1(this._source.type)){const d=t.coveringZoomLevel({tileSize:n||this._source.tileSize,roundZoom:this._source.roundZoom&&!r}),p=Math.min(d,this._source.maxzoom),m=t.extendTileCoverForShadows(a,o,p);for(const _ of m)this._shadowCasterTiles[_.key]=!0,a.push(_)}const c=this._updateRetainedTiles(a);if(z1(this._source.type)&&a.length!==0){const d={},p={},m=Object.keys(c);for(const v of m){const x=c[v],w=this._tiles[v];if(!w||w.fadeEndTime&&w.fadeEndTime<=Ve.now())continue;const T=this.findLoadedParent(x,Math.max(x.overscaledZ-Bs.maxOverzooming,this._source.minzoom));T&&(this._addTile(T.tileID),d[T.tileID.key]=T.tileID),p[v]=x}const _=a[a.length-1].overscaledZ;for(const v in this._tiles){const x=this._tiles[v];if(c[v]||!x.hasData())continue;let w=x.tileID;for(;w.overscaledZ>_;){w=w.scaledTo(w.overscaledZ-1);const T=this._tiles[w.key];if(T&&T.hasData()&&p[w.key]){c[v]=x.tileID;break}}}for(const v in d)c[v]||(this._coveredTiles[v]=!0,c[v]=d[v])}for(const d in c)this._tiles[d].clearFadeHold();const u=function(d,p){const m=[];for(const _ in d)_ in p||m.push(_);return m}(this._tiles,c);for(const d of u){const p=this._tiles[d];p.hasSymbolBuckets&&!p.holdingForFade()?p.setHoldDuration(this.map._fadeDuration):p.hasSymbolBuckets&&!p.symbolFadeFinished()||this._removeTile(+d)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const n={};if(t.length===0)return n;const r={},o=t.reduce((p,m)=>Math.min(p,m.overscaledZ),1/0),a=t[0].overscaledZ,c=Math.max(a-Bs.maxOverzooming,this._source.minzoom),u=Math.max(a+Bs.maxUnderzooming,this._source.minzoom),d={};for(const p of t){const m=this._addTile(p);n[p.key]=p,m.hasData()||o<this._source.maxzoom&&(d[p.key]=p)}this._retainLoadedChildren(d,o,u,n);for(const p of t){let m=this._tiles[p.key];if(m.hasData())continue;if(p.canonical.z>=this._source.maxzoom){const v=p.children(this._source.maxzoom)[0],x=this.getTile(v);if(x&&x.hasData()){n[v.key]=v;continue}}else{const v=p.children(this._source.maxzoom);if(n[v[0].key]&&n[v[1].key]&&n[v[2].key]&&n[v[3].key])continue}let _=m.wasRequested();for(let v=p.overscaledZ-1;v>=c;--v){const x=p.scaledTo(v);if(r[x.key]||(r[x.key]=!0,m=this.getTile(x),!m&&_&&(m=this._addTile(x)),m&&(n[x.key]=x,_=m.wasRequested(),m.hasData())))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const n=[];let r,o=this._tiles[t].tileID;for(;o.overscaledZ>0;){if(o.key in this._loadedParentTiles){r=this._loadedParentTiles[o.key];break}n.push(o.key);const a=o.scaledTo(o.overscaledZ-1);if(r=this._getLoadedTile(a),r)break;o=a}for(const a of n)this._loadedParentTiles[a]=r}}_addTile(t){let n=this._tiles[t.key];if(n)return n.isExtraShadowCaster!==!0||this._shadowCasterTiles[t.key]||this._reloadTile(t.key,"reloading"),n;n=this._cache.getAndRemove(t),n&&(this._setTileReloadTimer(t.key,n),n.tileID=t,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,n)));const r=!!n;if(!r){const o=this.map?this.map.painter:null;n=new _f(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,o,this._isRaster),this._loadTile(n,this._tileLoaded.bind(this,n,t.key,n.state))}return n?(n.uses++,this._tiles[t.key]=n,r||this._source.fire(new Nt("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(t,n){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const r=n.getExpiryTimeout();r&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},r))}_removeTile(t){const n=this._tiles[t];n&&(n.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,n,r){const o=[],a=this.transform;if(!a)return o;const c=a.projection.name==="globe",u=Qr(a.center.lng);for(const d in this._tiles){const p=this._tiles[d];if(r&&p.clearQueryDebugViz(),p.holdingForFade())continue;let m;if(c){const _=p.tileID.canonical;if(_.z===0){const v=[Math.abs(jt(u,...yf(_,-1))-u),Math.abs(jt(u,...yf(_,1))-u)];m=[0,2*v.indexOf(Math.min(...v))-1]}else{const v=[Math.abs(jt(u,...yf(_,-1))-u),Math.abs(jt(u,...yf(_,0))-u),Math.abs(jt(u,...yf(_,1))-u)];m=[v.indexOf(Math.min(...v))-1]}}else m=[0];for(const _ of m){const v=t.containsTile(p,a,n,_);v&&o.push(v)}}return o}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(t){return this._getRenderableCoordinates(t)}_getRenderableCoordinates(t,n){const r=this.getRenderableIds(t,n).map(a=>this._tiles[a].tileID),o=this.transform.projection.name==="globe";for(const a of r)a.projMatrix=this.transform.calculateProjMatrix(a.toUnwrapped()),a.expandedProjMatrix=o?this.transform.calculateProjMatrix(a.toUnwrapped(),!1,!0):a.projMatrix;return r}sortCoordinatesByDistance(t){const n=t.slice(),r=this.transform._camera.position,o=this.transform._camera.forward(),a={};for(const c of n){const u=1/(1<<c.canonical.z);a[c.key]=((c.canonical.x+.5)*u+c.wrap-r[0])*o[0]+((c.canonical.y+.5)*u-r[1])*o[1]-r[2]*o[2]}return n.sort((c,u)=>a[c.key]-a[u.key]),n}hasTransition(){if(this._source.hasTransition())return!0;if(z1(this._source.type))for(const t in this._tiles){const n=this._tiles[t];if(n.fadeEndTime!==void 0&&n.fadeEndTime>=Ve.now())return!0}return!1}setFeatureState(t,n,r){this._state.updateState(t=t||"_geojsonTileLayer",n,r)}removeFeatureState(t,n,r){this._state.removeFeatureState(t=t||"_geojsonTileLayer",n,r)}getFeatureState(t,n){return this._state.getState(t=t||"_geojsonTileLayer",n)}setDependencies(t,n,r){const o=this._tiles[t];o&&o.setDependencies(n,r)}reloadTilesForDependencies(t,n){for(const r in this._tiles)this._tiles[r].hasDependency(t,n)&&this._reloadTile(+r,"reloading");this._cache.filter(r=>!r.hasDependency(t,n))}_preloadTiles(t,n){if(!this._sourceLoaded){const u=()=>{this._sourceLoaded&&(this._source.off("data",u),this._preloadTiles(t,n))};return void this._source.on("data",u)}const r=new Map,o=Array.isArray(t)?t:[t],a=this.map.painter.terrain,c=this.usedForTerrain&&a?a.getScaledDemTileSize():this._source.tileSize;for(const u of o){const d=u.coveringTiles({tileSize:c,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const p of d)r.set(p.key,p);this.usedForTerrain&&u.updateElevation(!1)}kt(Array.from(r.values()),(u,d)=>{const p=new _f(u,this._source.tileSize*u.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(p,m=>{this._source.type==="raster-dem"&&p.dem&&this._backfillDEM(p),d(m,p)})},n)}}function uP(e,t){const n=Math.abs(2*e.wrap)-+(e.wrap<0),r=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||r-n||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function z1(e){return e==="raster"||e==="image"||e==="video"||e==="custom"}function yf(e,t){const n=1<<e.z;return[e.x/n+t,(e.x+1)/n+t]}Bs.maxOverzooming=10,Bs.maxUnderzooming=3;const aU=Dn([{name:"a_pos_3f",components:3,type:"Float32"}]),lU=Dn([{name:"a_color_3f",components:3,type:"Float32"}]),cU=Dn([{name:"a_color_4f",components:4,type:"Float32"}]),uU=Dn([{name:"a_uv_2f",components:2,type:"Float32"}]),hU=Dn([{name:"a_normal_3f",components:3,type:"Float32"}]),dU=Dn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),fU=Dn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class D1{constructor(t=0,n=0,r=0,o=0){if(isNaN(t)||t<0||isNaN(n)||n<0||isNaN(r)||r<0||isNaN(o)||o<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=n,this.left=r,this.right=o}interpolate(t,n,r){return n.top!=null&&t.top!=null&&(this.top=Xe(t.top,n.top,r)),n.bottom!=null&&t.bottom!=null&&(this.bottom=Xe(t.bottom,n.bottom,r)),n.left!=null&&t.left!=null&&(this.left=Xe(t.left,n.left,r)),n.right!=null&&t.right!=null&&(this.right=Xe(t.right,n.right,r)),this}getCenter(t,n){const r=jt((this.left+t-this.right)/2,0,t),o=jt((this.top+n-this.bottom)/2,0,n);return new N(r,o)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new D1(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function hP(e,t){const n=zn(e,3);wt.fromQuat(e,t),er(e,3,n)}function B1(e,t){const n=Ri.identity([]);return Ri.rotateZ(n,n,-t),Ri.rotateX(n,n,-e),n}function dP(e,t){const n=[e[0],e[1],0],r=[t[0],t[1],0];if(ot.length(n)>=1e-15){const c=ot.normalize([],n);ot.scale(r,c,ot.dot(r,c)),t[0]=r[0],t[1]=r[1]}const o=ot.cross([],t,e);if(ot.len(o)<1e-15)return null;const a=Math.atan2(-o[1],o[0]);return B1(Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2]),a)}class fP{constructor(t,n){this.position=t,this.orientation=n}get position(){return this._position}set position(t){if(t){const n=t instanceof xn?t:new xn(t[0],t[1],t[2]);this._renderWorldCopies&&(n.x=we(n.x,0,1)),this._position=n}else this._position=null}lookAtPoint(t,n){if(this.orientation=null,!this.position)return;const r=this.position,o=this._elevation?this._elevation.getAtPointOrZero(xn.fromLngLat(t)):0,a=xn.fromLngLat(t,o),c=[a.x-r.x,a.y-r.y,a.z-r.z];n||(n=[0,0,1]),n[2]=Math.abs(n[2]),this.orientation=dP(c,n)}setPitchBearing(t,n){this.orientation=B1(it(t),it(-n))}}class Tg{constructor(t,n){this._transform=wt.identity([]),this.orientation=n,this.position=t}get mercatorPosition(){const t=this.position;return new xn(t[0],t[1],t[2])}get position(){const t=zn(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var n;t&&er(this._transform,3,[(n=t)[0],n[1],n[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||Ri.identity([]),t&&hP(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),n=this.right();return{bearing:Math.atan2(-n[1],n[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,n){this._orientation=B1(t,n),hP(this._transform,this._orientation)}forward(){const t=zn(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=zn(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=zn(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,n){const r=new Float64Array(16);return wt.invert(r,this.getWorldToCamera(t,n)),r}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(t,n,r){const o=this.position;ot.scale(o,o,-t);const a=new Float64Array(16);return wt.fromScaling(a,[r,r,r]),wt.translate(a,a,o),a[10]*=n,a}getWorldToCamera(t,n){const r=new Float64Array(16),o=new Float64Array(4),a=this.position;return Ri.conjugate(o,this._orientation),ot.scale(a,a,-t),wt.fromQuat(r,o),wt.translate(r,r,a),r[1]*=-1,r[5]*=-1,r[9]*=-1,r[13]*=-1,r[8]*=n,r[9]*=n,r[10]*=n,r[11]*=n,r}getCameraToClipPerspective(t,n,r,o){const a=new Float64Array(16);return wt.perspective(a,t,n,r,o),a}getCameraToClipOrthographic(t,n,r,o,a,c){const u=new Float64Array(16);return wt.ortho(u,t,n,r,o,a,c),u}getDistanceToElevation(t,n=!1){const r=t===0?0:Hn(t,n?qr(this.position[1]):this.position[1]),o=this.forward();return(r-this.position[2])/o[2]}clone(){return new Tg([...this.position],[...this.orientation])}}function pP(e,t){const n=vf(e.projection,e.zoom,e.width,e.height),r=function(a,c,u,d,p){const m=new Ke(u.lng-180*zl,u.lat),_=new Ke(u.lng+180*zl,u.lat),v=a.project(m.lng,m.lat),x=a.project(_.lng,_.lat),w=-Math.atan2(x.y-v.y,x.x-v.x),T=xn.fromLngLat(u);T.y=jt(T.y,-1+zl,1-zl);const S=T.toLngLat(),I=a.project(S.lng,S.lat),A=xn.fromLngLat(S);A.x+=zl;const R=A.toLngLat(),k=a.project(R.lng,R.lat),P=_P(k.x-I.x,k.y-I.y,w),O=xn.fromLngLat(S);O.y+=zl;const j=O.toLngLat(),G=a.project(j.lng,j.lat),W=_P(G.x-I.x,G.y-I.y,w),Z=Math.abs(P.x)/Math.abs(W.y),K=wt.identity([]);wt.rotateZ(K,K,-w*(1-(p?0:d)));const Q=wt.identity([]);return wt.scale(Q,Q,[1,1-(1-Z)*d,1]),Q[4]=-W.x/W.y*d,wt.rotateZ(Q,Q,w),wt.multiply(Q,K,Q),Q}(e.projection,0,e.center,n,t),o=mP(e);return wt.scale(r,r,[o,o,1]),r}function mP(e){const t=e.projection,n=vf(e.projection,e.zoom,e.width,e.height),r=gP(t,e.center),o=gP(t,Ke.convert(t.center));return Math.pow(2,r*n+(1-n)*o)}function vf(e,t,n,r,o=1/0){const a=e.range;if(!a)return 0;const c=Math.min(o,Math.max(n,r)),u=Math.log(c/1024)/Math.LN2;return Le(a[0]+u,a[1]+u,t)}const zl=1/4e4;function gP(e,t){const n=jt(t.lat,-Or,Or),r=new Ke(t.lng-180*zl,n),o=new Ke(t.lng+180*zl,n),a=e.project(r.lng,n),c=e.project(o.lng,n),u=xn.fromLngLat(r),d=xn.fromLngLat(o),p=c.x-a.x,m=c.y-a.y,_=d.x-u.x,v=d.y-u.y,x=Math.sqrt((_*_+v*v)/(p*p+m*m));return Math.log(x)/Math.LN2}function _P(e,t,n){const r=Math.cos(n),o=Math.sin(n);return{x:e*r-t*o,y:e*o+t*r}}function Lc(e,t,n){return t*(Rt/(e.tileSize*Math.pow(2,n-e.tileID.overscaledZ)))}const uh={unknown:0,flipRequired:1,flipNotRequired:2},pU=Math.tan(85*Math.PI/180);function Sg(e,t,n,r,o,a,c){const u=wt.create();if(n)if(a.name==="globe"){const d=function(p,m){const{x:_,y:v}=p.point,x=DI(_,v,p.worldSize/p._pixelsPerMercatorPixel,0,0);return wt.multiply(x,x,Kx(qo(m)))}(o,t);wt.multiply(u,u,d)}else{const d=Hu.invert([],c);u[0]=d[0],u[1]=d[1],u[4]=d[2],u[5]=d[3],r||wt.rotateZ(u,u,o.angle)}else wt.multiply(u,o.labelPlaneMatrix,e);return u}function yP(e,t,n,r,o,a,c){const u=Sg(e,t,n,r,o,a,c);return a.name==="globe"&&n||(u[2]=u[6]=u[10]=u[14]=0),u}function vP(e,t,n,r,o,a,c){if(n){if(a.name==="globe"){const u=Sg(e,t,n,r,o,a,c);return wt.invert(u,u),wt.multiply(u,e,u),u}{const u=wt.clone(e),d=wt.identity([]);return d[0]=c[0],d[1]=c[1],d[4]=c[2],d[5]=c[3],wt.multiply(u,u,d),r||wt.rotateZ(u,u,-o.angle),u}}return o.glCoordMatrix}function Fs(e,t,n,r){const o=[e,t,n,1];n?Wn.transformMat4(o,o,r):CP(o,o,r);const a=o[3];return o[0]/=a,o[1]/=a,o[2]/=a,o}function xP(e,t){return Math.min(.5+e/t*.5,1.5)}function mU(e,t){const n=e[0]/e[3],r=e[1]/e[3];return n>=-t[0]&&n<=t[0]&&r>=-t[1]&&r<=t[1]}function gU(e,t,n,r,o,a,c,u,d,p){const m=n.transform,_=r?e.textSizeData:e.iconSizeData,v=oa(_,n.transform.zoom),x=m.projection.name==="globe",w=[256/n.width*2+1,256/n.height*2+1],T=r?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;T.clear();let S=null;x&&(S=r?e.text.globeExtVertexArray:e.icon.globeExtVertexArray);const I=e.lineVertexArray,A=r?e.text.placedSymbolArray:e.icon.placedSymbolArray,R=n.transform.width/n.transform.height;let k,P=!1;for(let O=0;O<A.length;O++){const j=A.get(O),{numGlyphs:G,writingMode:W}=j;if(W!==ur.vertical||P||k===ur.horizontal||(P=!0),k=W,(j.hidden||W===ur.vertical)&&!P){hh(G,T);continue}P=!1;const Z=new N(j.tileAnchorX,j.tileAnchorY);let{x:K,y:Q,z:at}=m.projection.projectTilePoint(Z.x,Z.y,p.canonical);if(d){const[zt,Ft,Ut]=d(Z);K+=zt,Q+=Ft,at+=Ut}const X=[K,Q,at,1];if(Wn.transformMat4(X,X,t),!mU(X,w)){hh(G,T);continue}const ft=X[3],gt=xP(n.transform.getCameraToCenterDistance(m.projection),ft),vt=af(_,v,j),ht=c?vt/gt:vt*gt,pt=Fs(K,Q,at,o);if(pt[3]<=0){hh(G,T);continue}let Ct={};const At=c?null:d,It=TP(j,ht,!1,u,t,o,a,e.glyphOffsetArray,I,T,S,pt,Z,Ct,R,At,m.projection,p,c);P=It.useVertical,At&&It.needsFlipping&&(Ct={}),(It.notEnoughRoom||P||It.needsFlipping&&TP(j,ht,!0,u,t,o,a,e.glyphOffsetArray,I,T,S,pt,Z,Ct,R,At,m.projection,p,c).notEnoughRoom)&&hh(G,T)}r?(e.text.dynamicLayoutVertexBuffer.updateData(T),S&&e.text.globeExtVertexBuffer&&e.text.globeExtVertexBuffer.updateData(S)):(e.icon.dynamicLayoutVertexBuffer.updateData(T),S&&e.icon.globeExtVertexBuffer&&e.icon.globeExtVertexBuffer.updateData(S))}function bP(e,t,n,r,o,a,c,u,d,p,m,_,v,x,w,T){const{lineStartIndex:S,glyphStartIndex:I,segment:A}=u,R=I+u.numGlyphs,k=S+u.lineLength,P=t.getoffsetX(I),O=t.getoffsetX(R-1),j=Eg(e*P,n,r,o,a,c,A,S,k,d,p,m,_,v,!0,x,w,T);if(!j)return null;const G=Eg(e*O,n,r,o,a,c,A,S,k,d,p,m,_,v,!0,x,w,T);return G?{first:j,last:G}:null}function wP(e,t,n,r){return e===ur.horizontal&&Math.abs(r)>Math.abs(n)?{useVertical:!0}:e===ur.vertical?r>0?{needsFlipping:!0}:null:t!==uh.unknown&&function(o,a){return o===0||Math.abs(a/o)>pU}(n,r)?t===uh.flipRequired?{needsFlipping:!0}:null:n<0?{needsFlipping:!0}:null}function TP(e,t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S,I,A){const R=t/24,k=e.lineOffsetX*R,P=e.lineOffsetY*R,{lineStartIndex:O,glyphStartIndex:j,numGlyphs:G,segment:W,writingMode:Z,flipState:K}=e,Q=O+e.lineLength,at=X=>{if(m){const[ht,pt,Ct]=X.up,At=p.length;_g(m,At+0,ht,pt,Ct),_g(m,At+1,ht,pt,Ct),_g(m,At+2,ht,pt,Ct),_g(m,At+3,ht,pt,Ct)}const[ft,gt,vt]=X.point;ch(p,ft,gt,vt,X.angle)};if(G>1){const X=bP(R,u,k,P,n,_,v,e,d,a,x,T,!1,S,I,A);if(!X)return{notEnoughRoom:!0};if(r&&!n){let[ft,gt,vt]=X.first.point,[ht,pt,Ct]=X.last.point;[ft,gt]=Fs(ft,gt,vt,c),[ht,pt]=Fs(ht,pt,Ct,c);const At=wP(Z,K,(ht-ft)*w,pt-gt);if(e.flipState=At&&At.needsFlipping?uh.flipRequired:uh.flipNotRequired,At)return At}at(X.first);for(let ft=j+1;ft<j+G-1;ft++){const gt=Eg(R*u.getoffsetX(ft),k,P,n,_,v,W,O,Q,d,a,x,T,!1,!1,S,I,A);if(!gt)return p.length-=4*(ft-j),{notEnoughRoom:!0};at(gt)}at(X.last)}else{if(r&&!n){const ft=Fs(v.x,v.y,0,o),gt=O+W+1,vt=new N(d.getx(gt),d.gety(gt)),ht=Fs(vt.x,vt.y,0,o),pt=ht[3]>0?ht:EP(v,vt,ft,1,o,void 0,S,I.canonical),Ct=wP(Z,K,(pt[0]-ft[0])*w,pt[1]-ft[1]);if(e.flipState=Ct&&Ct.needsFlipping?uh.flipRequired:uh.flipNotRequired,Ct)return Ct}const X=Eg(R*u.getoffsetX(j),k,P,n,_,v,W,O,Q,d,a,x,T,!1,!1,S,I,A);if(!X)return{notEnoughRoom:!0};at(X)}return{}}function SP(e,t,n,r,o){const{x:a,y:c,z:u}=r.projectTilePoint(e.x,e.y,t);if(!o)return Fs(a,c,u,n);const[d,p,m]=o(e);return Fs(a+d,c+p,u+m,n)}function EP(e,t,n,r,o,a,c,u){const d=SP(e.sub(t)._unit()._add(e),u,o,c,a);return ot.sub(d,n,d),ot.normalize(d,d),ot.scaleAndAdd(d,n,d,r)}function Eg(e,t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S,I){const A=r?e-t:e+t;let R=A>0?1:-1,k=0;r&&(R*=-1,k=Math.PI),R<0&&(k+=Math.PI);let P=u+c+(R>0?0:1)|0,O=o,j=o,G=0,W=0;const Z=Math.abs(A),K=[],Q=[];let at=a,X=at;const ft=()=>EP(X,at,j,Z-G+1,m,v,T,S.canonical);for(;G+W<=Z;){if(P+=R,P<u||P>=d)return null;if(j=O,X=at,K.push(j),x&&Q.push(X),at=new N(p.getx(P),p.gety(P)),O=_[P],!O){const Ft=SP(at,S.canonical,m,T,v);O=Ft[3]>0?_[P]=Ft:ft()}G+=W,W=ot.distance(j,O)}w&&v&&(_[P]&&(O=ft(),W=ot.distance(j,O)),_[P]=O);const gt=(Z-G)/W,vt=at.sub(X)._mult(gt)._add(X),ht=ot.sub([],O,j),pt=ot.scaleAndAdd([],j,ht,gt);let Ct=[0,0,1],At=ht[0],It=ht[1];if(I&&(Ct=T.upVector(S.canonical,vt.x,vt.y),Ct[0]!==0||Ct[1]!==0||Ct[2]!==1)){const Ft=[Ct[2],0,-Ct[0]],Ut=ot.cross([],Ct,Ft);ot.normalize(Ft,Ft),ot.normalize(Ut,Ut),At=ot.dot(ht,Ft),It=ot.dot(ht,Ut)}if(n){const Ft=ot.cross([],Ct,ht);ot.normalize(Ft,Ft),ot.scaleAndAdd(pt,pt,Ft,n*R)}const zt=k+Math.atan2(It,At);return K.push(pt),x&&Q.push(vt),{point:pt,angle:zt,path:K,tilePath:Q,up:Ct}}function hh(e,t){const n=t.length,r=n+4*e;t.resize(r),t.float32.fill(-1/0,4*n,4*r)}function CP(e,t,n){const r=t[0],o=t[1];return e[0]=n[0]*r+n[4]*o+n[12],e[1]=n[1]*r+n[5]*o+n[13],e[3]=n[3]*r+n[7]*o+n[15],e}const MP=(e,t,n)=>(1-n)*e+n*t,IP=e=>e*e*e*e*e;class F1{constructor(t,n,r,o,a,c,u){this.tileSize=512,this._renderWorldCopies=a===void 0||a,this._minZoom=t||0,this._maxZoom=n||22,this._minPitch=r??0,this._maxPitch=o??60,this.setProjection(c),this.setMaxBounds(u),this.width=0,this.height=0,this._center=new Ke(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new D1,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Tg,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const t=new F1(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(t,n=!1){const r=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||r)&&this._updateCameraOnTerrain(),(t||r)&&this._constrainCamera(n),this._calcMatrices()}getProjection(){return Pe(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const n=this.projection?this.getProjection():void 0;this.projection=dg(this.projectionOptions);const r=!et(n,this.getProjection());return r&&this._calcMatrices(),this.mercatorFromTransition=!1,r}setOrthographicProjectionAtLowPitch(t){return this._orthographicProjectionAtLowPitch!==t&&(this._orthographicProjectionAtLowPitch=t,this._calcMatrices(),!0)}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=dg({name:"mercator"});const n=t!==this.projection.name;return n&&this._calcMatrices(),n}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return Hn(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new N(this.width,this.height)}get bearing(){return we(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const n=-t*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=Hu.create(),Hu.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const n=jt(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=it(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const n=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==n&&(this._unmodified=!1,this._setZoom(n),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){const t=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,n=this.elevation&&t===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||t===Number.NEGATIVE_INFINITY&&(!n||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const r=this._elevation;n||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&r.exaggeration()&&this._centerAltitudeValidForExaggeration!==r.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*r.exaggeration(),this._centerAltitudeValidForExaggeration=r.exaggeration()):(this._centerAltitude=t||0,this._centerAltitudeValidForExaggeration=r.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,n=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],r=this.horizonLineFromTop();let o=0,a=0;for(let c=0;c<n.length;c++){const u=new N(n[c][0]*this.width,r+n[c][1]*(this.height-r)),d=t.pointCoordinate(u);if(!d)continue;const p=1/Math.hypot(d[0]-this._camera.position[0],d[1]-this._camera.position[1]);o+=d[3]*p,a+=p}return a===0?NaN:o/a}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const t=this._seaLevelZoom,n=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),r=this.pixelsPerMeter/this.worldSize*n,o=this._mercatorZfromZoom(t),a=this._mercatorZfromZoom(this._maxZoom),c=Math.max(o-r,a);this._setZoom(this._zoomFromMercatorZ(c))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const n=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let r;r=t.z<this._camera.position[2]?[n.x,n.y,n.z]:[t.x,t.y,t.z];const o=ot.length(ot.sub([],this._camera.position,r));return jt(this._zoomFromMercatorZ(o),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let n=!1;if(t.orientation&&!Ri.exactEquals(t.orientation,this._camera.orientation)&&(n=this._setCameraOrientation(t.orientation)),t.position){const r=[t.position.x,t.position.y,t.position.z];ot.exactEquals(r,this._camera.position)||(this._setCameraPosition(r),n=!0)}n&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,n=new fP;return n.position=new xn(t[0],t[1],t[2]),n.orientation=this._camera.orientation,n._elevation=this.elevation,n._renderWorldCopies=this.renderWorldCopies,n}_setCameraOrientation(t){if(!Ri.length(t))return!1;Ri.normalize(t,t);const n=ot.transformQuat([],[0,0,-1],t),r=ot.transformQuat([],[0,-1,0],t);if(r[2]<0)return!1;const o=dP(n,r);return!!o&&(this._camera.orientation=o,!0)}_setCameraPosition(t){const n=this.zoomScale(this.minZoom)*this.tileSize,r=this.zoomScale(this.maxZoom)*this.tileSize,o=this.cameraToCenterDistance;t[2]=jt(t[2],o/r,o/n),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,n,r){this._unmodified=!1,this._edgeInsets.interpolate(t,n,r),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const n=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,n)}getVisibleUnwrappedCoordinates(t){const n=[new Gx(0,t)];if(this.renderWorldCopies){const r=this.pointCoordinate(new N(0,0)),o=this.pointCoordinate(new N(this.width,0)),a=this.pointCoordinate(new N(this.width,this.height)),c=this.pointCoordinate(new N(0,this.height)),u=Math.floor(Math.min(r.x,o.x,a.x,c.x)),d=Math.floor(Math.max(r.x,o.x,a.x,c.x)),p=1;for(let m=u-p;m<=d+p;m++)m!==0&&n.push(new Gx(m,t))}return n}isLODDisabled(t){return(!t||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(t,n,r){let o=[];if(n[0]===0&&n[1]===0)return o;for(const c of t){const u=c.canonical,d=c.overscaledZ,p=c.wrap,m=1<<u.z,_=u.x+1<m,v=u.x>0,x=u.y+1<m,w=u.y>0,T=c.wrap-(v?0:1),S=c.wrap+(_?0:1),I=v?u.x-1:m-1,A=_?u.x+1:0;n[0]<0?(o.push(new Pn(d,S,u.z,A,u.y)),n[1]<0&&x&&(o.push(new Pn(d,p,u.z,u.x,u.y+1)),o.push(new Pn(d,S,u.z,A,u.y+1))),n[1]>0&&w&&(o.push(new Pn(d,p,u.z,u.x,u.y-1)),o.push(new Pn(d,S,u.z,A,u.y-1)))):n[0]>0?(o.push(new Pn(d,T,u.z,I,u.y)),n[1]<0&&x&&(o.push(new Pn(d,p,u.z,u.x,u.y+1)),o.push(new Pn(d,T,u.z,I,u.y+1))),n[1]>0&&w&&(o.push(new Pn(d,p,u.z,u.x,u.y-1)),o.push(new Pn(d,T,u.z,I,u.y-1)))):n[1]<0&&x?o.push(new Pn(d,p,u.z,u.x,u.y+1)):w&&o.push(new Pn(d,p,u.z,u.x,u.y-1))}if(o.length>1){o.sort((d,p)=>d.overscaledZ-p.overscaledZ||d.wrap-p.wrap||d.canonical.z-p.canonical.z||d.canonical.x-p.canonical.x||d.canonical.y-p.canonical.y);let c=0,u=0;for(;u<o.length;)o[u].equals(o[c])?++u:o[++c]=o[u++];o.length=c+1}const a=[];for(const c of o)o.some(u=>c.isChildOf(u))||a.push(c);return o=a.filter(c=>!t.some(u=>!!(c.overscaledZ<r&&u.isChildOf(c))||c.equals(u)||c.isChildOf(u))),o}coveringTiles(t){let n=this.coveringZoomLevel(t);const r=n,o=this.elevation&&this.elevation.exaggeration(),a=o&&!t.isTerrainDEM,c=this.projection.name==="mercator";if(t.minzoom!==void 0&&n<t.minzoom)return[];t.maxzoom!==void 0&&n>t.maxzoom&&(n=t.maxzoom);const u=this.locationCoordinate(this.center),d=this.center.lat,p=1<<n,m=[p*u.x,p*u.y,0],_=this.projection.name==="globe",v=!_,x=Na.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,v),w=_?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),T=p*Hn(1,this.center.lat),S=this._camera.position[2]/Hn(1,this.center.lat),I=[p*w.x,p*w.y,S*(v?1:T)],A=_||o,R=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),k=this.isLODDisabled(!0)?n:0;let P;if(this._elevation&&t.isTerrainDEM)P=1e4*this._elevation.exaggeration();else if(this._elevation){const ht=this._elevation.getMinMaxForVisibleTiles();P=ht?ht.max:this._centerAltitude}else P=this._centerAltitude;const O=t.isTerrainDEM?-P:this._elevation?this._elevation.getMinElevationBelowMSL():0,j=this.projection.isReprojectedInTileSpace?mP(this):1,G=ht=>{const Ct=new xn(ht.x+25e-6,ht.y,ht.z),At=new xn(ht.x,ht.y+25e-6,ht.z),It=ht.toLngLat(),zt=Ct.toLngLat(),Ft=At.toLngLat(),Ut=this.locationCoordinate(It),Pt=this.locationCoordinate(zt),Ht=this.locationCoordinate(Ft),he=Math.hypot(Pt.x-Ut.x,Pt.y-Ut.y),de=Math.hypot(Ht.x-Ut.x,Ht.y-Ut.y);return Math.sqrt(he*de)*j/25e-6},W=ht=>{const pt=P,Ct=O;return{aabb:JA(this,p,0,0,0,ht,Ct,pt,this.projection),zoom:0,x:0,y:0,minZ:Ct,maxZ:pt,wrap:ht,fullyVisible:!1}},Z=[];let K=[];const Q=n,at=t.reparseOverscaled?r:n,X=ht=>ht*ht,ft=X((S-this._centerAltitude)*T),gt=ht=>{if(!this._elevation||!ht.tileID||!c)return;const pt=this._elevation.getMinMaxForTile(ht.tileID),Ct=ht.aabb;pt?(Ct.min[2]=pt.min,Ct.max[2]=pt.max,Ct.center[2]=(Ct.min[2]+Ct.max[2])/2):(ht.shouldSplit=vt(ht),ht.shouldSplit||(Ct.min[2]=Ct.max[2]=Ct.center[2]=this._centerAltitude))},vt=ht=>{if(ht.zoom<k)return!0;if(ht.zoom===Q)return!1;if(ht.shouldSplit!=null)return ht.shouldSplit;const pt=ht.aabb.distanceX(I),Ct=ht.aabb.distanceY(I);let At=ft,It=1;if(_){At=X(ht.aabb.distanceZ(I));const Ut=Math.pow(2,ht.zoom),Pt=qr((ht.y+1)/Ut),Ht=qr(ht.y/Ut),he=Math.min(Math.max(d,Pt),Ht),de=jm(he)/jm(d);if(It=he===d?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,de/this._mercatorScaleRatio),this.zoom<=tf&&ht.zoom===Q-1&&de>=.9)return!0}else if(a&&(At=X(ht.aabb.distanceZ(I)*T)),this.projection.isReprojectedInTileSpace&&r<=5){const Ut=Math.pow(2,ht.zoom),Pt=G(new xn((ht.x+.5)/Ut,(ht.y+.5)/Ut));It=Pt>.85?1:Pt}const zt=pt*pt+Ct*Ct+At,Ft=X((1<<Q-ht.zoom)*R*It*((Ut,Pt)=>{if(Pt*X(.707)<Ut)return 1;const Ht=Math.sqrt(Pt/Ut);return Ht/(1.4144271570014144+(Math.pow(1.1,Ht-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(At,ft),zt));return zt<Ft};if(this.renderWorldCopies)for(let ht=1;ht<=3;ht++)Z.push(W(-ht)),Z.push(W(ht));for(Z.push(W(0));Z.length>0;){const ht=Z.pop(),pt=ht.x,Ct=ht.y;let At=ht.fullyVisible;const It=()=>this.projection.name==="globe"&&(ht.y===0||ht.y===(1<<ht.zoom)-1);if(!At){let zt=A?ht.aabb.intersects(x):ht.aabb.intersectsFlat(x);if(zt===0&&It()){const Ft=new hs(ht.zoom,pt,Ct);zt=Zx(this,p,Ft,!0).intersects(x)}if(zt===0)continue;At=zt===2}if(ht.zoom!==Q&&vt(ht))for(let zt=0;zt<4;zt++){const Ft=(pt<<1)+zt%2,Ut=(Ct<<1)+(zt>>1),Pt={aabb:c?ht.aabb.quadrant(zt):JA(this,p,ht.zoom+1,Ft,Ut,ht.wrap,ht.minZ,ht.maxZ,this.projection),zoom:ht.zoom+1,x:Ft,y:Ut,wrap:ht.wrap,fullyVisible:At,tileID:void 0,shouldSplit:void 0,minZ:ht.minZ,maxZ:ht.maxZ};a&&!_&&(Pt.tileID=new Pn(ht.zoom+1===Q?at:ht.zoom+1,ht.wrap,ht.zoom+1,Ft,Ut),gt(Pt)),Z.push(Pt)}else{const zt=ht.zoom===Q?at:ht.zoom;if(t.minzoom&&t.minzoom>zt)continue;if(!At){let Ht=A?ht.aabb.intersectsPrecise(x):ht.aabb.intersectsPreciseFlat(x);if(Ht===0&&It()){const he=new hs(ht.zoom,pt,Ct);Ht=Zx(this,p,he,!0).intersectsPrecise(x)}if(Ht===0)continue}const Ft=m[0]-(.5+pt+(ht.wrap<<ht.zoom))*(1<<n-ht.zoom),Ut=m[1]-.5-Ct,Pt=ht.tileID?ht.tileID:new Pn(zt,ht.wrap,ht.zoom,pt,Ct);K.push({tileID:Pt,distanceSq:Ft*Ft+Ut*Ut})}}if(this.fogCullDistSq){const ht=this.fogCullDistSq,pt=this.horizonLineFromTop();K=K.filter(Ct=>{const At=[0,0,0,1],It=[Rt,Rt,0,1],zt=this.calculateFogTileMatrix(Ct.tileID.toUnwrapped());Wn.transformMat4(At,At,zt),Wn.transformMat4(It,It,zt);const Ft=function(Ht,he,de){let _e=0;for(let xe=0;xe<2;++xe)Ht[xe]>0&&(_e+=(Ht[xe]-0)*(Ht[xe]-0)),he[xe]<0&&(_e+=(0-he[xe])*(0-he[xe]));return _e}(Wn.min([],At,It),Wn.max([],At,It));if(Ft===0)return!0;let Ut=!1;const Pt=this._elevation;if(Pt&&Ft>ht&&pt!==0){const Ht=this.calculateProjMatrix(Ct.tileID.toUnwrapped());let he;t.isTerrainDEM||(he=Pt.getMinMaxForTile(Ct.tileID)),he||(he={min:O,max:P});const de=function(xe){const He=Math.round((xe+45+360)%360/90)%4;return Vt[He]}(this.rotation),_e=[de[0]*Rt,de[1]*Rt,he.max];ot.transformMat4(_e,_e,Ht),Ut=(1-_e[1])*this.height*.5<pt}return Ft<ht||Ut})}return K.sort((ht,pt)=>ht.distanceSq-pt.distanceSq).map(ht=>ht.tileID)}resize(t,n){this.width=t,this.height=n,this.pixelsToGLUnits=[2/t,-2/n],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const n=jt(t.lat,-Or,Or),r=this.projection.project(t.lng,n);return new N(r.x*this.worldSize,r.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/Hn(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,n){let r,o;const a=this.centerPoint;if(this.projection.name==="globe"){const u=this.worldSize;r=(n.x-a.x)/u,o=(n.y-a.y)/u}else{const u=this.pointCoordinate(n),d=this.pointCoordinate(a);r=u.x-d.x,o=u.y-d.y}const c=this.locationCoordinate(t);this.setLocation(new xn(c.x-r,c.y-o))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(t,n){const r=n?Hn(n,t.lat):void 0,o=this.projection.project(t.lng,t.lat);return new xn(o.x,o.y,r)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,n){const r=n??this._centerAltitude,o=[t.x,t.y,0,1],a=[t.x,t.y,1,1];Wn.transformMat4(o,o,this.pixelMatrixInverse),Wn.transformMat4(a,a,this.pixelMatrixInverse);const c=a[3];Wn.scale(o,o,1/o[3]),Wn.scale(a,a,1/c);const u=o[2],d=a[2];return{p0:o,p1:a,t:u===d?0:(r-u)/(d-u)}}screenPointToMercatorRay(t){const n=[t.x,t.y,0,1],r=[t.x,t.y,1,1];return Wn.transformMat4(n,n,this.pixelMatrixInverse),Wn.transformMat4(r,r,this.pixelMatrixInverse),Wn.scale(n,n,1/n[3]),Wn.scale(r,r,1/r[3]),n[2]=Hn(n[2],this._center.lat)*this.worldSize,r[2]=Hn(r[2],this._center.lat)*this.worldSize,Wn.scale(n,n,1/this.worldSize),Wn.scale(r,r,1/this.worldSize),new zm([n[0],n[1],n[2]],ot.normalize([],ot.sub([],r,n)))}rayIntersectionCoordinate(t){const{p0:n,p1:r,t:o}=t,a=Hn(n[2],this._center.lat),c=Hn(r[2],this._center.lat);return new xn(Xe(n[0],r[0],o)/this.worldSize,Xe(n[1],r[1],o)/this.worldSize,Xe(a,c,o))}pointCoordinate(t,n=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,n)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let n=this.projection.pointCoordinate3D(this,t.x,t.y);if(n)return new xn(n[0],n[1],n[2]);let r=0,o=this.horizonLineFromTop();if(t.y>o)return this.pointCoordinate(t);const a=.02*o,c=t.clone();for(let u=0;u<10&&o-r>a;u++){c.y=Xe(r,o,.66);const d=this.projection.pointCoordinate3D(this,c.x,c.y);d?(o=c.y,n=d):r=c.y}return n?new xn(n[0],n[1],n[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}isPointOnSurface(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=wl)return!this.isPointAboveHorizon(t);const n=this.pointCoordinate(t);return n.y>=0&&n.y<=1}_coordinatePoint(t,n){const r=n&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,o=[t.x*this.worldSize,t.y*this.worldSize,r+t.toAltitude(),1];return Wn.transformMat4(o,o,this.pixelMatrix),o[3]>0?new N(o[0]/o[3],o[1]/o[3]):new N(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:n}=this._edgeInsets,r=this.height-this._edgeInsets.bottom,o=this.width-this._edgeInsets.right,a=this.pointLocation3D(new N(n,t)),c=this.pointLocation3D(new N(o,t)),u=this.pointLocation3D(new N(o,r)),d=this.pointLocation3D(new N(n,r));let p=Math.min(a.lng,c.lng,u.lng,d.lng),m=Math.max(a.lng,c.lng,u.lng,d.lng),_=Math.min(a.lat,c.lat,u.lat,d.lat),v=Math.max(a.lat,c.lat,u.lat,d.lat);const x=Math.pow(2,-this.zoom)/16*270,w=this.projection.name==="globe"?1:4,T=(S,I,A,R,k)=>{const P=(S+A)/2,O=(I+R)/2,j=new N(P,O),{lng:G,lat:W}=this.pointLocation3D(j),Z=Math.max(0,p-G,_-W,G-m,W-v);p=Math.min(p,G),m=Math.max(m,G),_=Math.min(_,W),v=Math.max(v,W),(k<w||Z>x)&&(T(S,I,P,O,k+1),T(P,O,A,R,k+1))};if(T(n,t,o,t,1),T(o,t,o,r,1),T(o,r,n,r,1),T(n,r,n,t,1),this.projection.name==="globe"){const[S,I]=function(A){const R=wt.identity(new Float64Array(16));wt.multiply(R,A.pixelMatrix,A.globeMatrix);const k=[0,ds,0],P=[0,fs,0];return ot.transformMat4(k,k,R),ot.transformMat4(P,P,R),[k[0]>0&&k[0]<=A.width&&k[1]>0&&k[1]<=A.height&&!Nm(A,new Ke(A.center.lat,90)),P[0]>0&&P[0]<=A.width&&P[1]>0&&P[1]<=A.height&&!Nm(A,new Ke(A.center.lat,-90))]}(this);S?(v=90,m=180,p=-180):I&&(_=-90,m=180,p=-180)}return new To(new Ke(p,_),new Ke(m,v))}_getBoundsRectangular(t,n){const{top:r,left:o}=this._edgeInsets,a=this.height-this._edgeInsets.bottom,c=this.width-this._edgeInsets.right,u=new N(o,r),d=new N(c,r),p=new N(c,a),m=new N(o,a);let _=this.pointCoordinate(u,t),v=this.pointCoordinate(d,t);const x=this.pointCoordinate(p,n),w=this.pointCoordinate(m,n),T=(S,I)=>(I.y-S.y)/(I.x-S.x);return _.y>1&&v.y>=0?_=new xn((1-w.y)/T(w,_)+w.x,1):_.y<0&&v.y<=1&&(_=new xn(-w.y/T(w,_)+w.x,0)),v.y>1&&_.y>=0?v=new xn((1-x.y)/T(x,v)+x.x,1):v.y<0&&_.y<=1&&(v=new xn(-x.y/T(x,v)+x.x,0)),new To().extend(this.coordinateLocation(_)).extend(this.coordinateLocation(v)).extend(this.coordinateLocation(w)).extend(this.coordinateLocation(x))}_getBoundsRectangularTerrain(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBoundsRectangular(0,0);const n=t.visibleDemTiles.reduce((r,o)=>{if(o.dem){const a=o.dem.tree;r.min=Math.min(r.min,a.minimums[0]),r.max=Math.max(r.max,a.maximums[0])}return r},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(n.min*t.exaggeration(),n.max*t.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(t=!0){const n=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,r=this.height/2-n*(1-this._horizonShift);return t?Math.max(0,r):r}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-Or,this.maxLat=Or,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=Qr(this.minLng)*this.tileSize,this.worldMaxX=Qr(this.maxLng)*this.tileSize,this.worldMinY=oi(this.maxLat)*this.tileSize,this.worldMaxY=oi(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,n){return this.projection.createTileMatrix(this,n,t)}calculateDistanceTileData(t){const n=t.key,r=this._distanceTileDataCache;if(r[n])return r[n];const o=t.canonical,a=1/this.height,c=this.cameraWorldSize,u=c/this.zoomScale(o.z),d=(o.x+Math.pow(2,o.z)*t.wrap)*u,p=o.y*u,m=this.point;m.x*=c/this.worldSize,m.y*=c/this.worldSize;const _=this.angle,v=Math.sin(-_),x=-Math.cos(-_);return r[n]={bearing:[v,x],center:[(m.x-d)*a,(m.y-p)*a],scale:u/Rt*a},r[n]}calculateFogTileMatrix(t){const n=t.key,r=this._fogTileMatrixCache;if(r[n])return r[n];const o=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return wt.multiply(o,this.worldToFogMatrix,o),r[n]=new Float32Array(o),r[n]}calculateProjMatrix(t,n=!1,r=!1){const o=t.key;let a;if(a=r?this._expandedProjMatrixCache:n?this._alignedProjMatrixCache:this._projMatrixCache,a[o])return a[o];const c=this.calculatePosMatrix(t,this.worldSize);let u;return u=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:r?this.expandedFarZProjMatrix:n?this.alignedProjMatrix:this.projMatrix,wt.multiply(c,u,c),a[o]=new Float32Array(c),a[o]}calculatePixelsToTileUnitsMatrix(t){const n=t.tileID.key,r=this._pixelsToTileUnitsCache;if(r[n])return r[n];const o=function(a,c){const{scale:u}=a.tileTransform,d=u*Rt/(a.tileSize*Math.pow(2,c.zoom-a.tileID.overscaledZ+a.tileID.canonical.z));return Hu.scale(new Float32Array(4),c.inverseAdjustmentMatrix,[d,d])}(t,this);return r[n]=o,r[n]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const t=1/this.worldSize,n=wt.fromScaling([],[t,t,t]);return wt.multiply(n,n,this.globeMatrix),n}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const t=this._elevation;this._updateCameraState();const n=Hn(1,this._center.lat)*this.worldSize,r=this._computeCameraPosition(n),o=this._camera.forward(),a=Hn(1,this._center.lat);r[2]/=a,o[2]/=a,ot.normalize(o,o);const c=t.raycast(r,o,t.exaggeration());if(c){const u=ot.scaleAndAdd([],r,o,c),d=new xn(u[0],u[1],Hn(u[2],qr(u[1]))),p=(d.z+ot.length([d.x-r[0],d.y-r[1],d.z-r[2]*a]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(p),this._centerAltitude=d.toAltitude(),this._center=this.coordinateLocation(d),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(t=!1){if(!this._elevation)return;const n=this._elevation,r=Hn(1,this._center.lat)*this.worldSize,o=this._computeCameraPosition(r),a=n.getAtPointOrZero(new xn(...o)),c=this.pixelsPerMeter/this.worldSize*a,u=this._minimumHeightOverTerrain(),d=o[2]-c;if(d<=u)if(d<0||t){const p=this.locationCoordinate(this._center,this._centerAltitude),m=[o[0],o[1],p.z-o[2]],_=ot.length(m);m[2]-=(u-d)/this._pixelsPerMercatorPixel;const v=ot.length(m);if(v===0)return;ot.scale(m,m,_/v*this._pixelsPerMercatorPixel),this._camera.position=[o[0],o[1],p.z*this._pixelsPerMercatorPixel-m[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const v=this.center;return v.lat=jt(v.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(v.lng=jt(v.lng,this.minLng,this.maxLng)),this.center=v,void(this._constraining=!1)}const n=this._unmodified,{x:r,y:o}=this.point;let a=0,c=r,u=o;const d=this.width/2,p=this.height/2,m=this.worldMinY*this.scale,_=this.worldMaxY*this.scale;if(o-p<m&&(u=m+p),o+p>_&&(u=_-p),_-m<this.height&&(a=Math.max(a,this.height/(_-m)),u=(_+m)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const v=this.worldMinX*this.scale,x=this.worldMaxX*this.scale,w=this.worldSize/2-(v+x)/2;c=(r+w+this.worldSize)%this.worldSize-w,c-d<v&&(c=v+d),c+d>x&&(c=x-d),x-v<this.width&&(a=Math.max(a,this.width/(x-v)),c=(x+v)/2)}c===r&&u===o||(this.center=this.unproject(new N(c,u))),a&&(this.zoom+=this.scaleZoom(a)),this._constrainCamera(),this._unmodified=n,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,n=this.projection.name==="globe",r=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=Hn(1,this.center.lat)/Hn(1,45));const o=vf(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,o),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const a=this.projection.zAxisUnit==="meters"?r:1,c=this._camera.getWorldToCamera(this.worldSize,a);let u;const d=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(d[8]=2*-t.x/this.width,d[9]=2*t.y/this.height,this.isOrthographic){let W=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Z=W*this.aspect,K=-Z,Q=-W;Z-=t.x,K-=t.x,W+=t.y,Q+=t.y,u=this._camera.getCameraToClipOrthographic(K,Z,Q,W,this._nearZ,this._farZ),((at,X,ft,gt)=>{for(let vt=0;vt<16;vt++)at[vt]=MP(X[vt],ft[vt],gt)})(u,u,d,IP(this.pitch>=15?1:this.pitch/15))}else u=d;const p=wt.mul([],d,c);let m=wt.mul([],u,c);if(this.projection.isReprojectedInTileSpace){const W=this.locationCoordinate(this.center),Z=wt.identity([]);wt.translate(Z,Z,[W.x*this.worldSize,W.y*this.worldSize,0]),wt.multiply(Z,Z,pP(this)),wt.translate(Z,Z,[-W.x*this.worldSize,-W.y*this.worldSize,0]),wt.multiply(m,m,Z),wt.multiply(p,p,Z),this.inverseAdjustmentMatrix=function(K){const Q=pP(K,!0);return Hu.invert([],[Q[0],Q[1],Q[4],Q[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=wt.scale([],m,[this.worldSize,this.worldSize,this.worldSize/a,1]),this.projMatrix=m,this.invProjMatrix=wt.invert(new Float64Array(16),this.projMatrix),n){const W=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);W[8]=2*-t.x/this.width,W[9]=2*t.y/this.height,this.expandedFarZProjMatrix=wt.mul([],W,c)}else this.expandedFarZProjMatrix=this.projMatrix;const _=wt.invert([],u);this.frustumCorners=Wx.fromInvProjectionMatrix(_,this.horizonLineFromTop(),this.height),this.cameraFrustum=Na.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!n);const v=new Float32Array(16);wt.identity(v),wt.scale(v,v,[1,-1,1]),wt.rotateX(v,v,this._pitch),wt.rotateZ(v,v,this.angle);const x=wt.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=wt.clone(x);const w=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;x[8]=2*-t.x/this.width,x[9]=2*(t.y+w)/this.height,this.skyboxMatrix=wt.multiply(v,x,v);const T=this.point,S=T.x,I=T.y,A=this.width%2/2,R=this.height%2/2,k=Math.cos(this.angle),P=Math.sin(this.angle),O=S-Math.round(S)+k*A+P*R,j=I-Math.round(I)+k*R+P*A,G=new Float64Array(m);if(wt.translate(G,G,[O>.5?O-1:O,j>.5?j-1:j,0]),this.alignedProjMatrix=G,m=wt.create(),wt.scale(m,m,[this.width/2,-this.height/2,1]),wt.translate(m,m,[1,-1,0]),this.labelPlaneMatrix=m,m=wt.create(),wt.scale(m,m,[1,-1,1]),wt.translate(m,m,[-1,-1,0]),wt.scale(m,m,[2/this.width,2/this.height,1]),this.glCoordMatrix=m,this.pixelMatrix=wt.multiply(new Float64Array(16),this.labelPlaneMatrix,p),this._calcFogMatrices(),this._distanceTileDataCache={},m=wt.invert(new Float64Array(16),this.pixelMatrix),!m)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=m,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=function(Z){const{x:K,y:Q}=Z.point,{lng:at,lat:X}=Z._center;return DI(K,Q,Z.worldSize,at,X)}(this);const W=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=ot.transformMat4(W,W,c),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=m;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,n=this.cameraPixelsPerMeter,r=this._camera.position,o=1/this.height/this._pixelsPerMercatorPixel,a=[t,t,n];ot.scale(a,a,o),ot.scale(r,r,-1),ot.multiply(r,r,a);const c=wt.create();wt.translate(c,c,r),wt.scale(c,c,a),this.mercatorFogMatrix=c,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,n,o)}_computeCameraPosition(t){const n=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,r=this._camera.forward(),o=this.point,a=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*n-t/this.worldSize*this._centerAltitude;return[o.x/this.worldSize-r[0]*a,o.y/this.worldSize-r[1]*a,t/this.worldSize*this._centerAltitude-r[2]*a]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const n=this._maxCameraBoundsDistance()*Math.cos(this._pitch),r=this._camera.position[2],o=t[2];let a=1;this.projection.wrap&&(this.center=this.center.wrap()),o>0&&(a=Math.min((n-r)/o,1)),this._camera.position=ot.scaleAndAdd([],this._camera.position,t,a),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,n=this._camera.forward(),{pitch:r,bearing:o}=this._camera.getPitchBearing(),a=Hn(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,c=this._mercatorZfromZoom(this._maxZoom)*Math.cos(it(this._maxPitch)),u=Math.max((t[2]-a)/Math.cos(r),c),d=this._zoomFromMercatorZ(u);ot.scaleAndAdd(t,t,n,u),this._pitch=jt(r,it(this.minPitch),it(this.maxPitch)),this.angle=we(o,-Math.PI,Math.PI),this._setZoom(jt(d,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new xn(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}zoomFromMercatorZAdjusted(t){let n=0,r=wl,o=0,a=1/0;for(;r-n>1e-6&&r>n;){const c=n+.5*(r-n),u=this.tileSize*Math.pow(2,c),d=this.getCameraToCenterDistance(this.projection,c,u),p=this.scaleZoom(d/(t*this.tileSize)),m=Math.abs(c-p);m<a&&(a=m,o=c),c<p?n=c:r=c}return o}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(dt("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,n){const r=Math.min(t.x,n.x),o=Math.max(t.x,n.x),a=Math.min(t.y,n.y),c=Math.max(t.y,n.y);if(a<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const u=[new N(r,a),new N(o,c),new N(r,c),new N(o,a)],d=this.renderWorldCopies?-3:0,p=this.renderWorldCopies?4:1;for(const m of u){const _=this.pointRayIntersection(m);if(_.t<0)return!0;const v=this.rayIntersectionCoordinate(_);if(v.x<d||v.y<0||v.x>p||v.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+Tt(this.fovAboveCenter)>88||this.anyCornerOffEdge(new N(0,0),new N(this.width,this.height))}zoomDeltaToMovement(t,n){const r=ot.length(ot.sub([],this._camera.position,t)),o=this._zoomFromMercatorZ(r)+n;return r-this._mercatorZfromZoom(o)}getCameraPoint(){if(this.projection.name==="globe"){const t=function([n,r,o],a){const c=[n,r,o,1];Wn.transformMat4(c,c,a);const u=c[3]=Math.max(c[3],1e-6);return c[0]/=u,c[1]/=u,c[2]/=u,c}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new N(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new N(0,t))}}getCameraToCenterDistance(t,n=this.zoom,r=this.worldSize){const o=vf(t,n,this.width,this.height,1024),a=t.pixelSpaceConversion(this.center.lat,r,o);let c=.5/Math.tan(.5*this._fov)*this.height*a;return this.isOrthographic&&(c=MP(1,c,IP(this.pitch>=15?1:this.pitch/15))),c}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&wt.multiply(t,t,this.globeMatrix),t}getFrustum(t){return Na.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,t,this.projection.zAxisUnit==="meters")}}function AP(e,t,n){wt.identity(e),wt.rotateZ(e,e,it(t[2])),wt.rotateX(e,e,it(t[0])),wt.rotateY(e,e,it(t[1])),wt.scale(e,e,n),wt.multiply(e,e,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Cg(e,t,n,r,o,a,c,u){const d=[n[0]-t[0],n[1]-t[1],0],p=[r[0]-t[0],r[1]-t[1],0];if(ot.length(d)<1e-12||ot.length(p)<1e-12)return Ri.identity(e);const m=ot.cross([],d,p);ot.normalize(m,m),ot.subtract(p,r,t),d[2]=(a-o)*u,p[2]=(c-o)*u;const _=d;return ot.cross(_,d,p),ot.normalize(_,_),Ri.rotationTo(e,m,_)}function PP(e,t,n=!1){const r=fi(t.zoom),o=function(a,c,u){const d=c.worldSize,p=[a[12],a[13],a[14]],m=qr(p[1]/d),_=So(p[0]/d),v=wt.identity([]),x=Hn(1,m)*d,w=Hn(1,0)*d*El(m,c.zoom),T=1/Yx(d);let S=w*T;if(u){const k=vf(c.projection,c.zoom,c.width,c.height,1024);S=T*c.projection.pixelSpaceConversion(c.center.lat,d,k)}const I=fo(m,_);ot.add(I,I,ot.scale([],ot.normalize([],I),x*S*p[2]));const A=function(k){const P=[k[0],k[1],k[2]];let O=[0,1,0];const j=ot.cross([],O,P);return ot.cross(O,P,j),ot.squaredLength(O)===0&&(O=[0,1,0],ot.cross(j,P,O)),ot.normalize(j,j),ot.normalize(O,O),ot.normalize(P,P),[j[0],j[1],j[2],0,O[0],O[1],O[2],0,P[0],P[1],P[2],0,k[0],k[1],k[2],1]}(I);wt.scale(v,v,[S,S,S*x]),wt.translate(v,v,[-p[0],-p[1],-p[2]]);const R=wt.multiply([],c.globeMatrix,A);return wt.multiply(R,R,v),wt.multiply(R,R,a),R}(e,t,n);if(r>0){const a=function(c,u){const d=u.worldSize,p=Hn(1,0)*d*El(u.center.lat,u.zoom)/Yx(d),m=Hn(1,u.center.lat)*d,_=wt.identity([]);return wt.rotateY(_,_,it(u.center.lng)),wt.rotateX(_,_,it(u.center.lat)),wt.translate(_,_,[0,0,Yi]),wt.scale(_,_,[p,p,p*m]),wt.translate(_,_,[u.point.x-.5*d,u.point.y-.5*d,0]),wt.multiply(_,_,c),wt.multiply(_,u.globeMatrix,_)}(e,t);return function(c,u,d){const p=(w,T,S)=>{const I=ot.length(w),A=ot.length(T),R=ja(w,T,S);return ot.scale(R,R,1/ot.length(R)*Xe(I,A,S))},m=p([c[0],c[1],c[2]],[u[0],u[1],u[2]],d),_=p([c[4],c[5],c[6]],[u[4],u[5],u[6]],d),v=p([c[8],c[9],c[10]],[u[8],u[9],u[10]],d),x=ja([c[12],c[13],c[14]],[u[12],u[13],u[14]],d);return[m[0],m[1],m[2],0,_[0],_[1],_[2],0,v[0],v[1],v[2],0,x[0],x[1],x[2],1]}(o,a,r)}return o}const zc=64,_U=[1,1,1];class RP{constructor(t,n,r,o){this.id=t,this.position=n!=null?new Ke(n[0],n[1]):new Ke(0,0),this.orientation=r??[0,0,0],this.nodes=o,this.uploaded=!1,this.aabb=new nr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(t,n){if(wt.multiply(t.matrix,n,t.matrix),t.meshes)for(const r of t.meshes){const o=nr.applyTransform(r.aabb,t.matrix);this.aabb.encapsulate(o)}if(t.children)for(const r of t.children)this._applyTransformations(r,t.matrix)}computeBoundsAndApplyParent(){const t=wt.identity([]);for(const n of this.nodes)this._applyTransformations(n,t)}_positionModelOnTerrain(t,n){const r=t.elevation;if(!r)return 0;const o=nr.projectAabbCorners(this.aabb,this.matrix),a=Hn(1,this.position.lat)*t.worldSize,c=function(I,A){const R=[0,0,1],k=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const P of k){const O=I[P.corners[0]],j=I[P.corners[1]],G=I[P.corners[2]],W=[j[0]-O[0],j[1]-O[1],A*(j[2]-O[2])],Z=ot.cross(W,W,[G[0]-O[0],G[1]-O[1],A*(G[2]-O[2])]);ot.normalize(Z,Z),P.dotProductWithUp=ot.dot(Z,R)}return k.sort((P,O)=>P.dotProductWithUp-O.dotProductWithUp),k[0].corners}(o,a),u=o[c[0]],d=o[c[1]],p=o[c[2]],m=o[c[3]],_=r.getAtPointOrZero(new xn(u[0]/t.worldSize,u[1]/t.worldSize),0),v=r.getAtPointOrZero(new xn(d[0]/t.worldSize,d[1]/t.worldSize),0),x=r.getAtPointOrZero(new xn(p[0]/t.worldSize,p[1]/t.worldSize),0),w=r.getAtPointOrZero(new xn(m[0]/t.worldSize,m[1]/t.worldSize),0),T=(_+w)/2,S=(v+x)/2;return T>S?v<x?Cg(n,d,m,u,v,w,_,a):Cg(n,p,u,m,x,_,w,a):_<w?Cg(n,u,d,p,_,v,x,a):Cg(n,m,p,d,w,x,v,a),Math.max(T,S)}computeModelMatrix(t,n,r,o,a,c,u=!1){const d=t.transform,p=d.zoom,m=d.project(this.position),_=El(this.position.lat,p),v=1/_;wt.identity(this.matrix),wt.translate(this.matrix,this.matrix,[m.x+o[0]*v,m.y+o[1]*v,o[2]]);let x=1,w=1;const T=d.worldSize;if(u){if(d.projection.name==="mercator"){let R=0;d.elevation&&(R=d.elevation.getAtPointOrZero(new xn(m.x/T,m.y/T),0));const k=Wn.transformMat4([],[m.x,m.y,R,1],d.projMatrix)[3]/d.cameraToCenterDistance;x=k,w=k*El(d.center.lat,p)}else if(d.projection.name==="globe"){const R=PP(this.matrix,d),k=wt.multiply([],d.projMatrix,R),P=[0,0,0,1];Wn.transformMat4(P,P,k);const O=P[3]/d.cameraToCenterDistance,j=fi(p),G=d.projection.pixelsPerMeter(this.position.lat,T)*El(this.position.lat,p),W=d.projection.pixelsPerMeter(d.center.lat,T)*El(d.center.lat,p);x=O/Xe(G,WI(d.center.lat),j),w=O*_/G,x*=W,w*=W}}else x=v;wt.scale(this.matrix,this.matrix,[x,x,w]);const S=[...this.matrix],I=this.orientation,A=[];if(AP(A,[I[0]+n[0],I[1]+n[1],I[2]+n[2]],r),wt.multiply(this.matrix,S,A),a&&d.elevation){let R=0;const k=[];if(c&&d.elevation){R=this._positionModelOnTerrain(d,k);const P=wt.fromQuat([],k),O=wt.multiply([],P,A);wt.multiply(this.matrix,S,O)}else R=d.elevation.getAtPointOrZero(new xn(m.x/T,m.y/T),0);R!==0&&(this.matrix[14]+=R)}}upload(t){if(!this.uploaded){for(const n of this.nodes)N1(n,t);for(const n of this.nodes)Mg(n);this.uploaded=!0}}destroy(){for(const t of this.nodes)Ig(t)}}function xf(e,t,n=!1){e.uploaded||(e.gfxTexture=new gr(t,e.image,n?t.gl.R8:t.gl.RGBA,{useMipmap:e.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),e.uploaded=!0,e.image=null)}function yU(e,t,n){e.indexBuffer=t.createIndexBuffer(e.indexArray,!1,!0),e.vertexBuffer=t.createVertexBuffer(e.vertexArray,aU.members,!1,!0),e.normalArray&&(e.normalBuffer=t.createVertexBuffer(e.normalArray,hU.members,!1,!0)),e.texcoordArray&&(e.texcoordBuffer=t.createVertexBuffer(e.texcoordArray,uU.members,!1,!0)),e.colorArray&&(e.colorBuffer=t.createVertexBuffer(e.colorArray,(e.colorArray.bytesPerElement===12?lU:cU).members,!1,!0)),e.featureArray&&(e.pbrBuffer=t.createVertexBuffer(e.featureArray,fU.members,!0)),e.segments=Gn.simpleSegment(0,0,e.vertexArray.length,e.indexArray.length);const r=e.material;r.pbrMetallicRoughness.baseColorTexture&&xf(r.pbrMetallicRoughness.baseColorTexture,t),r.pbrMetallicRoughness.metallicRoughnessTexture&&xf(r.pbrMetallicRoughness.metallicRoughnessTexture,t),r.normalTexture&&xf(r.normalTexture,t),r.occlusionTexture&&xf(r.occlusionTexture,t,n),r.emissionTexture&&xf(r.emissionTexture,t)}function N1(e,t,n){if(e.meshes)for(const r of e.meshes)yU(r,t,n);if(e.children)for(const r of e.children)N1(r,t,n)}function Mg(e){if(e.meshes)for(const t of e.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(e.children)for(const t of e.children)Mg(t)}function Ig(e){if(e.meshes)for(const n of e.meshes)n.vertexBuffer&&(n.vertexBuffer.destroy(),n.indexBuffer.destroy(),n.normalBuffer&&n.normalBuffer.destroy(),n.texcoordBuffer&&n.texcoordBuffer.destroy(),n.colorBuffer&&n.colorBuffer.destroy(),n.pbrBuffer&&n.pbrBuffer.destroy(),n.segments.destroy(),n.material&&((t=n.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(e.children)for(const n of e.children)Ig(n)}class kP{constructor(t,n){this.feature=t,this.instancedDataOffset=n,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class OP{constructor(){this.instancedDataArray=new bx,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class LP{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.fqid),this.projection=t.projection,this.index=t.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(t,n,r,o){this.tileToMeter=nf(r);const a=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:c,id:u,index:d,sourceLayerIndex:p}of t){const m=Cl(c,a);if(!this.layers[0]._featureFilter.filter(new fr(this.zoom),m,r))continue;const _={id:u,sourceLayerIndex:p,index:d,geometry:a?m.geometry:ia(c,r,o),properties:c.properties,type:c.type,patterns:{}},v=this.addFeature(_,_.geometry,m);v&&n.featureIndex.insert(c,_.geometry,d,p,this.index,this.instancesPerModel[v].instancedDataArray.length)}this.lookup=null}update(t,n,r,o){for(const a in this.instancesPerModel){const c=this.instancesPerModel[a];for(const u in t)c.idToFeaturesIndex.hasOwnProperty(u)&&this.evaluate(c.features[c.idToFeaturesIndex[u]],t[u],c,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const n in this.instancesPerModel){const r=this.instancesPerModel[n];for(const o of r.features){const a=this.layers[0],c=o.feature,u=this.canonical,d=a.paint.get("model-rotation").evaluate(c,{},u),p=a.paint.get("model-scale").evaluate(c,{},u),m=a.paint.get("model-translation").evaluate(c,{},u);ot.exactEquals(o.rotation,d)&&ot.exactEquals(o.scale,p)&&ot.exactEquals(o.translation,m)||(this.evaluate(o,o.featureStates,r,!0),t=!0)}}return t}isEmpty(){for(const t in this.instancesPerModel)if(this.instancesPerModel[t].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const n in this.instancesPerModel){const r=this.instancesPerModel[n];r.instancedDataArray.length<0||r.instancedDataArray.length===0||(r.instancedDataBuffer?r.instancedDataBuffer.updateData(r.instancedDataArray):r.instancedDataBuffer=t.createVertexBuffer(r.instancedDataArray,dU.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const t in this.instancesPerModel){const n=this.instancesPerModel[t];n.instancedDataArray.length!==0&&n.instancedDataBuffer&&n.instancedDataBuffer.destroy()}}addFeature(t,n,r){const o=this.layers[0],a=o.layout.get("model-id").evaluate(r,{},this.canonical);if(!a)return dt(`modelId is not evaluated for layer ${o.id} and it is not going to get rendered.`),a;this.instancesPerModel[a]||(this.instancesPerModel[a]=new OP);const c=this.instancesPerModel[a],u=c.instancedDataArray,d=new kP(r,u.length);for(const p of n)for(const m of p){if(m.x<0||m.x>=Rt||m.y<0||m.y>=Rt)continue;const _=(this.lookupDim-1)/Rt,v=this.lookupDim*(m.y*_|0)+m.x*_|0;if(this.lookup){if(this.lookup[v]!==0)continue;this.lookup[v]=1}this.instanceCount++;const x=u.length;u.resize(x+1),c.instancesEvaluatedElevation.push(0),u.float32[16*x]=m.x,u.float32[16*x+1]=m.y}return d.instancedDataCount=c.instancedDataArray.length-d.instancedDataOffset,d.instancedDataCount>0&&(t.id&&(c.idToFeaturesIndex[t.id]=c.features.length),c.features.push(d),this.evaluate(d,{},c,!1)),a}evaluate(t,n,r,o){const a=this.layers[0],c=t.feature,u=this.canonical,d=t.rotation=a.paint.get("model-rotation").evaluate(c,n,u),p=t.scale=a.paint.get("model-scale").evaluate(c,n,u),m=t.translation=a.paint.get("model-translation").evaluate(c,n,u),_=a.paint.get("model-color").evaluate(c,n,u);_.a=a.paint.get("model-color-mix-intensity").evaluate(c,n,u);const v=[];this.maxVerticalOffset<m[2]&&(this.maxVerticalOffset=m[2]),this.maxScale=Math.max(Math.max(this.maxScale,p[0]),Math.max(p[1],p[2])),AP(v,d,p);const x=Math.round(100*_.a)+_.b/1.05;for(let w=0;w<t.instancedDataCount;++w){const T=t.instancedDataOffset+w,S=16*T,I=r.instancedDataArray.float32;let A=0;o&&(A=I[S+6]-r.instancesEvaluatedElevation[T]);const R=0|I[S+1];I[S]=(0|I[S])+_.r/1.05,I[S+1]=R+_.g/1.05,I[S+2]=x,I[S+3]=1/(u.z>10?this.tileToMeter:nf(u,R)),I[S+4]=m[0],I[S+5]=m[1],I[S+6]=m[2]+A,I[S+7]=v[0],I[S+8]=v[1],I[S+9]=v[2],I[S+10]=v[4],I[S+11]=v[5],I[S+12]=v[6],I[S+13]=v[8],I[S+14]=v[9],I[S+15]=v[10],r.instancesEvaluatedElevation[T]=m[2]}}}Te(LP,"ModelBucket",{omit:["layers"]}),Te(OP,"PerModelAttributes"),Te(kP,"ModelFeature");const vU=new Mr({visibility:new te(_t.layout_model.visibility),"model-id":new Be(_t.layout_model["model-id"])});var xU={paint:new Mr({"model-opacity":new te(_t.paint_model["model-opacity"]),"model-rotation":new Be(_t.paint_model["model-rotation"]),"model-scale":new Be(_t.paint_model["model-scale"]),"model-translation":new Be(_t.paint_model["model-translation"]),"model-color":new Be(_t.paint_model["model-color"]),"model-color-mix-intensity":new Be(_t.paint_model["model-color-mix-intensity"]),"model-type":new te(_t.paint_model["model-type"]),"model-cast-shadows":new te(_t.paint_model["model-cast-shadows"]),"model-receive-shadows":new te(_t.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new te(_t.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Be(_t.paint_model["model-emissive-strength"]),"model-roughness":new Be(_t.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Be(_t.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new te(_t.paint_model["model-cutoff-fade-range"])}),layout:vU};const j1=new Float32Array(262144),Dc=new Uint8Array(262144);function zP(e){let t=0;if(e.meshes)for(const n of e.meshes)t=Math.max(t,n.aabb.max[2]);if(e.children)for(const n of e.children)t=Math.max(t,zP(n));return t}const DP=["","wall","door","roof","window","lamp","logo"];class BP{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:t.id,geometry:[],properties:{height:zP(t)}}}}class FP{constructor(t,n,r,o){this.nodes=t,this.id=n,this.modelTraits|=1,this.uploaded=!1,this.hasPattern=!1,r&&(this.modelTraits|=4),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=o,this.dirty=!0,this.needsUpload=!1}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const n=this.getNodesInfo();for(const r of n){const o=r.node;this.uploaded?this.updatePbrBuffer(o):N1(o,t,!0)}for(const r of n)Mg(r.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let n=!1;if(!t.meshes)return n;for(const r of t.meshes)r.pbrBuffer&&(r.pbrBuffer.updateData(r.featureArray),n=!0);return n}needsReEvaluation(t,n,r){const o=t.transform.projectionOptions,a=t.style.getBrightness(),c=this.brightness!==a;return!!(!this.uploaded||this.dirty||o.name!==this.projection.name||bf(r.paint.get("model-color").value,c)||bf(r.paint.get("model-color-mix-intensity").value,c)||bf(r.paint.get("model-roughness").value,c)||bf(r.paint.get("model-emissive-strength").value,c)||bf(r.paint.get("model-height-based-emissive-strength-multiplier").value,c))&&(this.projection=o,this.brightness=a,!0)}evaluateScale(t,n){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const r=this.getNodesInfo(),o=this.id.canonical;for(const a of r){const c=a.feature;a.evaluatedScale=n.paint.get("model-scale").evaluate(c,{},o)}}evaluate(t){const n=this.getNodesInfo();for(const r of n){if(!r.node.meshes)continue;const o=r.feature,a=r.node.meshes&&r.node.meshes[0].featureData,c=r.evaluatedColor[2],u=r.evaluatedRMEA[2],d=this.id.canonical;if(r.hasTranslucentParts=!1,a){for(let p=0;p<DP.length;p++){const m=DP[p];m.length&&(o.properties.part=m);const _=t.paint.get("model-color").evaluate(o,{},d),v=t.paint.get("model-color-mix-intensity").evaluate(o,{},d);r.evaluatedColor[p]=[_.r,_.g,_.b,v],r.evaluatedRMEA[p][0]=t.paint.get("model-roughness").evaluate(o,{},d),r.evaluatedRMEA[p][2]=t.paint.get("model-emissive-strength").evaluate(o,{},d),r.evaluatedRMEA[p][3]=_.a,r.emissionHeightBasedParams[p]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(o,{},d),!r.hasTranslucentParts&&_.a<1&&(r.hasTranslucentParts=!0)}delete o.properties.part,wU(r,c!==r.evaluatedColor[2]||u!==r.evaluatedRMEA[2])}r.evaluatedScale=t.paint.get("model-scale").evaluate(o,{},d),this.updatePbrBuffer(r.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,n,r,o){const a=t.findDEMTileFor(r);if(a&&(a.tileID.canonical!==this.terrainTile||n!==this.terrainExaggeration)){if(a.dem&&a.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=a.tileID.overscaledZ;const c=rh.create(t,r,a);if(!c)return;4&this.modelTraits&&this.updateDEM(t,c,r,o);for(const u of this.getNodesInfo()){const d=u.node;if(!d.footprint||!d.footprint.vertices||!d.footprint.vertices.length)continue;const p=d.footprint.vertices;let m=c.getElevationAt(p[0].x,p[0].y,!0,!0);for(let _=1;_<p.length;_++)m=Math.min(m,c.getElevationAt(p[_].x,p[_].y,!0,!0));d.elevation=m}}this.terrainTile=a.tileID.canonical,this.terrainExaggeration=n}}updateDEM(t,n,r,o){let a=n._dem._modifiedForSources[o];if(a===void 0&&(n._dem._modifiedForSources[o]=[],a=n._dem._modifiedForSources[o]),a.includes(r.canonical))return;const c=n._dem.dim;a.push(r.canonical);let u=!1;for(const d of this.getNodesInfo()){const p=d.node;if(!p.footprint||!p.footprint.grid)continue;const m=p.footprint.grid,_=n.tileCoordToPixel(m.min.x,m.min.y),v=n.tileCoordToPixel(m.max.x,m.max.y),x=Math.min(Math.min(c-v.y,_.x),Math.min(_.y,c-v.x));if(x<0)continue;const w=jt(x,2,5);let T=Math.max(0,_.x-w),S=Math.max(0,_.y-w),I=Math.min(v.x+w,c-1),A=Math.min(v.y+w,c-1);for(let O=S;O<=A;++O)for(let j=T;j<=I;++j)Dc[O*c+j]=255;let R=0,k=0;for(let O=0;O<m.cellsY;++O)for(let j=0;j<m.cellsX;++j){if(!m.cells[O*m.cellsX+j])continue;const G=n.tileCoordToPixel(m.min.x+j/m.xScale,m.min.y+O/m.yScale),W=n.tileCoordToPixel(m.min.x+(j+1)/m.xScale,m.min.y+(O+1)/m.yScale);for(let Z=G.y;Z<=Math.min(W.y+1,c-1);++Z)for(let K=G.x;K<=Math.min(W.x+1,c-1);++K)Dc[Z*c+K]===255&&(Dc[Z*c+K]=0,R+=n.getElevationAtPixel(K,Z),k++)}const P=R/k;T=Math.max(1,_.x-w),S=Math.max(1,_.y-w),I=Math.min(v.x+w,c-2),A=Math.min(v.y+w,c-2),u=!0;for(let O=S;O<=A;++O)for(let j=T;j<=I;++j)Dc[O*c+j]===0&&(j1[O*c+j]=n._dem.set(j,O,P));for(let O=1;O<w;++O){T=Math.max(1,_.x-O),S=Math.max(1,_.y-O),I=Math.min(v.x+O,c-2),A=Math.min(v.y+O,c-2);for(let j=S;j<=A;++j)for(let G=T;G<=I;++G){const W=j*c+G;if(Dc[W]===255){let Z=0,K=0,Q=-1,at=-1;for(let X=-1;X<=1;++X)for(let ft=-1;ft<=1;++ft){const gt=(j+X)*c+G+ft;if(Dc[gt]>=O)continue;const vt=j1[gt],ht=Math.abs(vt);ht>K&&(Z=vt,K=ht,Q=ft,at=X)}if(K>.1){const X=1-(O+.5*Math.abs(Q*at))/w;let ft=n._dem.get(G,j)+Z*X;const gt=n._dem.get(G+Q,j+at),vt=n._dem.get(G-Q,j-at,!0);(ft-gt)*(ft-vt)>0&&(ft=(gt+vt)/2),j1[W]=n._dem.set(G,j,ft),Dc[W]=O}}}}}u&&(n._demTile.needsDEMTextureUpload=!0,n._dem._timestamp=Ve.now())}getNodesInfo(){if(!this.nodesInfo){this.nodesInfo=[];for(const t of this.nodes)this.nodesInfo.push(new BP(t));this.freeNodes()}return this.nodesInfo}freeNodes(){if(this.nodes){for(const t of this.nodes)Ig(t);this.nodes.splice(0,this.nodes.length)}}destroy(){this.freeNodes();const t=this.getNodesInfo();for(const n of t)Mg(n.node),Ig(n.node)}isEmpty(){return!this.nodes.length}updateReplacement(t,n){if(n.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=n.updateTime;const r=n.getReplacementRegionsForTile(t.toUnwrapped()),o=this.getNodesInfo();for(let a=0;a<this.nodesInfo.length;a++){const c=o[a].node;o[a].hiddenByReplacement=!!c.footprint&&!r.find(u=>u.footprint===c.footprint)}}getHeightAtTileCoord(t,n){const r=this.getNodesInfo(),o=[];for(let a=0;a<this.nodesInfo.length;a++){const c=r[a],u=c.node.meshes[0];if(t<u.aabb.min[0]||n<u.aabb.min[1]||t>u.aabb.max[0]||n>u.aabb.max[1])continue;const d=(t-u.aabb.min[0])/(u.aabb.max[0]-u.aabb.min[0])*zc|0,p=Math.min(63,(n-u.aabb.min[1])/(u.aabb.max[1]-u.aabb.min[1])*zc|0)*zc+Math.min(63,d);if(!(u.heightmap[p]<0&&c.node.footprint))return c.hiddenByReplacement?void 0:{height:u.heightmap[p],maxHeight:c.feature.properties.height,hidden:!1,verticalScale:c.evaluatedScale[2]};if(c.node.footprint.grid.query(new N(t,n),new N(t,n),o),o.length>0)return{height:void 0,maxHeight:c.feature.properties.height,hidden:c.hiddenByReplacement,verticalScale:c.evaluatedScale[2]}}}}function bf(e,t){return!e.isLightConstant&&t}function bU(e,t,n,r,o,a,c,u){let d=(61440&t|(61440&t)>>4)>>8,p=(3840&t|(3840&t)>>4)>>4,m=240&t|(240&t)>>4;n[3]>0&&(d=Xe(d,255*n[0],n[3]),p=Xe(p,255*n[1],n[3]),m=Xe(m,255*n[2],n[3]));const _=d<<8|p,v=m<<8|Math.floor(255*r[3]),x=function(O){const j=jt(O,0,2);return Math.min(Math.round(.5*j*255),255)}(r[2])<<8|15*r[0]<<4|15*r[1],w=jt(o[0],0,1),T=jt(o[1],0,1),S=jt(o[2],0,1),I=jt(o[3],0,1);let A,R,k,P;if(w!==T&&c!==a&&T!==w){const O=c-a;R=1/(O*(T-w)),k=-(a+O*w)/(O*(T-w));const j=jt(o[4],-1,1);P=Math.pow(10,j),A=255*S<<8|255*I}else A=65535,R=0,k=1,P=1;if(e.emplaceBack(_,v,x,A,R,k,P),u){const O=u.length;u.clear();for(let j=0;j<O;j++)u.emplaceBack(_,v,x,A,R,k,P)}}function wU(e,t){const n=e.node;let r=0;for(const o of n.meshes){if(n.lights&&n.lightMeshIndex===r||!o.featureData)continue;o.featureArray=new Im,o.featureArray.reserve(o.featureData.length);let a=t;for(const c of o.featureData){let u;const d=65535&c,p=(15&d)<8?15&d:0,m=c>>16&65535,_=e.evaluatedRMEA[p],v=e.evaluatedColor[p],x=e.emissionHeightBasedParams[p];if(a&&p===2&&n.lights&&(u=new Im,u.resize(10*n.lights.length)),bU(o.featureArray,m,v,_,x,o.aabb.min[2],o.aabb.max[2],u),u&&a){a=!1;const w=n.meshes[n.lightMeshIndex];w.featureArray=u,w.featureArray._trim()}}o.featureArray._trim(),r++}}Te(FP,"Tiled3dModelBucket",{omit:["layers"]}),Te(BP,"Tiled3dModelFeature");class TU{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(t){const n=UP(new N(0,0),new N(Rt,Rt),t),r=[];for(const o of this._activeRegions){if(o.hiddenByOverlap||!jP(n,o))continue;const a=SU(o.min,o.max,t);r.push({min:a.min,max:a.max,sourceId:this._sourceIds[o.priority],footprint:o.footprint,footprintTileId:o.tileId})}return r}setSources(t){this._setSources(t.map(n=>({getSourceId:()=>n.cache.id,getFootprints:()=>{const r=[];for(const o of n.cache.getVisibleCoordinates()){const a=n.cache.getTile(o).buckets[n.layer];if(a)for(const c of a.getNodesInfo()){const u=c.node;u.footprint&&r.push({footprint:u.footprint,id:o.toUnwrapped()})}}return r}})))}_addSource(t){const n=t.getFootprints();if(n.length!==0){for(const r of n){if(!r.footprint)continue;const o=UP(r.footprint.min,r.footprint.max,r.id);this._activeRegions.push({min:o.min,max:o.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:r.id,footprint:r.footprint})}this._sourceIds.push(t.getSourceId())}}_computeReplacement(){this._activeRegions.sort((n,r)=>n.priority-r.priority||Ag(n.min,r.min)||Ag(n.max,r.max));let t=this._activeRegions.length!==this._prevRegions.length;if(!t){let n=0,r=0;for(;!t&&n!==this._activeRegions.length;){const o=this._activeRegions[n],a=this._prevRegions[r];t=o.priority!==a.priority||!NP(o,a),++n,++r}}if(t){++this._updateTime;const n=r=>{const o=this._activeRegions;if(r>=o.length)return r;const a=o[r].priority;for(;r<o.length&&o[r].priority===a;)++r;return r};if(this._sourceIds.length>1){let r=0,o=n(r);for(;r!==o;){let a=r;const c=r;for(;a!==o;){const u=this._activeRegions[a];u.hiddenByOverlap=!1;for(let d=0;d<c;d++){const p=this._activeRegions[d];if(!p.hiddenByOverlap&&jP(u,p)&&(u.hiddenByOverlap=VP(u.footprint,u.tileId,p.footprint,p.tileId),u.hiddenByOverlap))break}++a}r=o,o=n(r)}}}}_setSources(t){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let n=t.length-1;n>=0;n--)this._addSource(t[n]);this._computeReplacement()}}function Ag(e,t){return e.x-t.x||e.y-t.y}function NP(e,t){return Ag(e.min,t.min)===0&&Ag(e.max,t.max)===0}function jP(e,t){return!(e.min.x>t.max.x||e.max.x<t.min.x||e.min.y>t.max.y||e.max.y<t.min.y)}function UP(e,t,n){const r=1/Rt,o=1/(1<<n.canonical.z),a=(t.x*r+n.canonical.x)*o+n.wrap,c=(t.y*r+n.canonical.y)*o;return{min:new N((e.x*r+n.canonical.x)*o+n.wrap,(e.y*r+n.canonical.y)*o),max:new N(a,c)}}function SU(e,t,n){const r=1<<n.canonical.z,o=((t.x-n.wrap)*r-n.canonical.x)*Rt,a=(t.y*r-n.canonical.y)*Rt;return{min:new N(((e.x-n.wrap)*r-n.canonical.x)*Rt,(e.y*r-n.canonical.y)*Rt),max:new N(o,a)}}function $P(e,t,n,r,o,a,c){const u=e.indices,d=e.vertices,p=[];for(let m=r;m<r+o;m+=3){const _=t[n[m+0]+a],v=t[n[m+1]+a],x=t[n[m+2]+a],w=Math.min(_.x,v.x,x.x),T=Math.max(_.x,v.x,x.x),S=Math.min(_.y,v.y,x.y),I=Math.max(_.y,v.y,x.y);p.length=0,e.grid.query(new N(w,S),new N(T,I),p);for(let A=0;A<p.length;A++){const R=p[A];if(s1(d[u[3*R+0]],d[u[3*R+1]],d[u[3*R+2]],_,v,x,c))return!0}}return!1}function VP(e,t,n,r){if(!e||!n)return!1;let o=e.vertices;if(!t.canonical.equals(r.canonical)||t.wrap!==r.wrap){if(n.vertices.length<e.vertices.length)return VP(n,r,e,t);const a=t.canonical,c=r.canonical,u=Math.pow(2,c.z-a.z);o=e.vertices.map(d=>new N(d.x*a.x*Rt*u-c.x*Rt,d.y*a.y*Rt*u-c.y*Rt))}return $P(n,o,e.indices,0,e.indices.length,0,0)}const EU=Qm.types,CU=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],MU=["fill-extrusion-flood-light-ground-radius"],IU=Math.pow(2,13),AU=Math.pow(2,15)-1,GP=new N(0,1),la=2147483648;function wf(e,t,n,r,o,a,c,u){e.emplaceBack((t<<1)+c,(n<<1)+a,(Math.floor(r*IU)<<1)+o,Math.round(u))}function Pg(e,t,n,r,o,a){e.emplaceBack(t.x,t.y,(n.x<<1)+r,(n.y<<1)+o,a)}function Tf(e,t,n){e.emplaceBack(t.x,t.y,t.z,n[0]*16384,n[1]*16384,n[2]*16384)}class WP{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class qP{constructor(){this.centroidXY=new N(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new N(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new N(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new N(this.max.x-this.min.x,this.max.y-this.min.y)}}class HP{constructor(){this.acc=new N(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,n){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=n.x,t.min.y=t.max.y=n.y)}appendEdge(t,n,r){this.accCount++,this.acc._add(n);let o=!!this.borders;n.x<t.min.x?(t.min.x=n.x,o=!0):n.x>t.max.x&&(t.max.x=n.x,o=!0),n.y<t.min.y?(t.min.y=n.y,o=!0):n.y>t.max.y&&(t.max.y=n.y,o=!0),((n.x===0||n.x===Rt)&&n.x===r.x)!=((n.y===0||n.y===Rt)&&n.y===r.y)&&this.processBorderOverlap(n,r),o&&this.checkBorderIntersection(n,r)}checkBorderIntersection(t,n){n.x<0!=t.x<0&&this.addBorderIntersection(0,Xe(n.y,t.y,(0-n.x)/(t.x-n.x))),n.x>Rt!=t.x>Rt&&this.addBorderIntersection(1,Xe(n.y,t.y,(Rt-n.x)/(t.x-n.x))),n.y<0!=t.y<0&&this.addBorderIntersection(2,Xe(n.x,t.x,(0-n.y)/(t.y-n.y))),n.y>Rt!=t.y>Rt&&this.addBorderIntersection(3,Xe(n.x,t.x,(Rt-n.y)/(t.y-n.y)))}addBorderIntersection(t,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const r=this.borders[t];n<r[0]&&(r[0]=n),n>r[1]&&(r[1]=n)}processBorderOverlap(t,n){if(t.x===n.x){if(t.y===n.y)return;const r=t.x===0?0:1;this.addBorderIntersection(r,n.y),this.addBorderIntersection(r,t.y)}else{const r=t.y===0?2:3;this.addBorderIntersection(r,n.x),this.addBorderIntersection(r,t.x)}}centroid(){return this.accCount===0?new N(0,0):new N(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((t,n)=>t+ +(n[0]!==Number.MAX_VALUE),0):0}}function ZP(e,t){const n=e.add(t)._unit(),r=jt(e.x*n.x+e.y*n.y,-1,1);var o,a,c;return o=Math.acos(r),Math.min(4,Math.max(-4,Math.tan(o)))/4*AU*((a=e).x*(c=t).y-a.y*c.x<0?-1:1)}const PU=[e=>e.x<0,e=>e.x>Rt,e=>e.y<0,e=>e.y>Rt];function RU(e,t,n,r){const o=[4];if(r===0)return o;n._mult(r);const a=e.sub(n),c=t.sub(n),u=[e,t,a,c];for(let d=0;d<4;d++)for(const p of u)if(PU[d](p)){o.push(d);break}return o}class XP{constructor(t){this.vertexArray=new cx,this.indexArray=new Wr,this.programConfigurations=new vl(t.layers,t.zoom,n=>MU.includes(n)),this._segments=new Gn,this.hiddenByLandmarkVertexArray=new wx,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Gn}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(t,n,r,o=!1){const a=t.length;if(a>2){let c=Math.max(0,this._segments.get().length-1);const u=this._segments._prepareSegment(4*a,this.vertexArray.length,2*this._segmentToGroundQuads[c].length);let d;c!==this._segments.get().length-1&&(c++,this._segmentToGroundQuads[c]=[],this._segmentToRegionTriCounts[c]=[0,0,0,0,0]);{const p=t[0],m=t[1];d=ZP(p.sub(t[a-1])._perp()._unit(),m.sub(p)._perp()._unit())}for(let p=0;p<a;p++){const m=p===a-1?0:p+1,_=t[p],v=t[m],x=t[m===a-1?0:m+1],w=v.sub(_)._perp()._unit(),T=ZP(w,x.sub(v)._perp()._unit()),S=d,I=T;if(U1(_,v,n)||o&&QP(_,n)&&QP(v,n)){d=T;continue}const A=u.vertexLength;Pg(this.vertexArray,_,v,1,1,S),Pg(this.vertexArray,_,v,1,0,S),Pg(this.vertexArray,_,v,0,1,I),Pg(this.vertexArray,_,v,0,0,I),u.vertexLength+=4;const R=RU(_,v,w,r);for(const k of R)this._segmentToGroundQuads[c].push({id:A,region:k}),this._segmentToRegionTriCounts[c][k]+=2,u.primitiveLength+=2;d=T}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),n=t.length;for(let r=0;r<n;r++)this._segmentToGroundQuads[r].sort((o,a)=>o.region-a.region);for(let r=0;r<n;r++){const o=this._segmentToGroundQuads[r],a=t[r],c=this._segmentToRegionTriCounts[r];c.reduce((d,p)=>d+p,0);let u=0;for(let d=0;d<=4;d++){const p=c[d];if(p!==0){let m=this.regionSegments[d];m||(m=this.regionSegments[d]=new Gn);const _={vertexOffset:a.vertexOffset,primitiveOffset:a.primitiveOffset+u,vertexLength:a.vertexLength,primitiveLength:p};m.get().push(_)}u+=p}for(let d=0;d<o.length;d++){const p=o[d].id;this.indexArray.emplaceBack(p,p+1,p+3),this.indexArray.emplaceBack(p,p+3,p+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,n,r,o,a,c){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,n,r,o,a,c)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,n6.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,n,r,o,a,c){this.hasData()&&this.programConfigurations.updatePaintArrays(t,n,r,o,a,c)}updateHiddenByLandmark(t){if(!this.hasData())return;const n=t.groundVertexCount+t.groundVertexArrayOffset;if(t.groundVertexCount===0)return;const r=t.flags&la?1:0;for(let o=t.groundVertexArrayOffset;o<n;++o)this.hiddenByLandmarkVertexArray.emplace(o,r);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,i6.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const n=this.regionSegments[t];n&&n.destroy()}}}}class Sf{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Wr,this.footprintVertices=new bo,this.footprintSegments=[],this.layoutVertexArray=new Cc,this.centroidVertexArray=new oM,this.indexArray=new Wr,this.programConfigurations=new vl(t.layers,t.zoom,n=>CU.includes(n)),this.segments=new Gn,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.groundEffect=new XP(t),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}populate(t,n,r,o){this.features=[],this.hasPattern=f1("fill-extrusion",this.layers,n),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=nf(r),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:a,id:c,index:u,sourceLayerIndex:d}of t){const p=this.layers[0]._featureFilter.needGeometry,m=Cl(a,p);if(!this.layers[0]._featureFilter.filter(new fr(this.zoom),m,r))continue;const _={id:c,sourceLayerIndex:d,index:u,geometry:p?m.geometry:ia(a,r,o),properties:a.properties,type:a.type,patterns:{}},v=this.layoutVertexArray.length;this.hasPattern?this.features.push(p1("fill-extrusion",this.layers,_,this.zoom,n)):this.addFeature(_,_.geometry,u,r,{},n.availableImages,o,n.brightness),n.featureIndex.insert(a,_.geometry,u,d,this.index,v)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(t,n,r,o,a,c){for(const u of this.features){const{geometry:d}=u;this.addFeature(u,d,u.index,n,r,o,a,c)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(t,n,r,o,a){const c=Object.keys(t).length!==0;if(c&&!this.stateDependentLayers.length)return;const u=c?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(t,n,u,r,o,a),this.groundEffect.update(t,n,u,r,o,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,s6),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,o6.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,r6.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,n,r,o,a,c,u,d){const p=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,m=[new N(0,0),new N(Rt,Rt)],_=u.projection,v=_.name==="globe",x=EU[t.type]==="Polygon",w=new HP;w.centroidDataIndex=this.centroidData.length;const T=new qP,S=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},o)<=0,I=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},o);T.height=I,T.vertexArrayOffset=this.layoutVertexArray.length,T.groundVertexArrayOffset=this.groundEffect.vertexArray.length,v&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Cm);const A=d1(n,500);for(let G=A.length-1;G>=0;G--){const W=A[G];(W.length===0||(R=W[0]).every(Z=>Z.x<=0)||R.every(Z=>Z.x>=Rt)||R.every(Z=>Z.y<=0)||R.every(Z=>Z.y>=Rt))&&A.splice(G,1)}var R;let k;if(v)k=nR(A,m,o);else{k=[];for(const G of A)k.push({polygon:G,bounds:m})}const P=x?this.edgeRadius:0,O=P>0&&this.zoom<17,j=(G,W)=>{if(G.length===0)return!1;const Z=G[G.length-1];return W.x===Z.x&&W.y===Z.y};for(const{polygon:G,bounds:W}of k){let Z=0,K=0;for(const ft of G)x&&!ft[0].equals(ft[ft.length-1])&&ft.push(ft[0]),K+=x?ft.length-1:ft.length;const Q=this.segments.prepareSegment((x?5:4)*K,this.layoutVertexArray,this.indexArray);T.footprintSegIdx<0&&(T.footprintSegIdx=this.footprintSegments.length),T.polygonSegIdx<0&&(T.polygonSegIdx=this.polygonSegments.length);const at={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},X=new WP;if(X.vertexOffset=this.footprintVertices.length,X.indexOffset=3*this.footprintIndices.length,X.ringIndices=[],x){const ft=[],gt=[];Z=Q.vertexLength;for(let ht=0;ht<G.length;ht++){const pt=G[ht];pt.length&&ht!==0&&gt.push(ft.length/2);const Ct=[];let At,It;At=pt[1].sub(pt[0])._perp()._unit(),X.ringIndices.push(pt.length-1);for(let zt=1;zt<pt.length;zt++){const Ft=pt[zt],Ut=pt[zt===pt.length-1?1:zt+1],Pt=Ft.clone();if(P){It=Ut.sub(Ft)._perp()._unit();const Ht=At.add(It)._unit(),he=P*Math.min(4,1/(At.x*Ht.x+At.y*Ht.y));Pt.x+=he*Ht.x,Pt.y+=he*Ht.y,Pt.x=Math.round(Pt.x),Pt.y=Math.round(Pt.y),At=It}!S||P!==0&&!O||j(Ct,Pt)||Ct.push(Pt),wf(this.layoutVertexArray,Pt.x,Pt.y,0,0,1,1,0),Q.vertexLength++,this.footprintVertices.emplaceBack(Ft.x,Ft.y),ft.push(Ft.x,Ft.y),v&&Tf(this.layoutVertexExtArray,_.projectTilePoint(Pt.x,Pt.y,o),_.upVector(o,Pt.x,Pt.y))}S&&(P===0||O)&&(Ct.length!==0&&j(Ct,Ct[0])&&Ct.pop(),this.groundEffect.addData(Ct,W,p))}const vt=Xm(ft,gt);for(let ht=0;ht<vt.length;ht+=3)this.footprintIndices.emplaceBack(X.vertexOffset+vt[ht+0],X.vertexOffset+vt[ht+1],X.vertexOffset+vt[ht+2]),this.indexArray.emplaceBack(Z+vt[ht],Z+vt[ht+2],Z+vt[ht+1]),Q.primitiveLength++;X.indexCount+=vt.length,X.vertexCount+=this.footprintVertices.length-X.vertexOffset}for(let ft=0;ft<G.length;ft++){const gt=G[ft];w.startRing(T,gt[0]);let vt=gt.length>4&&JP(gt[gt.length-2],gt[0],gt[1]),ht=P?kU(gt[gt.length-2],gt[0],gt[1],P):0;const pt=[];let Ct,At,It;At=gt[1].sub(gt[0])._perp()._unit();let zt=!0;for(let Ft=1,Ut=0;Ft<gt.length;Ft++){let Pt=gt[Ft-1],Ht=gt[Ft];const he=gt[Ft===gt.length-1?1:Ft+1];if(w.appendEdge(T,Ht,Pt),U1(Ht,Pt,W)){P&&(At=he.sub(Ht)._perp()._unit(),zt=!zt);continue}const de=Ht.sub(Pt)._perp(),_e=de.x/(Math.abs(de.x)+Math.abs(de.y)),xe=de.y>0?1:0,He=Pt.dist(Ht);if(Ut+He>32768&&(Ut=0),P){It=he.sub(Ht)._perp()._unit();let Ze=YP(Pt,Ht,he,KP(At,It),P);isNaN(Ze)&&(Ze=0);const We=Ht.sub(Pt)._unit();Pt=Pt.add(We.mult(ht))._round(),Ht=Ht.add(We.mult(-Ze))._round(),ht=Ze,At=It,S&&this.zoom>=17&&(j(pt,Pt)||pt.push(Pt),j(pt,Ht)||pt.push(Ht))}const Ae=Q.vertexLength,Sn=gt.length>4&&JP(Pt,Ht,he);let pn=tR(Ut,vt,zt);if(wf(this.layoutVertexArray,Pt.x,Pt.y,_e,xe,0,0,pn),wf(this.layoutVertexArray,Pt.x,Pt.y,_e,xe,0,1,pn),Ut+=He,pn=tR(Ut,Sn,!zt),vt=Sn,wf(this.layoutVertexArray,Ht.x,Ht.y,_e,xe,0,0,pn),wf(this.layoutVertexArray,Ht.x,Ht.y,_e,xe,0,1,pn),Q.vertexLength+=4,this.indexArray.emplaceBack(Ae+0,Ae+1,Ae+2),this.indexArray.emplaceBack(Ae+1,Ae+3,Ae+2),Q.primitiveLength+=2,P){const Ze=Z+(Ft===1?gt.length-2:Ft-2),We=Ft===1?Z:Ze+1;if(this.indexArray.emplaceBack(Ae+1,Ze,Ae+3),this.indexArray.emplaceBack(Ze,We,Ae+3),Q.primitiveLength+=2,Ct===void 0&&(Ct=Ae),!U1(he,gt[Ft],W)){const ze=Ft===gt.length-1?Ct:Q.vertexLength;this.indexArray.emplaceBack(Ae+2,Ae+3,ze),this.indexArray.emplaceBack(Ae+3,ze+1,ze),this.indexArray.emplaceBack(Ae+3,We,ze+1),Q.primitiveLength+=3}zt=!zt}if(v){const Ze=this.layoutVertexExtArray,We=_.projectTilePoint(Pt.x,Pt.y,o),ze=_.projectTilePoint(Ht.x,Ht.y,o),yn=_.upVector(o,Pt.x,Pt.y),wn=_.upVector(o,Ht.x,Ht.y);Tf(Ze,We,yn),Tf(Ze,We,yn),Tf(Ze,ze,wn),Tf(Ze,ze,wn)}}x&&(Z+=gt.length-1),S&&P&&this.zoom>=17&&(pt.length!==0&&j(pt,pt[0])&&pt.pop(),this.groundEffect.addData(pt,W,p,P>0))}this.footprintSegments.push(X),at.triangleCount=this.indexArray.length-at.triangleArrayOffset,this.polygonSegments.push(at),++T.footprintSegLen,++T.polygonSegLen}if(T.vertexCount=this.layoutVertexArray.length-T.vertexArrayOffset,T.groundVertexCount=this.groundEffect.vertexArray.length-T.groundVertexArrayOffset,T.vertexCount!==0){if(T.centroidXY=w.borders?GP:this.encodeCentroid(w,T),this.centroidData.push(T),w.borders){this.featuresOnBorder.push(w);const G=this.featuresOnBorder.length-1;for(let W=0;W<w.borders.length;W++)w.borders[W][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[W].push(G)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,a,c,o,d),this.groundEffect.addPaintPropertiesData(t,r,a,c,o,d),this.maxHeight=Math.max(this.maxHeight,I)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort((n,r)=>this.featuresOnBorder[n].borders[t][0]-this.featuresOnBorder[r].borders[t][0])}splitToSubtiles(){const t=[];for(let u=0;u<this.centroidData.length;u++){const d=this.centroidData[u],p=+(d.min.y+d.max.y>Rt),m=2*p+(+(d.min.x+d.max.x>Rt)^p);for(let _=0;_<d.polygonSegLen;_++){const v=d.polygonSegIdx+_;t.push({centroidIdx:u,subtile:m,polygonSegmentIdx:v,triangleSegmentIdx:this.polygonSegments[v].triangleSegIdx})}}const n=new Wr;t.sort((u,d)=>u.triangleSegmentIdx===d.triangleSegmentIdx?u.subtile-d.subtile:u.triangleSegmentIdx-d.triangleSegmentIdx);let r=0,o=0,a=0;for(const u of t){if(u.triangleSegmentIdx!==r)break;a++}const c=t.length;for(;o!==t.length;){r=t[o].triangleSegmentIdx;let u=0,d=o,p=o;for(let m=d;m<a&&t[m].subtile===u;m++)p++;for(;d!==a;){const m=t[d];u=m.subtile;const _=this.centroidData[m.centroidIdx].min.clone(),v=this.centroidData[m.centroidIdx].max.clone(),x={vertexOffset:this.segments.segments[r].vertexOffset,primitiveOffset:n.length,vertexLength:this.segments.segments[r].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let w=d;w<p;w++){const T=t[w],S=this.polygonSegments[T.polygonSegmentIdx],I=this.centroidData[T.centroidIdx].min,A=this.centroidData[T.centroidIdx].max,R=this.indexArray.uint16;for(let k=S.triangleArrayOffset;k<S.triangleArrayOffset+S.triangleCount;k++)n.emplaceBack(R[3*k],R[3*k+1],R[3*k+2]);x.primitiveLength+=S.triangleCount,_.x=Math.min(_.x,I.x),_.y=Math.min(_.y,I.y),v.x=Math.max(v.x,A.x),v.y=Math.max(v.y,A.y)}x.primitiveLength>0&&this.triangleSubSegments.push({segment:x,min:_,max:v}),d=p;for(let w=d;w<a&&t[w].subtile===t[d].subtile;w++)p++}o=a;for(let m=o;m<c&&t[m].triangleSegmentIdx===t[o].triangleSegmentIdx;m++)a++}n._trim(),this.indexArray=n}getVisibleSegments(t,n,r){let o=0,a=0;const c=1<<t.canonical.z;if(n){const T=n.getMinMaxForTile(t);T&&(o=T.min,a=T.max)}a+=this.maxHeight;const u=t.toUnwrapped();let d;const p=[u.canonical.x/c+u.wrap,u.canonical.y/c],m=[(u.canonical.x+1)/c+u.wrap,(u.canonical.y+1)/c],_=new Gn,v=(T,S,I)=>[T[0]*(1-I[0])+S[0]*I[0],T[1]*(1-I[1])+S[1]*I[1]],x=[],w=[];for(const T of this.triangleSubSegments){x[0]=T.min.x/Rt,x[1]=T.min.y/Rt,w[0]=T.max.x/Rt,w[1]=T.max.y/Rt;const S=v(p,m,x),I=v(p,m,w);if(new nr([S[0],S[1],o],[I[0],I[1],a]).intersectsPrecise(r)===0){d&&(_.segments.push(d),d=void 0);continue}const A=T.segment;d&&d.vertexOffset!==A.vertexOffset&&(_.segments.push(d),d=void 0),d?(d.vertexLength+=A.vertexLength,d.primitiveLength+=A.primitiveLength):d={vertexOffset:A.vertexOffset,primitiveLength:A.primitiveLength,vertexLength:A.vertexLength,primitiveOffset:A.primitiveOffset,sortKey:void 0,vaos:{}}}return d&&_.segments.push(d),_}encodeCentroid(t,n){const r=t.centroid(),o=n.span(),a=Math.min(7,Math.round(o.x*this.tileToMeter/10)),c=Math.min(7,Math.round(o.y*this.tileToMeter/10));return new N(jt(r.x,1,Rt-1)<<3|a,jt(r.y,1,Rt-1)<<3|c)}showCentroid(t){const n=this.centroidData[t.centroidDataIndex];n.flags&=la,n.centroidXY.x=0,n.centroidXY.y=0,this.writeCentroidToBuffer(n)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const n=t.vertexArrayOffset,r=t.vertexCount+t.vertexArrayOffset,o=t.flags&la?GP:t.centroidXY,a=this.centroidVertexArray.geta_centroid_pos0(n);if(this.centroidVertexArray.geta_centroid_pos1(n)!==o.y||a!==o.x){for(let c=n;c<r;++c)this.centroidVertexArray.emplace(c,o.x,o.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,n){if(n.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=n.updateTime;const r=n.getReplacementRegionsForTile(t.toUnwrapped());if(function(a,c){if(a.length!==c.length)return!1;for(let u=0;u<a.length;u++)if(a[u].sourceId!==c[u].sourceId||!NP(a[u],c[u]))return!1;return!0}(this.activeReplacements,r))return;if(this.activeReplacements=r,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const a of this.centroidData)a.flags&=2147483647;const o=[];for(const a of this.activeReplacements){const c=Math.pow(2,a.footprintTileId.canonical.z-t.canonical.z);for(const u of this.centroidData)if(!(u.flags&la||a.min.x>u.max.x||u.min.x>a.max.x||a.min.y>u.max.y||u.min.y>a.max.y))for(let d=0;d<u.footprintSegLen;d++){const p=this.footprintSegments[u.footprintSegIdx+d];if(o.length=0,OU(this.footprintVertices,p.vertexOffset,p.vertexCount,a.footprintTileId.canonical,t.canonical,o),$P(a.footprint,o,this.footprintIndices.uint16,p.indexOffset,p.indexCount,-p.vertexOffset,-c)){u.flags|=la;break}}}for(const a of this.centroidData)this.writeCentroidToBuffer(a);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,n,r){let o=!1;for(let a=0;a<r.footprintSegLen;a++){const c=this.footprintSegments[r.footprintSegIdx+a];let u=0;for(const d of c.ringIndices){for(let p=u,m=d+u-1;p<d+u;m=p++){const _=this.footprintVertices.int16[2*(p+c.vertexOffset)+0],v=this.footprintVertices.int16[2*(p+c.vertexOffset)+1],x=this.footprintVertices.int16[2*(m+c.vertexOffset)+1];v>n!=x>n&&t<(this.footprintVertices.int16[2*(m+c.vertexOffset)+0]-_)*(n-v)/(x-v)+_&&(o=!o)}u=d}}return o}getHeightAtTileCoord(t,n){let r=Number.NEGATIVE_INFINITY,o=!0;const a=4*(t+Rt)*Rt+(n+Rt);if(this.partLookup.hasOwnProperty(a)){const c=this.partLookup[a];return c?{height:c.height,hidden:!!(c.flags&la)}:void 0}for(const c of this.centroidData)t>c.max.x||c.min.x>t||n>c.max.y||c.min.y>n||this.footprintContainsPoint(t,n,c)&&c&&c.height>r&&(r=c.height,this.partLookup[a]=c,o=!!(c.flags&la));if(r!==Number.NEGATIVE_INFINITY)return{height:r,hidden:o};this.partLookup[a]=void 0}}function KP(e,t){const n=e.add(t)._unit();return e.x*n.x+e.y*n.y}function kU(e,t,n,r){const o=t.sub(e)._perp()._unit(),a=n.sub(t)._perp()._unit();return YP(e,t,n,KP(o,a),r)}function YP(e,t,n,r,o){const a=Math.sqrt(1-r*r);return Math.min(e.dist(t)/3,t.dist(n)/3,o*a/r)}function U1(e,t,n){return e.x<n[0].x&&t.x<n[0].x||e.x>n[1].x&&t.x>n[1].x||e.y<n[0].y&&t.y<n[0].y||e.y>n[1].y&&t.y>n[1].y}function QP(e,t){return e.x<t[0].x||e.x>t[1].x||e.y<t[0].y||e.y>t[1].y}function JP(e,t,n){if(e.x<0||e.x>=Rt||t.x<0||t.x>=Rt||n.x<0||n.x>=Rt)return!1;const r=n.sub(t),o=r.perp(),a=e.sub(t);return(r.x*a.x+r.y*a.y)/Math.sqrt((r.x*r.x+r.y*r.y)*(a.x*a.x+a.y*a.y))>-.866&&o.x*a.x+o.y*a.y<0}function tR(e,t,n){const r=t?2|e:-3&e;return n?1|r:-2&r}function eR(){const e=Math.PI/32,t=Math.tan(e),n=Ku;return n*Math.sqrt(1+2*t*t)-n}function nR(e,t,n){const r=1<<n.z,o=So(n.x/r),a=So((n.x+1)/r),c=qr(n.y/r),u=qr((n.y+1)/r);return function(d,p,m,_,v=0,x){const w=[];if(!d.length||!m||!_)return w;const T=(O,j)=>{for(const G of O)w.push({polygon:G,bounds:j})},S=Math.ceil(Math.log2(m)),I=Math.ceil(Math.log2(_)),A=S-I,R=[];for(let O=0;O<Math.abs(A);O++)R.push(A>0?0:1);for(let O=0;O<Math.min(S,I);O++)R.push(0),R.push(1);let k=d;if(k=Jm(k,p[0].y-v,p[1].y+v,1),k=Jm(k,p[0].x-v,p[1].x+v,0),!k.length)return w;const P=[];for(R.length?P.push({polygons:k,bounds:p,depth:0}):T(k,p);P.length;){const O=P.pop(),j=O.depth,G=R[j],W=O.bounds[0],Z=O.bounds[1],K=G===0?W.x:W.y,Q=G===0?Z.x:Z.y,at=x?x(G,K,Q):.5*(K+Q),X=Jm(O.polygons,K-v,at+v,G),ft=Jm(O.polygons,at-v,Q+v,G);if(X.length){const gt=[W,new N(G===0?at:Z.x,G===1?at:Z.y)];R.length>j+1?P.push({polygons:X,bounds:gt,depth:j+1}):T(X,gt)}if(ft.length){const gt=[new N(G===0?at:W.x,G===1?at:W.y),Z];R.length>j+1?P.push({polygons:ft,bounds:gt,depth:j+1}):T(ft,gt)}}return w}(e,t,Math.ceil((a-o)/11.25),Math.ceil((c-u)/11.25),1,(d,p,m)=>{if(d===0)return .5*(p+m);{const _=qr((n.y+p/Rt)/r);return(oi(.5*(qr((n.y+m/Rt)/r)+_))*r-n.y)*Rt}})}function OU(e,t,n,r,o,a){const c=Math.pow(2,r.z-o.z);for(let u=0;u<n;u++){let d=e.int16[2*(u+t)+0],p=e.int16[2*(u+t)+1];d=(d+o.x*Rt)*c-r.x*Rt,p=(p+o.y*Rt)*c-r.y*Rt,a.push(new N(d,p))}}Te(Sf,"FillExtrusionBucket",{omit:["layers","features"]}),Te(qP,"PartData"),Te(WP,"FootprintSegment"),Te(HP,"BorderCentroidData"),Te(XP,"GroundEffect");const LU=new Mr({visibility:new te(_t["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new te(_t["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var zU={paint:new Mr({"fill-extrusion-opacity":new te(_t["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Be(_t["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new te(_t["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new te(_t["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Be(_t["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Be(_t["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Be(_t["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new te(_t["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new te(_t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new te(_t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new te(_t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new te(_t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new te(_t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new te(_t["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new te(_t["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Be(_t["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Be(_t["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new te(_t["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new te(_t["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new te(_t["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new te(_t["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new te(_t["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:LU};class dh extends N{constructor(t,n,r){super(t,n),this.z=r}}function Ef(e,t){return e.x*t.x+e.y*t.y}function rR(e,t){if(e.length===1){let n=0;const r=t[n++];let o;for(;!o||r.equals(o);)if(o=t[n++],!o)return 1/0;for(;n<t.length;n++){const a=t[n],c=e[0],u=o.sub(r),d=a.sub(r),p=c.sub(r),m=Ef(u,u),_=Ef(u,d),v=Ef(d,d),x=Ef(p,u),w=Ef(p,d),T=m*v-_*_,S=(v*x-_*w)/T,I=(m*w-_*x)/T,A=r.z*(1-S-I)+o.z*S+a.z*I;if(isFinite(A))return A}return 1/0}{let n=1/0;for(const r of t)n=Math.min(n,r.z);return n}}function iR(e,t,n,r,o,a,c,u){const d=c*o.getElevationAt(e,t,!0,!0),p=a[0]!==0,m=p?a[1]===0?c*(a[0]/7-450):c*function(_,v,x){const w=Math.floor(v[0]/8),T=Math.floor(v[1]/8),S=10*(v[0]-8*w),I=10*(v[1]-8*T),A=_.getElevationAt(w,T,!0,!0),R=_.getMeterToDEM(x),k=Math.floor(.5*(S*R-1)),P=Math.floor(.5*(I*R-1)),O=_.tileCoordToPixel(w,T),j=2*k+1,G=2*P+1,W=function(ft,gt,vt,ht,pt){return[ft.getElevationAtPixel(gt,vt,!0),ft.getElevationAtPixel(gt+pt,vt,!0),ft.getElevationAtPixel(gt,vt+pt,!0),ft.getElevationAtPixel(gt+ht,vt+pt,!0)]}(_,O.x-k,O.y-P,j,G),Z=Math.abs(W[0]-W[1]),K=Math.abs(W[2]-W[3]),Q=Math.abs(W[0]-W[2])+Math.abs(W[1]-W[3]),at=Math.min(.25,.5*R*(Z+K)/j),X=Math.min(.25,.5*R*Q/G);return A+Math.max(at*S,X*I)}(o,a,u):d;return{base:d+(n===0)?-1:n,top:p?Math.max(m+r,d+n+2):d+r}}const DU=new Mr({"line-cap":new Be(_t.layout_line["line-cap"]),"line-join":new Be(_t.layout_line["line-join"]),"line-miter-limit":new te(_t.layout_line["line-miter-limit"]),"line-round-limit":new te(_t.layout_line["line-round-limit"]),"line-sort-key":new Be(_t.layout_line["line-sort-key"]),visibility:new te(_t.layout_line.visibility)});var oR={paint:new Mr({"line-opacity":new Be(_t.paint_line["line-opacity"]),"line-color":new Be(_t.paint_line["line-color"]),"line-translate":new te(_t.paint_line["line-translate"]),"line-translate-anchor":new te(_t.paint_line["line-translate-anchor"]),"line-width":new Be(_t.paint_line["line-width"]),"line-gap-width":new Be(_t.paint_line["line-gap-width"]),"line-offset":new Be(_t.paint_line["line-offset"]),"line-blur":new Be(_t.paint_line["line-blur"]),"line-dasharray":new Be(_t.paint_line["line-dasharray"]),"line-pattern":new Be(_t.paint_line["line-pattern"]),"line-gradient":new qd(_t.paint_line["line-gradient"]),"line-trim-offset":new te(_t.paint_line["line-trim-offset"]),"line-emissive-strength":new te(_t.paint_line["line-emissive-strength"]),"line-border-width":new Be(_t.paint_line["line-border-width"]),"line-border-color":new Be(_t.paint_line["line-border-color"])}),layout:DU};const BU=(e,t,n,r,o,a,c)=>{const u=e.transform,d=u.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:aR(e,t,n,r),u_pixels_to_tile_units:d,u_device_pixel_ratio:a,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:o,u_texsize:cR(n)&&t.lineAtlasTexture?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:sR(t,e.transform),u_alpha_discard_threshold:0,u_trim_offset:c,u_emissive_strength:n.paint.get("line-emissive-strength")}},FU=(e,t,n,r,o)=>{const a=e.transform;return{u_matrix:aR(e,t,n,r),u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:a.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:o,u_image:0,u_tile_units_to_pixels:sR(t,a),u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function sR(e,t){return 1/Lc(e,1,t.tileZoom)}function aR(e,t,n,r){return e.translatePosMatrix(r||t.tileID.projMatrix,t,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const lR=e=>{const t=[];cR(e)&&t.push("RENDER_LINE_DASH"),e.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const n=e.paint.get("line-trim-offset");return n[0]===0&&n[1]===0||t.push("RENDER_LINE_TRIM_OFFSET"),e.paint.get("line-border-width").constantOr(1)!==0&&t.push("RENDER_LINE_BORDER"),t};function cR(e){const t=e.paint.get("line-dasharray").value;return t.value||t.kind!=="constant"}const uR=new class extends Be{possiblyEvaluate(e,t){return t=new fr(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,n,r){return t=Ot({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,n,r)}}(oR.paint.properties["line-width"].specification);function hR(e,t){return t>0?t+2*e:e}uR.useIntegerZoom=!0;const NU=new Mr({visibility:new te(_t.layout_background.visibility)});var jU={paint:new Mr({"background-color":new te(_t.paint_background["background-color"]),"background-pattern":new te(_t.paint_background["background-pattern"]),"background-opacity":new te(_t.paint_background["background-opacity"]),"background-emissive-strength":new te(_t.paint_background["background-emissive-strength"])}),layout:NU};const UU=new Mr({visibility:new te(_t.layout_raster.visibility)});var $U={paint:new Mr({"raster-opacity":new te(_t.paint_raster["raster-opacity"]),"raster-color":new qd(_t.paint_raster["raster-color"]),"raster-color-mix":new te(_t.paint_raster["raster-color-mix"]),"raster-color-range":new te(_t.paint_raster["raster-color-range"]),"raster-hue-rotate":new te(_t.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new te(_t.paint_raster["raster-brightness-min"]),"raster-brightness-max":new te(_t.paint_raster["raster-brightness-max"]),"raster-saturation":new te(_t.paint_raster["raster-saturation"]),"raster-contrast":new te(_t.paint_raster["raster-contrast"]),"raster-resampling":new te(_t.paint_raster["raster-resampling"]),"raster-fade-duration":new te(_t.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new te(_t.paint_raster["raster-emissive-strength"]),"raster-array-band":new te(_t.paint_raster["raster-array-band"]),"raster-elevation":new te(_t.paint_raster["raster-elevation"])}),layout:UU};function dR(e,t,n,r,o,a,c,u){const d=[e,n,o,t,r,a,1,1,1],p=[c,u,1],m=ho.adjoint([],d),[_,v,x]=ot.transformMat3(p,p,ho.transpose(m,m));return ho.multiply(d,[_,0,0,0,v,0,0,0,x],d)}class ms extends En{constructor(t,n,r,o){super(),this.id=t,this.dispatcher=r,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(o),this.options=n,this._dirty=!1}load(t,n){if(this._loaded=n||!1,this.fire(new Nt("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=Qe(this.map._requestManager.transformRequest(this.url,Dt.Image),(r,o)=>{if(this._imageRequest=null,this._loaded=!0,r)this.fire(new ve(r));else if(o){const{HTMLImageElement:a}=C;this.image=o instanceof a?Ve.getImageData(o):o,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new xg(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Nt("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof xg||this.texture.destroy()}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let n=t[0][1],r=t[0][1];for(const a of t)a[1]>r&&(r=a[1]),a[1]<n&&(n=a[1]);const o=(r+n)/2;if(o>Or?this.onNorthPole=!0:o<-Or&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const a=t.map(xn.fromLngLat);this.tileID=function(c){let u=1/0,d=1/0,p=-1/0,m=-1/0;for(const w of c)u=Math.min(u,w.x),d=Math.min(d,w.y),p=Math.max(p,w.x),m=Math.max(m,w.y);const _=Math.max(p-u,m-d),v=Math.max(0,Math.floor(-Math.log(_)/Math.LN2)),x=Math.pow(2,v);return new hs(v,Math.floor((u+p)/2*x),Math.floor((d+m)/2*x))}(a),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Nt("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const d in this.tiles){const p=this.tiles[d];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}if(this._boundsArray)return;const n=Oc(this.tileID,this.map.transform.projection),[r,o,a,c]=this.coordinates.map(d=>{const p=n.projection.project(d[0],d[1]);return tP(n,p)._round()});this.perspectiveTransform=function(d,p,m,_,v,x,w,T,S,I){const A=dR(0,0,d,0,0,p,d,p),R=dR(m,_,v,x,w,T,S,I);return ho.multiply(R,ho.adjoint(A,A),R),[R[6]/R[8]*d/Rt,R[7]/R[8]*p/Rt]}(this.width,this.height,r.x,r.y,o.x,o.y,c.x,c.y,a.x,a.y);const u=this._boundsArray=new Cc;u.emplaceBack(r.x,r.y,0,0),u.emplaceBack(o.x,o.y,Rt,0),u.emplaceBack(c.x,c.y,0,Rt),u.emplaceBack(a.x,a.y,Rt,Rt),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(u,P1.members),this.boundsSegments=Gn.simpleSegment(0,0,4,2)}prepare(){const t=Object.keys(this.tiles).length!==0;if(this.tileID&&!t)return;const n=this.map.painter.context,r=n.gl;!this._dirty||this.texture instanceof xg||(this.texture?this.texture.update(this.image):(this.texture=new gr(n,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(n)}loadTile(t,n){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},n(null)):(t.state="errored",n(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class VU extends Vo{constructor(t){super(t,{}),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(t){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}const GU=new Mr({visibility:new te(_t.layout_sky.visibility)});var WU={paint:new Mr({"sky-type":new te(_t.paint_sky["sky-type"]),"sky-atmosphere-sun":new te(_t.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new te(_t.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new te(_t.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new te(_t.paint_sky["sky-gradient-radius"]),"sky-gradient":new qd(_t.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new te(_t.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new te(_t.paint_sky["sky-atmosphere-color"]),"sky-opacity":new te(_t.paint_sky["sky-opacity"])}),layout:GU};function $1(e,t,n){const r=[0,0,1],o=Ri.identity([]);return Ri.rotateY(o,o,n?-it(e)+Math.PI:it(e)),Ri.rotateX(o,o,-it(t)),ot.transformQuat(r,r,o),ot.normalize(r,r)}var qU={paint:new Mr({})};const HU={circle:class extends Vo{constructor(e,t){super(e,RN,t)}createBucket(e){return new r1(e)}queryRadius(e){const t=e;return Qu("circle-radius",this,t)+Qu("circle-stroke-width",this,t)+Vm(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,n,r,o,a,c,u){const d=tA(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),p=this.paint.get("circle-radius").evaluate(t,n)+this.paint.get("circle-stroke-width").evaluate(t,n);return nA(e,r,a,c,u,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",d,p)}getProgramIds(){return["circle"]}getDefaultProgramParams(e,t){const n=eA(this);return{config:new Ac(this,t),defines:n,overrideFog:!1}}},heatmap:class extends Vo{createBucket(e){return new iA(e)}constructor(e,t){super(e,FN,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Gm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(e){return Qu("heatmap-radius",this,e)}queryIntersectsFeature(e,t,n,r,o,a,c,u){const d=this.paint.get("heatmap-radius").evaluate(t,n);return nA(e,r,a,c,u,!0,!0,new N(0,0),d)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(e,t){return e==="heatmap"?{config:new Ac(this,t),overrideFog:!1}:{}}},hillshade:class extends Vo{constructor(e,t){super(e,jN,t)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(e,t){return{overrideFog:!1}}},fill:class extends Vo{constructor(e,t){super(e,t6,t)}getProgramIds(){const e=this.paint.get("fill-pattern"),t=e&&e.constantOr(1),n=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getDefaultProgramParams(e,t){return{config:new Ac(this,t),overrideFog:!1}}recalculate(e,t){super.recalculate(e,t);const n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Km(e)}queryRadius(){return Vm(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,n,r,o,a){return!e.queryGeometry.isAboveHorizon&&XI(JI(e.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),r)}isTileClipped(){return!0}},"fill-extrusion":class extends Vo{constructor(e,t){super(e,zU,t),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(e){return new Sf(e)}queryRadius(){return Vm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(e,t,n,r,o,a,c,u,d){const p=tA(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),m=this.paint.get("fill-extrusion-height").evaluate(t,n),_=this.paint.get("fill-extrusion-base").evaluate(t,n),v=[0,0],x=u&&a.elevation,w=a.elevation?a.elevation.exaggeration():1,T=e.tile.getBucket(this);if(x&&T instanceof Sf){const k=T.centroidVertexArray,P=d+1;P<k.length&&(v[0]=k.geta_centroid_pos0(P),v[1]=k.geta_centroid_pos1(P))}if(v[0]===0&&v[1]===1)return!1;a.projection.name==="globe"&&(r=nR([r],[new N(0,0),new N(Rt,Rt)],e.tileID.canonical).map(k=>k.polygon).flat());const S=x?u:null,[I,A]=function(k,P,O,j,G,W,Z,K,Q,at,X){return k.projection.name==="globe"?function(ft,gt,vt,ht,pt,Ct,At,It,zt,Ft,Ut){const Pt=[],Ht=[],he=ft.projection.upVectorScale(Ut,ft.center.lat,ft.worldSize).metersToTile,de=[0,0,0,1],_e=[0,0,0,1],xe=(Ae,Sn,pn,Ze)=>{Ae[0]=Sn,Ae[1]=pn,Ae[2]=Ze,Ae[3]=1},He=eR();vt>0&&(vt+=He),ht+=He;for(const Ae of gt){const Sn=[],pn=[];for(const Ze of Ae){const We=Ze.x+pt.x,ze=Ze.y+pt.y,yn=ft.projection.projectTilePoint(We,ze,Ut),wn=ft.projection.upVector(Ut,Ze.x,Ze.y);let sn=vt,Zn=ht;if(At){const Lr=iR(We,ze,vt,ht,At,It,zt,Ft);sn+=Lr.base,Zn+=Lr.top}vt!==0?xe(de,yn.x+wn[0]*he*sn,yn.y+wn[1]*he*sn,yn.z+wn[2]*he*sn):xe(de,yn.x,yn.y,yn.z),xe(_e,yn.x+wn[0]*he*Zn,yn.y+wn[1]*he*Zn,yn.z+wn[2]*he*Zn),ot.transformMat4(de,de,Ct),ot.transformMat4(_e,_e,Ct),Sn.push(new dh(de[0],de[1],de[2])),pn.push(new dh(_e[0],_e[1],_e[2]))}Pt.push(Sn),Ht.push(pn)}return[Pt,Ht]}(k,P,O,j,G,W,Z,K,Q,at,X):Z?function(ft,gt,vt,ht,pt,Ct,At,It,zt){const Ft=[],Ut=[],Pt=[0,0,0,1];for(const Ht of ft){const he=[],de=[];for(const _e of Ht){const xe=_e.x+ht.x,He=_e.y+ht.y,Ae=iR(xe,He,gt,vt,Ct,At,It,zt);Pt[0]=xe,Pt[1]=He,Pt[2]=Ae.base,Pt[3]=1,Wn.transformMat4(Pt,Pt,pt),Pt[3]=Math.max(Pt[3],1e-5);const Sn=new dh(Pt[0]/Pt[3],Pt[1]/Pt[3],Pt[2]/Pt[3]);Pt[0]=xe,Pt[1]=He,Pt[2]=Ae.top,Pt[3]=1,Wn.transformMat4(Pt,Pt,pt),Pt[3]=Math.max(Pt[3],1e-5);const pn=new dh(Pt[0]/Pt[3],Pt[1]/Pt[3],Pt[2]/Pt[3]);he.push(Sn),de.push(pn)}Ft.push(he),Ut.push(de)}return[Ft,Ut]}(P,O,j,G,W,Z,K,Q,at):function(ft,gt,vt,ht,pt){const Ct=[],At=[],It=pt[8]*gt,zt=pt[9]*gt,Ft=pt[10]*gt,Ut=pt[11]*gt,Pt=pt[8]*vt,Ht=pt[9]*vt,he=pt[10]*vt,de=pt[11]*vt;for(const _e of ft){const xe=[],He=[];for(const Ae of _e){const Sn=Ae.x+ht.x,pn=Ae.y+ht.y,Ze=pt[0]*Sn+pt[4]*pn+pt[12],We=pt[1]*Sn+pt[5]*pn+pt[13],ze=pt[2]*Sn+pt[6]*pn+pt[14],yn=pt[3]*Sn+pt[7]*pn+pt[15],wn=Ze+It,sn=We+zt,Zn=ze+Ft,Lr=Math.max(yn+Ut,1e-5),qn=Ze+Pt,rr=We+Ht,Dr=ze+he,zr=Math.max(yn+de,1e-5);xe.push(new dh(wn/Lr,sn/Lr,Zn/Lr)),He.push(new dh(qn/zr,rr/zr,Dr/zr))}Ct.push(xe),At.push(He)}return[Ct,At]}(P,O,j,G,W)}(a,r,_,m,p,c,S,v,w,a.center.lat,e.tileID.canonical),R=e.queryGeometry;return function(k,P,O){let j=1/0;XI(O,P)&&(j=rR(O,P[0]));for(let G=0;G<P.length;G++){const W=P[G],Z=k[G];for(let K=0;K<W.length-1;K++){const Q=W[K],at=[Q,W[K+1],Z[K+1],Z[K],Q];ZI(O,at)&&(j=Math.min(j,rR(O,at)))}}return j!==1/0&&j}(I,A,R.isPointQuery()?R.screenBounds:R.screenGeometry)}},line:class extends Vo{constructor(e,t){super(e,oR,t),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof Iv,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=uR.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new vg(e)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(e,t){const n=lR(this);return{config:new Ac(this,t),defines:n,overrideFog:!1}}queryRadius(e){const t=e,n=hR(Qu("line-width",this,t),Qu("line-gap-width",this,t)),r=Qu("line-offset",this,t);return n/2+Math.abs(r)+Vm(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,n,r,o,a){if(e.queryGeometry.isAboveHorizon)return!1;const c=JI(e.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),u=e.pixelToTileUnitsFactor/2*hR(this.paint.get("line-width").evaluate(t,n),this.paint.get("line-gap-width").evaluate(t,n)),d=this.paint.get("line-offset").evaluate(t,n);return d&&(r=function(p,m){const _=[],v=new N(0,0);for(let x=0;x<p.length;x++){const w=p[x],T=[];for(let S=0;S<w.length;S++){const I=w[S],A=w[S+1],R=S===0?v:I.sub(w[S-1])._unit()._perp(),k=S===w.length-1?v:A.sub(I)._unit()._perp(),P=R._add(k)._unit();P._mult(1/(P.x*k.x+P.y*k.y)),T.push(P._mult(m)._add(I))}_.push(T)}return _}(r,d*e.pixelToTileUnitsFactor)),function(p,m,_){for(let v=0;v<m.length;v++){const x=m[v];if(p.length>=3){for(let w=0;w<x.length;w++)if(Ml(p,x[w]))return!0}if(MN(p,x,_))return!0}return!1}(c,r,u)}isTileClipped(){return!0}},symbol:fg,background:class extends Vo{constructor(e,t){super(e,jU,t)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(e,t){return{overrideFog:!1}}},raster:class extends Vo{constructor(e,t){super(e,$U,t),this._updateColorRamp()}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}isLayerDraped(e){return!(e&&e._source instanceof ms)||!e._source.onNorthPole&&!e._source.onSouthPole&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(e){e!=="raster-color"&&e!=="raster-color-range"||this._updateColorRamp()}_updateColorRamp(){if(!this.hasColorMap())return;const e=this._transitionablePaint._values["raster-color"].value.expression,[t,n]=this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0});this.colorRamp=Gm({expression:e,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:t,end:n}],resolution:256}),this.colorRampTexture=null}},sky:class extends Vo{constructor(e,t){super(e,WU,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="sky-gradient"?this._updateColorRamp():e!=="sky-atmosphere-sun"&&e!=="sky-atmosphere-halo-color"&&e!=="sky-atmosphere-color"&&e!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Gm({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(e){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=e.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(e,t){if(this.paint.get("sky-type")==="atmosphere"){const r=this.paint.get("sky-atmosphere-sun"),o=!r,a=e.style.light,c=a.properties.get("position");return o&&a.properties.get("anchor")==="viewport"&&dt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),o?$1(c.azimuthal,90-c.polar,t):$1(r[0],90-r[1],t)}const n=this.paint.get("sky-gradient-center");return $1(n[0],90-n[1],t)}isSky(){return!0}markSkyboxValid(e){this._skyboxInvalidated=!1,this._lightPosition=e.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const e=this.paint.get("sky-type");return e==="atmosphere"?["skyboxCapture","skybox"]:e==="gradient"?["skyboxGradient"]:null}},slot:class extends Vo{constructor(e,t){super(e,qU)}},model:class extends Vo{constructor(e,t){super(e,xU,t)}createBucket(e){return new LP(e)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(){return 0}queryIntersectsFeature(){return!1}_handleOverridablePaintPropertyUpdate(e,t,n){return!(!this.layout||t.isDataDriven()||n.isDataDriven()||e!=="model-color"&&e!=="model-color-mix-intensity"&&e!=="model-rotation"&&e!=="model-scale"&&e!=="model-translation"&&e!=="model-emissive-strength")}_isPropertyZoomDependent(e){const t=this._transitionablePaint._values[e];return t!=null&&t.value!=null&&t.value.expression!=null&&t.value.expression instanceof fl}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}}};function Rg(e,t){return e.type==="custom"?new VU(e):new HU[e.type](e,t)}function ZU(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class XU extends En{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(t){this.images[t]={},this.loaded[t]=!1,this.updatedImages[t]={},this.patterns[t]={},this.callbackDispatchedThisFrame[t]={},this.atlasImage[t]=new jr({width:1,height:1})}isLoaded(){for(const t in this.loaded)if(!this.loaded[t])return!1;return!0}setLoaded(t,n){if(this.loaded[n]!==t&&(this.loaded[n]=t,t)){for(const{ids:r,callback:o}of this.requestors)this._notify(r,n,o);this.requestors=[]}}hasImage(t,n){return!!this.getImage(t,n)}getImage(t,n){return this.images[n][t]}addImage(t,n,r){this._validate(t,r)&&(this.images[n][t]=r)}_validate(t,n){let r=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new ve(new Error(`Image "${t}" has invalid "stretchX" value`))),r=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new ve(new Error(`Image "${t}" has invalid "stretchY" value`))),r=!1),this._validateContent(n.content,n)||(this.fire(new ve(new Error(`Image "${t}" has invalid "content" value`))),r=!1),r}_validateStretch(t,n){if(!t)return!0;let r=0;for(const o of t){if(o[0]<r||o[1]<o[0]||n<o[1])return!1;r=o[1]}return!0}_validateContent(t,n){return!(t&&(t.length!==4||t[0]<0||n.data.width<t[0]||t[1]<0||n.data.height<t[1]||t[2]<0||n.data.width<t[2]||t[3]<0||n.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,n,r){r.version=this.images[n][t].version+1,this.images[n][t]=r,this.updatedImages[n][t]=!0}removeImage(t,n){const r=this.images[n][t];delete this.images[n][t],delete this.patterns[n][t],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(t){return Object.keys(this.images[t])}getImages(t,n,r){let o=!0;const a=!!this.loaded[n];if(!a)for(const c of t)this.images[n][c]||(o=!1);a||o?this._notify(t,n,r):this.requestors.push({ids:t,scope:n,callback:r})}getUpdatedImages(t){return this.updatedImages[t]}_notify(t,n,r){const o={};for(const a of t){this.images[n][a]||this.fire(new Nt("styleimagemissing",{id:a}));const c=this.images[n][a];c?o[a]={data:c.data.clone(),pixelRatio:c.pixelRatio,sdf:c.sdf,version:c.version,stretchX:c.stretchX,stretchY:c.stretchY,content:c.content,hasRenderCallback:!!(c.userImage&&c.userImage.render)}:dt(`Image "${a}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}r(null,o)}getPixelSize(t){const{width:n,height:r}=this.atlasImage[t];return{width:n,height:r}}getPattern(t,n){const r=this.patterns[n][t],o=this.getImage(t,n);if(!o)return null;if(r&&r.position.version===o.version)return r.position;if(r)r.position.version=o.version;else{const a={w:o.data.width+2,h:o.data.height+2,x:0,y:0},c=new w1(a,o);this.patterns[n][t]={bin:a,position:c}}return this._updatePatternAtlas(n),this.patterns[n][t].position}bind(t,n){const r=t.gl;let o=this.atlasTexture[n];o?this.dirty&&(o.update(this.atlasImage[n]),this.dirty=!1):(o=new gr(t,this.atlasImage[n],r.RGBA),this.atlasTexture[n]=o),o.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(t){const n=[];for(const c in this.patterns[t])n.push(this.patterns[t][c].bin);const{w:r,h:o}=b1(n),a=this.atlasImage[t];a.resize({width:r||1,height:o||1});for(const c in this.patterns[t]){const{bin:u}=this.patterns[t][c],d=u.x+1,p=u.y+1,m=this.images[t][c].data,_=m.width,v=m.height;jr.copy(m,a,{x:0,y:0},{x:d,y:p},{width:_,height:v}),jr.copy(m,a,{x:0,y:v-1},{x:d,y:p-1},{width:_,height:1}),jr.copy(m,a,{x:0,y:0},{x:d,y:p+v},{width:_,height:1}),jr.copy(m,a,{x:_-1,y:0},{x:d-1,y:p},{width:1,height:v}),jr.copy(m,a,{x:0,y:0},{x:d+_,y:p},{width:1,height:v})}this.dirty=!0}beginFrame(){for(const t in this.images)this.callbackDispatchedThisFrame[t]={}}dispatchRenderCallbacks(t,n){for(const r of t){if(this.callbackDispatchedThisFrame[n][r])continue;this.callbackDispatchedThisFrame[n][r]=!0;const o=this.images[n][r];ZU(o)&&this.updateImage(r,n,o)}}}const KU=new Mr({anchor:new te(_t.light.anchor),position:new class{constructor(e){this.specification=e}possiblyEvaluate(e,t){return ae(e.expression.evaluate(t))}interpolate(e,t,n){return{x:Xe(e.x,t.x,n),y:Xe(e.y,t.y,n),z:Xe(e.z,t.z,n),azimuthal:Xe(e.azimuthal,t.azimuthal,n),polar:Xe(e.polar,t.polar,n)}}}(_t.light.position),color:new te(_t.light.color),intensity:new te(_t.light.intensity)});class fR extends En{constructor(t,n="flat"){super(),this._transitionable=new Gd(KU),this.setLight(t,n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,n,r={}){this._validate(vF,t,r)||(this._transitionable.setTransitionOrValue(t),this.id=n)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,n,r){return(!r||r.validate!==!1)&&ym(this,t.call(ju,Ot({value:n,style:{glyphs:!0,sprite:!0},styleSpec:_t})))}}const YU=new Mr({source:new te(_t.terrain.source),exaggeration:new te(_t.terrain.exaggeration)});let QU=class extends En{constructor(e,t,n,r){super(),this.scope=n,this._transitionable=new Gd(YU,r),this._transitionable.setTransitionOrValue(e,r),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=t}get(){return this._transitionable.serialize()}set(e,t){this._transitionable.setTransitionOrValue(e,t)}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}getExaggeration(e){return this._transitioning.possiblyEvaluate(new fr(e)).get("exaggeration")}isZoomDependent(){const e=this._transitionable._values.exaggeration;return e!=null&&e.value!=null&&e.value.expression!=null&&e.value.expression instanceof fl}};const pR=45,mR=65,Bc=.05;function kg(e,t,n,r){const o=Le(pR,mR,n),[a,c]=gR(e,r);let u=1-Math.min(1,Math.exp((t-a)/(c-a)*-6));return u*=u*u,u=Math.min(1,1.00747*u),u*o*e.alpha}function gR(e,t){const n=.5/Math.tan(.5*t);return[e.range[0]+n,e.range[1]+n]}function _R(e,t,n,r,o){const a=ot.transformMat4([],[t,n,r],o.mercatorFogMatrix);return kg(e,ot.length(a),o.pitch,o._fov)}function yR(e,t,n,r,o,a,c){const u=[[n,r,0],[o,r,0],[o,a,0],[n,a,0]];let d=Number.MAX_VALUE,p=-Number.MAX_VALUE;for(const m of u){const _=ot.transformMat4([],m,t),v=ot.length(_);d=Math.min(d,v),p=Math.max(p,v)}return[kg(e,d,c.pitch,c._fov),kg(e,p,c.pitch,c._fov)]}const JU=new Mr({range:new te(_t.fog.range),color:new te(_t.fog.color),"high-color":new te(_t.fog["high-color"]),"space-color":new te(_t.fog["space-color"]),"horizon-blend":new te(_t.fog["horizon-blend"]),"star-intensity":new te(_t.fog["star-intensity"]),"vertical-range":new te(_t.fog["vertical-range"])});class t$ extends En{constructor(t,n){super(),this._transitionable=new Gd(JU),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=n}get state(){const t=this._transform,n=t.projection.name==="globe",r=fi(t.zoom),o=this.properties.get("range"),a=[.5,3];return{range:n?[Xe(a[0],o[0],r),Xe(a[1],o[1],r)]:o,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,n={}){if(this._validate(wF,t,n))return;const r=Ot({},t);for(const o of Object.keys(_t.fog))r[o]===void 0&&(r[o]=_t.fog[o].default);this._transitionable.setTransitionOrValue(r)}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const n=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:Le(pR,mR,t))*n.a}getOpacityAtLatLng(t,n){return this._transform.projection.supportsFog?function(r,o,a){const c=xn.fromLngLat(o),u=a.elevation?a.elevation.getAtPointOrZero(c):0;return _R(r,c.x,c.y,u,a)}(this.state,t,n):0}getOpacityForTile(t){if(!this._transform.projection.supportsFog)return[1,1];const n=this._transform.calculateFogTileMatrix(t.toUnwrapped());return yR(this.state,n,0,0,Rt,Rt,this._transform)}getOpacityForBounds(t,n,r,o,a){return this._transform.projection.supportsFog?yR(this.state,t,n,r,o,a,this._transform):[1,1]}getFovAdjustedRange(t){return this._transform.projection.supportsFog?gR(this.state,t):[0,1]}isVisibleOnFrustum(t){if(!this._transform.projection.supportsFog)return!1;const n=[4,5,6,7];for(const r of n){const o=t.points[r];let a;if(o[2]>=0)a=o;else{const c=t.points[r-4];a=qE(c,o,c[2]/(c[2]-o[2]))}if(_R(this.state,a[0],a[1],0,this._transform)>=Bc)return!0}return!1}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,n,r){return(!r||r.validate!==!1)&&ym(this,t.call(ju,Ot({value:n,style:{glyphs:!0,sprite:!0},styleSpec:_t})))}}class e${constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class n${constructor(){this.tasks={},this.taskQueue=[],Ue(["process"],this),this.invoker=new e$(this.process),this.nextId=0}add(t,n){const r=this.nextId++,o=function({type:a,isSymbolTile:c,zoom:u}){return u=u||0,a==="message"?0:a!=="maybePrepare"||c?a!=="parseTile"||c?a==="parseTile"&&c?300-u:a==="maybePrepare"&&c?400-u:500:200-u:100-u}(n);if(o===0){qt();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[r]={fn:t,metadata:n,priority:o,id:r},this.taskQueue.push(r),this.invoker.trigger(),{cancel:()=>{delete this.tasks[r]}}}process(){qt();try{if(this.taskQueue=this.taskQueue.filter(r=>!!this.tasks[r]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const n=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let t=null,n=1/0;for(let o=0;o<this.taskQueue.length;o++){const a=this.tasks[this.taskQueue[o]];a.priority<n&&(n=a.priority,t=o)}if(t===null)return null;const r=this.taskQueue[t];return this.taskQueue.splice(t,1),r}remove(){this.invoker.remove()}}class vR{constructor(t,n,r){this.target=t,this.parent=n,this.mapId=r,this.callbacks={},this.cancelCallbacks={},Ue(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new n$}send(t,n,r,o,a=!1,c){const u=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(r.metadata=c,this.callbacks[u]=r);const d=new Set;return this.target.postMessage({id:u,type:t,hasCallback:!!r,targetMapId:o,mustQueue:a,sourceMapId:this.mapId,data:$u(n,d)},d),{cancel:()=>{r&&delete this.callbacks[u],this.target.postMessage({id:u,type:"<cancel>",targetMapId:o,sourceMapId:this.mapId})}}}receive(t){const n=t.data,r=n.id;if(r&&(!n.targetMapId||this.mapId===n.targetMapId))if(n.type==="<cancel>"){const o=this.cancelCallbacks[r];delete this.cancelCallbacks[r],o&&o.cancel()}else if(n.mustQueue||qt()){const o=this.callbacks[r];this.cancelCallbacks[r]=this.scheduler.add(()=>this.processTask(r,n),o&&o.metadata||{type:"message"})}else this.processTask(r,n)}processTask(t,n){if(n.type==="<response>"){const r=this.callbacks[t];delete this.callbacks[t],r&&(n.error?r(Vu(n.error)):r(null,Vu(n.data)))}else{const r=new Set,o=n.hasCallback?(c,u)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:c?$u(c):null,data:$u(u,r)},r)}:c=>{},a=Vu(n.data);if(this.parent[n.type])this.parent[n.type](n.sourceMapId,a,o);else if(this.parent.getWorkerSource){const c=n.type.split(".");this.parent.getWorkerSource(n.sourceMapId,c[0],a.source,a.scope)[c[1]](a,o)}else o(new Error(`Could not find function ${n.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Fc{constructor(t,n){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=Ne();const r=this.workerPool.acquire(this.id);for(let o=0;o<r.length;o++){const a=new Fc.Actor(r[o],n,this.id);a.name=`Worker ${o}`,this.actors.push(a)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,n,r){kt(this.actors,(o,a)=>{o.send(t,n,a)},r=r||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}Fc.Actor=vR;class xR extends En{constructor(t,n,r,o){super(),this.scope=r,this._options=t,this.properties=new Wd(n),this._transitionable=new Gd(n,new Map(o)),this._transitionable.setTransitionOrValue(t.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(t){this._transitionable.setTransitionOrValue(this._options.properties,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(t,n){this._options=t,this._transitionable.setTransitionOrValue(t.properties,n)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}const r$=new Mr({color:new te(_t.properties_light_ambient.color),intensity:new te(_t.properties_light_ambient.intensity)}),i$=new Mr({direction:new class{constructor(e){this.specification=e}possiblyEvaluate(e,t){return function([n,r]){const o=ae([1,n,r]);return{x:o.x,y:o.y,z:o.z}}(e.expression.evaluate(t))}interpolate(e,t,n){return{x:Xe(e.x,t.x,n),y:Xe(e.y,t.y,n),z:Xe(e.z,t.z,n)}}}(_t.properties_light_directional.direction),color:new te(_t.properties_light_directional.color),intensity:new te(_t.properties_light_directional.intensity),"cast-shadows":new te(_t.properties_light_directional["cast-shadows"]),"shadow-intensity":new te(_t.properties_light_directional["shadow-intensity"])});class V1{constructor(t,n,r,o){this.screenBounds=t,this.cameraPoint=n,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=r,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,o)}static createFromScreenPoints(t,n){let r,o;if(t instanceof N||typeof t[0]=="number"){const a=N.convert(t);r=[a],o=n.isPointAboveHorizon(a)}else{const a=N.convert(t[0]),c=N.convert(t[1]);r=[a,c],o=$t(a,c).every(u=>n.isPointAboveHorizon(u))}return new V1(r,n.getCameraPoint(),o,n)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(t){return $t(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const n=this.screenBounds[0],r=this.screenBounds.length===1?this.screenBounds[0].add(new N(1,1)):this.screenBounds[1],o=$t(n,r,0,!1);return this.cameraPoint.y>r.y&&(this.cameraPoint.x>n.x&&this.cameraPoint.x<r.x?o.splice(3,0,this.cameraPoint):this.cameraPoint.x>=r.x?o[2]=this.cameraPoint:this.cameraPoint.x<=n.x&&(o[3]=this.cameraPoint)),function(a,c){const u=[];for(let d=0;d<a.length;d++){const p=we(d-1,-1,a.length-1),m=we(d+1,-1,a.length-1),_=a[d],v=a[m],x=a[p].sub(_).unit(),w=v.sub(_).unit(),T=w.angleWithSep(x.x,x.y),S=x.add(w).unit().mult(-1*c/Math.sin(T/2));u.push(_.add(S))}return u}(o,t)}bufferedCameraGeometryGlobe(t){const n=this.screenBounds[0],r=this.screenBounds.length===1?this.screenBounds[0].add(new N(1,1)):this.screenBounds[1],o=$t(n,r,t),a=this.cameraPoint.clone();switch(3*((a.y>n.y)+(a.y>r.y))+((a.x>n.x)+(a.x>r.x))){case 0:o[0]=a,o[4]=a.clone();break;case 1:o.splice(1,0,a);break;case 2:o[1]=a;break;case 3:o.splice(4,0,a);break;case 5:o.splice(2,0,a);break;case 6:o[3]=a;break;case 7:o.splice(3,0,a);break;case 8:o[2]=a}return o}containsTile(t,n,r,o=0){const a=t.queryPadding/n._pixelsPerMercatorPixel+1,c=r?this._bufferedCameraMercator(a,n):this._bufferedScreenMercator(a,n);let u=t.tileID.wrap+(c.unwrapped?o:0);const d=c.polygon.map(S=>tP(t.tileTransform,S,u));if(!QI(d,0,0,Rt,Rt))return;u=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?o:0);const p=this.screenGeometryMercator.polygon.map(S=>eP(t.tileTransform,S,u)),m=p.map(S=>new N(S[0],S[1])),_=n.getFreeCameraOptions().position||new xn(0,0,0),v=eP(t.tileTransform,_,u),x=p.map(S=>{const I=ot.sub(S,S,v);return ot.normalize(I,I),new zm(v,I)}),w=Lc(t,1,n.zoom)*n._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:m,tilespaceRays:x,bufferedTilespaceGeometry:d,bufferedTilespaceBounds:(T=Et(d),T.min.x=jt(T.min.x,0,Rt),T.min.y=jt(T.min.y,0,Rt),T.max.x=jt(T.max.x,0,Rt),T.max.y=jt(T.max.y,0,Rt),T),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:w};var T}_bufferedScreenMercator(t,n){const r=bR(t);if(this._screenRaycastCache[r])return this._screenRaycastCache[r];{let o;return o=n.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(t),n):{polygon:this.bufferedScreenGeometry(t).map(a=>n.pointCoordinate3D(a)),unwrapped:!0},this._screenRaycastCache[r]=o,o}}_bufferedCameraMercator(t,n){const r=bR(t);if(this._cameraRaycastCache[r])return this._cameraRaycastCache[r];{let o;return o=n.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),n):{polygon:this.bufferedCameraGeometry(t).map(a=>n.pointCoordinate3D(a)),unwrapped:!0},this._cameraRaycastCache[r]=o,o}}_projectAndResample(t,n){const r=function(a,c){const u=wt.multiply([],c.pixelMatrix,c.globeMatrix),d=[0,-Yi,0,1],p=[0,Yi,0,1],m=[0,0,0,1];Wn.transformMat4(d,d,u),Wn.transformMat4(p,p,u),Wn.transformMat4(m,m,u);const _=new N(d[0]/d[3],d[1]/d[3]),v=new N(p[0]/p[3],p[1]/p[3]),x=Ml(a,_)&&d[3]<m[3],w=Ml(a,v)&&p[3]<m[3];if(!x&&!w)return null;const T=function(j,G,W){for(let Z=1;Z<j.length;Z++){const K=Cf(G.pointCoordinate3D(j[Z-1]).x),Q=Cf(G.pointCoordinate3D(j[Z]).x);if(W<0){if(K<Q)return{idx:Z,t:-K/(Q-1-K)}}else if(Q<K)return{idx:Z,t:(1-K)/(Q+1-K)}}return null}(a,c,x?-1:1);if(!T)return null;const{idx:S,t:I}=T;let A=S>1?G1(a.slice(0,S),c):[],R=S<a.length?G1(a.slice(S),c):[];A=A.map(j=>new N(Cf(j.x),j.y)),R=R.map(j=>new N(Cf(j.x),j.y));const k=[...A];k.length===0&&k.push(R[R.length-1]);const P=Xe(k[k.length-1].y,(R.length===0?A[0]:R[0]).y,I);let O;return O=x?[new N(0,P),new N(0,0),new N(1,0),new N(1,P)]:[new N(1,P),new N(1,1),new N(0,1),new N(0,P)],k.push(...O),R.length===0?k.push(A[0]):k.push(...R),{polygon:k.map(j=>new xn(j.x,j.y)),unwrapped:!1}}(t,n);if(r)return r;const o=function(a,c){let u=!1,d=-1/0,p=0;for(let _=0;_<a.length-1;_++)a[_].x>d&&(d=a[_].x,p=_);for(let _=0;_<a.length-1;_++){const v=(p+_)%(a.length-1),x=a[v],w=a[v+1];Math.abs(x.x-w.x)>.5&&(x.x<w.x?(x.x+=1,v===0&&(a[a.length-1].x+=1)):(w.x+=1,v+1===a.length-1&&(a[0].x+=1)),u=!0)}const m=Qr(c.center.lng);return u&&m<Math.abs(m-1)&&a.forEach(_=>{_.x-=1}),{polygon:a,unwrapped:u}}(G1(t,n).map(a=>new N(Cf(a.x),a.y)),n);return{polygon:o.polygon.map(a=>new xn(a.x,a.y)),unwrapped:o.unwrapped}}}function G1(e,t){return qI(e,n=>{const r=t.pointCoordinate3D(n);n.x=r.x,n.y=r.y},1/256)}function Cf(e){return e<0?1+e%1:e%1}function bR(e){return 100*e|0}function W1(e,t,n,r,o){const a=function(c,u){if(c)return o(c);if(u){e.url&&u.tiles&&e.tiles&&delete e.tiles;const d=Pe(Ot(u,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);u.vector_layers&&(d.vectorLayers=u.vector_layers,d.vectorLayerIds=d.vectorLayers.map(p=>p.id)),d.tiles=t.canonicalizeTileset(d,e.url),o(null,d)}};return e.url?Qt(t.transformRequest(t.normalizeSourceURL(e.url,null,n,r),Dt.Source),a):Ve.frame(()=>a(null,e))}class Og{constructor(t,n,r){this.bounds=To.convert(this.validateBounds(t)),this.minzoom=n||0,this.maxzoom=r||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const n=Math.pow(2,t.z),r=Math.floor(Qr(this.bounds.getWest())*n),o=Math.floor(oi(this.bounds.getNorth())*n),a=Math.ceil(Qr(this.bounds.getEast())*n),c=Math.ceil(oi(this.bounds.getSouth())*n);return t.x>=r&&t.x<a&&t.y>=o&&t.y<c}}class wR{constructor(t,n){this.width=t,this.height=n,this.nextRow=0,this.image=new Ua({width:t,height:n}),this.positions={},this.uploaded=!1}getDash(t,n){const r=this.getKey(t,n);return this.positions[r]}trim(){const t=this.width,n=this.height=je(this.nextRow);this.image.resize({width:t,height:n})}getKey(t,n){return t.join(",")+n}getDashRanges(t,n,r){const o=[];let a=t.length%2==1?-t[t.length-1]*r:0,c=t[0]*r,u=!0;o.push({left:a,right:c,isDash:u,zeroLength:t[0]===0});let d=t[0];for(let p=1;p<t.length;p++){u=!u;const m=t[p];a=d*r,d+=m,c=d*r,o.push({left:a,right:c,isDash:u,zeroLength:m===0})}return o}addRoundDash(t,n,r){const o=n/2;for(let a=-r;a<=r;a++){const c=this.width*(this.nextRow+r+a);let u=0,d=t[u];for(let p=0;p<this.width;p++){p/d.right>1&&(d=t[++u]);const m=Math.abs(p-d.left),_=Math.abs(p-d.right),v=Math.min(m,_);let x;const w=a/r*(o+1);if(d.isDash){const T=o-Math.abs(w);x=Math.sqrt(v*v+T*T)}else x=o-Math.sqrt(v*v+w*w);this.image.data[c+p]=Math.max(0,Math.min(255,x+128))}}}addRegularDash(t,n){for(let d=t.length-1;d>=0;--d){const p=t[d],m=t[d+1];p.zeroLength?t.splice(d,1):m&&m.isDash===p.isDash&&(m.left=p.left,t.splice(d,1))}const r=t[0],o=t[t.length-1];r.isDash===o.isDash&&(r.left=o.left-this.width,o.right=r.right+this.width);const a=this.width*this.nextRow;let c=0,u=t[c];for(let d=0;d<this.width;d++){d/u.right>1&&(u=t[++c]);const p=Math.abs(d-u.left),m=Math.abs(d-u.right),_=Math.min(p,m);this.image.data[a+d]=Math.max(0,Math.min(255,(u.isDash?_:-_)+n+128))}}addDash(t,n){const r=this.getKey(t,n);if(this.positions[r])return this.positions[r];const o=n==="round",a=o?7:0,c=2*a+1;if(this.nextRow+c>this.height)return dt("LineAtlas out of space"),null;t.length===0&&t.push(1);let u=0;for(let m=0;m<t.length;m++)t[m]<0&&(dt("Negative value is found in line dasharray, replacing values with 0"),t[m]=0),u+=t[m];if(u!==0){const m=this.width/u,_=this.getDashRanges(t,this.width,m);o?this.addRoundDash(_,m,a):this.addRegularDash(_,n==="square"?.5*m:0)}const d=this.nextRow+a;this.nextRow+=c;const p={tl:[d,a],br:[u,0]};return this.positions[r]=p,p}}Te(wR,"LineAtlas");const TR=1*Ds;class SR{constructor(t){const n={},r=[];for(const u in t){const d=t[u],p=n[u]={};for(const m in d.glyphs){const _=d.glyphs[+m];if(!_||_.bitmap.width===0||_.bitmap.height===0)continue;const v=_.metrics.localGlyph?TR:1,x={x:0,y:0,w:_.bitmap.width+2*v,h:_.bitmap.height+2*v};r.push(x),p[m]=x}}const{w:o,h:a}=b1(r),c=new Ua({width:o||1,height:a||1});for(const u in t){const d=t[u];for(const p in d.glyphs){const m=d.glyphs[+p];if(!m||m.bitmap.width===0||m.bitmap.height===0)continue;const _=n[u][p],v=m.metrics.localGlyph?TR:1;Ua.copy(m.bitmap,c,{x:0,y:0},{x:_.x+v,y:_.y+v},m.bitmap)}}this.image=c,this.positions=n}}Te(SR,"GlyphAtlas");class o${constructor(t){this.tileID=new Pn(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.scope=t.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.promoteId=t.promoteId,this.isSymbolTile=t.isSymbolTile,this.tileTransform=Oc(t.tileID.canonical,t.projection),this.projection=t.projection,this.brightness=t.brightness,this.extraShadowCaster=!!t.extraShadowCaster}parse(t,n,r,o,a){this.status="parsing",this.data=t,this.collisionBoxArray=new Tx;const c=new mA(Object.keys(t.layers).sort()),u=new _1(this.tileID,this.promoteId);u.bucketLayerIDs=[];const d={},p=new wR(256,256),m={featureIndex:u,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:p,availableImages:r,brightness:this.brightness},_=n.familiesBySource[this.source];for(const A in _){const R=t.layers[A];if(!R)continue;let k=!1,P=!1,O=!1;for(const W of _[A])W[0].type==="symbol"?k=!0:P=!0,W[0].is3D()&&W[0].type!=="model"&&(O=!0);if(this.extraShadowCaster&&!O||this.isSymbolTile===!0&&!k||this.isSymbolTile===!1&&!P)continue;R.version===1&&dt(`Vector tile source "${this.source}" layer "${A}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const j=c.encode(A),G=[];for(let W=0;W<R.length;W++){const Z=R.feature(W),K=u.getId(Z,A);G.push({feature:Z,id:K,index:W,sourceLayerIndex:j})}for(const W of _[A]){const Z=W[0];(!this.extraShadowCaster||Z.is3D()&&Z.type!=="model")&&(this.isSymbolTile!==void 0&&Z.type==="symbol"!==this.isSymbolTile||Z.minzoom&&this.zoom<Math.floor(Z.minzoom)||Z.maxzoom&&this.zoom>=Z.maxzoom||Z.visibility!=="none"&&(q1(W,this.zoom,m.brightness,r),(d[Z.id]=Z.createBucket({index:u.bucketLayerIDs.length,layers:W,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:j,sourceID:this.source,projection:this.projection.spec})).populate(G,m,this.tileID.canonical,this.tileTransform),u.bucketLayerIDs.push(W.map(K=>K.id))))}}let v,x,w,T;p.trim();const S={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},I=()=>{if(v)return this.status="done",a(v);if(this.extraShadowCaster)this.status="done",a(null,{buckets:Xt(d).filter(A=>!A.isEmpty()),featureIndex:u,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:m.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(x&&w&&T){const A=new SR(x),R=new WA(w,T);for(const k in d){const P=d[k];P instanceof gf?(q1(P.layers,this.zoom,m.brightness,r),ej(P,x,A.positions,w,R.iconPositions,this.showCollisionBoxes,r,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):P.hasPattern&&(P instanceof vg||P instanceof Km||P instanceof Sf)&&(q1(P.layers,this.zoom,m.brightness,r),P.addFeatures(m,this.tileID.canonical,R.patternPositions,r,this.tileTransform,this.brightness))}this.status="done",a(null,{buckets:Xt(d).filter(k=>!k.isEmpty()),featureIndex:u,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:A.image,lineAtlas:p,imageAtlas:R,brightness:m.brightness})}};if(!this.extraShadowCaster){const A=vn(m.glyphDependencies,P=>Object.keys(P).map(Number));Object.keys(A).length?o.send("getGlyphs",{uid:this.uid,stacks:A,scope:this.scope},(P,O)=>{v||(v=P,x=O,I())},void 0,!1,S):x={};const R=Object.keys(m.iconDependencies);R.length?o.send("getImages",{icons:R,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(P,O)=>{v||(v=P,w=O,I())},void 0,!1,S):w={};const k=Object.keys(m.patternDependencies);k.length?o.send("getImages",{icons:k,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(P,O)=>{v||(v=P,T=O,I())},void 0,!1,S):T={}}I()}}function q1(e,t,n,r){const o=new fr(t,{brightness:n});for(const a of e)a.recalculate(o,r)}class ER{constructor(t){this.entries={},this.scheduler=t}request(t,n,r,o){const a=this.entries[t]=this.entries[t]||{callbacks:[]};if(a.result){const[c,u]=a.result;return this.scheduler?this.scheduler.add(()=>{o(c,u)},n):o(c,u),()=>{}}return a.callbacks.push(o),a.cancel||(a.cancel=r((c,u)=>{a.result=[c,u];for(const d of a.callbacks)this.scheduler?this.scheduler.add(()=>{d(c,u)},n):d(c,u);setTimeout(()=>delete this.entries[t],3e3)})),()=>{a.result||(a.callbacks=a.callbacks.filter(c=>c!==o),a.callbacks.length||(a.cancel(),delete this.entries[t]))}}}function CR(e,t,n){const r=JSON.stringify(e.request);return e.data&&(this.deduped.entries[r]={result:[null,e.data]}),this.deduped.request(r,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom},o=>{const a=le(e.request,(c,u,d,p)=>{c?o(c):u&&o(null,{vectorTile:n?void 0:new m1(new ng(u)),rawData:u,cacheControl:d,expires:p})});return()=>{a.cancel(),o()}},t)}class MR extends En{constructor(t,n,r,o){if(super(),this.id=t,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Ot(this,Pe(n,["url","scheme","tileSize","promoteId"])),this._options=Ot({type:"vector"},n),this._collectResourceTiming=!!n.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(o),this._tileWorkers={},this._deduped=new ER}load(t){this._loaded=!1,this.fire(new Nt("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,r=this.map._worldview;this._tileJSONRequest=W1(this._options,this.map._requestManager,n,r,(o,a)=>{this._tileJSONRequest=null,this._loaded=!0,o?(n&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${n}`),r&&r.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${r}`),this.fire(new ve(o))):a&&(Ot(this,a),a.bounds&&(this.tileBounds=new Og(a.bounds,this.minzoom,this.maxzoom)),mc(a.tiles,this.map._requestManager._customAccessToken),this.fire(new Nt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Nt("data",{dataType:"source",sourceDataType:"content"}))),t&&t(o)})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=$i(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return Ot({},this._options)}loadTile(t,n){const r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),o={request:this.map._requestManager.transformRequest(r,Dt.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:Ve.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:t.isExtraShadowCaster};if(o.request.collectResourceTiming=this._collectResourceTiming,t.actor&&t.state!=="expired")t.state==="loading"?t.reloadCallback=n:t.request=t.actor.send("reloadTile",o,a.bind(this));else if(t.actor=this._tileWorkers[r]=this._tileWorkers[r]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",o,a.bind(this),void 0,!0);else{const c=CR.call({deduped:this._deduped},o,(u,d)=>{u||!d?a.call(this,u):(o.data={cacheControl:d.cacheControl,expires:d.expires,rawData:d.rawData.slice(0)},t.actor&&t.actor.send("loadTile",o,a.bind(this),void 0,!0))},!0);t.request={cancel:c}}function a(c,u){return delete t.request,t.aborted?n(null):c&&c.status!==404?n(c):(u&&u.resourceTiming&&(t.resourceTiming=u.resourceTiming),this.map._refreshExpiredTiles&&u&&t.setExpiryData(u),t.loadVectorData(u,this.map.painter),Hi(this.dispatcher),n(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(t){t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope}),t.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class H1 extends En{constructor(t,n,r,o){super(),this.id=t,this.dispatcher=r,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Ot({type:"raster"},n),Ot(this,Pe(n,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new Nt("dataloading",{dataType:"source"})),this._tileJSONRequest=W1(this._options,this.map._requestManager,null,null,(n,r)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new ve(n)):r&&(Ot(this,r),r.bounds&&(this.tileBounds=new Og(r.bounds,this.minzoom,this.maxzoom)),mc(r.tiles),this.fire(new Nt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Nt("data",{dataType:"source",sourceDataType:"content"}))),t&&t(n)})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=$i(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return Ot({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,n){const r=Ve.devicePixelRatio>=2,o=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),r,this.tileSize);t.request=Qe(this.map._requestManager.transformRequest(o,Dt.Tile),(a,c,u,d)=>(delete t.request,t.aborted?(t.state="unloaded",n(null)):a?(t.state="errored",n(a)):c?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:u,expires:d}),t.setTexture(c,this.map.painter),t.state="loaded",Hi(this.dispatcher),void n(null)):n(null)))}abortTile(t,n){t.request&&(t.request.cancel(),delete t.request),n()}unloadTile(t,n){t.texture&&t.texture instanceof gr?(t.destroy(!0),t.texture&&t.texture instanceof gr&&this.map.painter.saveTileTexture(t.texture)):t.destroy(),n()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function s$(){return n_.workerClass!=null?new n_.workerClass:new C.Worker(n_.workerUrl)}const Z1="mapboxgl_preloaded_worker_pool";class fh{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<fh.workerCount;)this.workers.push(new s$);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&this.numActive()===0&&(this.workers.forEach(n=>{n.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Z1]}numActive(){return Object.keys(this.active).length}}let Mf;function If(){return Mf||(Mf=new fh),Mf}fh.workerCount=2;let Lg,X1,Ns,K1=null;function IR(){return qt()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:X1||z.DRACO_URL}const Y1=5123,Q1=5126,J1={5120:Int8Array,5121:Uint8Array,5122:Int16Array,[Y1]:Uint16Array,5125:Uint32Array,[Q1]:Float32Array},a$={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",[Y1]:"DT_UINT16",5125:"DT_UINT32",[Q1]:"DT_FLOAT32"},tb={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function AR(e,t,n){const r=n.json.bufferViews.length,o=n.buffers.length;t.bufferView=r,n.json.bufferViews[r]={buffer:o,byteLength:e.byteLength},n.buffers[o]=e}const eb="KHR_draco_mesh_compression";function l$(e,t){const n=e.extensions&&e.extensions[eb];if(!n)return;const r=new Ns.Decoder,o=OR(t,n.bufferView),a=new Ns.Mesh;if(!r.DecodeArrayToMesh(o,o.byteLength,a))throw new Error("Failed to decode Draco mesh");const c=t.json.accessors[e.indices],u=J1[c.componentType],d=c.count*u.BYTES_PER_ELEMENT,p=Ns._malloc(d);u===Uint16Array?r.GetTrianglesUInt16Array(a,d,p):r.GetTrianglesUInt32Array(a,d,p),AR(Ns.memory.buffer.slice(p,p+d),c,t),Ns._free(p);for(const m of Object.keys(n.attributes)){const _=r.GetAttributeByUniqueId(a,n.attributes[m]),v=t.json.accessors[e.attributes[m]],x=a$[v.componentType],w=v.count*tb[v.type]*J1[v.componentType].BYTES_PER_ELEMENT,T=Ns._malloc(w);r.GetAttributeDataArrayForAllPoints(a,_,Ns[x],w,T),AR(Ns.memory.buffer.slice(T,T+w),v,t),Ns._free(T)}r.destroy(),a.destroy(),delete e.extensions[eb]}const PR=1179937895,RR=new TextDecoder("utf8");function kR(e,t){return new URL(e,t).href}function c$(e,t,n,r){return fetch(kR(e.uri,r)).then(o=>o.arrayBuffer()).then(o=>{t.buffers[n]=o})}function OR(e,t){const n=e.json.bufferViews[t];return new Uint8Array(e.buffers[n.buffer],n.byteOffset||0,n.byteLength)}function u$(e,t,n,r){if(e.uri){const o=kR(e.uri,r);return fetch(o).then(a=>a.blob()).then(a=>C.createImageBitmap(a)).then(a=>{t.images[n]=a})}if(e.bufferView!==void 0){const o=OR(t,e.bufferView),a=new C.Blob([o],{type:e.mimeType});return C.createImageBitmap(a).then(c=>{t.images[n]=c})}}function LR(e,t=0,n){const r={json:null,images:[],buffers:[]};if(new Uint32Array(e,t,1)[0]===PR){const p=new Uint32Array(e,t);let m=2;const _=(p[m++]>>2)-3,v=p[m++]>>2;if(m++,r.json=JSON.parse(RR.decode(p.subarray(m,m+v))),m+=v,m<_){const x=p[m++];m++;const w=t+(m<<2);r.buffers[0]=e.slice(w,w+x)}}else r.json=JSON.parse(RR.decode(new Uint8Array(e,t)));const{buffers:o,images:a,meshes:c,extensionsUsed:u}=r.json;let d=Promise.resolve();if(o){const p=[];for(let m=0;m<o.length;m++){const _=o[m];_.uri?p.push(c$(_,r,m,n)):r.buffers[m]||(r.buffers[m]=null)}d=Promise.all(p)}return d.then(()=>{const p=[],m=u&&u.includes(eb);if(m&&p.push(function(){if(!Ns)return Lg||(Lg=function(_){let v,x=null;function w(){v=new Uint8Array(x.buffer)}function T(){throw new Error("Unexpected Draco error.")}const S={a:{a:T,d:function(I,A,R){return v.copyWithin(I,A,A+R)},c:function(I){const A=v.length,R=Math.max(I>>>0,Math.ceil(1.2*A)),k=Math.ceil((R-A)/65536);try{return x.grow(k),w(),!0}catch{return!1}},b:T}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(_,S):_.then(I=>I.arrayBuffer()).then(I=>WebAssembly.instantiate(I,S))).then(I=>{const{Rb:A,Qb:R,P:k,T:P,X:O,Ja:j,La:G,Qa:W,Va:Z,Wa:K,eb:Q,jb:at,f:X,e:ft,yb:gt,zb:vt,Ab:ht,Bb:pt,Db:Ct,Gb:At}=I.instance.exports;x=ft;const It=(()=>{let zt=0,Ft=0,Ut=0,Pt=0;return Ht=>{Ut&&(A(Pt),A(zt),Ft+=Ut,Ut=zt=0),zt||(Ft+=128,zt=R(Ft));const he=Ht.length+7&-8;let de=zt;he>=Ft&&(Ut=he,de=Pt=R(he));for(let _e=0;_e<Ht.length;_e++)v[de+_e]=Ht[_e];return de}})();return w(),X(),{memory:ft,_free:A,_malloc:R,Mesh:class{constructor(){this.ptr=k()}destroy(){P(this.ptr)}},Decoder:class{constructor(){this.ptr=j()}destroy(){at(this.ptr)}DecodeArrayToMesh(zt,Ft,Ut){const Pt=It(zt),Ht=G(this.ptr,Pt,Ft,Ut.ptr);return!!O(Ht)}GetAttributeByUniqueId(zt,Ft){return{ptr:W(this.ptr,zt.ptr,Ft)}}GetTrianglesUInt16Array(zt,Ft,Ut){Z(this.ptr,zt.ptr,Ft,Ut)}GetTrianglesUInt32Array(zt,Ft,Ut){K(this.ptr,zt.ptr,Ft,Ut)}GetAttributeDataArrayForAllPoints(zt,Ft,Ut,Pt,Ht){Q(this.ptr,zt.ptr,Ft.ptr,Ut,Pt,Ht)}},DT_INT8:gt(),DT_UINT8:vt(),DT_INT16:ht(),DT_UINT16:pt(),DT_UINT32:Ct(),DT_FLOAT32:At()}})}(fetch(IR())),Lg.then(_=>{Ns=_,Lg=void 0}))}()),a)for(let _=0;_<a.length;_++)p.push(u$(a[_],r,_,n));return(p.length?Promise.all(p):Promise.resolve()).then(()=>{if(m&&c)for(const{primitives:_}of c)for(const v of _)l$(v,r);return r})})}function zR(e){return fetch(e).then(t=>t.arrayBuffer()).then(t=>LR(t,0,e))}class DR{constructor(t,n,r){if(this.triangleCount=n.length/3,this.min=new N(0,0),this.max=new N(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||t.length===0||r===0)return;const o=t.map(m=>m.x),a=t.map(m=>m.y);this.min=new N(Math.min(...o),Math.min(...a)),this.max=new N(Math.max(...o),Math.max(...a));const c=this.max.sub(this.min);c.x=Math.max(c.x,1),c.y=Math.max(c.y,1);const u=Math.max(c.x,c.y)/r;this.cellsX=Math.max(1,Math.ceil(c.x/u)),this.cellsY=Math.max(1,Math.ceil(c.y/u)),this.xScale=1/u,this.yScale=1/u;const d=[];for(let m=0;m<this.triangleCount;m++){const _=t[n[3*m+0]].sub(this.min),v=t[n[3*m+1]].sub(this.min),x=t[n[3*m+2]].sub(this.min),w=Dl(Math.floor(Math.min(_.x,v.x,x.x)),this.xScale,this.cellsX),T=Dl(Math.floor(Math.max(_.x,v.x,x.x)),this.xScale,this.cellsX),S=Dl(Math.floor(Math.min(_.y,v.y,x.y)),this.yScale,this.cellsY),I=Dl(Math.floor(Math.max(_.y,v.y,x.y)),this.yScale,this.cellsY),A=new N(0,0),R=new N(0,0),k=new N(0,0),P=new N(0,0);for(let O=S;O<=I;++O){A.y=R.y=O*u,k.y=P.y=(O+1)*u;for(let j=w;j<=T;++j)A.x=k.x=j*u,R.x=P.x=(j+1)*u,(s1(_,v,x,A,R,P)||s1(_,v,x,A,P,k))&&d.push({cellIdx:O*this.cellsX+j,triIdx:m})}}if(d.length===0)return;d.sort((m,_)=>m.cellIdx-_.cellIdx||m.triIdx-_.triIdx);let p=0;for(;p<d.length;){const m=d[p].cellIdx,_={start:this.payload.length,len:0};for(;p<d.length&&d[p].cellIdx===m;)++_.len,this.payload.push(d[p++].triIdx);this.cells[m]=_}}query(t,n,r){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>n.x||t.y>this.max.y||this.min.y>n.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let d=0;d<this.lookup.length;d++)this.lookup[d]=0;const o=Dl(t.x-this.min.x,this.xScale,this.cellsX),a=Dl(n.x-this.min.x,this.xScale,this.cellsX),c=Dl(t.y-this.min.y,this.yScale,this.cellsY),u=Dl(n.y-this.min.y,this.yScale,this.cellsY);for(let d=c;d<=u;d++)for(let p=o;p<=a;p++){const m=this.cells[d*this.cellsX+p];if(m)for(let _=0;_<m.len;_++){const v=this.payload[m.start+_],x=Math.floor(v/8),w=1<<v%8;if(!(this.lookup[x]&w)&&(this.lookup[x]|=w,r.push(v),r.length===this.triangleCount))return}}}}function Dl(e,t,n){return Math.max(0,Math.min(n-1,Math.floor(e*t)))}function Nc(e,t){const n=e.json.bufferViews[t.bufferView];return new J1[t.componentType](e.buffers[n.buffer],(t.byteOffset||0)+(n.byteOffset||0),t.count*tb[t.type])}function h$(e,t,n){const r=e.indices,o=e.attributes,a={};a.indexArray=new Wr;const c=t.json.accessors[r],u=c.count/3;a.indexArray.reserve(u);const d=Nc(t,c);for(let v=0;v<u;v++)a.indexArray.emplaceBack(d[3*v],d[3*v+1],d[3*v+2]);a.indexArray._trim(),a.vertexArray=new Ic;const p=t.json.accessors[o.POSITION];a.vertexArray.reserve(p.count);const m=Nc(t,p);for(let v=0;v<p.count;v++)a.vertexArray.emplaceBack(m[3*v],m[3*v+1],m[3*v+2]);if(a.vertexArray._trim(),a.aabb=new nr(p.min,p.max),a.centroid=function(v,x){const w=[0,0,0],T=v.length;if(T>0){for(let S=0;S<T;S++){const I=3*v[S];w[0]+=x[I],w[1]+=x[I+1],w[2]+=x[I+2]}w[0]/=T,w[1]/=T,w[2]/=T}return w}(d,m),o.COLOR_0!==void 0){const v=t.json.accessors[o.COLOR_0],x=tb[v.type];if(v.componentType===Q1){a.colorArray=x===3?new Ic:new ka,a.colorArray.reserve(v.count);const w=Nc(t,v);if(x===3)for(let T=0;T<v.count;T++)a.colorArray.emplaceBack(w[3*T],w[3*T+1],w[3*T+2]);else for(let T=0;T<v.count;T++)a.colorArray.emplaceBack(w[4*T],w[4*T+1],w[4*T+2],w[4*T+3]);a.colorArray._trim()}else if(v.componentType===Y1&&x===4){a.colorArray=new ka,a.colorArray.resize(v.count);const w=Nc(t,v),T=1/65535,S=a.colorArray.float32;for(let I=0;I<4*w.length;++I)S[I]=w[I]*T}else dt(`glTF color buffer parsing for accessor ${JSON.stringify(v)} is not supported`)}if(o.NORMAL!==void 0){a.normalArray=new Ic;const v=t.json.accessors[o.NORMAL];a.normalArray.reserve(v.count);const x=Nc(t,v);for(let w=0;w<v.count;w++)a.normalArray.emplaceBack(x[3*w],x[3*w+1],x[3*w+2]);a.normalArray._trim()}if(o.TEXCOORD_0!==void 0&&n.length>0){a.texcoordArray=new Xd;const v=t.json.accessors[o.TEXCOORD_0];a.texcoordArray.reserve(v.count);const x=Nc(t,v);for(let w=0;w<v.count;w++)a.texcoordArray.emplaceBack(x[2*w],x[2*w+1]);a.texcoordArray._trim()}const _=e.material;return a.material=function(v,x){const{emissiveFactor:w=[0,0,0],alphaMode:T="OPAQUE",alphaCutoff:S=.5,normalTexture:I,occlusionTexture:A,emissiveTexture:R,doubleSided:k}=v,{baseColorFactor:P=[1,1,1,1],metallicFactor:O=1,roughnessFactor:j=1,baseColorTexture:G,metallicRoughnessTexture:W}=v.pbrMetallicRoughness||{};return{pbrMetallicRoughness:{baseColorFactor:new en(...P),metallicFactor:O,roughnessFactor:j,baseColorTexture:G?x[G.index]:void 0,metallicRoughnessTexture:W?x[W.index]:void 0},doubleSided:k,emissiveFactor:w,alphaMode:T,alphaCutoff:S,normalTexture:I?x[I.index]:void 0,occlusionTexture:A?x[A.index]:void 0,emissionTexture:R?x[R.index]:void 0,defined:v.defined===void 0}}(_!==void 0?t.json.materials[_]:{defined:!1},n),o._FEATURE_RGBA4444!==void 0&&(a.featureData=new Uint32Array(Nc(t,t.json.accessors[o._FEATURE_RGBA4444]).buffer)),a}function BR(e,t,n){const{matrix:r,rotation:o,translation:a,scale:c,mesh:u,extras:d,children:p}=e,m={};if(m.matrix=r||wt.fromRotationTranslationScale([],o||[0,0,0,1],a||[0,0,0],c||[1,1,1]),u!==void 0){m.meshes=n[u];const _=m.anchor=[0,0];for(const v of m.meshes){const{min:x,max:w}=v.aabb;_[0]+=x[0]+w[0],_[1]+=x[1]+w[1]}_[0]=Math.floor(_[0]/m.meshes.length/2),_[1]=Math.floor(_[1]/m.meshes.length/2)}if(d&&(d.id&&(m.id=d.id),d.lights&&(m.lights=function(_){if(!_.length)return[];const v=function(I){const A=atob(I),R=new Uint8Array(A.length);for(let k=0;k<A.length;k++)R[k]=A.codePointAt(k);return R}(_),x=[],w=v.length/24,T=new Uint16Array(v.buffer),S=new Float32Array(v.buffer);for(let I=0;I<w;I++){const A=T[2*I*6]/30,R=T[2*I*6+1]/30,k=T[2*I*6+10]/100,P=S[6*I+1],O=S[6*I+2],j=S[6*I+3],G=S[6*I+4],W=j-P,Z=G-O,K=Math.hypot(W,Z);x.push({pos:[P+.5*W,O+.5*Z,R],normal:[Z/K,-W/K,0],width:K,height:A,depth:k,points:[P,O,j,G]})}return x}(d.lights))),p){const _=[];for(const v of p)_.push(BR(t.json.nodes[v],t,n));m.children=_}return m}function d$(e){if(e.vertices.length===0||e.indices.length===0)return null;const[t,n]=[e.vertices[0].clone(),e.vertices[0].clone()];for(let c=1;c<e.vertices.length;++c){const u=e.vertices[c];t.x=Math.min(t.x,u.x),t.y=Math.min(t.y,u.y),n.x=Math.max(n.x,u.x),n.y=Math.max(n.y,u.y)}const r=Math.ceil(Math.max(n.x-t.x,n.y-t.y)/256),o=Math.max(8,r),a=new DR(e.vertices,e.indices,o);return{vertices:e.vertices,indices:e.indices,grid:a,min:t,max:n}}function f$(e){if(!e.extras||!e.extras.ground)return null;const t=e.extras.ground;if(!t||!Array.isArray(t)||t.length===0)return null;const n=t[0];if(!n||!Array.isArray(n)||n.length===0)return null;const r=[];for(const c of n){if(!Array.isArray(c)||c.length!==2)continue;const u=c[0],d=c[1];typeof u=="number"&&typeof d=="number"&&r.push(new N(u,d))}if(r.length<3)return null;r.length>1&&r[r.length-1].equals(r[0])&&r.pop();let o=0;for(let c=0;c<r.length;c++){const u=r[c],d=r[(c+1)%r.length],p=r[(c+2)%r.length];o+=(u.x-d.x)*(p.y-d.y)-(p.x-d.x)*(u.y-d.y)}o>0&&r.reverse();const a=Xm(r.flatMap(c=>[c.x,c.y]),[]);return a.length===0?null:{vertices:r,indices:a}}function p$(e){const t=[],n=[];let r=0;for(const o of e){r=t.length;const a=o.vertexArray.float32,c=o.indexArray.uint16;for(let u=0;u<o.vertexArray.length;u++)t.push(new N(a[3*u+0],a[3*u+1]));for(let u=0;u<3*o.indexArray.length;u++)n.push(c[u]+r)}if(n.length%3!=0)return null;for(let o=0;o<n.length;o+=3){const a=t[n[o+0]],c=t[n[o+1]],u=t[n[o+2]];(a.x-c.x)*(u.y-c.y)-(u.x-c.x)*(a.y-c.y)>0&&([n[o+1],n[o+2]]=[n[o+2],n[o+1]])}return{vertices:t,indices:n}}function nb(e){const t=function(d,p){const m=[],_=C.WebGL2RenderingContext;if(d.json.textures)for(const v of d.json.textures){const x={magFilter:_.LINEAR,minFilter:_.NEAREST,wrapS:_.REPEAT,wrapT:_.REPEAT};v.sampler!==void 0&&Object.assign(x,d.json.samplers[v.sampler]),m.push({image:p[v.source],sampler:x,uploaded:!1})}return m}(e,e.images),n=function(d,p){const m=[];for(const _ of d.json.meshes){const v=[];for(const x of _.primitives)v.push(h$(x,d,p));m.push(v)}return m}(e,t),{scenes:r,scene:o,nodes:a}=e.json,c=r?r[o||0].nodes:a,u=[];for(const d of c)u.push(BR(a[d],e,n));return function(d,p,m){const _={},v=new Set;for(let x=0;x<d.length;x++){const w=m[p[x]];if(!w.extras)continue;const T=w.extras["mapbox:footprint:version"],S=w.extras["mapbox:footprint:id"];(T||S)&&v.add(x),T==="1.0.0"&&S&&(_[S]=x)}for(let x=0;x<d.length;x++){if(v.has(x))continue;const w=d[x],T=m[p[x]];if(!T.extras)continue;let S=null;w.id in _&&(S=p$(d[_[w.id]].meshes)),S||(S=f$(T)),S&&(w.footprint=d$(S))}if(v.size>0){const x=Array.from(v.values()).sort((w,T)=>w-T);for(let w=x.length-1;w>=0;w--)d.splice(x[w],1)}}(u,c,e.json.nodes),u}function m$(e){e.heightmap=new Float32Array(4096),e.heightmap.fill(-1);const t=e.vertexArray.float32,n=e.aabb.min[0]-1,r=e.aabb.min[1]-1,o=zc/(e.aabb.max[0]-n+2),a=zc/(e.aabb.max[1]-r+2);for(let c=0;c<t.length;c+=3){const u=t[c+2],d=(t[c+0]-n)*o|0,p=(t[c+1]-r)*a|0;u>e.heightmap[p*zc+d]&&(e.heightmap[p*zc+d]=u)}}function g$(e,t){const n={};n.indexArray=new Wr,n.indexArray.reserve(4*e.length),n.vertexArray=new Ic,n.vertexArray.reserve(10*e.length),n.colorArray=new ka,n.vertexArray.reserve(10*e.length);let r=0;for(const c of e){const u=Math.min(10,Math.max(4,1.3*c.height))*t,d=[-c.normal[1],c.normal[0],0],p=Math.min(.29,.1*c.width/c.depth),m=c.width-2*c.depth*t*(p+.01),_=ot.scaleAndAdd([],c.pos,d,m/2),v=ot.scaleAndAdd([],c.pos,d,-m/2),x=[_[0],_[1],_[2]+c.height],w=[v[0],v[1],v[2]+c.height],T=ot.scaleAndAdd([],c.normal,d,p);ot.scale(T,T,u);const S=ot.scaleAndAdd([],c.normal,d,-p);ot.scale(S,S,u),ot.add(T,_,T),ot.add(S,v,S),_[2]+=.1,v[2]+=.1,n.vertexArray.emplaceBack(T[0],T[1],T[2]),n.vertexArray.emplaceBack(S[0],S[1],S[2]),n.vertexArray.emplaceBack(_[0],_[1],_[2]),n.vertexArray.emplaceBack(v[0],v[1],v[2]),n.vertexArray.emplaceBack(x[0],x[1],x[2]),n.vertexArray.emplaceBack(w[0],w[1],w[2]),n.vertexArray.emplaceBack(_[0],_[1],_[2]),n.vertexArray.emplaceBack(v[0],v[1],v[2]),n.vertexArray.emplaceBack(T[0],T[1],T[2]),n.vertexArray.emplaceBack(S[0],S[1],S[2]);const I=m/u/2;n.colorArray.emplaceBack(-I-p,-1,I,.8),n.colorArray.emplaceBack(I+p,-1,I,.8),n.colorArray.emplaceBack(-I,0,I,1.3),n.colorArray.emplaceBack(I,0,I,1.3),n.colorArray.emplaceBack(I+p,-.8,I,.7),n.colorArray.emplaceBack(I+p,-.8,I,.7),n.colorArray.emplaceBack(0,0,I,1.3),n.colorArray.emplaceBack(0,0,I,1.3),n.colorArray.emplaceBack(I+p,-1.2,I,.8),n.colorArray.emplaceBack(I+p,-1.2,I,.8),n.indexArray.emplaceBack(6+r,4+r,8+r),n.indexArray.emplaceBack(7+r,9+r,5+r),n.indexArray.emplaceBack(0+r,1+r,2+r),n.indexArray.emplaceBack(1+r,3+r,2+r),r+=10}const o={defined:!0,emissiveFactor:[0,0,0]},a={};return a.baseColorFactor=en.white,o.pbrMetallicRoughness=a,n.material=o,n.aabb=new nr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),n}Te(DR,"TriangleGridIndex");const rb={vector:MR,raster:H1,"raster-dem":class extends H1{constructor(e,t,n,r){super(e,t,n,r),this.type="raster-dem",this.maxzoom=22,this._options=Ot({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(e,t){const n=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function r(o,a){o&&(e.state="errored",t(o)),a&&(e.dem=a,e.dem.onDeserialize(),e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0,e.state="loaded",t(null))}e.request=Qe(this.map._requestManager.transformRequest(n,Dt.Tile),(function(o,a,c,u){if(delete e.request,e.aborted)e.state="unloaded",t(null);else if(o)e.state="errored",t(o);else if(a){this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:c,expires:u});const p=C.ImageBitmap&&a instanceof C.ImageBitmap&&Ks(),m=1-(a.width-((d=a.width)<=1?1:Math.pow(2,Math.floor(Math.log(d)/Math.LN2))))/2;m<1||e.neighboringTiles||(e.neighboringTiles=this._getNeighboringTiles(e.tileID));const _=p?a:Ve.getImageData(a,m),v={uid:e.uid,coord:e.tileID,source:this.id,scope:this.scope,rawImageData:_,encoding:this.encoding,padding:m};e.actor&&e.state!=="expired"||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",v,r.bind(this),void 0,!0))}var d}).bind(this))}_getNeighboringTiles(e){const t=e.canonical,n=Math.pow(2,t.z),r=(t.x-1+n)%n,o=t.x===0?e.wrap-1:e.wrap,a=(t.x+1+n)%n,c=t.x+1===n?e.wrap+1:e.wrap,u={};return u[new Pn(e.overscaledZ,o,t.z,r,t.y).key]={backfilled:!1},u[new Pn(e.overscaledZ,c,t.z,a,t.y).key]={backfilled:!1},t.y>0&&(u[new Pn(e.overscaledZ,o,t.z,r,t.y-1).key]={backfilled:!1},u[new Pn(e.overscaledZ,e.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},u[new Pn(e.overscaledZ,c,t.z,a,t.y-1).key]={backfilled:!1}),t.y+1<n&&(u[new Pn(e.overscaledZ,o,t.z,r,t.y+1).key]={backfilled:!1},u[new Pn(e.overscaledZ,e.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},u[new Pn(e.overscaledZ,c,t.z,a,t.y+1).key]={backfilled:!1}),u}},geojson:class extends En{constructor(e,t,n,r){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=n.getActor(),this.setEventedParent(r),this._data=t.data,this._options=Ot({},t),this._collectResourceTiming=t.collectResourceTiming,t.maxzoom!==void 0&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const o=Rt/this.tileSize;this.workerOptions=Ot({source:this.id,scope:this.scope,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(t.buffer!==void 0?t.buffer:128)*o,tolerance:(t.tolerance!==void 0?t.tolerance:.375)*o,extent:Rt,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:t.clusterMaxZoom!==void 0?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:Rt,radius:(t.clusterRadius!==void 0?t.clusterRadius:50)*o,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions)}onAdd(e){this.map=e,this.setData(this._data)}setData(e){return this._data=e,this._updateWorkerData(),this}getClusterExpansionZoom(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id,scope:this.scope},t),this}getClusterChildren(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id,scope:this.scope},t),this}getClusterLeaves(e,t,n,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:e,limit:t,offset:n},r),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new Nt("dataloading",{dataType:"source"})),this._loaded=!1;const e=Ot({},this.workerOptions);e.scope=this.scope;const t=this._data;typeof t=="string"?(e.request=this.map._requestManager.transformRequest(Ve.resolveURL(t),Dt.Source),e.request.collectResourceTiming=this._collectResourceTiming):e.data=JSON.stringify(t),this._pendingLoad=this.actor.send(`${this.type}.loadData`,e,(n,r)=>{if(this._loaded=!0,this._pendingLoad=null,n)this.fire(new ve(n));else{const o={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&r&&r.resourceTiming&&r.resourceTiming[this.id]&&(o.resourceTiming=r.resourceTiming[this.id]),this.fire(new Nt("data",o)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(e,t){const n=e.actor?"reloadTile":"loadTile";e.actor=this.actor;const r={type:this.type,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:Ve.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};e.request=this.actor.send(n,r,(o,a)=>(delete e.request,e.destroy(),e.aborted?t(null):o?t(o):(e.loadVectorData(a,this.map.painter,n==="reloadTile"),t(null))),void 0,n==="loadTile")}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0}unloadTile(e){this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id,scope:this.scope}),e.destroy()}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Ot({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends ms{constructor(e,t,n,r){super(e,t,n,r),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const e=this.options;this.urls=[];for(const t of e.urls)this.urls.push(this.map._requestManager.transformRequest(t,Dt.Source).url);(function(t,n){const r=C.document.createElement("video");r.muted=!0,r.onloadstart=function(){n(null,r)};for(let o=0;o<t.length;o++){const a=C.document.createElement("source");pe(t[o])||(r.crossOrigin="Anonymous"),a.src=t[o],r.appendChild(a)}})(this.urls,(t,n)=>{this._loaded=!0,t?this.fire(new ve(t)):n&&(this.video=n,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const t=this.video.seekable;e<t.start(0)||e>t.end(0)?this.fire(new ve(new se(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,t=e.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new gr(e,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(e)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:ms,model:class extends En{constructor(e,t,n,r){super(),this.id=e,this.type="model",this.models=[],this._loaded=!1,this._options=t}load(){const e=[];for(const t in this._options.models){const n=this._options.models[t],r=zR(this.map._requestManager.transformRequest(n.uri,Dt.Model).url).then(o=>{if(!o)return;const a=nb(o),c=new RP(t,n.position,n.orientation,a);c.computeBoundsAndApplyParent(),this.models.push(c)}).catch(o=>{this.fire(new ve(new Error(`Could not load model ${t} from ${n.uri}: ${o.message}`)))});e.push(r)}return Promise.allSettled(e).then(()=>{this._loaded=!0,this.fire(new Nt("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(t=>{this.fire(new ve(new Error(`Could not load models: ${t.message}`)))})}onAdd(e){this.map=e,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(e,t){}serialize(){return{type:"model"}}},"batched-model":class extends En{constructor(e,t,n,r){super(),this.type="batched-model",this.id=e,this.tileSize=512,this._options=t,this.tiles=this._options.tiles,this.maxzoom=t.maxzoom||19,this.minzoom=t.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=n,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(r)}onAdd(e){this.map=e,this.load()}load(e){this._loaded=!1,this.fire(new Nt("dataloading",{dataType:"source"}));const t=Array.isArray(this.map._language)?this.map._language.join():this.map._language,n=this.map._worldview;this._tileJSONRequest=W1(this._options,this.map._requestManager,t,n,(r,o)=>{this._tileJSONRequest=null,this._loaded=!0,r?(t&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${t}`),n&&n.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${n}`),this.fire(new ve(r))):o&&(Ot(this,o),o.bounds&&(this.tileBounds=new Og(o.bounds,this.minzoom,this.maxzoom)),mc(o.tiles,this.map._requestManager._customAccessToken),this.fire(new Nt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Nt("data",{dataType:"source",sourceDataType:"content"}))),e&&e(r)})}hasTransition(){return!1}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loaded(){return this._loaded}loadTile(e,t){const n=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),r={request:this.map._requestManager.transformRequest(n,Dt.Tile),data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:e.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(e.actor&&e.state!=="expired")if(e.state==="loading")e.reloadCallback=t;else{if(e.buckets){const a=Object.values(e.buckets);for(const c of a)c.dirty=!0;return void(e.state="loaded")}e.request=e.actor.send("reloadTile",r,o.bind(this))}else e.actor=this.dispatcher.getActor(),e.request=e.actor.send("loadTile",r,o.bind(this),void 0,!0);function o(a,c){return e.aborted?t(null):a&&a.status!==404?t(a):(c&&(c.resourceTiming&&(e.resourceTiming=c.resourceTiming),this.map._refreshExpiredTiles&&e.setExpiryData(c),e.buckets={...e.buckets,...c.buckets}),e.state="loaded",void t(null))}}serialize(){return Ot({},this._options)}},canvas:class extends ms{constructor(e,t,n,r){super(e,t,n,r),t.coordinates?Array.isArray(t.coordinates)&&t.coordinates.length===4&&!t.coordinates.some(o=>!Array.isArray(o)||o.length!==2||o.some(a=>typeof a!="number"))||this.fire(new ve(new se(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new ve(new se(`sources.${e}`,null,'missing required property "coordinates"'))),t.animate&&typeof t.animate!="boolean"&&this.fire(new ve(new se(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),t.canvas?typeof t.canvas=="string"||t.canvas instanceof C.HTMLCanvasElement||this.fire(new ve(new se(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new ve(new se(`sources.${e}`,null,'missing required property "canvas"'))),this.options=t,this.animate=t.animate===void 0||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof C.HTMLCanvasElement?this.options.canvas:C.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new ve(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const t=this.map.painter.context;this.texture?!e&&!this._playing||this.texture instanceof xg||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new gr(t,this.canvas,t.gl.RGBA,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}},custom:class extends En{constructor(e,t,n,r){super(),this.id=e,this.type="custom",this._dataType="raster",this._dispatcher=n,this._implementation=t,this.setEventedParent(r),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new ve(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new ve(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Og(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.clearTiles=this._clearTiles.bind(this),t.coveringTiles=this._coveringTiles.bind(this),Ot(this,Pe(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return Pe(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new Nt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Nt("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(e){this._map=e,this._loaded=!1,this.fire(new Nt("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(e),this.load()}onRemove(e){this._implementation.onRemove&&this._implementation.onRemove(e)}hasTile(e){if(this._implementation.hasTile){const{x:t,y:n,z:r}=e.canonical;return this._implementation.hasTile({x:t,y:n,z:r})}return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e,t){const{x:n,y:r,z:o}=e.tileID.canonical,a=new C.AbortController;e.request=Promise.resolve(this._implementation.loadTile({x:n,y:r,z:o},{signal:a.signal})).then((function(c){return delete e.request,e.aborted?(e.state="unloaded",t(null)):c===void 0?(e.state="errored",t(null)):c===null?(this.loadTileData(e,{width:this.tileSize,height:this.tileSize,data:null}),e.state="loaded",t(null)):function(u){return u instanceof C.ImageData||u instanceof C.HTMLCanvasElement||u instanceof C.ImageBitmap||u instanceof C.HTMLImageElement}(c)?(this.loadTileData(e,c),e.state="loaded",void t(null)):(e.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(c=>{c.code!==20&&(e.state="errored",t(c))}),e.request.cancel=()=>a.abort()}loadTileData(e,t){e.setTexture(t,this._map.painter)}unloadTile(e,t){if(e.texture&&e.texture instanceof gr?(e.destroy(!0),e.texture&&e.texture instanceof gr&&this._map.painter.saveTileTexture(e.texture)):e.destroy(),this._implementation.unloadTile){const{x:n,y:r,z:o}=e.tileID.canonical;this._implementation.unloadTile({x:n,y:r,z:o})}t()}abortTile(e,t){e.request&&e.request.cancel&&(e.request.cancel(),delete e.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(e=>({x:e.canonical.x,y:e.canonical.y,z:e.canonical.z}))}_clearTiles(){const e=$i(this.id,this.scope);this._map.style.clearSource(e)}_update(){this.fire(new Nt("data",{dataType:"source",sourceDataType:"content"}))}}},ib=function(e,t,n,r){const o=new rb[t.type](e,t,n,r);if(o.id!==e)throw new Error(`Expected Source id to be ${e} instead of ${o.id}`);return Ue(["load","abort","unload","serialize","prepare"],o),o};function _$(e,t){const n=wt.identity([]);return wt.scale(n,n,[.5*e.width,.5*-e.height,1]),wt.translate(n,n,[1,-1,0]),wt.multiply(n,n,e.calculateProjMatrix(t.toUnwrapped())),Float32Array.from(n)}function y$(e,t,n,r,o,a,c,u=!1){const d=e.tilesIn(r,c,u);d.sort(FR);const p=[];for(const _ of d)p.push({wrappedTileID:_.tile.tileID.wrapped().key,queryResults:_.tile.queryRenderedFeatures(t,n,e._state,_,o,a,_$(e.transform,_.tile.tileID),u)});const m=function(_){const v={},x={};for(const w of _){const T=w.queryResults,S=w.wrappedTileID,I=x[S]=x[S]||{};for(const A in T){const R=T[A],k=I[A]=I[A]||{},P=v[A]=v[A]||[];for(const O of R)k[O.featureIndex]||(k[O.featureIndex]=!0,P.push(O))}}return v}(p);for(const _ in m)m[_].forEach(v=>{const x=v.feature,w=x.layer;w&&w.type!=="background"&&w.type!=="sky"&&w.type!=="slot"&&(x.source=w.source,w["source-layer"]&&(x.sourceLayer=w["source-layer"]),x.state=x.id!==void 0?e.getFeatureState(w["source-layer"],x.id):{})});return m}function v$(e,t){const n=e.getRenderableIds().map(a=>e.getTileByID(a)),r=[],o={};for(let a=0;a<n.length;a++){const c=n[a],u=c.tileID.canonical.key;o[u]||(o[u]=!0,c.querySourceFeatures(r,t))}return r}function FR(e,t){const n=e.tileID,r=t.tileID;return n.overscaledZ-r.overscaledZ||n.canonical.y-r.canonical.y||n.wrap-r.wrap||n.canonical.x-r.canonical.x}class x${constructor(t){this.style=t}processLayersChanged(){this.layers=[];for(const t in this.style._mergedLayers){const n=this.style._mergedLayers[t];if(n.type==="fill-extrusion")this.layers.push(n);else if(n.type==="model"){const r=this.style.getLayerSource(n);r&&r.type==="batched-model"&&this.layers.push(n)}}}updateZOffset(t,n){this.currentBuildingBuckets=[];for(let o=0;o<this.layers.length;++o){const a=this.layers[o],c=this.style.getLayerSourceCache(a);let u=1;a.type==="fill-extrusion"&&(u=a.paint.get("fill-extrusion-opacity")>0?a.paint.get("fill-extrusion-vertical-scale"):0);let d=c?c.getTile(n):null;if(!d&&c&&n.canonical.z>c.getSource().minzoom){let p=n.scaledTo(Math.min(c.getSource().maxzoom,n.overscaledZ-1));for(;p.overscaledZ>=c.getSource().minzoom&&(d=c.getTile(p),!d&&p.overscaledZ!==0);)p=p.scaledTo(p.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:d?d.getBucket(a):null,tileID:d?d.tileID:n,verticalScale:u})}t.hasAnyZOffset=!1;let r=!1;for(let o=0;o<t.symbolInstances.length;o++){const a=t.symbolInstances.get(o),c=a.zOffset,u=this._getHeightAtTileOffset(n,a.tileAnchorX,a.tileAnchorY);a.zOffset=u!==-1?u:c,r||c===a.zOffset||(r=!0),t.hasAnyZOffset||a.zOffset===0||(t.hasAnyZOffset=!0)}r&&(t.zOffsetBuffersNeedUpload=!0,t.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(t,n,r,o){let a=n,c=r;if(t.canonical.z!==o.canonical.z){const u=o.canonical,d=1/(1<<t.canonical.z-u.z);a=(n+t.canonical.x*Rt)*d-u.x*Rt|0,c=(r+t.canonical.y*Rt)*d-u.y*Rt|0}return{tileX:a,tileY:c}}_getHeightAtTileOffset(t,n,r){let o;for(let a=0;a<this.layers.length;++a){if(this.layers[a].type!=="fill-extrusion")continue;const{bucket:c,tileID:u,verticalScale:d}=this.currentBuildingBuckets[a];if(!c)continue;const{tileX:p,tileY:m}=this._mapCoordToOverlappingTile(t,n,r,u),_=c.getHeightAtTileCoord(p,m);if(_&&_.height!==void 0){if(!_.hidden)return _.height*d;o=_.height}}for(let a=0;a<this.layers.length;++a){if(this.layers[a].type!=="model")continue;const{bucket:c,tileID:u}=this.currentBuildingBuckets[a];if(!c)continue;const{tileX:d,tileY:p}=this._mapCoordToOverlappingTile(t,n,r,u),m=c.getHeightAtTileCoord(d,p);if(m&&!m.hidden)return m.height===void 0&&o!==void 0?Math.min(m.maxHeight,o)*m.verticalScale:(m.height||0)*m.verticalScale}return-1}}var NR=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function b$(e,t){const n={};for(const r in e)r!=="ref"&&(n[r]=e[r]);return NR.forEach(r=>{r in t&&(n[r]=t[r])}),n}function jR(e){e=e.slice();const t=Object.create(null);for(let n=0;n<e.length;n++)t[e[n].id]=e[n];for(let n=0;n<e.length;n++)"ref"in e[n]&&(e[n]=b$(e[n],t[e[n].ref]));return e}const On={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",setImportUrl:"setImportUrl",setImportData:"setImportData",setImportConfig:"setImportConfig"};function UR(e,t,n){n.push({command:On.addSource,args:[e,t[e]]})}function $R(e,t,n){t.push({command:On.removeSource,args:[e]}),n[e]=!0}function w$(e,t,n,r){$R(e,n,r),UR(e,t,n)}function T$(e,t,n){let r;for(r in e[n])if(e[n].hasOwnProperty(r)&&r!=="data"&&!et(e[n][r],t[n][r]))return!1;for(r in t[n])if(t[n].hasOwnProperty(r)&&r!=="data"&&!et(e[n][r],t[n][r]))return!1;return!0}function zg(e,t,n,r,o,a){let c;for(c in t=t||{},e=e||{})e.hasOwnProperty(c)&&(et(e[c],t[c])||n.push({command:a,args:[r,c,t[c],o]}));for(c in t)t.hasOwnProperty(c)&&!e.hasOwnProperty(c)&&(et(e[c],t[c])||n.push({command:a,args:[r,c,t[c],o]}))}function Dg(e){return e.id}function Bg(e,t){return e[t.id]=t,e}class S${constructor(t,n){this.reset(t,n)}reset(t,n){this.points=t||[],this._distances=[0];for(let r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(n||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=jt(t,0,1);let n=1,r=this._distances[n];const o=t*this.paddedLength+this.padding;for(;r<o&&n<this._distances.length;)r=this._distances[++n];const a=n-1,c=this._distances[a],u=r-c,d=u>0?(o-c)/u:0;return this.points[a].mult(1-d).add(this.points[n].mult(d))}}class VR{constructor(t,n,r){const o=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(t/r),this.yCellCount=Math.ceil(n/r);for(let c=0;c<this.xCellCount*this.yCellCount;c++)o.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=n,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,n,r,o,a){this._forEachCell(n,r,o,a,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(o),this.bboxes.push(a)}insertCircle(t,n,r,o){this._forEachCell(n-o,r-o,n+o,r+o,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(n),this.circles.push(r),this.circles.push(o)}_insertBoxCell(t,n,r,o,a,c){this.boxCells[a].push(c)}_insertCircleCell(t,n,r,o,a,c){this.circleCells[a].push(c)}_query(t,n,r,o,a,c){if(r<0||t>this.width||o<0||n>this.height)return!a&&[];const u=[];if(t<=0&&n<=0&&this.width<=r&&this.height<=o){if(a)return!0;for(let d=0;d<this.boxKeys.length;d++)u.push({key:this.boxKeys[d],x1:this.bboxes[4*d],y1:this.bboxes[4*d+1],x2:this.bboxes[4*d+2],y2:this.bboxes[4*d+3]});for(let d=0;d<this.circleKeys.length;d++){const p=this.circles[3*d],m=this.circles[3*d+1],_=this.circles[3*d+2];u.push({key:this.circleKeys[d],x1:p-_,y1:m-_,x2:p+_,y2:m+_})}return c?u.filter(c):u}return this._forEachCell(t,n,r,o,this._queryCell,u,{hitTest:a,seenUids:{box:{},circle:{}}},c),a?u.length>0:u}_queryCircle(t,n,r,o,a){const c=t-r,u=t+r,d=n-r,p=n+r;if(u<0||c>this.width||p<0||d>this.height)return!o&&[];const m=[];return this._forEachCell(c,d,u,p,this._queryCellCircle,m,{hitTest:o,circle:{x:t,y:n,radius:r},seenUids:{box:{},circle:{}}},a),o?m.length>0:m}query(t,n,r,o,a){return this._query(t,n,r,o,!1,a)}hitTest(t,n,r,o,a){return this._query(t,n,r,o,!0,a)}hitTestCircle(t,n,r,o){return this._queryCircle(t,n,r,!0,o)}_queryCell(t,n,r,o,a,c,u,d){const p=u.seenUids,m=this.boxCells[a];if(m!==null){const v=this.bboxes;for(const x of m)if(!p.box[x]){p.box[x]=!0;const w=4*x;if(t<=v[w+2]&&n<=v[w+3]&&r>=v[w+0]&&o>=v[w+1]&&(!d||d(this.boxKeys[x]))){if(u.hitTest)return c.push(!0),!0;c.push({key:this.boxKeys[x],x1:v[w],y1:v[w+1],x2:v[w+2],y2:v[w+3]})}}}const _=this.circleCells[a];if(_!==null){const v=this.circles;for(const x of _)if(!p.circle[x]){p.circle[x]=!0;const w=3*x;if(this._circleAndRectCollide(v[w],v[w+1],v[w+2],t,n,r,o)&&(!d||d(this.circleKeys[x]))){if(u.hitTest)return c.push(!0),!0;{const T=v[w],S=v[w+1],I=v[w+2];c.push({key:this.circleKeys[x],x1:T-I,y1:S-I,x2:T+I,y2:S+I})}}}}}_queryCellCircle(t,n,r,o,a,c,u,d){const p=u.circle,m=u.seenUids,_=this.boxCells[a];if(_!==null){const x=this.bboxes;for(const w of _)if(!m.box[w]){m.box[w]=!0;const T=4*w;if(this._circleAndRectCollide(p.x,p.y,p.radius,x[T+0],x[T+1],x[T+2],x[T+3])&&(!d||d(this.boxKeys[w])))return c.push(!0),!0}}const v=this.circleCells[a];if(v!==null){const x=this.circles;for(const w of v)if(!m.circle[w]){m.circle[w]=!0;const T=3*w;if(this._circlesCollide(x[T],x[T+1],x[T+2],p.x,p.y,p.radius)&&(!d||d(this.circleKeys[w])))return c.push(!0),!0}}}_forEachCell(t,n,r,o,a,c,u,d){const p=this._convertToXCellCoord(t),m=this._convertToYCellCoord(n),_=this._convertToXCellCoord(r),v=this._convertToYCellCoord(o);for(let x=p;x<=_;x++)for(let w=m;w<=v;w++)if(a.call(this,t,n,r,o,this.xCellCount*w+x,c,u,d))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,n,r,o,a,c){const u=o-t,d=a-n,p=r+c;return p*p>u*u+d*d}_circleAndRectCollide(t,n,r,o,a,c,u){const d=(c-o)/2,p=Math.abs(t-(o+d));if(p>d+r)return!1;const m=(u-a)/2,_=Math.abs(n-(a+m));if(_>m+r)return!1;if(p<=d||_<=m)return!0;const v=p-d,x=_-m;return v*v+x*x<=r*r}}const ca=100;class E${constructor(t,n,r=new VR(t.width+200,t.height+200,25),o=new VR(t.width+200,t.height+200,25)){this.transform=t,this.grid=r,this.ignoredGrid=o,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+ca,this.screenBottomBoundary=t.height+ca,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=n}placeCollisionBox(t,n,r,o,a,c,u,d){let p=r.projectedAnchorX,m=r.projectedAnchorY,_=r.projectedAnchorZ;const v=r.elevation,x=r.tileID,w=t.getProjection();if(v&&x){const[O,j,G]=w.upVector(x.canonical,r.tileAnchorX,r.tileAnchorY),W=w.upVectorScale(x.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;p+=O*v*W,m+=j*v*W,_+=G*v*W}const T=this.projectAndGetPerspectiveRatio(u,p,m,_,r.tileID,w.name==="globe"||!!v||this.transform.pitch>0,w),S=c*T.perspectiveRatio,I=(r.x1*n+o.x-r.padding)*S+T.point.x,A=(r.y1*n+o.y-r.padding)*S+T.point.y,R=(r.x2*n+o.x+r.padding)*S+T.point.x,k=(r.y2*n+o.y+r.padding)*S+T.point.y,P=T.perspectiveRatio<=.55||T.occluded;return!this.isInsideGrid(I,A,R,k)||!a&&this.grid.hitTest(I,A,R,k,d)||P?{box:[],offscreen:!1,occluded:T.occluded}:{box:[I,A,R,k],offscreen:this.isOffscreen(I,A,R,k),occluded:!1}}placeCollisionCircles(t,n,r,o,a,c,u,d,p,m,_,v,x,w,T){const S=[],I=this.transform.elevation,A=t.getProjection(),R=I?I.getAtTileOffsetFunc(T,this.transform.center.lat,this.transform.worldSize,A):null,k=new N(r.tileAnchorX,r.tileAnchorY);let{x:P,y:O,z:j}=A.projectTilePoint(k.x,k.y,T.canonical);if(R){const[vt,ht,pt]=R(k);P+=vt,O+=ht,j+=pt}const G=A.name==="globe",W=this.projectAndGetPerspectiveRatio(u,P,O,j,T,G||!!I||this.transform.pitch>0,A),{perspectiveRatio:Z}=W,K=(_?c/Z:c*Z)/pi,Q=Fs(P,O,j,d),at=W.signedDistanceFromCamera>0?bP(K,a,r.lineOffsetX*K,r.lineOffsetY*K,!1,Q,k,r,o,d,{},I&&!_?R:null,_&&!!I,A,T,_):null;let X=!1,ft=!1,gt=!0;if(at&&!W.occluded){const vt=.5*x*Z+w,ht=new N(-100,-100),pt=new N(this.screenRightBoundary,this.screenBottomBoundary),Ct=new S$,{first:At,last:It}=at,zt=At.path.length;let Ft=[];for(let Ht=zt-1;Ht>=1;Ht--)Ft.push(At.path[Ht]);for(let Ht=1;Ht<It.path.length;Ht++)Ft.push(It.path[Ht]);const Ut=2.5*vt;p&&(Ft=Ft.map(([Ht,he,de],_e)=>(R&&!G&&(de=R(_e<zt-1?At.tilePath[zt-1-_e]:It.tilePath[_e-zt+2])[2]),Fs(Ht,he,de,p))),Ft.some(Ht=>Ht[3]<=0)&&(Ft=[]));let Pt=[];if(Ft.length>0){let Ht=1/0,he=-1/0,de=1/0,_e=-1/0;for(const xe of Ft)Ht=Math.min(Ht,xe[0]),de=Math.min(de,xe[1]),he=Math.max(he,xe[0]),_e=Math.max(_e,xe[1]);he>=ht.x&&Ht<=pt.x&&_e>=ht.y&&de<=pt.y&&(Pt=[Ft.map(xe=>new N(xe[0],xe[1]))],(Ht<ht.x||he>pt.x||de<ht.y||_e>pt.y)&&(Pt=GA(Pt,ht.x,ht.y,pt.x,pt.y)))}for(const Ht of Pt){Ct.reset(Ht,.25*vt);let he=0;he=Ct.length<=.5*vt?1:Math.ceil(Ct.paddedLength/Ut)+1;for(let de=0;de<he;de++){const _e=de/Math.max(he-1,1),xe=Ct.lerp(_e),He=xe.x+ca,Ae=xe.y+ca;S.push(He,Ae,vt,0);const Sn=He-vt,pn=Ae-vt,Ze=He+vt,We=Ae+vt;if(gt=gt&&this.isOffscreen(Sn,pn,Ze,We),ft=ft||this.isInsideGrid(Sn,pn,Ze,We),!n&&this.grid.hitTestCircle(He,Ae,vt,v)&&(X=!0,!m))return{circles:[],offscreen:!1,collisionDetected:X,occluded:!1}}}}return{circles:!m&&X||!ft?[]:S,offscreen:gt,collisionDetected:X,occluded:W.occluded}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const n=[];let r=1/0,o=1/0,a=-1/0,c=-1/0;for(const m of t){const _=new N(m.x+ca,m.y+ca);r=Math.min(r,_.x),o=Math.min(o,_.y),a=Math.max(a,_.x),c=Math.max(c,_.y),n.push(_)}const u=this.grid.query(r,o,a,c).concat(this.ignoredGrid.query(r,o,a,c)),d={},p={};for(const m of u){const _=m.key;d[_.bucketInstanceId]===void 0&&(d[_.bucketInstanceId]={}),d[_.bucketInstanceId][_.featureIndex]||ZI(n,[new N(m.x1,m.y1),new N(m.x2,m.y1),new N(m.x2,m.y2),new N(m.x1,m.y2)])&&(d[_.bucketInstanceId][_.featureIndex]=!0,p[_.bucketInstanceId]===void 0&&(p[_.bucketInstanceId]=[]),p[_.bucketInstanceId].push(_.featureIndex))}return p}insertCollisionBox(t,n,r,o,a){(n?this.ignoredGrid:this.grid).insert({bucketInstanceId:r,featureIndex:o,collisionGroupID:a},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,n,r,o,a){const c=n?this.ignoredGrid:this.grid,u={bucketInstanceId:r,featureIndex:o,collisionGroupID:a};for(let d=0;d<t.length;d+=4)c.insertCircle(u,t[d],t[d+1],t[d+2])}projectAndGetPerspectiveRatio(t,n,r,o,a,c,u){const d=[n,r,o,1];let p=!1;o||this.transform.pitch>0?(Wn.transformMat4(d,d,t),this.fogState&&a&&u.name!=="globe"&&(p=function(v,x,w,T,S,I){const A=I.calculateFogTileMatrix(S),R=[x,w,T];return ot.transformMat4(R,R,A),kg(v,ot.length(R),I.pitch,I._fov)}(this.fogState,n,r,o,a.toUnwrapped(),this.transform)>.9)):CP(d,d,t);const m=d[3];return{point:new N((d[0]/m+1)/2*this.transform.width+ca,(-d[1]/m+1)/2*this.transform.height+ca),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(u)/m*.5,1.5),signedDistanceFromCamera:m,occluded:c&&d[2]>m||p}}isOffscreen(t,n,r,o){return r<ca||t>=this.screenRightBoundary||o<ca||n>this.screenBottomBoundary}isInsideGrid(t,n,r,o){return r>=0&&t<this.gridRightBoundary&&o>=0&&n<this.gridBottomBoundary}getViewportMatrix(){const t=wt.identity([]);return wt.translate(t,t,[-100,-100,0]),t}}function ob(e,t,n){const r=t.createTileMatrix(e,e.worldSize,n.toUnwrapped());return wt.multiply(new Float32Array(16),e.projMatrix,r)}function C$(e,t,n){if(t.projection.name===n.projection.name)return e.projMatrix;const r=n.clone();return r.setProjection(t.projection),ob(r,t.getProjection(),e)}function sb(e,t,n){return t.name===n.projection.name?e.projMatrix:ob(n,t,e)}class GR{constructor(t,n,r,o){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?n:-n))):o&&r?1:0,this.placed=r}isHidden(){return this.opacity===0&&!this.placed}}class Af{constructor(t,n,r,o,a,c=!1){this.text=new GR(t?t.text:null,n,r,a),this.icon=new GR(t?t.icon:null,n,o,a),this.clipped=c}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ab{constructor(t,n,r,o=!1){this.text=t,this.icon=n,this.skipFade=r,this.clipped=o}}class M${constructor(){this.invProjMatrix=wt.create(),this.viewportMatrix=wt.create(),this.circles=[]}}class I${constructor(t,n,r,o,a){this.bucketInstanceId=t,this.featureIndex=n,this.sourceLayerIndex=r,this.bucketIndex=o,this.tileID=a}}class A${constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const n=++this.maxGroupID;this.collisionGroups[t]={ID:n,predicate:r=>r.collisionGroupID===n}}return this.collisionGroups[t]}}function WR(e,t,n,r,o){const{horizontalAlign:a,verticalAlign:c}=og(e),u=-(a-.5)*t,d=-(c-.5)*n,p=S1(e,r);return new N(u+p[0]*o,d+p[1]*o)}function lb(e,t,n,r,o){const a=new N(e,t);return n&&a._rotate(r?o:-o),a}class P${constructor(t,n,r,o,a,c){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new E$(this.transform,a),this.buildingIndex=c,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new A$(r),this.collisionCircleArrays={},this.prevPlacement=o,o&&(o.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,n,r,o){const a=r.getBucket(n),c=r.latestFeatureIndex;if(!a||!c||n.fqid!==a.layerIds[0])return;const u=a.layers[0].layout,d=r.collisionBoxArray,p=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),m=r.tileSize/Rt,_=r.tileID.toUnwrapped();this.transform.setProjection(a.projection);const v=(x=r.tileID,w=a.getProjection(),T=this.transform,w.name===this.projection?T.calculateProjMatrix(x.toUnwrapped()):ob(T,w,x));var x,w,T;const S=u.get("text-pitch-alignment")==="map",I=u.get("text-rotation-alignment")==="map";n.compileFilter();const A=n.dynamicFilter(),R=n.dynamicFilterNeedsFeature(),k=this.transform.calculatePixelsToTileUnitsMatrix(r),P=yP(v,r.tileID.canonical,S,I,this.transform,a.getProjection(),k);let O=null;if(S){const W=vP(v,r.tileID.canonical,S,I,this.transform,a.getProjection(),k);O=wt.multiply([],this.transform.labelPlaneMatrix,W)}let j=null;A&&r.latestFeatureIndex&&(j={unwrappedTileID:_,dynamicFilter:A,dynamicFilterNeedsFeature:R,featureIndex:r.latestFeatureIndex}),this.retainedQueryData[a.bucketInstanceId]=new I$(a.bucketInstanceId,c,a.sourceLayerIndex,a.index,r.tileID);const G={bucket:a,layout:u,posMatrix:v,textLabelPlaneMatrix:P,labelToScreenMatrix:O,clippingData:j,scale:p,textPixelRatio:m,holdingForFade:r.holdingForFade(),collisionBoxArray:d,partiallyEvaluatedTextSize:oa(a.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:oa(a.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(o)for(const W of a.sortKeyRanges){const{sortKey:Z,symbolInstanceStart:K,symbolInstanceEnd:Q}=W;t.push({sortKey:Z,symbolInstanceStart:K,symbolInstanceEnd:Q,parameters:G})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:G})}attemptAnchorPlacement(t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S,I,A){const{textOffset0:R,textOffset1:k,crossTileID:P}=v,O=[R,k],j=WR(t,r,o,O,a),G=this.collisionIndex.placeCollisionBox(w,a,n,lb(j.x,j.y,c,u,this.transform.angle),_,d,p,m.predicate);if(S){const W=w.getSymbolInstanceIconSize(A,this.transform.zoom,v.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(w,W,S,lb(j.x,j.y,c,u,this.transform.angle),_,d,p,m.predicate).box.length===0)return}if(G.box.length>0){let W;return this.prevPlacement&&this.prevPlacement.variableOffsets[P]&&this.prevPlacement.placements[P]&&this.prevPlacement.placements[P].text&&(W=this.prevPlacement.variableOffsets[P].anchor),this.variableOffsets[P]={textOffset:O,width:r,height:o,anchor:t,textScale:a,prevAnchor:W},this.markUsedJustification(w,t,v,T),w.allowVerticalPlacement&&(this.markUsedOrientation(w,T,v),this.placedOrientations[P]=T),{shift:j,placedGlyphBoxes:G}}}placeLayerBucketPart(t,n,r,o){const{bucket:a,layout:c,posMatrix:u,textLabelPlaneMatrix:d,labelToScreenMatrix:p,clippingData:m,textPixelRatio:_,holdingForFade:v,collisionBoxArray:x,partiallyEvaluatedTextSize:w,partiallyEvaluatedIconSize:T,collisionGroup:S}=t.parameters,I=c.get("text-optional"),A=c.get("icon-optional"),R=c.get("text-allow-overlap"),k=c.get("icon-allow-overlap"),P=c.get("text-rotation-alignment")==="map",O=c.get("text-pitch-alignment")==="map",j=c.get("symbol-z-order")==="viewport-y",G=c.get("symbol-z-elevate");this.transform.setProjection(a.projection);let W=R&&(k||!a.hasIconData()||A),Z=k&&(R||!a.hasTextData()||I);!a.collisionArrays&&x&&a.deserializeCollisionBoxes(x),r&&o&&a.updateCollisionDebugBuffers(this.transform.zoom,x);const K=(Q,at,X)=>{const{crossTileID:ft,numVerticalGlyphVertices:gt}=Q;if(m){const Ze={zoom:this.transform.zoom,pitch:this.transform.pitch};let We=null;if(m.dynamicFilterNeedsFeature){const ze=this.retainedQueryData[a.bucketInstanceId];We=m.featureIndex.loadFeature({featureIndex:Q.featureIndex,bucketIndex:ze.bucketIndex,sourceLayerIndex:ze.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,m.dynamicFilter)(Ze,We,this.retainedQueryData[a.bucketInstanceId].tileID.canonical,new N(Q.tileAnchorX,Q.tileAnchorY),this.transform.calculateDistanceTileData(m.unwrappedTileID)))return this.placements[ft]=new ab(!1,!1,!1,!0),void n.add(ft)}if(n.has(ft))return;if(v)return void(this.placements[ft]=new ab(!1,!1,!1));let vt=!1,ht=!1,pt=!0,Ct=!1,At=!1,It=null,zt={box:null,offscreen:null,occluded:null},Ft={box:null,offscreen:null,occluded:null},Ut=null,Pt=null,Ht=null,he=0,de=0,_e=0;X.textFeatureIndex?he=X.textFeatureIndex:Q.useRuntimeCollisionCircles&&(he=Q.featureIndex),X.verticalTextFeatureIndex&&(de=X.verticalTextFeatureIndex);const xe=Ze=>{Ze.tileID=this.retainedQueryData[a.bucketInstanceId].tileID;const We=this.transform.elevation;Ze.elevation=Q.zOffset+(We?We.getAtTileOffset(Ze.tileID,Ze.tileAnchorX,Ze.tileAnchorY):0)},He=X.textBox;if(He){xe(He);const Ze=ze=>{let yn=ur.horizontal;if(a.allowVerticalPlacement&&!ze&&this.prevPlacement){const wn=this.prevPlacement.placedOrientations[ft];wn&&(this.placedOrientations[ft]=wn,yn=wn,this.markUsedOrientation(a,yn,Q))}return yn},We=(ze,yn)=>{if(a.allowVerticalPlacement&&gt>0&&X.verticalTextBox){for(const wn of a.writingModes)if(wn===ur.vertical?(zt=yn(),Ft=zt):zt=ze(),zt&&zt.box&&zt.box.length)break}else zt=ze()};if(c.get("text-variable-anchor")){let ze=c.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ft]){const sn=this.prevPlacement.variableOffsets[ft];ze.indexOf(sn.anchor)>0&&(ze=ze.filter(Zn=>Zn!==sn.anchor),ze.unshift(sn.anchor))}const yn=(sn,Zn,Lr)=>{const qn=a.getSymbolInstanceTextSize(w,Q,this.transform.zoom,at),rr=(sn.x2-sn.x1)*qn+2*sn.padding,Dr=(sn.y2-sn.y1)*qn+2*sn.padding,zr=Q.hasIconTextFit&&!k?Zn:null;zr&&xe(zr);let sr={box:[],offscreen:!1,occluded:!1};const jn=R?2*ze.length:ze.length;for(let bi=0;bi<jn;++bi){const ha=this.attemptAnchorPlacement(ze[bi%ze.length],sn,rr,Dr,qn,P,O,_,u,S,bi>=ze.length,Q,at,a,Lr,zr,w,T);if(ha&&(sr=ha.placedGlyphBoxes,sr&&sr.box&&sr.box.length)){vt=!0,It=ha.shift;break}}return sr};We(()=>yn(He,X.iconBox,ur.horizontal),()=>{const sn=X.verticalTextBox;return sn&&xe(sn),a.allowVerticalPlacement&&!(zt&&zt.box&&zt.box.length)&&gt>0&&sn?yn(sn,X.verticalIconBox,ur.vertical):{box:null,offscreen:null,occluded:null}}),zt&&(vt=zt.box,pt=zt.offscreen,Ct=zt.occluded);const wn=Ze(!(!zt||!zt.box));if(!vt&&this.prevPlacement){const sn=this.prevPlacement.variableOffsets[ft];sn&&(this.variableOffsets[ft]=sn,this.markUsedJustification(a,sn.anchor,Q,wn))}}else{const ze=(yn,wn)=>{const sn=a.getSymbolInstanceTextSize(w,Q,this.transform.zoom,at),Zn=this.collisionIndex.placeCollisionBox(a,sn,yn,new N(0,0),R,_,u,S.predicate);return Zn&&Zn.box&&Zn.box.length&&(this.markUsedOrientation(a,wn,Q),this.placedOrientations[ft]=wn),Zn};We(()=>ze(He,ur.horizontal),()=>{const yn=X.verticalTextBox;return a.allowVerticalPlacement&&gt>0&&yn?(xe(yn),ze(yn,ur.vertical)):{box:null,offscreen:null,occluded:null}}),Ze(!!(zt&&zt.box&&zt.box.length))}}if(Ut=zt,vt=Ut&&Ut.box&&Ut.box.length>0,pt=Ut&&Ut.offscreen,Ct=Ut&&Ut.occluded,Q.useRuntimeCollisionCircles){const Ze=a.text.placedSymbolArray.get(Q.centerJustifiedTextSymbolIndex>=0?Q.centerJustifiedTextSymbolIndex:Q.verticalPlacedTextSymbolIndex),We=af(a.textSizeData,w,Ze),ze=c.get("text-padding");Pt=this.collisionIndex.placeCollisionCircles(a,R,Ze,a.lineVertexArray,a.glyphOffsetArray,We,u,d,p,r,O,S.predicate,Q.collisionCircleDiameter*We/pi,ze,this.retainedQueryData[a.bucketInstanceId].tileID),vt=R||Pt.circles.length>0&&!Pt.collisionDetected,pt=pt&&Pt.offscreen,Ct=Pt.occluded}if(X.iconFeatureIndex&&(_e=X.iconFeatureIndex),X.iconBox){const Ze=We=>{xe(We);const ze=Q.hasIconTextFit&&It?lb(It.x,It.y,P,O,this.transform.angle):new N(0,0),yn=a.getSymbolInstanceIconSize(T,this.transform.zoom,Q.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(a,yn,We,ze,k,_,u,S.predicate)};Ft&&Ft.box&&Ft.box.length&&X.verticalIconBox?(Ht=Ze(X.verticalIconBox),ht=Ht.box.length>0):(Ht=Ze(X.iconBox),ht=Ht.box.length>0),pt=pt&&Ht.offscreen,At=Ht.occluded}const Ae=I||Q.numHorizontalGlyphVertices===0&&gt===0,Sn=A||Q.numIconVertices===0;if(Ae||Sn?Sn?Ae||(ht=ht&&vt):vt=ht&&vt:ht=vt=ht&&vt,vt&&Ut&&Ut.box&&this.collisionIndex.insertCollisionBox(Ut.box,c.get("text-ignore-placement"),a.bucketInstanceId,Ft&&Ft.box&&de?de:he,S.ID),ht&&Ht&&this.collisionIndex.insertCollisionBox(Ht.box,c.get("icon-ignore-placement"),a.bucketInstanceId,_e,S.ID),Pt&&(vt&&this.collisionIndex.insertCollisionCircles(Pt.circles,c.get("text-ignore-placement"),a.bucketInstanceId,he,S.ID),r)){const Ze=a.bucketInstanceId;let We=this.collisionCircleArrays[Ze];We===void 0&&(We=this.collisionCircleArrays[Ze]=new M$);for(let ze=0;ze<Pt.circles.length;ze+=4)We.circles.push(Pt.circles[ze+0]),We.circles.push(Pt.circles[ze+1]),We.circles.push(Pt.circles[ze+2]),We.circles.push(Pt.collisionDetected?1:0)}const pn=a.projection.name!=="globe";W=W&&(pn||!Ct),Z=Z&&(pn||!At),this.placements[ft]=new ab(vt||W,ht||Z,pt||a.justReloaded),n.add(ft)};if(G&&this.buildingIndex&&(this.buildingIndex.updateZOffset(a,this.retainedQueryData[a.bucketInstanceId].tileID),a.updateZOffset()),j){const Q=a.getSortedSymbolIndexes(this.transform.angle);for(let at=Q.length-1;at>=0;--at){const X=Q[at];K(a.symbolInstances.get(X),X,a.collisionArrays[X])}a.hasAnyZOffset&&dt(`${a.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(a.hasAnyZOffset){const Q=a.getSortedIndexesByZOffset();for(let at=0;at<Q.length;++at){const X=Q[at];K(a.symbolInstances.get(X),X,a.collisionArrays[X])}}else for(let Q=t.symbolInstanceStart;Q<t.symbolInstanceEnd;Q++)K(a.symbolInstances.get(Q),Q,a.collisionArrays[Q]);if(r&&a.bucketInstanceId in this.collisionCircleArrays){const Q=this.collisionCircleArrays[a.bucketInstanceId];wt.invert(Q.invProjMatrix,u),Q.viewportMatrix=this.collisionIndex.getViewportMatrix()}a.justReloaded=!1}markUsedJustification(t,n,r,o){const{leftJustifiedTextSymbolIndex:a,centerJustifiedTextSymbolIndex:c,rightJustifiedTextSymbolIndex:u,verticalPlacedTextSymbolIndex:d,crossTileID:p}=r,m=E1(n),_=o===ur.vertical?d:m==="left"?a:m==="center"?c:m==="right"?u:-1;a>=0&&(t.text.placedSymbolArray.get(a).crossTileID=_>=0&&a!==_?0:p),c>=0&&(t.text.placedSymbolArray.get(c).crossTileID=_>=0&&c!==_?0:p),u>=0&&(t.text.placedSymbolArray.get(u).crossTileID=_>=0&&u!==_?0:p),d>=0&&(t.text.placedSymbolArray.get(d).crossTileID=_>=0&&d!==_?0:p)}markUsedOrientation(t,n,r){const o=n===ur.horizontal||n===ur.horizontalOnly?n:0,a=n===ur.vertical?n:0,{leftJustifiedTextSymbolIndex:c,centerJustifiedTextSymbolIndex:u,rightJustifiedTextSymbolIndex:d,verticalPlacedTextSymbolIndex:p}=r,m=t.text.placedSymbolArray;c>=0&&(m.get(c).placedOrientation=o),u>=0&&(m.get(u).placedOrientation=o),d>=0&&(m.get(d).placedOrientation=o),p>=0&&(m.get(p).placedOrientation=a)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const n=this.prevPlacement;let r=!1;this.prevZoomAdjustment=n?n.zoomAdjustment(this.transform.zoom):0;const o=n?n.symbolFadeChange(t):1,a=n?n.opacities:{},c=n?n.variableOffsets:{},u=n?n.placedOrientations:{};for(const d in this.placements){const p=this.placements[d],m=a[d];m?(this.opacities[d]=new Af(m,o,p.text,p.icon,null,p.clipped),r=r||p.text!==m.text.placed||p.icon!==m.icon.placed):(this.opacities[d]=new Af(null,o,p.text,p.icon,p.skipFade,p.clipped),r=r||p.text||p.icon)}for(const d in a){const p=a[d];if(!this.opacities[d]){const m=new Af(p,o,!1,!1);m.isHidden()||(this.opacities[d]=m,r=r||p.text.placed||p.icon.placed)}}for(const d in c)this.variableOffsets[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.variableOffsets[d]=c[d]);for(const d in u)this.placedOrientations[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.placedOrientations[d]=u[d]);r?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=n?n.lastPlacementChangeTime:t)}updateLayerOpacities(t,n){const r=new Set;for(const o of n){const a=o.getBucket(t);a&&o.latestFeatureIndex&&t.fqid===a.layerIds[0]&&(this.updateBucketOpacities(a,r,o.collisionBoxArray),a.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(a,o.tileID),a.updateZOffset()))}}updateBucketOpacities(t,n,r){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const o=t.layers[0].layout,a=!!t.layers[0].dynamicFilter(),c=new Af(null,0,!1,!1,!0),u=o.get("text-allow-overlap"),d=o.get("icon-allow-overlap"),p=o.get("text-variable-anchor"),m=o.get("text-rotation-alignment")==="map",_=o.get("text-pitch-alignment")==="map",v=new Af(null,0,u&&(d||!t.hasIconData()||o.get("icon-optional")),d&&(u||!t.hasTextData()||o.get("text-optional")),!0);!t.collisionArrays&&r&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(r);const x=(T,S,I)=>{for(let A=0;A<S/4;A++)T.opacityVertexArray.emplaceBack(I)};let w=0;for(let T=0;T<t.symbolInstances.length;T++){const S=t.symbolInstances.get(T),{numHorizontalGlyphVertices:I,numVerticalGlyphVertices:A,crossTileID:R,numIconVertices:k}=S,P=n.has(R);let O=this.opacities[R];P?O=c:O||(O=v,this.opacities[R]=O),n.add(R);const j=I>0||A>0,G=k>0,W=this.placedOrientations[R],Z=W===ur.vertical,K=W===ur.horizontal||W===ur.horizontalOnly;if(!j&&!G||O.isHidden()||w++,j){const Q=qR(O.text);x(t.text,I,Z?Ng:Q),x(t.text,A,K?Ng:Q);const at=O.text.isHidden(),{leftJustifiedTextSymbolIndex:X,centerJustifiedTextSymbolIndex:ft,rightJustifiedTextSymbolIndex:gt,verticalPlacedTextSymbolIndex:vt}=S,ht=t.text.placedSymbolArray,pt=at||Z?1:0;X>=0&&(ht.get(X).hidden=pt),ft>=0&&(ht.get(ft).hidden=pt),gt>=0&&(ht.get(gt).hidden=pt),vt>=0&&(ht.get(vt).hidden=at||K?1:0);const Ct=this.variableOffsets[R];Ct&&this.markUsedJustification(t,Ct.anchor,S,W);const At=this.placedOrientations[R];At&&(this.markUsedJustification(t,"left",S,At),this.markUsedOrientation(t,At,S))}if(G){const Q=qR(O.icon),{placedIconSymbolIndex:at,verticalPlacedIconSymbolIndex:X}=S,ft=t.icon.placedSymbolArray,gt=O.icon.isHidden()?1:0;at>=0&&(x(t.icon,k,Z?Ng:Q),ft.get(at).hidden=gt),X>=0&&(x(t.icon,S.numVerticalIconVertices,K?Ng:Q),ft.get(X).hidden=gt)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Q=t.collisionArrays[T];if(Q){let at=new N(0,0),X=!0;if(Q.textBox||Q.verticalTextBox){if(p){const gt=this.variableOffsets[R];gt?(at=WR(gt.anchor,gt.width,gt.height,gt.textOffset,gt.textScale),m&&at._rotate(_?this.transform.angle:-this.transform.angle)):X=!1}a&&(X=!O.clipped),Q.textBox&&Fg(t.textCollisionBox.collisionVertexArray,O.text.placed,!X||Z,at.x,at.y),Q.verticalTextBox&&Fg(t.textCollisionBox.collisionVertexArray,O.text.placed,!X||K,at.x,at.y)}const ft=X&&!!(!K&&Q.verticalIconBox);Q.iconBox&&Fg(t.iconCollisionBox.collisionVertexArray,O.icon.placed,ft,S.hasIconTextFit?at.x:0,S.hasIconTextFit?at.y:0),Q.verticalIconBox&&Fg(t.iconCollisionBox.collisionVertexArray,O.icon.placed,!ft,S.hasIconTextFit?at.x:0,S.hasIconTextFit?at.y:0)}}}if(t.fullyClipped=w===0,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const T=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=T.invProjMatrix,t.placementViewportMatrix=T.viewportMatrix,t.collisionCircleArray=T.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,n){const r=this.zoomAtLastRecencyCheck===n?1-this.zoomAdjustment(n):1;return this.zoomAtLastRecencyCheck=n,this.commitTime+this.fadeDuration*r>t}setStale(){this.stale=!0}}function Fg(e,t,n,r,o){e.emplaceBack(t?1:0,n?1:0,r||0,o||0),e.emplaceBack(t?1:0,n?1:0,r||0,o||0),e.emplaceBack(t?1:0,n?1:0,r||0,o||0),e.emplaceBack(t?1:0,n?1:0,r||0,o||0)}const R$=Math.pow(2,25),k$=Math.pow(2,24),O$=Math.pow(2,17),L$=Math.pow(2,16),z$=Math.pow(2,9),D$=Math.pow(2,8),B$=Math.pow(2,1);function qR(e){if(e.opacity===0&&!e.placed)return 0;if(e.opacity===1&&e.placed)return 4294967295;const t=e.placed?1:0,n=Math.floor(127*e.opacity);return n*R$+t*k$+n*O$+t*L$+n*z$+t*D$+n*B$+t}const Ng=0;class F${constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&t.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(t,n,r,o,a){const c=this._bucketParts;for(;this._currentTileIndex<t.length;)if(n.getBucketParts(c,o,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,a())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,c.sort((u,d)=>u.sortKey-d.sortKey));this._currentPartIndex<c.length;){const u=c[this._currentPartIndex];if(n.placeLayerBucketPart(u,this._seenCrossTileIDs,r,u.symbolInstanceStart===0),this._currentPartIndex++,a())return!0}return!1}}class N${constructor(t,n,r,o,a,c,u,d,p){this.placement=new P$(t,a,c,u,d,p),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=o,this._done=!1}isDone(){return this._done}continuePlacement(t,n,r,o){const a=Ve.now(),c=()=>{const u=Ve.now()-a;return!this._forceFullPlacement&&u>2};for(;this._currentPlacementIndex>=0;){const u=n[t[this._currentPlacementIndex]],d=this.placement.collisionIndex.transform.zoom;if(u.type==="symbol"&&(!u.minzoom||u.minzoom<=d)&&(!u.maxzoom||u.maxzoom>d)){const p=u,m=p.layout.get("symbol-z-elevate"),_=this._inProgressLayer=this._inProgressLayer||new F$(p),v=$i(u.source,u.scope);if(_.continuePlacement(m?o[v]:r[v],this.placement,this._showCollisionBoxes,u,c))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const HR=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class jg{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,r]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const o=r>>4;if(o!==1)throw new Error(`Got v${o} data when expected v1.`);const a=HR[15&r];if(!a)throw new Error("Unrecognized array type.");const[c]=new Uint16Array(t,2,1),[u]=new Uint32Array(t,4,1);return new jg(u,c,a,t)}constructor(t,n=64,r=Float64Array,o){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=r,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const a=HR.indexOf(this.ArrayType),c=2*t*this.ArrayType.BYTES_PER_ELEMENT,u=t*this.IndexArrayType.BYTES_PER_ELEMENT,d=(8-u%8)%8;if(a<0)throw new Error(`Unexpected typed array class: ${r}.`);o&&o instanceof ArrayBuffer?(this.data=o,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+u+d,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+c+u+d),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+u+d,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+a]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=t,this.coords[this._pos++]=n,r}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return cb(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,r,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:a,coords:c,nodeSize:u}=this,d=[0,a.length-1,0],p=[];for(;d.length;){const m=d.pop()||0,_=d.pop()||0,v=d.pop()||0;if(_-v<=u){for(let S=v;S<=_;S++){const I=c[2*S],A=c[2*S+1];I>=t&&I<=r&&A>=n&&A<=o&&p.push(a[S])}continue}const x=v+_>>1,w=c[2*x],T=c[2*x+1];w>=t&&w<=r&&T>=n&&T<=o&&p.push(a[x]),(m===0?t<=w:n<=T)&&(d.push(v),d.push(x-1),d.push(1-m)),(m===0?r>=w:o>=T)&&(d.push(x+1),d.push(_),d.push(1-m))}return p}within(t,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:o,coords:a,nodeSize:c}=this,u=[0,o.length-1,0],d=[],p=r*r;for(;u.length;){const m=u.pop()||0,_=u.pop()||0,v=u.pop()||0;if(_-v<=c){for(let S=v;S<=_;S++)XR(a[2*S],a[2*S+1],t,n)<=p&&d.push(o[S]);continue}const x=v+_>>1,w=a[2*x],T=a[2*x+1];XR(w,T,t,n)<=p&&d.push(o[x]),(m===0?t-r<=w:n-r<=T)&&(u.push(v),u.push(x-1),u.push(1-m)),(m===0?t+r>=w:n+r>=T)&&(u.push(x+1),u.push(_),u.push(1-m))}return d}}function cb(e,t,n,r,o,a){if(o-r<=n)return;const c=r+o>>1;ZR(e,t,c,r,o,a),cb(e,t,n,r,c-1,1-a),cb(e,t,n,c+1,o,1-a)}function ZR(e,t,n,r,o,a){for(;o>r;){if(o-r>600){const p=o-r+1,m=n-r+1,_=Math.log(p),v=.5*Math.exp(2*_/3),x=.5*Math.sqrt(_*v*(p-v)/p)*(m-p/2<0?-1:1);ZR(e,t,n,Math.max(r,Math.floor(n-m*v/p+x)),Math.min(o,Math.floor(n+(p-m)*v/p+x)),a)}const c=t[2*n+a];let u=r,d=o;for(Pf(e,t,r,n),t[2*o+a]>c&&Pf(e,t,r,o);u<d;){for(Pf(e,t,u,d),u++,d--;t[2*u+a]<c;)u++;for(;t[2*d+a]>c;)d--}t[2*r+a]===c?Pf(e,t,r,d):(d++,Pf(e,t,d,o)),d<=n&&(r=d+1),n<=d&&(o=d-1)}}function Pf(e,t,n,r){ub(e,n,r),ub(t,2*n,2*r),ub(t,2*n+1,2*r+1)}function ub(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function XR(e,t,n,r){const o=e-n,a=t-r;return o*o+a*a}const hb=512/Rt/2;class j${constructor(t,n,r){this.tileID=t,this.bucketInstanceId=r,this.index=new jg(n.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const o=t.canonical.x*Rt,a=t.canonical.y*Rt;for(let c=0;c<n.length;c++){const{key:u,crossTileID:d,tileAnchorX:p,tileAnchorY:m}=n.get(c),_=Math.floor((o+p)*hb),v=Math.floor((a+m)*hb);this.index.add(_,v),this.keys.push(u),this.crossTileIDs.push(d)}this.index.finish()}findMatches(t,n,r){const o=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z),a=hb/Math.pow(2,n.canonical.z-this.tileID.canonical.z),c=n.canonical.x*Rt,u=n.canonical.y*Rt;for(let d=0;d<t.length;d++){const p=t.get(d);if(p.crossTileID)continue;const{key:m,tileAnchorX:_,tileAnchorY:v}=p,x=Math.floor((c+_)*a),w=Math.floor((u+v)*a),T=this.index.range(x-o,w-o,x+o,w+o);for(const S of T){const I=this.crossTileIDs[S];if(this.keys[S]===m&&!r.has(I)){r.add(I),p.crossTileID=I;break}}}}}class U${constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $${constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const n=Math.round((t-this.lng)/360);if(n!==0)for(const r in this.indexes){const o=this.indexes[r],a={};for(const c in o){const u=o[c];u.tileID=u.tileID.unwrapTo(u.tileID.wrap+n),a[u.tileID.key]=u}this.indexes[r]=a}this.lng=t}addBucket(t,n,r){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===n.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let a=0;a<n.symbolInstances.length;a++)n.symbolInstances.get(a).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]=new Set);const o=this.usedCrossTileIDs[t.overscaledZ];for(const a in this.indexes){const c=this.indexes[a];if(Number(a)>t.overscaledZ)for(const u in c){const d=c[u];d.tileID.isChildOf(t)&&d.findMatches(n.symbolInstances,t,o)}else{const u=c[t.scaledTo(Number(a)).key];u&&u.findMatches(n.symbolInstances,t,o)}}for(let a=0;a<n.symbolInstances.length;a++){const c=n.symbolInstances.get(a);c.crossTileID||(c.crossTileID=r.generate(),o.add(c.crossTileID))}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new j$(t,n.symbolInstances,n.bucketInstanceId),!0}removeBucketCrossTileIDs(t,n){for(const r of n.crossTileIDs)this.usedCrossTileIDs[t].delete(r)}removeStaleBuckets(t){let n=!1;for(const r in this.indexes){const o=this.indexes[r];for(const a in o)t[o[a].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,o[a]),delete o[a],n=!0)}return n}}class V${constructor(){this.layerIndexes={},this.crossTileIDs=new U$,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,n,r,o){let a=this.layerIndexes[t.fqid];a===void 0&&(a=this.layerIndexes[t.fqid]=new $$);let c=!1;const u={};o.name!=="globe"&&a.handleWrapJump(r);for(const d of n){const p=d.getBucket(t);p&&t.fqid===p.layerIds[0]&&(p.bucketInstanceId||(p.bucketInstanceId=++this.maxBucketInstanceId),a.addBucket(d.tileID,p,this.crossTileIDs)&&(c=!0),u[p.bucketInstanceId]=!0)}return a.removeStaleBuckets(u)&&(c=!0),c}pruneUnusedLayers(t){const n={};t.forEach(r=>{n[r]=!0});for(const r in this.layerIndexes)n[r]||delete this.layerIndexes[r]}}var KR=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w-0.0001;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,YR="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",QR=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,JR=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,tk=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,ek=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);vec4 _raTexLinearCoord(vec2 texCoord,vec2 texResolution,out vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return (texCoord.xxyy+vec2(1.5,0.5).xyxy)/texResolution.xxyy;}vec2 _raTexLinearMix(vec2 fxy,vec4 colorMix,float colorOffset,vec4 t00,vec4 t10,vec4 t01,vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec2 fxy;vec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texture(u_image0,c.yz),texture(u_image0,c.xz),texture(u_image0,c.yw),texture(u_image0,c.xw)
);}vec2 raTexture2D_image1_linear(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec2 fxy;vec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texture(u_image1,c.yz),texture(u_image1,c.xz),texture(u_image1,c.yw),texture(u_image1,c.xw)
);}vec2 raTexture2D_image0_nearest(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec4 t=texture(u_image0,texCoord);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec4 t=texture(u_image1,texCoord);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,nk=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,rk=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const ik=[];Vg(KR,ik);const Ug={"_prelude_fog.vertex.glsl":JR,"_prelude_terrain.vertex.glsl":QR,"_prelude_shadow.vertex.glsl":nk,"_prelude_fog.fragment.glsl":tk,"_prelude_shadow.fragment.glsl":rk,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":ek},$g={};Bn("",QR),Bn(tk,JR),Bn(rk,nk),Bn(ek,"");const ok=Bn(`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif`,`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`),sk=KR;var ak={background:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Bn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Bn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Bn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Bn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Bn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Bn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in vec2 v_pos;in vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;out vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
uniform float u_emissive_strength;in float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
#ifdef RENDER_CUTOFF
invariant gl_Position;
#endif
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),fillExtrusionDepth:Bn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Bn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,v_depth));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);v_depth=gl_Position.w;
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Bn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;HANDLE_WIREFRAME_DEBUG;
#endif
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;
#ifdef FORCE_ABS_FL_GROUND_RADIUS
fl_ground_radius=abs(flood_light_ground_radius);
#endif
float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Bn(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform vec4 u_tl_br;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#elif defined(PROJECTION_GLOBE_VIEW)
in vec2 a_pos;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec2 globe_tl=vec2(u_tl_br.x,u_tl_br.y);vec2 globe_br=vec2(u_tl_br.z,u_tl_br.w);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=1.0-((mercatorY-globe_br.y)/(globe_tl.y-globe_br.y));float mercatorX=mercatorXfromLng(latLng[1]);float uvX=(mercatorX-globe_br.x)/(globe_tl.x-globe_br.x);vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);uv=vec2(uvX,uvY);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
uv=a_texture_pos/8192.0;
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),symbolIcon:Bn(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
in float v_fade_opacity;in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
uniform mediump float u_icon_saturation;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;
#else
out_color=texture(u_texture,v_tex_a)*alpha;
#endif
#ifdef SATURATION
vec3 luma=vec3(dot(out_color.rgb,vec3(0.2126,0.7152,0.0722)));out_color.rgb=mix(luma,out_color.rgb,u_icon_saturation);
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;}`),symbolSDF:Bn(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:Bn(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,v_depth,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Bn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Bn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,YR),skyboxGradient:Bn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,YR),skyboxCapture:Bn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Bn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
texColor.rgb=sRGBToLinear(texColor.rgb);if(u_baseTextureIsAlpha) {if (texColor.w < 0.5) {discard;}albedo*=mix(vec4(texColor.rgb,texColor.a),vec4(texColor.a),float(u_baseTextureIsAlpha));} else {albedo*=texColor;}
#endif
return vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 diffuse=getDiffuseShadedColor(getBaseColor().rgb,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(diffuse,1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
ao=(texture(u_occlusionTexture,uv_2f).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=local_pos;
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Bn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Bn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`)};function Vg(e,t){const n=e.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let r of n)if(r=r.trim(),r[0]==="#"&&r.includes("if")&&!r.includes("endif")){r=r.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const o=r.split(" ");for(const a of o)t.includes(a)||t.push(a)}}function Bn(e,t){const n=/#include\s+"([^"]+)"/g,r=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let o=t.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);o&&(o=o.map(p=>{const m=p.split(" ");return m[m.length-1]}),o=[...new Set(o)]);const a={},c=[],u=[];e=e.replace(n,(p,m)=>(u.push(m),"")),t=t.replace(n,(p,m)=>(c.push(m),""));let d=[...ik];Vg(e,d),Vg(t,d);for(const p of[...c,...u])Ug[p]||console.error(`Undefined include: ${p}`),$g[p]||($g[p]=[],Vg(Ug[p],$g[p])),d=[...d,...$g[p]];return{fragmentSource:e=e.replace(r,(p,m,_,v,x)=>(a[x]=!0,m==="define"?`
#ifndef HAS_UNIFORM_u_${x}
in ${_} ${v} ${x};
#else
uniform ${_} ${v} u_${x};
#endif
`:m==="initialize"?`
#ifdef HAS_UNIFORM_u_${x}
    ${_} ${v} ${x} = u_${x};
#endif
`:m==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${x}
    in ${_} ${v} ${x};
#endif
`:m==="initialize-attribute"?"":void 0)),vertexSource:t=t.replace(r,(p,m,_,v,x)=>{const w=v==="float"?"vec2":v,T=x.match(/color/)?"color":w;return m==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${x}
in ${_} ${v} a_${x};
#endif
`:a[x]?m==="define"?`
#ifndef HAS_UNIFORM_u_${x}
uniform lowp float u_${x}_t;
in ${_} ${w} a_${x};
out ${_} ${v} ${x};
#else
uniform ${_} ${v} u_${x};
#endif
`:m==="initialize"?T==="vec4"?`
#ifndef HAS_UNIFORM_u_${x}
    ${x} = a_${x};
#else
    ${_} ${v} ${x} = u_${x};
#endif
`:`
#ifndef HAS_UNIFORM_u_${x}
    ${x} = unpack_mix_${T}(a_${x}, u_${x}_t);
#else
    ${_} ${v} ${x} = u_${x};
#endif
`:m==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${x}
    in ${_} ${v} a_${x};
    out ${_} ${v} ${x};
#endif
`:m==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${x}
    ${x} = a_${x};
#endif
`:void 0:m==="define"?`
#ifndef HAS_UNIFORM_u_${x}
uniform lowp float u_${x}_t;
in ${_} ${w} a_${x};
#else
uniform ${_} ${v} u_${x};
#endif
`:m==="define-instanced"?T==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${x}0;
in vec4 a_${x}1;
in vec4 a_${x}2;
in vec4 a_${x}3;
#else
uniform ${_} ${v} u_${x};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${_} ${w} a_${x};
#else
uniform ${_} ${v} u_${x};
#endif
`:m==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${x}
    ${_} ${v} ${x} = a_${x};
#endif
`:T==="vec4"?`
#ifndef HAS_UNIFORM_u_${x}
    ${_} ${v} ${x} = a_${x};
#else
    ${_} ${v} ${x} = u_${x};
#endif
`:`
#ifndef HAS_UNIFORM_u_${x}
    ${_} ${v} ${x} = unpack_mix_${T}(a_${x}, u_${x}_t);
#else
    ${_} ${v} ${x} = u_${x};
#endif
`}),staticAttributes:o,usedDefines:d,vertexIncludes:c,fragmentIncludes:u}}class G${constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,n,r,o,a,c,u,d){this.context=t;let p=this.boundPaintVertexBuffers.length!==o.length;for(let _=0;!p&&_<o.length;_++)this.boundPaintVertexBuffers[_]!==o[_]&&(p=!0);let m=this.boundDynamicVertexBuffers.length!==u.length;for(let _=0;!m&&_<u.length;_++)this.boundDynamicVertexBuffers[_]!==u[_]&&(m=!0);if(!this.vao||this.boundProgram!==n||this.boundLayoutVertexBuffer!==r||p||m||this.boundIndexBuffer!==a||this.boundVertexOffset!==c)this.freshBind(n,r,o,a,c,u,d);else{t.bindVertexArrayOES.set(this.vao);for(const _ of u)_&&(_.bind(),d&&_.instanceCount&&_.setVertexAttribDivisor(t.gl,n,d));a&&a.dynamicDraw&&a.bind()}}freshBind(t,n,r,o,a,c,u){const d=t.numAttributes,p=this.context,m=p.gl;this.vao&&this.destroy(),this.vao=p.gl.createVertexArray(),p.bindVertexArrayOES.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=n,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=o,this.boundVertexOffset=a,this.boundDynamicVertexBuffers=c,n.enableAttributes(m,t),n.bind(),n.setVertexAttribPointers(m,t,a);for(const _ of r)_.enableAttributes(m,t),_.bind(),_.setVertexAttribPointers(m,t,a);for(const _ of c)_&&(_.enableAttributes(m,t),_.bind(),_.setVertexAttribPointers(m,t,a),u&&_.instanceCount&&_.setVertexAttribDivisor(m,t,u));o&&o.bind(),p.currentNumAttributes=d}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function W$(e,t){const n=Math.pow(2,t.canonical.z),r=t.canonical.y;return[new xn(0,r/n).toLngLat().lat,new xn(0,(r+1)/n).toLngLat().lat]}function q$(e,t,n,r,o,a,c){const u=e.context,d=u.gl,p=n.hillshadeFBO;if(!p)return;e.prepareDrawTile();const m=e.isTileAffectedByFog(t),_=e.getOrCreateProgram("hillshade",{overrideFog:m});u.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,p.colorAttachment.get());const v=((S,I,A,R)=>{const k=A.paint.get("hillshade-shadow-color"),P=A.paint.get("hillshade-highlight-color"),O=A.paint.get("hillshade-accent-color"),j=A.paint.get("hillshade-emissive-strength");let G=it(A.paint.get("hillshade-illumination-direction"));if(A.paint.get("hillshade-illumination-anchor")==="viewport")G-=S.transform.angle;else if(S.style&&S.style.enable3dLights()&&S.style.directionalLight){const Z=S.style.directionalLight.properties.get("direction");G=it(ce(Z.x,Z.y,Z.z)[1])}const W=!S.options.moving;return{u_matrix:R||S.transform.calculateProjMatrix(I.tileID.toUnwrapped(),W),u_image:0,u_latrange:W$(0,I.tileID),u_light:[A.paint.get("hillshade-exaggeration"),G],u_shadow:k,u_highlight:P,u_emissive_strength:j,u_accent:O}})(e,n,r,e.terrain?t.projMatrix:null);e.uploadCommonUniforms(u,_,t.toUnwrapped());const{tileBoundsBuffer:x,tileBoundsIndexBuffer:w,tileBoundsSegments:T}=e.getTileBoundsBuffers(n);_.draw(e,d.TRIANGLES,o,a,c,hn.disabled,v,r.id,x,w,T)}function lk(e,t,n){if(!t.needsDEMTextureUpload)return;const r=e.context,o=r.gl;r.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||e.getTileTexture(n.stride);const a=n.getPixels();t.demTexture?t.demTexture.update(a,{premultiply:!1}):t.demTexture=new gr(r,a,o.R32F,{premultiply:!1}),t.needsDEMTextureUpload=!1}function H$(e,t,n){const r=e.context,o=r.gl;if(!t.dem)return;const a=t.dem;if(r.activeTexture.set(o.TEXTURE1),lk(e,t,a),!t.demTexture)return;t.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE);const c=a.dim;r.activeTexture.set(o.TEXTURE0);let u=t.hillshadeFBO;if(!u){const v=new gr(r,{width:c,height:c,data:null},o.RGBA);v.bind(o.LINEAR,o.CLAMP_TO_EDGE),u=t.hillshadeFBO=r.createFramebuffer(c,c,!0,"renderbuffer"),u.colorAttachment.set(v.texture)}r.bindFramebuffer.set(u.framebuffer),r.viewport.set([0,0,c,c]);const{tileBoundsBuffer:d,tileBoundsIndexBuffer:p,tileBoundsSegments:m}=e.getMercatorTileBoundsBuffers(),_=[];e.linearFloatFilteringSupported()&&_.push("TERRAIN_DEM_FLOAT_FORMAT"),e.getOrCreateProgram("hillshadePrepare",{defines:_}).draw(e,o.TRIANGLES,qe.disabled,ln.disabled,Mn.unblended,hn.disabled,((v,x)=>{const w=x.stride,T=wt.create();return wt.ortho(T,0,Rt,-Rt,0,0,1),wt.translate(T,T,[0,-Rt,0]),{u_matrix:T,u_image:1,u_dimension:[w,w],u_zoom:v.overscaledZ}})(t.tileID,a),n.id,d,p,m),t.needsHillshadePrepare=!1}const ck=e=>({u_matrix:new Je(e),u_image0:new dn(e),u_skirt_height:new Kt(e),u_ground_shadow_factor:new nn(e)}),uk=(e,t,n)=>({u_matrix:e,u_image0:0,u_skirt_height:t,u_ground_shadow_factor:n}),hk=(e,t,n,r,o,a,c,u,d,p,m,_,v,x,w)=>({u_proj_matrix:Float32Array.from(e),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(r),u_merc_matrix:n,u_zoom_transition:o,u_merc_center:a,u_image0:0,u_frustum_tl:c,u_frustum_tr:u,u_frustum_br:d,u_frustum_bl:p,u_globe_pos:m,u_globe_radius:_,u_viewport:v,u_grid_matrix:w?Float32Array.from(w):new Float32Array(9),u_skirt_height:x}),ph=(e,t)=>{if(t>0&&e.terrain&&dt("Cutoff is currently disabled on terrain"),t<=0||e.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,0]}};const n=e.transform,r=Math.max(Math.abs(n._zoom-(e.minCutoffZoom-1)),1),o=n.isLODDisabled(!1)?Le(60,45,n.pitch):Le(30,15,n.pitch),a=n._farZ-n._nearZ,c=t*n.height,u=((1-(d=o))*(.75*n.cameraToCenterDistance)+d*(n._farZ+c))*r;var d;return{shouldRenderCutoff:o<1,uniformValues:{u_cutoff_params:[n._nearZ,n._farZ,(u-n._nearZ)/a,(u-c-n._nearZ)/a]}}};function dk(e,t){return e!=null&&t!=null&&!(!e.hasData()||!t.hasData())&&e.demTexture!=null&&t.demTexture!=null&&e.tileID.key!==t.tileID.key}const mh=new class{constructor(){this.operations={}}newMorphing(e,t,n,r,o){if(e in this.operations){const a=this.operations[e];a.to.tileID.key!==n.tileID.key&&(a.queued=n)}else this.operations[e]={startTime:r,phase:0,duration:o,from:t,to:n,queued:null}}getMorphValuesForProxy(e){if(!(e in this.operations))return null;const t=this.operations[e];return{from:t.from,to:t.to,phase:t.phase}}update(e){for(const t in this.operations){const n=this.operations[t];for(n.phase=(e-n.startTime)/n.duration;n.phase>=1||!this._validOp(n);)if(!this._nextOp(n,e)){delete this.operations[t];break}}}_nextOp(e,t){return!!e.queued&&(e.from=e.to,e.to=e.queued,e.queued=null,e.phase=0,e.startTime=t,!0)}_validOp(e){return e.from.hasData()&&e.to.hasData()}},fk={0:null,1:"TERRAIN_VERTEX_MORPHING"};function pk(e,t,n){if(t===0)return 0;const r=t<1&&n===514?.25/t:1;return 6*Math.pow(1.5,22-e)*Math.max(t,1)*r}function Z$(e,t){const n=1<<e.z;return!t&&(e.x===0||e.x===n-1)||e.y===0||e.y===n-1}const db=e=>({u_matrix:e});function mk(e,t,n,r,o){if(o>0){const a=Ve.now(),c=(a-e.timeAdded)/o,u=t?(a-t.timeAdded)/o:-1,d=n.getSource(),p=r.coveringZoomLevel({tileSize:d.tileSize,roundZoom:d.roundZoom}),m=!t||Math.abs(t.tileID.overscaledZ-p)>Math.abs(e.tileID.overscaledZ-p),_=m&&e.refreshedUponExpiration?1:jt(m?c:1-u,0,1);return e.refreshedUponExpiration&&c>=1&&(e.refreshedUponExpiration=!1),t?{opacity:1,mix:1-_}:{opacity:_,mix:0}}return{opacity:1,mix:0}}class X$ extends Bs{constructor(t){const n={type:"raster-dem",maxzoom:t.transform.maxZoom},r=new Fc(If(),null),o=ib("mock-dem",n,r,t.style);super("mock-dem",o,!1),o.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,n){t.state="loaded",n(null)}}class K$ extends Bs{constructor(t){const n=ib("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new Fc(If(),null),t.style);super("proxy",n,!1),n.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,n,r){if(t.freezeTileCoverage)return;this.transform=t;const o=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((a,c)=>{if(a[c.key]="",!this._tiles[c.key]){const u=new _f(c,this._source.tileSize*c.overscaleFactor(),t.tileZoom);u.state="loaded",this._tiles[c.key]=u}return a},{});for(const a in this._tiles)a in o||(this.freeFBO(a),this._tiles[a].unloadVectorData(),delete this._tiles[a])}freeFBO(t){const n=this.proxyCachedFBO[t];if(n!==void 0){const r=Object.values(n);this.renderCachePool.push(...r),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class gk extends Pn{constructor(t,n,r){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=n,this.projMatrix=r}}class Y$ extends A6{constructor(t,n){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[r,o,a]=function(d){const p=new bo,m=new Wr,_=131;p.reserve(17161),m.reserve(33800);const v=Rt/128,x=Rt+v/2,w=x+v;for(let S=-v;S<w;S+=v)for(let I=-v;I<w;I+=v){const A=I<0||I>x||S<0||S>x?24575:0,R=jt(Math.round(I),0,Rt),k=jt(Math.round(S),0,Rt);p.emplaceBack(R+A,k)}const T=(S,I)=>{const A=I*_+S;m.emplaceBack(A+1,A,A+_),m.emplaceBack(A+_,A+_+1,A+1)};for(let S=1;S<129;S++)for(let I=1;I<129;I++)T(I,S);return[0,129].forEach(S=>{for(let I=0;I<130;I++)T(I,S),T(S,I)}),[p,m,32768]}(),c=t.context;this.gridBuffer=c.createVertexBuffer(r,bl.members),this.gridIndexBuffer=c.createIndexBuffer(o),this.gridSegments=Gn.simpleSegment(0,0,r.length,o.length),this.gridNoSkirtSegments=Gn.simpleSegment(0,0,r.length,a),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new K$(n.map),this.orthoMatrix=wt.create(),wt.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,Rt,0,Rt,0,1);const u=c.gl;this._overlapStencilMode=new ln({func:u.GEQUAL,mask:255},0,255,u.KEEP,u.KEEP,u.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=n,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new X$(n.map),this._pendingGroundEffectLayers=[]}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),this._style=t,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(t,n,r){if(t&&t.terrain){this._style!==t&&(this.style=t,this._evaluationZoom=void 0);const o=t.terrain.properties,a=t.terrain.drapeRenderMode===0,c=t.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=Ve.now();const u=t.terrain&&t.terrain.scope,d=o.get("source"),p=a?this._mockSourceCache:t.getSourceCache(d,u);if(!p)return void dt(`Couldn't find terrain source "${d}".`);if(this.sourceCache=p,this._exaggeration=c?this.calculateExaggeration(n):o.get("exaggeration"),!n.projection.requiresDraping&&c&&this._exaggeration===0)return void this._disable();this.enabled=!0;const m=()=>{this.sourceCache.used&&dt(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const _=this.getScaledDemTileSize();this.sourceCache.update(n,_,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,m(),this._initializing=!0),m(),n.updateElevation(!0,r),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(n),this._emptyDEMTextureDirty=!0,this._previousZoom=n.zoom}else this._disable()}calculateExaggeration(t){const n=this._previousCameraAltitude,r=t.getFreeCameraOptions().position.z/t.pixelsPerMeter*t.worldSize;this._previousCameraAltitude=r;const o=n!=null?r-n:Number.MAX_VALUE;if(Math.abs(o)<2)return this._exaggeration;const a=t.zoom,c=this._style.terrain;if(!this._previousUpdateTimestamp)return c.getExaggeration(a);let u=a-this._previousZoom;const d=this._previousUpdateTimestamp;let p=a;this._evaluationZoom!=null&&(p=this._evaluationZoom,Math.abs(a-p)>.5&&(u=.5*(a-p+u)),u*o<0&&(p+=u)),this._evaluationZoom=p;const m=c.getExaggeration(p),_=m===c.getExaggeration(Math.max(0,p-.1));if(_&&Math.abs(m-this._exaggeration)<.01)return m;let v=Math.min(.1,.00375*(this._updateTimestamp-d));return(_||m<.1||Math.abs(u)<1e-4)&&(v=Math.min(.2,4*v)),Xe(this._exaggeration,m,v)}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(t){t.coord&&t.dataType==="source"?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):t.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._mergedSourceCaches)this._style._mergedSourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const n=this.proxySourceCache,r=this.painter.transform;this._initializing&&(this._initializing=r._centerAltitude===0&&this.getAtPointOrZero(xn.fromLngLat(r.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const o=this.proxyCoords=n.getIds().map(d=>{const p=n.getTileByID(d).tileID;return p.projMatrix=r.calculateProjMatrix(p.toUnwrapped()),p});(function(d,p){const m=p.transform.pointCoordinate(p.transform.getCameraPoint()),_=new N(m.x,m.y);d.sort((v,x)=>{if(x.overscaledZ-v.overscaledZ)return x.overscaledZ-v.overscaledZ;const w=new N(v.canonical.x+(1<<v.canonical.z)*v.wrap,v.canonical.y),T=new N(x.canonical.x+(1<<x.canonical.z)*x.wrap,x.canonical.y),S=_.mult(1<<v.canonical.z);return S.x-=.5,S.y-=.5,S.distSqr(w)-S.distSqr(T)})})(o,this.painter);const a=this.proxyToSource||{};this.proxyToSource={},o.forEach(d=>{this.proxyToSource[d.key]={}}),this.terrainTileForTile={};const c=this._style._mergedSourceCaches;for(const d in c){const p=c[d];if(!p.used||(p!==this.sourceCache&&this.resetTileLookupCache(p.id),this._setupProxiedCoordsForOrtho(p,t[d],a),p.usedForTerrain))continue;const m=t[d];p.getSource().reparseOverscaled&&this._assignTerrainTiles(m)}this.proxiedCoords[n.id]=o.map(d=>new gk(d,d.key,this.orthoMatrix)),this._assignTerrainTiles(o),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(a),this.renderingToTexture=!1;const u={};this._visibleDemTiles=[];for(const d of this.proxyCoords){const p=this.terrainTileForTile[d.key];if(!p)continue;const m=p.tileID.key;m in u||(this._visibleDemTiles.push(p),u[m]=m)}}_assignTerrainTiles(t){this._initializing||t.forEach(n=>{if(this.terrainTileForTile[n.key])return;const r=this._findTileCoveringTileID(n,this.sourceCache);r&&(this.terrainTileForTile[n.key]=r)})}_prepareDEMTextures(){const t=this.painter.context,n=t.gl;for(const r in this.terrainTileForTile){const o=this.terrainTileForTile[r],a=o.dem;!a||o.demTexture&&!o.needsDEMTextureUpload||(t.activeTexture.set(n.TEXTURE1),lk(this.painter,o,a))}}_prepareDemTileUniforms(t,n,r,o){if(!n||n.demTexture==null)return!1;const a=t.tileID.canonical,c=Math.pow(2,n.tileID.canonical.z-a.z),u=o||"";return r[`u_dem_tl${u}`]=[a.x*c%1,a.y*c%1],r[`u_dem_scale${u}`]=c,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,n=t.gl;if(!this._emptyDepthBufferTexture){const r=new jr({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new gr(t,r,n.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const n=this._visibleDemTiles.reduce((r,o)=>{if(!o.dem)return r;const a=o.dem.tree.minimums[0];return a>0&&t++,r+a},0);return t?n/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,n=t.gl;t.activeTexture.set(n.TEXTURE2);const r=this._getLoadedAreaMinimum(),[o,a]=(()=>{const u=new aA({width:1,height:1},new Float32Array([r]));return[n.R32F,u]})();this._emptyDEMTextureDirty=!1;let c=this._emptyDEMTexture;return c?c.update(a,{premultiply:!1}):c=this._emptyDEMTexture=new gr(t,a,o,{premultiply:!1}),c}setupElevationDraw(t,n,r){const o=this.painter.context,a=o.gl,c={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};c.u_exaggeration=this.exaggeration();let u=null,d=null,p=1;if(r&&r.morphing&&this._useVertexMorphing){const v=r.morphing.srcDemTile,x=r.morphing.dstDemTile;p=r.morphing.phase,v&&x&&(this._prepareDemTileUniforms(t,v,c,"_prev")&&(d=v),this._prepareDemTileUniforms(t,x,c)&&(u=x))}const m=v=>v&&v.demTexture&&this.painter.linearFloatFilteringSupported()?a.LINEAR:a.NEAREST,_=v=>{c.u_dem_size=v.size[0]===1?1:v.size[0]-2};if(d&&u)o.activeTexture.set(a.TEXTURE2),u.demTexture.bind(m(u),a.CLAMP_TO_EDGE),o.activeTexture.set(a.TEXTURE4),d.demTexture.bind(m(d),a.CLAMP_TO_EDGE),u.demTexture&&_(u.demTexture),c.u_dem_lerp=p;else{u=this.terrainTileForTile[t.tileID.key],o.activeTexture.set(a.TEXTURE2);const v=this._prepareDemTileUniforms(t,u,c)?u.demTexture:this.emptyDEMTexture;v.bind(m(u),a.CLAMP_TO_EDGE),_(v)}if(o.activeTexture.set(a.TEXTURE3),r&&r.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(a.NEAREST,a.CLAMP_TO_EDGE),this._depthFBO&&(c.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(a.NEAREST,a.CLAMP_TO_EDGE),c.u_depth_size_inv=[1,1]),r&&r.useMeterToDem&&u){const v=(1<<u.tileID.canonical.z)*Hn(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;c.u_meter_to_dem=v}if(r&&r.labelPlaneMatrixInv&&(c.u_label_plane_matrix_inv=r.labelPlaneMatrixInv),n.setTerrainUniformValues(o,c),this.painter.transform.projection.name==="globe"){const v=this.globeUniformValues(this.painter.transform,t.tileID.canonical,r&&r.useDenormalizedUpVectorScale);n.setGlobeUniformValues(o,v)}}globeUniformValues(t,n,r){const o=t.projection;return{u_tile_tl_up:o.upVector(n,0,0),u_tile_tr_up:o.upVector(n,Rt,0),u_tile_br_up:o.upVector(n,Rt,Rt),u_tile_bl_up:o.upVector(n,0,Rt),u_tile_up_scale:r?Dm(1):o.upVectorScale(n,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const n=this.painter,r=this.painter.context;t.length!==0&&(r.bindFramebuffer.set(null),r.viewport.set([0,0,n.width,n.height]),n.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(o,a,c,u,d){if(o.transform.projection.name==="globe")(function(p,m,_,v,x){const w=p.context,T=w.gl;let S,I;const A=p.transform,R=NI(p,w,A),k=(at,X)=>{if(I===X)return;const ft=[fk[X],"PROJECTION_GLOBE_VIEW"];R&&ft.push("CUSTOM_ANTIALIASING");const gt=p.isTileAffectedByFog(at);S=p.getOrCreateProgram("globeRaster",{defines:ft,overrideFog:gt}),I=X},P=p.colorModeForRenderPass(),O=new qe(T.LEQUAL,qe.ReadWrite,p.depthRangeFor3D);mh.update(x);const j=BI(A),G=[Qr(A.center.lng),oi(A.center.lat)],W=p.globeSharedBuffers,Z=[A.width*Ve.devicePixelRatio,A.height*Ve.devicePixelRatio],K=Float32Array.from(A.globeMatrix),Q={useDenormalizedUpVectorScale:!0};{const at=p.transform,X=pk(at.zoom,m.exaggeration(),m.sourceCache._source.tileSize);I=-1;const ft=T.TRIANGLES;for(const gt of v){const vt=_.getTile(gt),ht=ln.disabled,pt=m.prevTerrainTileForTile[gt.key],Ct=m.terrainTileForTile[gt.key];dk(pt,Ct)&&mh.newMorphing(gt.key,pt,Ct,x,250),w.activeTexture.set(T.TEXTURE0),vt.texture&&vt.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE);const At=mh.getMorphValuesForProxy(gt.key),It=At?1:0;At&&Pr(Q,{morphing:{srcDemTile:At.from,dstDemTile:At.to,phase:ne(At.phase)}});const zt=Bm(gt.canonical),Ft=yN(zt.getCenter().lat),Ut=jI(gt.canonical,zt,Ft,at.worldSize/at._pixelsPerMercatorPixel),Pt=Tl(qo(gt.canonical)),Ht=hk(at.expandedFarZProjMatrix,K,j,Pt,fi(at.zoom),G,at.frustumCorners.TL,at.frustumCorners.TR,at.frustumCorners.BR,at.frustumCorners.BL,at.globeCenterInViewSpace,at.globeRadius,Z,X,Ut);if(k(gt,It),S&&(m.setupElevationDraw(vt,S,Q),p.uploadCommonUniforms(w,S,gt.toUnwrapped()),W)){const[he,de,_e]=W.getGridBuffers(Ft,X!==0);S.draw(p,ft,O,ht,P,hn.backCCW,Ht,"globe_raster",he,de,_e)}}}if(W&&(p.renderDefaultNorthPole||p.renderDefaultSouthPole)){const at=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];R&&at.push("CUSTOM_ANTIALIASING"),S=p.getOrCreateProgram("globeRaster",{defines:at});for(const X of v){const{x:ft,y:gt,z:vt}=X.canonical,ht=gt===0,pt=gt===(1<<vt)-1,[Ct,At,It,zt]=W.getPoleBuffers(vt,!1);if(zt&&(ht||pt)){const Ft=_.getTile(X);w.activeTexture.set(T.TEXTURE0),Ft.texture&&Ft.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE);let Ut=FI(vt,ft,A);const Pt=Tl(qo(X.canonical)),Ht=(he,de)=>he.draw(p,T.TRIANGLES,O,ln.disabled,P,hn.disabled,hk(A.expandedFarZProjMatrix,Ut,Ut,Pt,0,G,A.frustumCorners.TL,A.frustumCorners.TR,A.frustumCorners.BR,A.frustumCorners.BL,A.globeCenterInViewSpace,A.globeRadius,Z,0),"globe_pole_raster",de,It,zt);m.setupElevationDraw(Ft,S,Q),p.uploadCommonUniforms(w,S,X.toUnwrapped()),ht&&p.renderDefaultNorthPole&&Ht(S,Ct),pt&&p.renderDefaultSouthPole&&(Ut=wt.scale(wt.create(),Ut,[1,-1,1]),Ht(S,At))}}}})(o,a,c,u,d);else{const p=o.context,m=p.gl;let _,v;const x=o.shadowRenderer,w=ph(o,o.longestCutoffRange),T=P=>{if(v===P)return;const O=[];O.push(fk[P]),w.shouldRenderCutoff&&O.push("RENDER_CUTOFF"),_=o.getOrCreateProgram("terrainRaster",{defines:O}),v=P},S=o.colorModeForRenderPass(),I=new qe(m.LEQUAL,qe.ReadWrite,o.depthRangeFor3D);mh.update(d);const A=o.transform,R=pk(A.zoom,a.exaggeration(),a.sourceCache._source.tileSize);let k=[0,0,0];if(x){const P=o.style.directionalLight,O=o.style.ambientLight;P&&O&&(k=_b(P,O))}{v=-1;const P=m.TRIANGLES,[O,j]=[a.gridIndexBuffer,a.gridSegments];for(const G of u){const W=c.getTile(G),Z=ln.disabled,K=a.prevTerrainTileForTile[G.key],Q=a.terrainTileForTile[G.key];dk(K,Q)&&mh.newMorphing(G.key,K,Q,d,250),p.activeTexture.set(m.TEXTURE0),W.texture&&W.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE);const at=mh.getMorphValuesForProxy(G.key),X=at?1:0;let ft;at&&(ft={morphing:{srcDemTile:at.from,dstDemTile:at.to,phase:ne(at.phase)}});const gt=uk(G.projMatrix,Z$(G.canonical,A.renderWorldCopies)?R/10:R,k);if(T(X),!_)continue;a.setupElevationDraw(W,_,ft);const vt=G.toUnwrapped();x&&x.setupShadows(vt,_),o.uploadCommonUniforms(p,_,vt,null,w),_.draw(o,P,I,Z,S,hn.backCCW,gt,"terrain_raster",a.gridBuffer,O,j)}}}}(n,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,n.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(this._drapedRenderBatches.length===0)return t+1;this.renderingToTexture=!0;const n=this.painter,r=this.painter.context,o=this.proxySourceCache,a=this.proxiedCoords[o.id],c=this._drapedRenderBatches.shift(),u=n.style.order,d=[];let p=0;for(const m of a){const _=o.getTileByID(m.proxyTileKey),v=o.proxyCachedFBO[m.key]?o.proxyCachedFBO[m.key][t]:void 0,x=v!==void 0?o.renderCache[v]:this.pool[p++],w=v!==void 0;if(_.texture=x.tex,w&&!x.dirty){d.push(_.tileID);continue}let T;r.bindFramebuffer.set(x.fb.framebuffer),this.renderedToTile=!1,x.dirty&&(r.clear({color:en.transparent,stencil:0}),x.dirty=!1);for(let S=c.start;S<=c.end;++S){const I=n.style._mergedLayers[u[S]];if(I.isHidden(n.transform.zoom))continue;const A=n.style.getLayerSourceCache(I),R=A?this.proxyToSource[m.key][A.id]:[m];if(!R)continue;const k=R;r.viewport.set([0,0,x.fb.width,x.fb.height]),T!==(A?A.id:null)&&(this._setupStencil(x,R,I,A),T=A?A.id:null),n.renderLayer(n,A,I,k)}if(this._drapedRenderBatches.length===0)for(const S of this._pendingGroundEffectLayers){const I=n.style._mergedLayers[u[S]];if(I.isHidden(n.transform.zoom))continue;const A=n.style.getLayerSourceCache(I),R=A?this.proxyToSource[m.key][A.id]:[m];if(!R)continue;const k=R;r.viewport.set([0,0,x.fb.width,x.fb.height]),T!==(A?A.id:null)&&(this._setupStencil(x,R,I,A),T=A?A.id:null),n.renderLayer(n,A,I,k)}this.renderedToTile?(x.dirty=!0,d.push(_.tileID)):w||--p,p===5&&(p=0,this.renderToBackBuffer(d))}return this.renderToBackBuffer(d),this.renderingToTexture=!1,r.bindFramebuffer.set(null),r.viewport.set([0,0,n.width,n.height]),c.end+1}postRender(){}isLayerOrderingCorrect(t){const n=t.order.length;let r=-1,o=n;for(let a=0;a<n;++a)this._style.isLayerDraped(t._mergedLayers[t.order[a]])?r=Math.max(r,a):o=Math.min(o,a);return o>r}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(n=>n.dem).forEach(n=>{t=Math.min(t,n.dem.tree.minimums[0])}),t===0?t:(t-30)*this._exaggeration}raycast(t,n,r){if(!this._visibleDemTiles)return null;const o=this._visibleDemTiles.filter(a=>a.dem).map(a=>{const c=a.tileID,u=1<<c.overscaledZ,{x:d,y:p}=c.canonical,m=d/u,_=(d+1)/u,v=p/u,x=(p+1)/u;return{minx:m,miny:v,maxx:_,maxy:x,t:a.dem.tree.raycastRoot(m,v,_,x,t,n,r),tile:a}});o.sort((a,c)=>(a.t!==null?a.t:Number.MAX_VALUE)-(c.t!==null?c.t:Number.MAX_VALUE));for(const a of o){if(a.t==null)return null;const c=a.tile.dem.tree.raycast(a.minx,a.miny,a.maxx,a.maxy,t,n,r);if(c!=null)return c}return null}_createFBO(){const t=this.painter.context,n=t.gl,r=this.drapeBufferSize;t.activeTexture.set(n.TEXTURE0);const o=new gr(t,{width:r[0],height:r[1],data:null},n.RGBA);o.bind(n.LINEAR,n.CLAMP_TO_EDGE);const a=t.createFramebuffer(r[0],r[1],!0,null);return a.colorAttachment.set(o.texture),a.depthAttachment=new iU(t,a.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,r[0],r[1]),this._stencilRef=0,a.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):a.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&n.texParameterf(n.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:a,tex:o,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.hasLightTransitions())return!0;for(const t in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const n=this._style._mergedLayers[t],r=n.isHidden(this.painter.transform.zoom);return n.type==="custom"?!r&&n.shouldRedrape():!r&&n.hasTransition()})}_clearLineLayersFromRenderCache(){let t=!1;for(const r of this._style.getSources())if(r instanceof MR){t=!0;break}if(!t)return;const n={};for(let r=0;r<this._style.order.length;++r){const o=this._style._mergedLayers[this._style.order[r]],a=this._style.getLayerSourceCache(o);if(a&&!n[a.id]&&!o.isHidden(this.painter.transform.zoom)&&o.type==="line"&&o.widthExpression()instanceof fl){n[a.id]=!0;for(const c of this.proxyCoords){const u=this.proxyToSource[c.key][a.id];if(u)for(const d of u)this._clearRenderCacheForTile(a.id,d)}}}}_clearRasterLayersFromRenderCache(){let t=!1;for(const r in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[r]._source instanceof H1){t=!0;break}if(!t)return;const n={};for(let r=0;r<this._style.order.length;++r){const o=this._style._mergedLayers[this._style.order[r]],a=this._style.getLayerSourceCache(o);if(!a||n[a.id]||o.isHidden(this.painter.transform.zoom)||o.type!=="raster")continue;const c=o.paint.get("raster-fade-duration");for(const u of this.proxyCoords){const d=this.proxyToSource[u.key][a.id];if(d)for(const p of d){const m=mk(a.getTile(p),a.findLoadedParent(p,0),a,this.painter.transform,c);(m.opacity!==1||m.mix!==0)&&this._clearRenderCacheForTile(a.id,p)}}}}_setupDrapedRenderBatches(){const t=this._style.order,n=t.length;if(n===0)return;const r=[];this._pendingGroundEffectLayers=[];let o,a=0,c=this._style._mergedLayers[t[a]];for(;!this._style.isLayerDraped(c)&&c.isHidden(this.painter.transform.zoom)&&++a<n;)c=this._style._mergedLayers[t[a]];for(;a<n;++a){const u=this._style._mergedLayers[t[a]];u.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(u)?o===void 0&&(o=a):(u.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(a),o!==void 0&&(r.push({start:o,end:a-1}),o=void 0)))}if(o!==void 0&&r.push({start:o,end:a-1}),r.length!==0){const u=r[r.length-1];this._pendingGroundEffectLayers.every(p=>p>u.end)||dt("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=r}_setupRenderCache(t){const n=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,n.renderCache.length>n.renderCachePool.length){const c=Object.values(n.proxyCachedFBO);n.proxyCachedFBO={};for(let u=0;u<c.length;++u){const d=Object.values(c[u]);n.renderCachePool.push(...d)}}return}this._clearRasterLayersFromRenderCache();const r=this.proxyCoords,o=this._tilesDirty;for(let c=r.length-1;c>=0;c--){const u=r[c];if(n.getTileByID(u.key),n.proxyCachedFBO[u.key]!==void 0){const d=t[u.key],p=this.proxyToSource[u.key];let m=0;for(const _ in p){const v=p[_],x=d[_];if(!x||x.length!==v.length||v.some((w,T)=>w!==x[T]||o[_]&&o[_].hasOwnProperty(w.key))){m=-1;break}++m}for(const _ in n.proxyCachedFBO[u.key])n.renderCache[n.proxyCachedFBO[u.key][_]].dirty=m<0||m!==Object.values(d).length}}const a=[...this._drapedRenderBatches];a.sort((c,u)=>u.end-u.start-(c.end-c.start));for(const c of a)for(const u of r){if(n.proxyCachedFBO[u.key])continue;let d=n.renderCachePool.pop();d===void 0&&n.renderCache.length<50&&(d=n.renderCache.length,n.renderCache.push(this._createFBO())),d!==void 0&&(n.proxyCachedFBO[u.key]={},n.proxyCachedFBO[u.key][c.start]=d,n.renderCache[d].dirty=!0)}this._tilesDirty={}}_setupStencil(t,n,r,o){if(!o||!this._sourceTilesOverlap[o.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const a=this.painter.context,c=a.gl;if(n.length<=1)return void(this._overlapStencilType=!1);let u;if(r.isTileClipped())u=n.length,this._overlapStencilMode.test={func:c.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(n[0].overscaledZ>n[n.length-1].overscaledZ))return void(this._overlapStencilType=!1);u=1,this._overlapStencilMode.test={func:c.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+u>255&&(a.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=u,this._overlapStencilMode.ref=this._stencilRef,r.isTileClipped()&&this._renderTileClippingMasks(n,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):ln.disabled}_renderTileClippingMasks(t,n){const r=this.painter,o=this.painter.context,a=o.gl;r._tileClippingMaskIDs={},o.setColorMode(Mn.disabled),o.setDepthMode(qe.disabled);const c=r.getOrCreateProgram("clippingMask");for(const u of t){const d=r._tileClippingMaskIDs[u.key]=--n;c.draw(r,a.TRIANGLES,qe.disabled,new ln({func:a.ALWAYS,mask:0},d,255,a.KEEP,a.KEEP,a.REPLACE),Mn.disabled,hn.disabled,db(u.projMatrix),"$clipping",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments)}}pointCoordinate(t){const n=this.painter.transform;if(t.x<0||t.x>n.width||t.y<0||t.y>n.height)return null;const r=[t.x,t.y,1,1];Wn.transformMat4(r,r,n.pixelMatrixInverse),Wn.scale(r,r,1/r[3]),r[0]/=n.worldSize,r[1]/=n.worldSize;const o=n._camera.position,a=Hn(1,n.center.lat),c=[o[0],o[1],o[2]/a,0],u=ot.subtract([],r.slice(0,3),c);ot.normalize(u,u);const d=this.raycast(c,u,this._exaggeration);return d!==null&&d?(ot.scaleAndAdd(c,c,u,d),c[3]=c[2],c[2]*=a,c):null}drawDepth(){const t=this.painter,n=t.context,r=this.proxySourceCache,o=Math.ceil(t.width),a=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===o&&this._depthFBO.height===a||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const c=n.gl,u=n.createFramebuffer(o,a,!0,"renderbuffer");n.activeTexture.set(c.TEXTURE0);const d=new gr(n,{width:o,height:a,data:null},c.RGBA);d.bind(c.NEAREST,c.CLAMP_TO_EDGE),u.colorAttachment.set(d.texture);const p=n.createRenderbuffer(n.gl.DEPTH_COMPONENT16,o,a);u.depthAttachment.set(p),this._depthFBO=u,this._depthTexture=d}n.bindFramebuffer.set(this._depthFBO.framebuffer),n.viewport.set([0,0,o,a]),function(c,u,d,p){if(c.transform.projection.name==="globe")return;const m=c.context,_=m.gl;m.clear({depth:1});const v=c.getOrCreateProgram("terrainDepth"),x=new qe(_.LESS,qe.ReadWrite,c.depthRangeFor3D);for(const w of p){const T=d.getTile(w),S=uk(w.projMatrix,0,[0,0,0]);u.setupElevationDraw(T,v),v.draw(c,_.TRIANGLES,x,ln.disabled,Mn.unblended,hn.backCCW,S,"terrain_depth",u.gridBuffer,u.gridIndexBuffer,u.gridNoSkirtSegments)}}(t,this,r,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,n,r){if(t.getSource()instanceof ms)return this._setupProxiedCoordsForImageSource(t,n,r);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const o=this.proxiedCoords[t.id]=[],a=this.proxyCoords;for(let u=0;u<a.length;u++){const d=a[u],p=this._findTileCoveringTileID(d,t);if(p){const m=this._createProxiedId(d,p,r[d.key]&&r[d.key][t.id]);o.push(m),this.proxyToSource[d.key][t.id]=[m]}}let c=!1;for(let u=0;u<n.length;u++){const d=t.getTile(n[u]);if(!d||!d.hasData())continue;const p=this._findTileCoveringTileID(d.tileID,this.proxySourceCache);if(p&&p.tileID.canonical.z!==d.tileID.canonical.z){const m=this.proxyToSource[p.tileID.key][t.id],_=this._createProxiedId(p.tileID,d,r[p.tileID.key]&&r[p.tileID.key][t.id]);m?m.splice(m.length-1,0,_):this.proxyToSource[p.tileID.key][t.id]=[_],o.push(_),c=!0}}this._sourceTilesOverlap[t.id]=c}_setupProxiedCoordsForImageSource(t,n,r){if(!t.getSource().loaded())return;const o=this.proxiedCoords[t.id]=[],a=this.proxyCoords,c=t.getSource(),u=c.tileID;if(!u)return;const d=new N(u.x,u.y)._div(1<<u.z),p=c.coordinates.map(xn.fromLngLat).reduce((_,v)=>(_.min.x=Math.min(_.min.x,v.x-d.x),_.min.y=Math.min(_.min.y,v.y-d.y),_.max.x=Math.max(_.max.x,v.x-d.x),_.max.y=Math.max(_.max.y,v.y-d.y),_),{min:new N(Number.MAX_VALUE,Number.MAX_VALUE),max:new N(-Number.MAX_VALUE,-Number.MAX_VALUE)}),m=(_,v)=>{const x=_.wrap+_.canonical.x/(1<<_.canonical.z),w=_.canonical.y/(1<<_.canonical.z),T=Rt/(1<<_.canonical.z),S=v.wrap+v.canonical.x/(1<<v.canonical.z),I=v.canonical.y/(1<<v.canonical.z);return x+T<S+p.min.x||x>S+p.max.x||w+T<I+p.min.y||w>I+p.max.y};for(let _=0;_<a.length;_++){const v=a[_];for(let x=0;x<n.length;x++){const w=t.getTile(n[x]);if(!w||!w.hasData()||m(v,w.tileID))continue;const T=this._createProxiedId(v,w,r[v.key]&&r[v.key][t.id]),S=this.proxyToSource[v.key][t.id];S?S.push(T):this.proxyToSource[v.key][t.id]=[T],o.push(T)}}}_createProxiedId(t,n,r){let o=this.orthoMatrix;if(r){const a=r.find(c=>c.key===n.tileID.key);if(a)return a}if(n.tileID.key!==t.key){const a=t.canonical.z-n.tileID.canonical.z;let c,u,d;o=wt.create();const p=n.tileID.wrap-t.wrap<<t.overscaledZ;a>0?(c=Rt>>a,u=c*((n.tileID.canonical.x<<a)-t.canonical.x+p),d=c*((n.tileID.canonical.y<<a)-t.canonical.y)):(c=Rt<<-a,u=Rt*(n.tileID.canonical.x-(t.canonical.x+p<<-a)),d=Rt*(n.tileID.canonical.y-(t.canonical.y<<-a))),wt.ortho(o,0,c,0,c,0,1),wt.translate(o,o,[u,d,0])}return new gk(n.tileID,t.key,o)}_findTileCoveringTileID(t,n){let r=n.getTile(t);if(r&&r.hasData())return r;const o=this._findCoveringTileCache[n.id],a=o[t.key];if(r=a?n.getTileByID(a):null,r&&r.hasData()||a===null)return r;let c=r?r.tileID:t,u=c.overscaledZ;const d=n.getSource().minzoom,p=[];if(!a){const _=n.getSource().maxzoom;if(t.canonical.z>=_){const v=t.canonical.z-_;n.getSource().reparseOverscaled?(u=Math.max(t.canonical.z+2,n.transform.tileZoom),c=new Pn(u,t.wrap,_,t.canonical.x>>v,t.canonical.y>>v)):v!==0&&(u=_,c=new Pn(u,t.wrap,_,t.canonical.x>>v,t.canonical.y>>v))}c.key!==t.key&&(p.push(c.key),r=n.getTile(c))}const m=_=>{p.forEach(v=>{o[v]=_}),p.length=0};for(u-=1;u>=d&&(!r||!r.hasData());u--){r&&m(r.tileID.key);const _=c.calculateScaledKey(u);if(r=n.getTileByID(_),r&&r.hasData())break;const v=o[_];if(v===null)break;v===void 0?p.push(_):r=n.getTileByID(v)}return m(r?r.tileID.key:null),r&&r.hasData()?r:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,n){let r=this._tilesDirty[t];r||(r=this._tilesDirty[t]={}),r[n.key]=!0}}function Q$(e,t,n){const r=function(u,d,p){const m=ot.dot(d,u),_=ot.dot(p,[.2126,.7152,.0722]),v=(w,T,S)=>(1-S)*w+S*T,x=v(1-.3*Math.min(_,1),1,Math.min(m+1,1));return v(.92,1,Math.asin(jt(d[2],-1,1))/Math.PI+.5)*x}(e,[0,0,1],t),o=[0,0,0];ot.scale(o,n.slice(0,3),r);const a=[0,0,0];ot.scale(a,t.slice(0,3),e[2]);const c=[0,0,0];return ot.add(c,o,a),ke(c)}const J$=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],t8=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class _k{static cacheKey(t,n,r,o){let a=`${n}${o?o.cacheKey:""}`;for(const c of r)t.usedDefines.includes(c)&&(a+=`/${c}`);return a}constructor(t,n,r,o,a,c){const u=t.gl;this.program=u.createProgram(),this.configuration=o,this.name=n,this.fixedDefines=[...c];const d=o?o.getBinderAttributes():[],p=(r.staticAttributes||[]).concat(d);let m=o?o.defines():[];m=m.concat(c.map(S=>`#define ${S}`));const _=`#version 300 es
`;let v=_+m.concat("precision mediump float;",sk,ok.fragmentSource).join(`
`);for(const S of r.fragmentIncludes)v+=`
${Ug[S]}`;v+=`
${r.fragmentSource}`;let x=_+m.concat("precision highp float;",sk,ok.vertexSource).join(`
`);for(const S of r.vertexIncludes)x+=`
${Ug[S]}`;x+=`
${r.vertexSource}`;const w=u.createShader(u.FRAGMENT_SHADER);if(u.isContextLost())return void(this.failedToCreate=!0);u.shaderSource(w,v),u.compileShader(w),u.attachShader(this.program,w);const T=u.createShader(u.VERTEX_SHADER);if(u.isContextLost())this.failedToCreate=!0;else{u.shaderSource(T,x),u.compileShader(T),u.attachShader(this.program,T),this.attributes={},this.numAttributes=p.length;for(let S=0;S<this.numAttributes;S++)if(p[S]){const I=p[S].startsWith("a_")?p[S]:`a_${p[S]}`;u.bindAttribLocation(this.program,S,I),this.attributes[I]=S}u.linkProgram(this.program),u.deleteShader(T),u.deleteShader(w),this.fixedUniforms=a(t),this.binderUniforms=o?o.getUniforms(t):[],c.includes("TERRAIN")&&(this.terrainUniforms=(S=>({u_dem:new dn(S),u_dem_prev:new dn(S),u_dem_tl:new fn(S),u_dem_scale:new Kt(S),u_dem_tl_prev:new fn(S),u_dem_scale_prev:new Kt(S),u_dem_size:new Kt(S),u_dem_lerp:new Kt(S),u_exaggeration:new Kt(S),u_depth:new dn(S),u_depth_size_inv:new fn(S),u_meter_to_dem:new Kt(S),u_label_plane_matrix_inv:new Je(S)}))(t)),c.includes("GLOBE")&&(this.globeUniforms=(S=>({u_tile_tl_up:new nn(S),u_tile_tr_up:new nn(S),u_tile_br_up:new nn(S),u_tile_bl_up:new nn(S),u_tile_up_scale:new Kt(S)}))(t)),c.includes("FOG")&&(this.fogUniforms=(S=>({u_fog_matrix:new Je(S),u_fog_range:new fn(S),u_fog_color:new wo(S),u_fog_horizon_blend:new Kt(S),u_fog_vertical_limit:new fn(S),u_fog_temporal_offset:new Kt(S),u_frustum_tl:new nn(S),u_frustum_tr:new nn(S),u_frustum_br:new nn(S),u_frustum_bl:new nn(S),u_globe_pos:new nn(S),u_globe_radius:new Kt(S),u_globe_transition:new Kt(S),u_is_globe:new dn(S),u_viewport:new fn(S)}))(t)),c.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(S=>({u_cutoff_params:new wo(S)}))(t)),c.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(S=>({u_lighting_ambient_color:new nn(S),u_lighting_directional_dir:new nn(S),u_lighting_directional_color:new nn(S),u_ground_radiance:new nn(S)}))(t)),c.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(S=>({u_light_matrix_0:new Je(S),u_light_matrix_1:new Je(S),u_fade_range:new fn(S),u_shadow_normal_offset:new nn(S),u_shadow_intensity:new Kt(S),u_shadow_texel_size:new Kt(S),u_shadow_map_resolution:new Kt(S),u_shadow_direction:new nn(S),u_shadow_bias:new nn(S),u_shadowmap_0:new dn(S),u_shadowmap_1:new dn(S)}))(t))}}setTerrainUniformValues(t,n){if(!this.terrainUniforms)return;const r=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const o in n)r[o]&&r[o].set(this.program,o,n[o])}}setGlobeUniformValues(t,n){if(!this.globeUniforms)return;const r=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const o in n)r[o]&&r[o].set(this.program,o,n[o])}}setFogUniformValues(t,n){if(!this.fogUniforms)return;const r=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const o in n)r[o].set(this.program,o,n[o])}}setCutoffUniformValues(t,n){if(!this.cutoffUniforms)return;const r=this.cutoffUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const o in n)r[o].set(this.program,o,n[o])}}setLightsUniformValues(t,n){if(!this.lightsUniforms)return;const r=this.lightsUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const o in n)r[o].set(this.program,o,n[o])}}setShadowUniformValues(t,n){if(this.failedToCreate||!this.shadowUniforms)return;const r=this.shadowUniforms;t.program.set(this.program);for(const o in n)r[o].set(this.program,o,n[o])}_drawDebugWireframe(t,n,r,o,a,c,u,d,p,m){const _=t.options.wireframe;if(_.terrain===!1&&_.layers2D===!1&&_.layers3D===!1)return;const v=t.context;if(!(!(!_.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!_.layers2D||t._terrain&&t._terrain.renderingToTexture||!J$.includes(this.name))||!(!_.layers3D||!t8.includes(this.name))))return;const x=v.gl,w=t.wireframeDebugCache.getLinesFromTrianglesBuffer(t.frameCounter,a,v);if(!w)return;const T=[...this.fixedDefines];T.push("DEBUG_WIREFRAME");const S=t.getOrCreateProgram(this.name,{config:this.configuration,defines:T});v.program.set(S.program);const I=(k,P,O)=>{if(P[k]&&O[k])for(const j in P[k])O[k][j]&&O[k][j].set(O.program,j,P[k][j].current)};p&&p.setUniforms(S.program,v,S.binderUniforms,u,{zoom:d}),I("fixedUniforms",this,S),I("terrainUniforms",this,S),I("globeUniforms",this,S),I("fogUniforms",this,S),I("lightsUniforms",this,S),I("shadowUniforms",this,S),w.bind(),v.setColorMode(new Mn([x.ONE,x.ONE_MINUS_SRC_ALPHA,x.ZERO,x.ONE],en.transparent,[!0,!0,!0,!1])),v.setDepthMode(new qe(n.func===x.LESS?x.LEQUAL:n.func,qe.ReadOnly,n.range)),v.setStencilMode(ln.disabled);const A=3*c.primitiveLength*2,R=3*c.primitiveOffset*2*2;m&&m>1?x.drawElementsInstanced(x.LINES,A,x.UNSIGNED_SHORT,R,m):x.drawElements(x.LINES,A,x.UNSIGNED_SHORT,R),a.bind(),v.program.set(this.program),v.setDepthMode(n),v.setStencilMode(r),v.setColorMode(o)}draw(t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S){const I=t.context,A=I.gl;if(this.failedToCreate)return;I.program.set(this.program),I.setDepthMode(r),I.setStencilMode(o),I.setColorMode(a),I.setCullFace(c);for(const P of Object.keys(this.fixedUniforms))this.fixedUniforms[P].set(this.program,P,u[P]);w&&w.setUniforms(this.program,I,this.binderUniforms,v,{zoom:x});const R={[A.LINES]:2,[A.TRIANGLES]:3,[A.LINE_STRIP]:1}[n],k=S&&S>0?1:void 0;for(const P of _.get()){const O=P.vaos||(P.vaos={});(O[d]||(O[d]=new G$)).bind(I,this,p,w?w.getPaintVertexBuffers():[],m,P.vertexOffset,T||[],k),S&&S>1?A.drawElementsInstanced(n,P.primitiveLength*R,A.UNSIGNED_SHORT,P.primitiveOffset*R*2,S):A.drawElements(n,P.primitiveLength*R,A.UNSIGNED_SHORT,P.primitiveOffset*R*2),n===A.TRIANGLES&&this._drawDebugWireframe(t,r,o,a,m,P,v,x,w,S)}}}function yk(e,t){const n=Math.pow(2,t.tileID.overscaledZ),r=t.tileSize*Math.pow(2,e.transform.tileZoom)/n,o=r*(t.tileID.canonical.x+t.tileID.wrap*n),a=r*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/Lc(t,1,e.transform.tileZoom),u_pixel_coord_upper:[o>>16,a>>16],u_pixel_coord_lower:[65535&o,65535&a]}}const e8=wt.create(),vk=(e,t,n,r,o,a,c,u,d,p,m,_,v,x,w,T)=>{const S=t.style.light,I=S.properties.get("position"),A=[I.x,I.y,I.z],R=ho.create();S.properties.get("anchor")==="viewport"&&(ho.fromRotation(R,-t.transform.angle),ot.transformMat3(A,A,R));const k=S.properties.get("color"),P=t.transform,O={u_matrix:e,u_lightpos:A,u_lightintensity:S.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+n,u_opacity:r,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:e8,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:o,u_edge_radius:a,u_flood_light_color:_,u_vertical_scale:v,u_flood_light_intensity:x,u_ground_shadow_factor:w,u_emissive_strength:T};return P.projection.name==="globe"&&(O.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],O.u_zoom_transition=d,O.u_inv_rot_matrix=m,O.u_merc_center=p,O.u_up_dir=P.projection.upVector(new hs(0,0,0),p[0]*Rt,p[1]*Rt),O.u_height_lift=u),O},n8=(e,t,n)=>({u_matrix:e,u_edge_radius:t,u_vertical_scale:n}),r8=(e,t,n,r,o,a,c,u,d,p,m,_,v,x)=>{const w=vk(e,t,n,r,o,a,c,d,p,m,_,v,x,1,[0,0,0],0),T={u_height_factor:-Math.pow(2,c.overscaledZ)/u.tileSize/8};return Ot(w,yk(t,u),T)},xk=(e,t)=>({u_matrix:e,u_emissive_strength:t}),bk=(e,t,n,r)=>Ot(xk(e,t),yk(n,r)),i8=(e,t,n)=>({u_matrix:e,u_world:n,u_emissive_strength:t}),o8=(e,t,n,r,o)=>Ot(bk(e,t,n,r),{u_world:o}),s8=(e,t,n,r)=>{const o=Rt/n.tileSize;return{u_matrix:e,u_camera_to_center_distance:t.getCameraToCenterDistance(r),u_extrude_scale:[t.pixelsToGLUnits[0]/o,t.pixelsToGLUnits[1]/o]}},wk=(e,t,n=1)=>({u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:n}),a8=wt.create(),l8=(e,t,n,r,o,a,c)=>{const u=e.transform,d=u.projection.name==="globe",p=d?zI(u.zoom,t.canonical)*u._pixelsPerMercatorPixel:Lc(n,1,a),m={u_matrix:t.projMatrix,u_extrude_scale:p,u_intensity:c,u_inv_rot_matrix:a8,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(d){m.u_inv_rot_matrix=r,m.u_merc_center=o,m.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],m.u_zoom_transition=fi(u.zoom);const _=o[0]*Rt,v=o[1]*Rt;m.u_up_dir=u.projection.upVector(new hs(0,0,0),_,v)}return m},Tk=(e,t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S,I,A,R,k,P)=>{return{u_matrix:e,u_normalize_matrix:t,u_globe_matrix:n,u_merc_matrix:r,u_grid_matrix:o,u_tl_parent:a,u_scale_parent:m,u_fade_t:_.mix,u_opacity:_.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(j=v.paint.get("raster-saturation"),j>0?1-1/(1.001-j):-j),u_contrast_factor:(O=v.paint.get("raster-contrast"),O>0?1/(1-O):1+O),u_spin_weights:c8(v.paint.get("raster-hue-rotate")),u_perspective_transform:x,u_raster_elevation:w,u_tl_br:c,u_zoom_transition:u,u_merc_center:d,u_cutoff_params:p,u_colorization_mix:u8(S,A),u_colorization_offset:h8(I,A),u_color_ramp:T,u_texture_offset:[k/(R+2*k),R/(R+2*k)],u_texture_res:[R+2*k,R+2*k],u_emissive_strength:P};var O,j};function c8(e){e*=Math.PI/180;const t=Math.sin(e),n=Math.cos(e);return[(2*n+1)/3,(-Math.sqrt(3)*t-n+1)/3,(Math.sqrt(3)*t-n+1)/3]}function u8([e,t,n,r],[o,a]){if(o===a)return[0,0,0,0];const c=259/257/(a-o);return[e*c,t*c,n*c,r*c]}function h8(e,[t,n]){return t===n?0:((e-t)/(n-t)*259-1)/257}const Sk=wt.create(),Ek=(e,t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S,I)=>{const A=o.transform,R={u_is_size_zoom_constant:+(e==="constant"||e==="source"),u_is_size_feature_constant:+(e==="constant"||e==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:A.getCameraToCenterDistance(T),u_rotate_symbol:+n,u_aspect_ratio:A.width/A.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_matrix:a,u_label_plane_matrix:c,u_coord_matrix:u,u_is_text:+d,u_pitch_with_map:+r,u_texsize:p,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Sk,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Sk,u_up_vector:[0,-1,0],u_icon_transition:I||0,u_icon_saturation:S};return T.name==="globe"&&(R.u_tile_id=[m.canonical.x,m.canonical.y,1<<m.canonical.z],R.u_zoom_transition=_,R.u_inv_rot_matrix=x,R.u_merc_center=v,R.u_camera_forward=A._camera.forward(),R.u_ecef_origin=function(k,P){const O=[0,0,0],j=Tl(qo(P.canonical));return ot.transformMat4(O,O,j),ot.transformMat4(O,O,k),O}(A.globeMatrix,m.toUnwrapped()),R.u_tile_matrix=Float32Array.from(A.globeMatrix),R.u_up_vector=w),R},Ck=(e,t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S)=>Ot(Ek(e,t,n,r,o,a,c,u,d,p,_,v,x,w,T,S,1),{u_gamma_scale:r?o.transform.getCameraToCenterDistance(S)*Math.cos(o.terrain?0:o.transform._pitch):1,u_device_pixel_ratio:Ve.devicePixelRatio,u_is_halo:+m,undefined:void 0}),d8=(e,t,n,r,o,a,c,u,d,p,m,_,v,x,w,T)=>Ot(Ck(e,t,n,r,o,a,c,u,!0,d,!0,m,_,v,x,w,T),{u_texsize_icon:p,u_texture_icon:1}),f8=(e,t,n,r)=>({u_matrix:e,u_emissive_strength:t,u_opacity:n,u_color:r}),p8=(e,t,n,r,o,a,c)=>Ot(function(u,d,p,m){const _=p.imageManager.getPattern(u.toString(),d),{width:v,height:x}=p.imageManager.getPixelSize(d),w=Math.pow(2,m.tileID.overscaledZ),T=m.tileSize*Math.pow(2,p.transform.tileZoom)/w,S=T*(m.tileID.canonical.x+m.tileID.wrap*w),I=T*m.tileID.canonical.y;return{u_image:0,u_pattern_tl:_.tl,u_pattern_br:_.br,u_texsize:[v,x],u_pattern_size:_.displaySize,u_tile_units_to_pixels:1/Lc(m,1,p.transform.tileZoom),u_pixel_coord_upper:[S>>16,I>>16],u_pixel_coord_lower:[65535&S,65535&I]}}(o,a,r,c),{u_matrix:e,u_emissive_strength:t,u_opacity:n}),Co={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},fb=(e,t,n,r,o,a,c,u,d,p,m,_,v=[0,0,0])=>{const x=r.style.light,w=x.properties.get("position"),T=[-w.x,-w.y,w.z],S=ho.create();x.properties.get("anchor")==="viewport"&&(ho.fromRotation(S,-r.transform.angle),ot.transformMat3(T,T,S));const I=p.alphaMode==="MASK",A=x.properties.get("color"),R=_.paint.get("model-ambient-occlusion-intensity"),k=_.paint.get("model-color").constantOr(en.white),P=_.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:e,u_lighting_matrix:t,u_normal_matrix:n,u_lightpos:T,u_lightintensity:x.properties.get("intensity"),u_lightcolor:[A.r,A.g,A.b],u_camera_pos:v,u_opacity:o,u_baseTextureIsAlpha:0,u_alphaMask:+I,u_alphaCutoff:p.alphaCutoff,u_baseColorFactor:[a.r,a.g,a.b,a.a],u_emissiveFactor:[c[0],c[1],c[2],1],u_metallicFactor:u,u_roughnessFactor:d,u_baseColorTexture:Co.BaseColor,u_metallicRoughnessTexture:Co.MetallicRoughness,u_normalTexture:Co.Normal,u_occlusionTexture:Co.Occlusion,u_emissionTexture:Co.Emission,u_color_mix:[k.r,k.g,k.b,P],u_aoIntensity:R,u_emissive_strength:m}},Mk=new Float32Array(16),Ik=(e,t=Mk,n=Mk)=>({u_matrix:e,u_instance:t,u_node_matrix:n}),m8={fillExtrusion:e=>({u_matrix:new Je(e),u_lightpos:new nn(e),u_lightintensity:new Kt(e),u_lightcolor:new nn(e),u_vertical_gradient:new Kt(e),u_opacity:new Kt(e),u_edge_radius:new Kt(e),u_ao:new fn(e),u_tile_id:new nn(e),u_zoom_transition:new Kt(e),u_inv_rot_matrix:new Je(e),u_merc_center:new fn(e),u_up_dir:new nn(e),u_height_lift:new Kt(e),u_flood_light_color:new nn(e),u_vertical_scale:new Kt(e),u_flood_light_intensity:new Kt(e),u_ground_shadow_factor:new nn(e),u_emissive_strength:new Kt(e)}),fillExtrusionDepth:e=>({u_matrix:new Je(e),u_edge_radius:new Kt(e),u_vertical_scale:new Kt(e)}),fillExtrusionPattern:e=>({u_matrix:new Je(e),u_lightpos:new nn(e),u_lightintensity:new Kt(e),u_lightcolor:new nn(e),u_vertical_gradient:new Kt(e),u_height_factor:new Kt(e),u_edge_radius:new Kt(e),u_ao:new fn(e),u_tile_id:new nn(e),u_zoom_transition:new Kt(e),u_inv_rot_matrix:new Je(e),u_merc_center:new fn(e),u_up_dir:new nn(e),u_height_lift:new Kt(e),u_image:new dn(e),u_texsize:new fn(e),u_pixel_coord_upper:new fn(e),u_pixel_coord_lower:new fn(e),u_tile_units_to_pixels:new Kt(e),u_opacity:new Kt(e)}),fillExtrusionGroundEffect:e=>({u_matrix:new Je(e),u_opacity:new Kt(e),u_ao_pass:new Kt(e),u_meter_to_tile:new Kt(e),u_ao:new fn(e),u_flood_light_intensity:new Kt(e),u_flood_light_color:new nn(e),u_attenuation:new Kt(e),u_edge_radius:new Kt(e),u_fb:new dn(e),u_fb_size:new Kt(e)}),fill:e=>({u_matrix:new Je(e),u_emissive_strength:new Kt(e)}),fillPattern:e=>({u_matrix:new Je(e),u_emissive_strength:new Kt(e),u_image:new dn(e),u_texsize:new fn(e),u_pixel_coord_upper:new fn(e),u_pixel_coord_lower:new fn(e),u_tile_units_to_pixels:new Kt(e)}),fillOutline:e=>({u_matrix:new Je(e),u_emissive_strength:new Kt(e),u_world:new fn(e)}),fillOutlinePattern:e=>({u_matrix:new Je(e),u_emissive_strength:new Kt(e),u_world:new fn(e),u_image:new dn(e),u_texsize:new fn(e),u_pixel_coord_upper:new fn(e),u_pixel_coord_lower:new fn(e),u_tile_units_to_pixels:new Kt(e)}),circle:e=>({u_camera_to_center_distance:new Kt(e),u_extrude_scale:new Mx(e),u_device_pixel_ratio:new Kt(e),u_matrix:new Je(e),u_inv_rot_matrix:new Je(e),u_merc_center:new fn(e),u_tile_id:new nn(e),u_zoom_transition:new Kt(e),u_up_dir:new nn(e),u_emissive_strength:new Kt(e)}),collisionBox:e=>({u_matrix:new Je(e),u_camera_to_center_distance:new Kt(e),u_extrude_scale:new fn(e)}),collisionCircle:e=>({u_matrix:new Je(e),u_inv_matrix:new Je(e),u_camera_to_center_distance:new Kt(e),u_viewport_size:new fn(e)}),debug:e=>({u_color:new Wu(e),u_matrix:new Je(e),u_overlay:new dn(e),u_overlay_scale:new Kt(e)}),clippingMask:e=>({u_matrix:new Je(e)}),heatmap:e=>({u_extrude_scale:new Kt(e),u_intensity:new Kt(e),u_matrix:new Je(e),u_inv_rot_matrix:new Je(e),u_merc_center:new fn(e),u_tile_id:new nn(e),u_zoom_transition:new Kt(e),u_up_dir:new nn(e)}),heatmapTexture:e=>({u_image:new dn(e),u_color_ramp:new dn(e),u_opacity:new Kt(e)}),hillshade:e=>({u_matrix:new Je(e),u_image:new dn(e),u_latrange:new fn(e),u_light:new fn(e),u_shadow:new Wu(e),u_highlight:new Wu(e),u_emissive_strength:new Kt(e),u_accent:new Wu(e)}),hillshadePrepare:e=>({u_matrix:new Je(e),u_image:new dn(e),u_dimension:new fn(e),u_zoom:new Kt(e)}),line:e=>({u_matrix:new Je(e),u_pixels_to_tile_units:new Mx(e),u_device_pixel_ratio:new Kt(e),u_units_to_pixels:new fn(e),u_dash_image:new dn(e),u_gradient_image:new dn(e),u_image_height:new Kt(e),u_texsize:new fn(e),u_tile_units_to_pixels:new Kt(e),u_alpha_discard_threshold:new Kt(e),u_trim_offset:new fn(e),u_emissive_strength:new Kt(e)}),linePattern:e=>({u_matrix:new Je(e),u_texsize:new fn(e),u_pixels_to_tile_units:new Mx(e),u_device_pixel_ratio:new Kt(e),u_image:new dn(e),u_units_to_pixels:new fn(e),u_tile_units_to_pixels:new Kt(e),u_alpha_discard_threshold:new Kt(e)}),raster:e=>({u_matrix:new Je(e),u_normalize_matrix:new Je(e),u_globe_matrix:new Je(e),u_merc_matrix:new Je(e),u_grid_matrix:new Cx(e),u_tl_parent:new fn(e),u_scale_parent:new Kt(e),u_fade_t:new Kt(e),u_opacity:new Kt(e),u_image0:new dn(e),u_image1:new dn(e),u_brightness_low:new Kt(e),u_brightness_high:new Kt(e),u_saturation_factor:new Kt(e),u_contrast_factor:new Kt(e),u_spin_weights:new nn(e),u_perspective_transform:new fn(e),u_raster_elevation:new Kt(e),u_tl_br:new wo(e),u_zoom_transition:new Kt(e),u_merc_center:new fn(e),u_cutoff_params:new wo(e),u_colorization_mix:new wo(e),u_colorization_offset:new Kt(e),u_color_ramp:new dn(e),u_texture_offset:new fn(e),u_texture_res:new fn(e),u_emissive_strength:new Kt(e)}),symbolIcon:e=>({u_is_size_zoom_constant:new dn(e),u_is_size_feature_constant:new dn(e),u_size_t:new Kt(e),u_size:new Kt(e),u_camera_to_center_distance:new Kt(e),u_rotate_symbol:new dn(e),u_aspect_ratio:new Kt(e),u_fade_change:new Kt(e),u_matrix:new Je(e),u_label_plane_matrix:new Je(e),u_coord_matrix:new Je(e),u_is_text:new dn(e),u_pitch_with_map:new dn(e),u_texsize:new fn(e),u_tile_id:new nn(e),u_zoom_transition:new Kt(e),u_inv_rot_matrix:new Je(e),u_merc_center:new fn(e),u_camera_forward:new nn(e),u_tile_matrix:new Je(e),u_up_vector:new nn(e),u_ecef_origin:new nn(e),u_texture:new dn(e),u_icon_transition:new Kt(e),u_icon_saturation:new Kt(e)}),symbolSDF:e=>({u_is_size_zoom_constant:new dn(e),u_is_size_feature_constant:new dn(e),u_size_t:new Kt(e),u_size:new Kt(e),u_camera_to_center_distance:new Kt(e),u_rotate_symbol:new dn(e),u_aspect_ratio:new Kt(e),u_fade_change:new Kt(e),u_matrix:new Je(e),u_label_plane_matrix:new Je(e),u_coord_matrix:new Je(e),u_is_text:new dn(e),u_pitch_with_map:new dn(e),u_texsize:new fn(e),u_texture:new dn(e),u_gamma_scale:new Kt(e),u_device_pixel_ratio:new Kt(e),u_tile_id:new nn(e),u_zoom_transition:new Kt(e),u_inv_rot_matrix:new Je(e),u_merc_center:new fn(e),u_camera_forward:new nn(e),u_tile_matrix:new Je(e),u_up_vector:new nn(e),u_ecef_origin:new nn(e),u_is_halo:new dn(e)}),symbolTextAndIcon:e=>({u_is_size_zoom_constant:new dn(e),u_is_size_feature_constant:new dn(e),u_size_t:new Kt(e),u_size:new Kt(e),u_camera_to_center_distance:new Kt(e),u_rotate_symbol:new dn(e),u_aspect_ratio:new Kt(e),u_fade_change:new Kt(e),u_matrix:new Je(e),u_label_plane_matrix:new Je(e),u_coord_matrix:new Je(e),u_is_text:new dn(e),u_pitch_with_map:new dn(e),u_texsize:new fn(e),u_texsize_icon:new fn(e),u_texture:new dn(e),u_texture_icon:new dn(e),u_gamma_scale:new Kt(e),u_device_pixel_ratio:new Kt(e),u_is_halo:new dn(e)}),background:e=>({u_matrix:new Je(e),u_emissive_strength:new Kt(e),u_opacity:new Kt(e),u_color:new Wu(e)}),backgroundPattern:e=>({u_matrix:new Je(e),u_emissive_strength:new Kt(e),u_opacity:new Kt(e),u_image:new dn(e),u_pattern_tl:new fn(e),u_pattern_br:new fn(e),u_texsize:new fn(e),u_pattern_size:new fn(e),u_pixel_coord_upper:new fn(e),u_pixel_coord_lower:new fn(e),u_tile_units_to_pixels:new Kt(e)}),terrainRaster:ck,terrainDepth:ck,skybox:e=>({u_matrix:new Je(e),u_sun_direction:new nn(e),u_cubemap:new dn(e),u_opacity:new Kt(e),u_temporal_offset:new Kt(e)}),skyboxGradient:e=>({u_matrix:new Je(e),u_color_ramp:new dn(e),u_center_direction:new nn(e),u_radius:new Kt(e),u_opacity:new Kt(e),u_temporal_offset:new Kt(e)}),skyboxCapture:e=>({u_matrix_3f:new Cx(e),u_sun_direction:new nn(e),u_sun_intensity:new Kt(e),u_color_tint_r:new wo(e),u_color_tint_m:new wo(e),u_luminance:new Kt(e)}),globeRaster:e=>({u_proj_matrix:new Je(e),u_globe_matrix:new Je(e),u_normalize_matrix:new Je(e),u_merc_matrix:new Je(e),u_zoom_transition:new Kt(e),u_merc_center:new fn(e),u_image0:new dn(e),u_grid_matrix:new Cx(e),u_skirt_height:new Kt(e),u_frustum_tl:new nn(e),u_frustum_tr:new nn(e),u_frustum_br:new nn(e),u_frustum_bl:new nn(e),u_globe_pos:new nn(e),u_globe_radius:new Kt(e),u_viewport:new fn(e)}),globeAtmosphere:e=>({u_frustum_tl:new nn(e),u_frustum_tr:new nn(e),u_frustum_br:new nn(e),u_frustum_bl:new nn(e),u_horizon:new Kt(e),u_transition:new Kt(e),u_fadeout_range:new Kt(e),u_color:new wo(e),u_high_color:new wo(e),u_space_color:new wo(e),u_temporal_offset:new Kt(e),u_horizon_angle:new Kt(e)}),model:e=>({u_matrix:new Je(e),u_lighting_matrix:new Je(e),u_normal_matrix:new Je(e),u_lightpos:new nn(e),u_lightintensity:new Kt(e),u_lightcolor:new nn(e),u_camera_pos:new nn(e),u_opacity:new Kt(e),u_baseColorFactor:new wo(e),u_emissiveFactor:new wo(e),u_metallicFactor:new Kt(e),u_roughnessFactor:new Kt(e),u_baseTextureIsAlpha:new dn(e),u_alphaMask:new dn(e),u_alphaCutoff:new Kt(e),u_baseColorTexture:new dn(e),u_metallicRoughnessTexture:new dn(e),u_normalTexture:new dn(e),u_occlusionTexture:new dn(e),u_emissionTexture:new dn(e),u_color_mix:new wo(e),u_aoIntensity:new Kt(e),u_emissive_strength:new Kt(e)}),modelDepth:e=>({u_matrix:new Je(e),u_instance:new Je(e),u_node_matrix:new Je(e)}),groundShadow:e=>({u_matrix:new Je(e),u_ground_shadow_factor:new nn(e)}),stars:e=>({u_matrix:new Je(e),u_up:new nn(e),u_right:new nn(e),u_intensity_multiplier:new Kt(e)})};let Gg;function Ak(e,t,n,r,o,a,c){const u=e.context,d=u.gl,p=e.transform,m=e.getOrCreateProgram("collisionBox"),_=[];let v=0,x=0;for(let k=0;k<r.length;k++){const P=r[k],O=t.getTile(P),j=O.getBucket(n);if(!j)continue;const G=C$(P,j,p);let W=G;o[0]===0&&o[1]===0||(W=e.translatePosMatrix(G,O,o,a));const Z=c?j.textCollisionBox:j.iconCollisionBox,K=j.collisionCircleArray;if(K.length>0){const Q=wt.create(),at=W;wt.mul(Q,j.placementInvProjMatrix,p.glCoordMatrix),wt.mul(Q,Q,j.placementViewportMatrix),_.push({circleArray:K,circleOffset:x,transform:at,invTransform:Q,projection:j.getProjection()}),v+=K.length/4,x=v}Z&&(e.terrain&&e.terrain.setupElevationDraw(O,m),m.draw(e,d.LINES,qe.disabled,ln.disabled,e.colorModeForRenderPass(),hn.disabled,s8(W,p,O,j.getProjection()),n.id,Z.layoutVertexBuffer,Z.indexBuffer,Z.segments,null,p.zoom,null,[Z.collisionVertexBuffer,Z.collisionVertexBufferExt]))}if(!c||!_.length)return;const w=e.getOrCreateProgram("collisionCircle"),T=new mx;T.resize(4*v),T._trim();let S=0;for(const k of _)for(let P=0;P<k.circleArray.length/4;P++){const O=4*P,j=k.circleArray[O+0],G=k.circleArray[O+1],W=k.circleArray[O+2],Z=k.circleArray[O+3];T.emplace(S++,j,G,W,Z,0),T.emplace(S++,j,G,W,Z,1),T.emplace(S++,j,G,W,Z,2),T.emplace(S++,j,G,W,Z,3)}(!Gg||Gg.length<2*v)&&(Gg=function(k){const P=2*k,O=new Wr;O.resize(P),O._trim();for(let j=0;j<P;j++){const G=6*j;O.uint16[G+0]=4*j+0,O.uint16[G+1]=4*j+1,O.uint16[G+2]=4*j+2,O.uint16[G+3]=4*j+2,O.uint16[G+4]=4*j+3,O.uint16[G+5]=4*j+0}return O}(v));const I=u.createIndexBuffer(Gg,!0),A=u.createVertexBuffer(T,F6.members,!0);for(const k of _){const P={u_matrix:k.transform,u_inv_matrix:k.invTransform,u_camera_to_center_distance:(R=p).getCameraToCenterDistance(k.projection),u_viewport_size:[R.width,R.height]};w.draw(e,d.TRIANGLES,qe.disabled,ln.disabled,e.colorModeForRenderPass(),hn.disabled,P,n.id,A,I,Gn.simpleSegment(0,2*k.circleOffset,k.circleArray.length,k.circleArray.length/2),null,p.zoom)}var R;A.destroy(),I.destroy()}const Pk=wt.create();function g8({width:e,height:t,anchor:n,textOffset:r,textScale:o},a){const{horizontalAlign:c,verticalAlign:u}=og(n),d=-(c-.5)*e,p=-(u-.5)*t,m=S1(n,r);return new N((d/o+m[0])*a,(p/o+m[1])*a)}function _8(e,t,n,r,o,a,c,u,d,p,m){const _=e.text.placedSymbolArray,v=e.text.dynamicLayoutVertexArray,x=e.icon.dynamicLayoutVertexArray,w={},T=e.getProjection(),S=sb(u,T,a),I=a.elevation,A=T.upVectorScale(u.canonical,a.center.lat,a.worldSize).metersToTile;v.clear();for(let R=0;R<_.length;R++){const k=_.get(R),{tileAnchorX:P,tileAnchorY:O,numGlyphs:j}=k,G=k.hidden||!k.crossTileID||e.allowVerticalPlacement&&!k.placedOrientation?null:r[k.crossTileID];if(G){let W=0,Z=0,K=0;if(I){const Ct=I?I.getAtTileOffset(u,P,O):0,[At,It,zt]=T.upVector(u.canonical,P,O);W=Ct*At*A,Z=Ct*It*A,K=Ct*zt*A}let[Q,at,X,ft]=Fs(k.projectedAnchorX+W,k.projectedAnchorY+Z,k.projectedAnchorZ+K,n?S:c);const gt=xP(a.getCameraToCenterDistance(T),ft);let vt=o.evaluateSizeForFeature(e.textSizeData,p,k)*gt/pi;n&&(vt*=e.tilePixelRatio/d);const ht=g8(G,vt);n?({x:Q,y:at,z:X}=T.projectTilePoint(P+ht.x,O+ht.y,u.canonical),[Q,at,X]=Fs(Q+W,at+Z,X+K,c)):(t&&ht._rotate(-a.angle),Q+=ht.x,at+=ht.y,X=0);const pt=e.allowVerticalPlacement&&k.placedOrientation===ur.vertical?Math.PI/2:0;for(let Ct=0;Ct<j;Ct++)ch(v,Q,at,X,pt);m&&k.associatedIconIndex>=0&&(w[k.associatedIconIndex]={x:Q,y:at,z:X,angle:pt})}else hh(j,v)}if(m){x.clear();const R=e.icon.placedSymbolArray;for(let k=0;k<R.length;k++){const P=R.get(k),{numGlyphs:O}=P,j=w[k];if(P.hidden||!j)hh(O,x);else{const{x:G,y:W,z:Z,angle:K}=j;for(let Q=0;Q<O;Q++)ch(x,G,W,Z,K)}}e.icon.dynamicLayoutVertexBuffer.updateData(x)}e.text.dynamicLayoutVertexBuffer.updateData(v)}function y8(e,t,n){return n.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function Rk(e,t,n,r,o,a,c,u,d,p,m,_,v){const x=e.context,w=x.gl,T=e.transform,S=u==="map",I=d==="map",A=S&&n.layout.get("symbol-placement")!=="point",R=S&&!I&&!A,k=n.layout.get("symbol-sort-key").constantOr(1)!==void 0;let P=!1;const O=e.depthModeForSublayer(0,qe.ReadOnly),j=[Qr(T.center.lng),oi(T.center.lat)],G=n.layout.get("text-variable-anchor"),W=T.projection.name==="globe",Z=[],K=[0,-1,0];let Q=K;!W&&!T.mercatorFromTransition||S||(Q=function(at){const X=at._camera.getWorldToCamera(at.worldSize,1),ft=wt.multiply([],X,at.globeMatrix);wt.invert(ft,ft);const gt=[0,0,0],vt=[0,1,0,0];return Wn.transformMat4(vt,vt,ft),gt[0]=vt[0],gt[1]=vt[1],gt[2]=vt[2],ot.normalize(gt,gt),gt}(T));for(const at of r){const X=t.getTile(at),ft=X.getBucket(n);if(!ft||ft.projection.name==="mercator"&&W)continue;const gt=o?ft.text:ft.icon;if(!gt||ft.fullyClipped||!gt.segments.get().length)continue;const vt=gt.programConfigurations.get(n.id),ht=o||ft.sdfIcons,pt=o?ft.textSizeData:ft.iconSizeData,Ct=I||T.pitch!==0,At=oa(pt,T.zoom);let It,zt,Ft,Ut,Pt=[0,0],Ht=null;if(o)zt=X.glyphAtlasTexture?X.glyphAtlasTexture:null,Ft=w.LINEAR,It=X.glyphAtlasTexture?X.glyphAtlasTexture.size:[0,0],ft.iconsInText&&(Pt=X.imageAtlasTexture?X.imageAtlasTexture.size:[0,0],Ht=X.imageAtlasTexture?X.imageAtlasTexture:null,Ut=Ct||e.options.rotating||e.options.zooming||pt.kind==="composite"||pt.kind==="camera"?w.LINEAR:w.NEAREST);else{const sr=n.layout.get("icon-size").constantOr(0)!==1||ft.iconsNeedLinear;zt=X.imageAtlasTexture?X.imageAtlasTexture:null,Ft=ht||e.options.rotating||e.options.zooming||sr||Ct?w.LINEAR:w.NEAREST,It=X.imageAtlasTexture?X.imageAtlasTexture.size:[0,0]}const he=ft.projection.name==="globe",de=he?Q:K,_e=he?fi(T.zoom):0,xe=sb(at,ft.getProjection(),T),He=T.calculatePixelsToTileUnitsMatrix(X),Ae=Sg(xe,X.tileID.canonical,I,S,T,ft.getProjection(),He),Sn=e.terrain&&I&&A?wt.invert(wt.create(),Ae):Pk,pn=vP(xe,X.tileID.canonical,I,S,T,ft.getProjection(),He),Ze=G&&ft.hasTextData(),We=ft.hasIconTextFit()&&Ze&&ft.hasIconData();if(A){const sr=T.elevation,jn=sr?sr.getAtTileOffsetFunc(at,T.center.lat,T.worldSize,ft.getProjection()):null,bi=yP(xe,X.tileID.canonical,I,S,T,ft.getProjection(),He);gU(ft,xe,e,o,bi,pn,I,p,jn,at)}const ze=A||o&&G||We,yn=e.translatePosMatrix(xe,X,a,c),wn=ze?Pk:Ae,sn=e.translatePosMatrix(pn,X,a,c,!0),Zn=ft.getProjection().createInversionMatrix(T,at.canonical),Lr=n.paint.get("icon-image-cross-fade").constantOr(0),qn=[];e.terrainRenderModeElevated()&&I&&qn.push("PITCH_WITH_MAP_TERRAIN"),he&&(qn.push("PROJECTION_GLOBE_VIEW"),ze&&qn.push("PROJECTED_POS_ON_VIEWPORT")),Lr>0&&qn.push("ICON_TRANSITION"),gt.zOffsetVertexBuffer&&qn.push("Z_OFFSET");const rr=ht&&n.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Dr;ht?Dr=ft.iconsInText?d8(pt.kind,At,R,I,e,yn,wn,sn,It,Pt,at,_e,j,Zn,de,ft.getProjection()):Ck(pt.kind,At,R,I,e,yn,wn,sn,o,It,!0,at,_e,j,Zn,de,ft.getProjection()):(m<1&&qn.push("SATURATION"),Dr=Ek(pt.kind,At,R,I,e,yn,wn,sn,o,It,at,_e,j,Zn,de,ft.getProjection(),m,Lr));const zr={program:e.getOrCreateProgram(y8(ht,o,ft),{config:vt,defines:qn}),buffers:gt,uniformValues:Dr,atlasTexture:zt,atlasTextureIcon:Ht,atlasInterpolation:Ft,atlasInterpolationIcon:Ut,isSDF:ht,hasHalo:rr,tile:X,labelPlaneMatrixInv:Sn};if(k&&ft.canOverlap){P=!0;const sr=gt.segments.get();for(const jn of sr)Z.push({segments:new Gn([jn]),sortKey:jn.sortKey,state:zr})}else Z.push({segments:gt.segments,sortKey:0,state:zr})}P&&Z.sort((at,X)=>at.sortKey-X.sortKey);for(const at of Z){const X=at.state;if(e.terrain&&e.terrain.setupElevationDraw(X.tile,X.program,{useDepthForOcclusion:T.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:X.labelPlaneMatrixInv}),x.activeTexture.set(w.TEXTURE0),X.atlasTexture&&X.atlasTexture.bind(X.atlasInterpolation,w.CLAMP_TO_EDGE),X.atlasTextureIcon&&(x.activeTexture.set(w.TEXTURE1),X.atlasTextureIcon&&X.atlasTextureIcon.bind(X.atlasInterpolationIcon,w.CLAMP_TO_EDGE)),e.uploadCommonLightUniforms(e.context,X.program),X.hasHalo){const ft=X.uniformValues;ft.u_is_halo=1,pb(X.buffers,at.segments,n,e,X.program,O,_,v,ft,2),ft.u_is_halo=0}else{if(X.isSDF){const ft=X.uniformValues;X.hasHalo&&(ft.u_is_halo=1,pb(X.buffers,at.segments,n,e,X.program,O,_,v,ft,1)),ft.u_is_halo=0}pb(X.buffers,at.segments,n,e,X.program,O,_,v,X.uniformValues,1)}}}function pb(e,t,n,r,o,a,c,u,d,p){const m=[e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer,e.iconTransitioningVertexBuffer,e.globeExtVertexBuffer,e.zOffsetVertexBuffer];o.draw(r,r.context.gl.TRIANGLES,a,c,u,hn.disabled,d,n.id,e.layoutVertexBuffer,e.indexBuffer,t,n.paint,r.transform.zoom,e.programConfigurations.get(n.id),m,p)}function kk(e,t,n,r,o,a,c){const u=e.context.gl,d=n.paint.get("fill-pattern"),p=d&&d.constantOr(1);let m,_,v,x,w;c?(_=p&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",m=u.LINES):(_=p?"fillPattern":"fill",m=u.TRIANGLES);for(const T of r){const S=t.getTile(T);if(p&&!S.patternsLoaded())continue;const I=S.getBucket(n);if(!I)continue;e.prepareDrawTile();const A=I.programConfigurations.get(n.id),R=e.isTileAffectedByFog(T),k=e.getOrCreateProgram(_,{config:A,overrideFog:R});p&&(e.context.activeTexture.set(u.TEXTURE0),S.imageAtlasTexture&&S.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),A.updatePaintBuffers());const P=d.constantOr(null);if(P&&S.imageAtlas){const G=S.imageAtlas.patternPositions[P.toString()];G&&A.setConstantPatternPositions(G)}const O=e.translatePosMatrix(T.projMatrix,S,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor")),j=n.paint.get("fill-emissive-strength");if(c){x=I.indexBuffer2,w=I.segments2;const G=e.terrain&&e.terrain.renderingToTexture?e.terrain.drapeBufferSize:[u.drawingBufferWidth,u.drawingBufferHeight];v=_==="fillOutlinePattern"&&p?o8(O,j,e,S,G):i8(O,j,G)}else x=I.indexBuffer,w=I.segments,v=p?bk(O,j,e,S):xk(O,j);e.uploadCommonUniforms(e.context,k,T.toUnwrapped()),k.draw(e,m,o,e.stencilModeForClipping(T),a,hn.disabled,v,n.id,I.layoutVertexBuffer,x,w,n.paint,e.transform.zoom,A,void 0)}}function Wg(e,t,n,r,o,a,c,u){n.resetLayerRenderingStats();const d=e.context,p=d.gl,m=e.transform,_=n.paint.get("fill-extrusion-pattern"),v=_.constantOr(1),x=n.paint.get("fill-extrusion-opacity"),w=e.style.enable3dLights(),T=n.paint.get(w&&!v?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),S=[n.paint.get("fill-extrusion-ambient-occlusion-intensity"),T],I=n.layout.get("fill-extrusion-edge-radius"),A=I>0&&!n.paint.get("fill-extrusion-rounded-roof"),R=A?0:I,k=m.projection.name==="globe"?eR():0,P=m.projection.name==="globe",O=P?fi(m.zoom):0,j=[Qr(m.center.lng),oi(m.center.lat)],G=n.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),W=n.paint.get("fill-extrusion-flood-light-intensity"),Z=n.paint.get("fill-extrusion-vertical-scale"),K=ph(e,n.paint.get("fill-extrusion-cutoff-fade-range")),Q=n.paint.get("fill-extrusion-emissive-strength"),at=[];let X;P&&at.push("PROJECTION_GLOBE_VIEW"),S[0]>0&&at.push("FAUX_AO"),A&&at.push("ZERO_ROOF_RADIUS"),u&&at.push("HAS_CENTROID"),W>0&&at.push("FLOOD_LIGHT"),K.shouldRenderCutoff&&at.push("RENDER_CUTOFF");const ft=e.renderPass==="shadow",gt=e.shadowRenderer,vt=ft&&!!gt;e.shadowRenderer&&(e.shadowRenderer.useNormalOffset=!0);let ht=[0,0,0];if(gt){const At=e.style.directionalLight,It=e.style.ambientLight;At&&It&&(ht=_b(At,It)),X=at.concat(["SHADOWS_SINGLE_CASCADE"])}const pt=vt?"fillExtrusionDepth":v?"fillExtrusionPattern":"fillExtrusion",Ct=n.getLayerRenderingStats();for(const At of r){const It=t.getTile(At),zt=It.getBucket(n);if(!zt||zt.projection.name!==m.projection.name)continue;let Ft=!1;gt&&(Ft=gt.getMaxCascadeForTile(At.toUnwrapped())===0);const Ut=e.isTileAffectedByFog(At),Pt=zt.programConfigurations.get(n.id),Ht=e.getOrCreateProgram(pt,{config:Pt,defines:Ft?X:at,overrideFog:Ut});if(e.terrain&&e.terrain.setupElevationDraw(It,Ht,{useMeterToDem:!0}),!zt.centroidVertexBuffer){const Ae=Ht.attributes.a_centroid_pos;Ae!==void 0&&p.vertexAttrib2f(Ae,0,0)}!ft&&gt&&gt.setupShadows(It.tileID.toUnwrapped(),Ht,"vector-tile",It.tileID.overscaledZ),v&&(e.context.activeTexture.set(p.TEXTURE0),It.imageAtlasTexture&&It.imageAtlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),Pt.updatePaintBuffers());const he=_.constantOr(null);if(he&&It.imageAtlas){const Ae=It.imageAtlas.patternPositions[he.toString()];Ae&&Pt.setConstantPatternPositions(Ae)}const de=n.paint.get("fill-extrusion-vertical-gradient");let _e;if(ft&&gt){if(T8(It.tileID,zt,e))continue;const Ae=gt.calculateShadowPassMatrixFromTile(It.tileID.toUnwrapped());_e=n8(Ae,R,Z)}else{const Ae=e.translatePosMatrix(At.expandedProjMatrix,It,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Sn=m.projection.createInversionMatrix(m,At.canonical);_e=v?r8(Ae,e,de,x,S,R,At,It,k,O,j,Sn,G,Z):vk(Ae,e,de,x,S,R,At,k,O,j,Sn,G,Z,W,ht,Q)}e.uploadCommonUniforms(d,Ht,At.toUnwrapped(),null,K);let xe=zt.segments;if(m.projection.name==="mercator"&&!ft&&(xe=zt.getVisibleSegments(It.tileID,e.terrain,e.transform.getFrustum(0)),!xe.get().length))continue;if(Ct)if(ft)for(const Ae of xe.get())Ct.numRenderedVerticesInShadowPass+=Ae.primitiveLength;else for(const Ae of xe.get())Ct.numRenderedVerticesInTransparentPass+=Ae.primitiveLength;const He=[];(e.terrain||u)&&He.push(zt.centroidVertexBuffer),P&&He.push(zt.layoutVertexExtBuffer),Ht.draw(e,d.gl.TRIANGLES,o,a,c,hn.backCCW,_e,n.id,zt.layoutVertexBuffer,zt.indexBuffer,xe,n.paint,e.transform.zoom,Pt,He)}e.shadowRenderer&&(e.shadowRenderer.useNormalOffset=!1)}function gh(e,t,n,r,o,a,c,u,d,p,m,_,v,x,w,T,S,I,A){const R=e.context,k=R.gl,P=e.transform,O=e.transform.zoom,j=[],G=ph(e,n.paint.get("fill-extrusion-cutoff-fade-range"));p==="clear"?(j.push("CLEAR_SUBPASS"),A&&(j.push("CLEAR_FROM_TEXTURE"),R.activeTexture.set(k.TEXTURE0),A.bind(k.LINEAR,k.CLAMP_TO_EDGE))):p==="sdf"&&j.push("SDF_SUBPASS"),S&&j.push("HAS_CENTROID"),G.shouldRenderCutoff&&j.push("RENDER_CUTOFF");const W=n.layout.get("fill-extrusion-edge-radius"),Z=(K,Q,at,X,ft)=>{const gt=Q.programConfigurations.get(n.id),vt=e.isTileAffectedByFog(K),ht=e.getOrCreateProgram("fillExtrusionGroundEffect",{config:gt,defines:j,overrideFog:vt}),pt=((At,It,zt,Ft,Ut,Pt,Ht,he,de,_e,xe)=>({u_matrix:It,u_opacity:zt,u_ao_pass:Ft?1:0,u_meter_to_tile:Ut,u_ao:Pt,u_flood_light_intensity:Ht,u_flood_light_color:he,u_attenuation:de,u_edge_radius:_e,u_fb:0,u_fb_size:xe}))(0,X,m,d,ft,[_,v*ft],x,w,T,O>=17?0:W*ft,A?A.size[0]:0),Ct=[];S&&Ct.push(Q.hiddenByLandmarkVertexBuffer),e.uploadCommonUniforms(R,ht,K.toUnwrapped(),null,G),ht.draw(e,R.gl.TRIANGLES,o,a,c,u,pt,n.id,Q.vertexBuffer,Q.indexBuffer,at,n.paint,O,gt,Ct)};for(const K of r){const Q=t.getTile(K),at=Q.getBucket(n);if(!at||at.projection.name!==P.projection.name||!at.groundEffect||at.groundEffect&&!at.groundEffect.hasData())continue;const X=at.groundEffect,ft=1/at.tileToMeter;{const gt=e.translatePosMatrix(K.projMatrix,Q,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),vt=X.getDefaultSegment();Z(K,X,vt,gt,ft)}if(I)for(let gt=0;gt<4;gt++){const vt=MI[gt](K),ht=t.getTile(vt);if(!ht)continue;const pt=ht.getBucket(n);if(!pt||pt.projection.name!==P.projection.name||!pt.groundEffect||pt.groundEffect&&!pt.groundEffect.hasData())continue;const Ct=pt.groundEffect;let At,It;gt===0?(At=[-Rt,0,0],It=1):gt===1?(At=[Rt,0,0],It=0):gt===2?(At=[0,-Rt,0],It=3):(At=[0,Rt,0],It=2);const zt=Ct.regionSegments[It];if(!zt)continue;const Ft=new Float32Array(16);wt.translate(Ft,K.projMatrix,At),Z(K,Ct,zt,e.translatePosMatrix(Ft,Q,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),ft)}}}function v8(e,t,n,r,o,a,c){r.centroidVertexArray.length===0&&r.createCentroidsBuffer();const u=a?a.findDEMTileFor(n):null;if(!(u&&u.dem||c))return;const d=I=>{const A=t.getSource().minzoom,R=P=>{const O=t.getTileByID(P);if(O&&O.hasData())return O.getBucket(o)},k=[0,-1,1];for(const P of k){if(I.overscaledZ+P<A)continue;const O=R(I.calculateScaledKey(I.overscaledZ+P));if(O)return O}},p=[0,0,0],m=(I,A)=>(p[0]=Math.min(I.min.y,A.min.y),p[1]=Math.max(I.max.y,A.max.y),p[2]=Rt-A.min.x>I.max.x?A.min.x-Rt:I.max.x,p),_=(I,A)=>(p[0]=Math.min(I.min.x,A.min.x),p[1]=Math.max(I.max.x,A.max.x),p[2]=Rt-A.min.y>I.max.y?A.min.y-Rt:I.max.y,p),v=[(I,A)=>m(I,A),(I,A)=>m(A,I),(I,A)=>_(I,A),(I,A)=>_(A,I)],x=(I,A,R,k,P,O,j)=>{if(!a)return 0;const G=[[O?R:I,O?I:R,0],[O?R:A,O?A:R,0]],W=j<0?Rt+j:j,Z=[O?W:(I+A)/2,O?(I+A)/2:W,0];return R===0&&j<0||R!==0&&j>0?a.getForTilePoints(P,[Z],!0,k):G.push(Z),a.getForTilePoints(n,G,!0,u),Math.max(G[0][2],G[1][2],Z[2])/a.exaggeration()};for(let I=0;I<4;I++){const A=r.borderFeatureIndices[I];if(A.length===0)continue;const R=MI[I](n),k=d(R);if(!(k&&k instanceof Sf)||r.borderDoneWithNeighborZ[I]===k.canonical.z)continue;k.centroidVertexArray.length===0&&k.createCentroidsBuffer();const P=a?a.findDEMTileFor(R):null;if(!(P&&P.dem||c))continue;const O=(I<2?1:5)-I,j=k.borderDoneWithNeighborZ[O]!==r.canonical.z,G=k.borderFeatureIndices[O];let W=0;if(r.canonical.z!==k.canonical.z){for(const Z of A)r.showCentroid(r.featuresOnBorder[Z]);if(j)for(const Z of G)k.showCentroid(k.featuresOnBorder[Z]);r.borderDoneWithNeighborZ[I]=k.canonical.z,k.borderDoneWithNeighborZ[O]=r.canonical.z}for(const Z of A){const K=r.featuresOnBorder[Z],Q=r.centroidData[K.centroidDataIndex],at=K.borders[I];let X;for(;W<G.length;){X=k.featuresOnBorder[G[W]];const ft=X.borders[O];if(ft[1]>at[0]+3||ft[0]>at[0]-3)break;k.showCentroid(X),W++}if(X&&W<G.length){const ft=W;let gt=0;for(;!(X.borders[O][0]>at[1]-3)&&(gt++,++W!==G.length);)X=k.featuresOnBorder[G[W]];if(X=k.featuresOnBorder[G[ft]],gt>1){const pt=X.borders[O];Math.abs(at[0]-pt[0])<3&&Math.abs(at[1]-pt[1])<3&&(gt=1,W=ft+1)}else if(gt===0){r.showCentroid(K);continue}const vt=k.centroidData[X.centroidDataIndex];c&&gt===1&&(((T=Q).flags|(S=vt).flags)&la?(T.flags|=la,S.flags|=la):(T.flags&=2147483647,S.flags&=2147483647));let ht=new N(0,0);if(gt>1)W=ft;else if(P&&P.dem&&!(K.intersectsCount()>1||X.intersectsCount()>1)){const pt=v[I](Q,vt),Ct=I%2?Rt-1:0;w=x(pt[0],Math.min(Rt-1,pt[1]),Ct,P,R,I<2,pt[2]),ht=new N(Math.ceil(7*(w+450)),0)}Q.centroidXY=vt.centroidXY=ht,r.writeCentroidToBuffer(Q),k.writeCentroidToBuffer(vt)}else r.showCentroid(K)}r.borderDoneWithNeighborZ[I]=k.canonical.z,k.borderDoneWithNeighborZ[O]=r.canonical.z}var w,T,S;(r.needsCentroidUpdate||!r.centroidVertexBuffer&&r.centroidVertexArray.length!==0)&&r.uploadCentroid(e)}const x8=[1,0,0],b8=[0,1,0],w8=[0,0,1];function T8(e,t,n){const r=n.transform,o=n.shadowRenderer;if(!o)return!0;const a=e.toUnwrapped(),c=r.tileSize*o._cascades[n.currentShadowCascade].scale;let u=t.maxHeight;if(r.elevation){const T=r.elevation.getMinMaxForTile(e);T&&(u+=T.max)}const d=[...o.shadowDirection];d[2]=-d[2];const p=o.computeSimplifiedTileShadowVolume(a,u,c,d);if(!p)return!1;const m=[x8,b8,w8,d,[d[0],0,d[2]],[0,d[1],d[2]]],_=r.projection.name==="globe",v=r.scaleZoom(c),x=Na.fromInvProjectionMatrix(r.invProjMatrix,r.worldSize,v,!_),w=o.getCurrentCascadeFrustum();return x.intersectsPrecise(p.vertices,p.planes,m)===0||w.intersectsPrecise(p.vertices,p.planes,m)===0}function S8(e){const t=e._nearZ,n=e.projection.farthestPixelDistance(e),r=n-t,o=.2*e.height,a=t+o;return[t,n,(a-o-t)/r,(a-t)/r]}const E8=new en(1,0,0,1),C8=new en(0,1,0,1),M8=new en(0,0,1,1),I8=new en(1,0,1,1),A8=new en(0,1,1,1);function P8(e,t,n){const r=e.context,o=e.transform,a=r.gl,c=o.projection.name==="globe",u=c?["PROJECTION_GLOBE_VIEW"]:[];let d=n.projMatrix;if(c&&fi(o.zoom)>0){const Z=Kx(kI(n.canonical,o));d=wt.multiply(new Float32Array(16),o.globeMatrix,Z),wt.multiply(d,o.projMatrix,d)}const p=e.getOrCreateProgram("debug",{defines:u}),m=t.getTileByID(n.key);e.terrain&&e.terrain.setupElevationDraw(m,p);const _=qe.disabled,v=ln.disabled,x=e.colorModeForRenderPass(),w="$debug";r.activeTexture.set(a.TEXTURE0),e.emptyTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE),c?m._makeGlobeTileDebugBuffers(e.context,o):m._makeDebugTileBoundsBuffers(e.context,o.projection);const T=m._tileDebugBuffer||e.debugBuffer,S=m._tileDebugIndexBuffer||e.debugIndexBuffer,I=m._tileDebugSegments||e.debugSegments;p.draw(e,a.LINE_STRIP,_,v,x,hn.disabled,wk(d,en.red),w,T,S,I,null,null,null,[m._globeTileDebugBorderBuffer]);const A=m.latestRawTileData,R=Math.floor((A&&A.byteLength||0)/1024),k=t.getTile(n).tileSize,P=512/Math.min(k,512)*(n.overscaledZ/o.zoom)*.5;let O=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(O+=` => ${n.overscaledZ}`),O+=` ${R}kb`,function(Z,K){Z.initDebugOverlayCanvas();const Q=Z.debugOverlayCanvas,at=Z.context.gl,X=Z.debugOverlayCanvas.getContext("2d");X.clearRect(0,0,Q.width,Q.height),X.shadowColor="white",X.shadowBlur=2,X.lineWidth=1.5,X.strokeStyle="white",X.textBaseline="top",X.font="bold 36px Open Sans, sans-serif",X.fillText(K,5,5),X.strokeText(K,5,5),Z.debugOverlayTexture.update(Q),Z.debugOverlayTexture.bind(at.LINEAR,at.CLAMP_TO_EDGE)}(e,O);const j=m._tileDebugTextBuffer||e.debugBuffer,G=m._tileDebugTextIndexBuffer||e.quadTriangleIndexBuffer,W=m._tileDebugTextSegments||e.debugSegments;p.draw(e,a.TRIANGLES,_,v,Mn.alphaBlended,hn.disabled,wk(d,en.transparent,P),w,j,G,W,null,null,null,[m._globeTileDebugTextBuffer])}function Ok(e,t,n,r){qg(e,0,t+n/2,e.transform.width,n,r)}function Lk(e,t,n,r){qg(e,t-n/2,0,n,e.transform.height,r)}function qg(e,t,n,r,o,a){const c=e.context,u=c.gl;u.enable(u.SCISSOR_TEST),u.scissor(t*Ve.devicePixelRatio,n*Ve.devicePixelRatio,r*Ve.devicePixelRatio,o*Ve.devicePixelRatio),c.clear({color:a}),u.disable(u.SCISSOR_TEST)}const R8=Dn([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:k8}=R8;function Bl(e,t,n,r){e.emplaceBack(t,n,r)}class zk{constructor(t){this.vertexArray=new Ic,this.indices=new Wr,Bl(this.vertexArray,-1,-1,1),Bl(this.vertexArray,1,-1,1),Bl(this.vertexArray,-1,1,1),Bl(this.vertexArray,1,1,1),Bl(this.vertexArray,-1,-1,-1),Bl(this.vertexArray,1,-1,-1),Bl(this.vertexArray,-1,1,-1),Bl(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,k8),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=Gn.simpleSegment(0,0,36,12)}}function _h(e,t,n,r,o,a){const c=e.context.gl,u=t.paint.get("sky-atmosphere-color"),d=t.paint.get("sky-atmosphere-halo-color"),p=t.paint.get("sky-atmosphere-sun-intensity"),m=((_,v,x,w,T)=>({u_matrix_3f:_,u_sun_direction:v,u_sun_intensity:x,u_color_tint_r:[w.r,w.g,w.b,w.a],u_color_tint_m:[T.r,T.g,T.b,T.a],u_luminance:5e-5}))(ho.fromMat4(ho.create(),r),o,p,u,d);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_CUBE_MAP_POSITIVE_X+a,t.skyboxTexture,0),n.draw(e,c.TRIANGLES,qe.disabled,ln.disabled,Mn.unblended,hn.frontCW,m,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}const O8=Dn([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class L8{constructor(t){const n=new Mc;n.emplaceBack(-1,1,1,0,0),n.emplaceBack(1,1,1,1,0),n.emplaceBack(1,-1,1,1,1),n.emplaceBack(-1,-1,1,0,1);const r=new Wr;r.emplaceBack(0,1,2),r.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(n,O8.members),this.indexBuffer=t.createIndexBuffer(r),this.segments=Gn.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const z8=Dn([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class D8{constructor(){this.colorModeAlphaBlendedWriteRGB=new Mn([1,wg,1,wg],en.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Mn([1,0,1,0],en.transparent,[!1,!1,!1,!0])}update(t){const n=t.context;if(!this.atmosphereBuffer){this.atmosphereBuffer=new L8(n);const r=100,o=200,a=function(m){const _=$v(30),v=[];for(let x=0;x<16e3;++x){const w=2*Math.PI*_(),T=Math.acos(1-2*_())-.5*Math.PI;v.push(ot.fromValues(Math.cos(T)*Math.cos(w),Math.cos(T)*Math.sin(w),Math.sin(T)))}return v}(),c=$v(300),u=new vx,d=new Wr;let p=0;for(let m=0;m<a.length;++m){const _=ot.scale([],a[m],200),v=Math.max(0,1+.01*r*(1*c()-.5)),x=Math.max(0,1+.01*o*(1*c()-.5));u.emplaceBack(_[0],_[1],_[2],-1,-1,v,x),u.emplaceBack(_[0],_[1],_[2],1,-1,v,x),u.emplaceBack(_[0],_[1],_[2],1,1,v,x),u.emplaceBack(_[0],_[1],_[2],-1,1,v,x),d.emplaceBack(p+0,p+1,p+2),d.emplaceBack(p+0,p+2,p+3),p+=4}this.starsVx=n.createVertexBuffer(u,z8.members),this.starsIdx=n.createIndexBuffer(d),this.starsSegments=Gn.simpleSegment(0,0,u.length,d.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(t,n){const r=t.context,o=r.gl,a=t.transform,c=new qe(o.LEQUAL,qe.ReadOnly,[0,1]),u=fi(a.zoom),d=n.properties.get("color").toArray01(),p=n.properties.get("high-color").toArray01(),m=n.properties.get("space-color").toArray01PremultipliedAlpha(),_=5e-4,v=jt((n.properties.get("horizon-blend")-0)/1*.2495+_,5e-4,.25),x=NI(t,r,a)&&v===_?a.worldSize/(2*Math.PI*1.025)-1:a.globeRadius,w=t.frameCounter/1e3%1,T=ot.length(a.globeCenterInViewSpace),S=Math.sqrt(Math.pow(T,2)-Math.pow(x,2)),I=Math.acos(S/T),A=R=>{const k=a.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];R&&k.push("ALPHA_PASS");const P=t.getOrCreateProgram("globeAtmosphere",{defines:k}),O=((G,W,Z,K,Q,at,X,ft,gt,vt,ht,pt)=>({u_frustum_tl:G,u_frustum_tr:W,u_frustum_br:Z,u_frustum_bl:K,u_horizon:Q,u_transition:at,u_fadeout_range:X,u_color:ft,u_high_color:gt,u_space_color:vt,u_temporal_offset:ht,u_horizon_angle:pt}))(a.frustumCorners.TL,a.frustumCorners.TR,a.frustumCorners.BR,a.frustumCorners.BL,a.frustumCorners.horizon,u,v,d,p,m,w,I);t.uploadCommonUniforms(r,P);const j=this.atmosphereBuffer;j&&P.draw(t,o.TRIANGLES,c,ln.disabled,R?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,hn.backCW,O,R?"atmosphere_glow_alpha":"atmosphere_glow",j.vertexBuffer,j.indexBuffer,j.segments)};A(!1),A(!0)}drawStars(t,n){const r=jt(n.properties.get("star-intensity"),0,1);if(r===0)return;const o=t.context,a=o.gl,c=t.transform,u=t.getOrCreateProgram("stars"),d=Ri.identity([]);Ri.rotateX(d,d,-c._pitch),Ri.rotateZ(d,d,-c.angle),Ri.rotateX(d,d,it(c._center.lat)),Ri.rotateY(d,d,-it(c._center.lng));const p=wt.fromQuat(new Float32Array(16),d),m=wt.multiply([],c.starsProjMatrix,p),_=ho.fromMat4([],p),v=ho.invert([],_),x=[0,1,0];ot.transformMat3(x,x,v),ot.scale(x,x,.15);const w=[1,0,0];ot.transformMat3(w,w,v),ot.scale(w,w,.15);const T=((S,I,A,R)=>({u_matrix:Float32Array.from(S),u_up:I,u_right:A,u_intensity_multiplier:R}))(m,x,w,r);t.uploadCommonUniforms(o,u),this.starsVx&&this.starsIdx&&u.draw(t,a.TRIANGLES,qe.disabled,ln.disabled,this.colorModeAlphaBlendedWriteRGB,hn.disabled,T,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Dk(e,t){const n=[...e],r=t.cameraWorldSizeForFog/t.worldSize,o=wt.identity([]);return wt.scale(o,o,[r,r,1]),wt.multiply(n,o,n),wt.multiply(n,t.worldToFogMatrix,n),n}function mb(e,t,n,r){const o=n.material,a=r.context,{baseColorTexture:c,metallicRoughnessTexture:u}=o.pbrMetallicRoughness,{normalTexture:d,occlusionTexture:p,emissionTexture:m}=o;function _(v,x,w){if(v&&(e.push(x),a.activeTexture.set(a.gl.TEXTURE0+w),v.gfxTexture)){const{minFilter:T,magFilter:S,wrapS:I,wrapT:A}=v.sampler;v.gfxTexture.bindExtraParam(T,S,I,A)}}_(c,"HAS_TEXTURE_u_baseColorTexture",Co.BaseColor),_(u,"HAS_TEXTURE_u_metallicRoughnessTexture",Co.MetallicRoughness),_(d,"HAS_TEXTURE_u_normalTexture",Co.Normal),_(p,"HAS_TEXTURE_u_occlusionTexture",Co.Occlusion),_(m,"HAS_TEXTURE_u_emissionTexture",Co.Emission),n.texcoordBuffer&&(e.push("HAS_ATTRIBUTE_a_uv_2f"),t.push(n.texcoordBuffer)),n.colorBuffer&&(e.push(n.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),t.push(n.colorBuffer)),n.normalBuffer&&(e.push("HAS_ATTRIBUTE_a_normal_3f"),t.push(n.normalBuffer)),n.pbrBuffer&&(e.push("HAS_ATTRIBUTE_a_pbr"),e.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),t.push(n.pbrBuffer)),o.alphaMode!=="OPAQUE"&&o.alphaMode!=="MASK"||e.push("UNPREMULT_TEXTURE_IN_SHADER"),o.defined||e.push("DIFFUSE_SHADED"),e.push("USE_STANDARD_DERIVATIVES")}function Hg(e,t,n,r,o,a){const c=n.paint.get("model-opacity"),u=t.context,d=new qe(t.context.gl.LEQUAL,qe.ReadWrite,t.depthRangeFor3D),p=t.transform,m=e.mesh,_=m.material,v=_.pbrMetallicRoughness,x=t.style.fog;let w;w=t.transform.projection.zAxisUnit==="pixels"?[...e.nodeModelMatrix]:wt.multiply([],r.zScaleMatrix,e.nodeModelMatrix),wt.multiply(w,r.negCameraPosMatrix,w);const T=wt.invert([],w);wt.transpose(T,T);const S=n.paint.get("model-emissive-strength").constantOr(0),I=fb(new Float32Array(e.worldViewProjection),new Float32Array(w),new Float32Array(T),t,c,v.baseColorFactor,_.emissiveFactor,v.metallicFactor,v.roughnessFactor,_,S,n),A={defines:[]},R=[];mb(A.defines,R,m,t);const k=t.shadowRenderer;k&&(k.useNormalOffset=!1);let P=null;if(x){const G=Dk(e.nodeModelMatrix,t.transform);if(P=new Float32Array(G),p.projection.name!=="globe"){const W=m.aabb.min,Z=m.aabb.max,[K,Q]=x.getOpacityForBounds(G,W[0],W[1],Z[0],Z[1]);A.overrideFog=K>=Bc||Q>=Bc}}const O=ph(t,n.paint.get("model-cutoff-fade-range"));O.shouldRenderCutoff&&A.defines.push("RENDER_CUTOFF");const j=t.getOrCreateProgram("model",A);t.uploadCommonUniforms(u,j,null,P,O),t.renderPass!=="shadow"&&k&&k.setupShadowsFromMatrix(e.nodeModelMatrix,j),j.draw(t,u.gl.TRIANGLES,d,o,a,m.material.doubleSided?hn.disabled:hn.backCCW,I,n.id,m.vertexBuffer,m.indexBuffer,m.segments,n.paint,t.transform.zoom,void 0,R)}function Bk(e,t,n,r,o,a,c){let u;u=e.projection.name==="globe"?PP(n,e):[...n],wt.multiply(u,u,t.matrix);const d=wt.multiply([],r,u);if(t.meshes)for(const p of t.meshes){if(p.material.alphaMode!=="BLEND"){c.push({mesh:p,depth:0,modelIndex:o,worldViewProjection:d,nodeModelMatrix:u});continue}const m=ot.transformMat4([],p.centroid,d);m[2]>0&&a.push({mesh:p,depth:m[2],modelIndex:o,worldViewProjection:d,nodeModelMatrix:u})}if(t.children)for(const p of t.children)Bk(e,p,n,r,o,a,c)}function gb(e,t,n,r){const o=n.shadowRenderer;if(!o)return;const a=o.getShadowPassDepthMode(),c=o.getShadowPassColorMode(),u=o.calculateShadowPassMatrixFromMatrix(t),d=Ik(u);n.getOrCreateProgram("modelDepth",{defines:["DEPTH_TEXTURE"]}).draw(n,n.context.gl.TRIANGLES,a,ln.disabled,c,hn.backCCW,d,r.id,e.vertexBuffer,e.indexBuffer,e.segments,r.paint,n.transform.zoom,void 0,void 0)}function B8(e,t,n){const r=t.updateZoomBasedPaintProperties(),o=function(a,c,u){let d,p,m,_=a.terrain?a.terrain.exaggeration():0;if(a.terrain&&_>0){const v=a.terrain,x=v.findDEMTileFor(u);x&&x.dem?d=rh.create(v,u,x):_=0}if(_===0&&(c.terrainElevationMin=0,c.terrainElevationMax=0),_===c.validForExaggeration&&(_===0||d&&d._demTile&&d._demTile.tileID===c.validForDEMTile.id&&d._dem._timestamp===c.validForDEMTile.timestamp))return!1;for(const v in c.instancesPerModel){const x=c.instancesPerModel[v];for(let w=0;w<x.instancedDataArray.length;++w){const T=(d?_*d.getElevationAt(0|x.instancedDataArray.float32[16*w],0|x.instancedDataArray.float32[16*w+1],!0,!0):0)+x.instancesEvaluatedElevation[w];x.instancedDataArray.float32[16*w+6]=T,p=p?Math.min(c.terrainElevationMin,T):T,m=m?Math.max(c.terrainElevationMax,T):T}}return c.terrainElevationMin=p||0,c.terrainElevationMax=m||0,c.validForExaggeration=_,c.validForDEMTile=d&&d._demTile?{id:d._demTile.tileID,timestamp:d._dem._timestamp}:{id:void 0,timestamp:0},!0}(e,t,n);(r||o)&&(t.uploaded=!1,t.upload(e.context))}const ua={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new nr([0,0,0],[Rt,Rt,0])};function F8(e,t){const n=1<<e.canonical.z,r=t.getFreeCameraOptions().position,o=t.elevation,a=e.canonical.x/n,c=(e.canonical.x+1)/n,u=e.canonical.y/n,d=(e.canonical.y+1)/n;let p=t._centerAltitude;if(o){const x=o.getMinMaxForTile(e);x&&x.max>p&&(p=x.max)}const m=jt(r.x,a,c)-r.x,_=jt(r.y,u,d)-r.y,v=Hn(p,t.center.lat)-r.z;return t._zoomFromMercatorZ(Math.sqrt(m*m+_*_+v*v))}function Fk(e,t,n,r,o,a,c){const u=e.context,d=e.renderPass==="shadow",p=e.shadowRenderer,m=d&&p?p.getShadowPassDepthMode():new qe(u.gl.LEQUAL,qe.ReadWrite,e.depthRangeFor3D),_=e.isTileAffectedByFog(a);if(n.meshes)for(const v of n.meshes){const x=["MODEL_POSITION_ON_GPU"],w=[];let T,S,I;r.instancedDataArray.length>20&&x.push("INSTANCED_ARRAYS");const A=ph(e,t.paint.get("model-cutoff-fade-range"));if(A.shouldRenderCutoff&&x.push("RENDER_CUTOFF"),d&&p)T=e.getOrCreateProgram("modelDepth",{defines:x}),S=Ik(c.shadowTileMatrix,c.shadowTileMatrix,Float32Array.from(n.matrix)),I=p.getShadowPassColorMode();else{mb(x,w,v,e),T=e.getOrCreateProgram("model",{defines:x,overrideFog:_});const k=v.material,P=k.pbrMetallicRoughness,O=t.paint.get("model-opacity"),j=t.paint.get("model-emissive-strength").constantOr(0);S=fb(a.expandedProjMatrix,Float32Array.from(n.matrix),new Float32Array(16),e,O,P.baseColorFactor,k.emissiveFactor,P.metallicFactor,P.roughnessFactor,k,j,t,o),p&&(c.shadowUniformsInitialized?T.setShadowUniformValues(u,p.getShadowUniformValues()):(p.setupShadows(a.toUnwrapped(),T,"model-tile",a.overscaledZ),c.shadowUniformsInitialized=!0)),I=A.shouldRenderCutoff||O<1||k.alphaMode!=="OPAQUE"?Mn.alphaBlended:Mn.unblended}e.uploadCommonUniforms(u,T,a.toUnwrapped(),null,A);const R=v.material.doubleSided?hn.disabled:hn.backCCW;if(r.instancedDataArray.length>20)w.push(r.instancedDataBuffer),T.draw(e,u.gl.TRIANGLES,m,ln.disabled,I,R,S,t.id,v.vertexBuffer,v.indexBuffer,v.segments,t.paint,e.transform.zoom,void 0,w,r.instancedDataArray.length);else{const k=d?"u_instance":"u_normal_matrix";for(let P=0;P<r.instancedDataArray.length;++P)S[k]=new Float32Array(r.instancedDataArray.arrayBuffer,64*P,16),T.draw(e,u.gl.TRIANGLES,m,ln.disabled,I,R,S,t.id,v.vertexBuffer,v.indexBuffer,v.segments,t.paint,e.transform.zoom,void 0,w)}}if(n.children)for(const v of n.children)Fk(e,t,v,r,o,a,c)}const N8=[1,-1,1];function j8(e,t,n,r){if(!n.modelManager)return!0;const o=n.modelManager;if(!n.shadowRenderer)return!0;const a=n.shadowRenderer,c=t.aabb;let u=!0,d=e.maxHeight;if(d===0){let m=0;for(const _ in e.instancesPerModel){const v=o.getModel(_,r);v?m=Math.max(m,Math.max(Math.max(v.aabb.max[0],v.aabb.max[1]),v.aabb.max[2])):u=!1}d=e.maxScale*m*1.41+e.maxVerticalOffset,u&&(e.maxHeight=d)}c.max[2]=d,c.min[2]+=e.terrainElevationMin,c.max[2]+=e.terrainElevationMax,ot.transformMat4(c.min,c.min,t.tileMatrix),ot.transformMat4(c.max,c.max,t.tileMatrix);const p=c.intersects(a.getCurrentCascadeFrustum());return n.currentShadowCascade===0&&(e.isInsideFirstShadowMapFrustum=p===2),p===0}class U8{}class $8{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(t,n,r){{const _=this._storage.get(n.id);if(_)return _.lastUsedFrameIdx=t,_.buf}const o=r.gl,a=o.getBufferParameter(o.ELEMENT_ARRAY_BUFFER,o.BUFFER_SIZE),c=new ArrayBuffer(a),u=new Int16Array(c);o.getBufferSubData(o.ELEMENT_ARRAY_BUFFER,0,new Int16Array(c));const d=new _l;for(let _=0;_<a/2;_+=3){const v=u[_],x=u[_+1],w=u[_+2];d.emplaceBack(v,x),d.emplaceBack(x,w),d.emplaceBack(w,v)}const p=r.bindVertexArrayOES.current,m=new U8;return m.buf=new Ll(r,d),m.lastUsedFrameIdx=t,this._storage.set(n.id,m),r.bindVertexArrayOES.set(p),m.buf}update(t){for(const[n,r]of this._storage)t-r.lastUsedFrameIdx>30&&(r.buf.destroy(),this._storage.delete(n))}destroy(){for(const[t,n]of this._storage)n.buf.destroy(),this._storage.delete(t)}}const Nk={symbol:function(e,t,n,r,o){if(e.renderPass!=="translucent")return;const a=ln.disabled,c=e.colorModeForRenderPass();n.layout.get("text-variable-anchor")&&function(u,d,p,m,_,v,x){const w=d.transform,T=_==="map",S=v==="map";for(const I of u){const A=m.getTile(I),R=A.getBucket(p);if(!R||!R.text||!R.text.segments.get().length)continue;const k=oa(R.textSizeData,w.zoom),P=sb(I,R.getProjection(),w),O=w.calculatePixelsToTileUnitsMatrix(A),j=Sg(P,A.tileID.canonical,S,T,w,R.getProjection(),O),G=R.hasIconTextFit()&&R.hasIconData();if(k){const W=Math.pow(2,w.zoom-A.tileID.overscaledZ);_8(R,T,S,x,N6,w,j,I,W,k,G)}}}(r,e,n,t,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),o),n.paint.get("icon-opacity").constantOr(1)!==0&&Rk(e,t,n,r,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),n.paint.get("icon-color-saturation"),a,c),n.paint.get("text-opacity").constantOr(1)!==0&&Rk(e,t,n,r,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),n.paint.get("icon-color-saturation"),a,c),t.map.showCollisionBoxes&&(Ak(e,t,n,r,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),Ak(e,t,n,r,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))},circle:function(e,t,n,r){if(e.renderPass!=="translucent")return;const o=n.paint.get("circle-opacity"),a=n.paint.get("circle-stroke-width"),c=n.paint.get("circle-stroke-opacity"),u=n.layout.get("circle-sort-key").constantOr(1)!==void 0,d=n.paint.get("circle-emissive-strength");if(o.constantOr(1)===0&&(a.constantOr(1)===0||c.constantOr(1)===0))return;const p=e.context,m=p.gl,_=e.transform,v=e.depthModeForSublayer(0,qe.ReadOnly),x=ln.disabled,w=e.colorModeForDrapableLayerRenderPass(d),T=_.projection.name==="globe",S=[Qr(_.center.lng),oi(_.center.lat)],I=[];for(let R=0;R<r.length;R++){const k=r[R],P=t.getTile(k),O=P.getBucket(n);if(!O||O.projection.name!==_.projection.name)continue;const j=O.programConfigurations.get(n.id),G=eA(n),W=e.isTileAffectedByFog(k);T&&G.push("PROJECTION_GLOBE_VIEW");const Z=e.getOrCreateProgram("circle",{config:j,defines:G,overrideFog:W}),K=O.layoutVertexBuffer,Q=O.globeExtVertexBuffer,at=O.indexBuffer,X=_.projection.createInversionMatrix(_,k.canonical),ft={programConfiguration:j,program:Z,layoutVertexBuffer:K,globeExtVertexBuffer:Q,indexBuffer:at,uniformValues:ON(e,k,P,X,S,n),tile:P};if(u){const gt=O.segments.get();for(const vt of gt)I.push({segments:new Gn([vt]),sortKey:vt.sortKey,state:ft})}else I.push({segments:O.segments,sortKey:0,state:ft})}u&&I.sort((R,k)=>R.sortKey-k.sortKey);const A={useDepthForOcclusion:_.depthOcclusionForSymbolsAndCircles};for(const R of I){const{programConfiguration:k,program:P,layoutVertexBuffer:O,globeExtVertexBuffer:j,indexBuffer:G,uniformValues:W,tile:Z}=R.state,K=R.segments;e.terrain&&e.terrain.setupElevationDraw(Z,P,A),e.uploadCommonUniforms(p,P,Z.tileID.toUnwrapped()),P.draw(e,m.TRIANGLES,v,x,w,hn.disabled,W,n.id,O,G,K,n.paint,_.zoom,k,[j])}},heatmap:function(e,t,n,r){if(n.paint.get("heatmap-opacity")!==0)if(e.renderPass==="offscreen"){const o=e.context,a=o.gl,c=ln.disabled,u=new Mn([a.ONE,a.ONE,a.ONE,a.ONE],en.transparent,[!0,!0,!0,!0]);(function(x,w,T,S){const I=x.gl,A=w.width*S,R=w.height*S;x.activeTexture.set(I.TEXTURE1),x.viewport.set([0,0,A,R]);let k=T.heatmapFbo;if(!k||k&&(k.width!==A||k.height!==R)){k&&k.destroy();const P=I.createTexture();I.bindTexture(I.TEXTURE_2D,P),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_S,I.CLAMP_TO_EDGE),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_T,I.CLAMP_TO_EDGE),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,I.LINEAR),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MAG_FILTER,I.LINEAR),k=T.heatmapFbo=x.createFramebuffer(A,R,!0,null),function(O,j,G,W,Z,K){const Q=O.gl;Q.texImage2D(Q.TEXTURE_2D,0,O.extRenderToTextureHalfFloat?Q.RGBA16F:Q.RGBA,Z,K,0,Q.RGBA,O.extRenderToTextureHalfFloat?Q.HALF_FLOAT:Q.UNSIGNED_BYTE,null),W.colorAttachment.set(G)}(x,0,P,k,A,R)}else I.bindTexture(I.TEXTURE_2D,k.colorAttachment.get()),x.bindFramebuffer.set(k.framebuffer)})(o,e,n,e.transform.projection.name==="globe"?.5:.25),o.clear({color:en.transparent});const d=e.transform,p=d.projection.name==="globe",m=p?["PROJECTION_GLOBE_VIEW"]:[],_=p?hn.frontCCW:hn.disabled,v=[Qr(d.center.lng),oi(d.center.lat)];for(let x=0;x<r.length;x++){const w=r[x];if(t.hasRenderableParent(w))continue;const T=t.getTile(w),S=T.getBucket(n);if(!S||S.projection.name!==d.projection.name)continue;const I=e.isTileAffectedByFog(w),A=S.programConfigurations.get(n.id),R=e.getOrCreateProgram("heatmap",{config:A,defines:m,overrideFog:I}),{zoom:k}=e.transform;e.terrain&&e.terrain.setupElevationDraw(T,R),e.uploadCommonUniforms(o,R,w.toUnwrapped());const P=d.projection.createInversionMatrix(d,w.canonical);R.draw(e,a.TRIANGLES,qe.disabled,c,u,_,l8(e,w,T,P,v,k,n.paint.get("heatmap-intensity")),n.id,S.layoutVertexBuffer,S.indexBuffer,S.segments,n.paint,e.transform.zoom,A,p?[S.globeExtVertexBuffer]:null)}o.viewport.set([0,0,e.width,e.height])}else e.renderPass==="translucent"&&(e.context.setColorMode(e.colorModeForRenderPass()),function(o,a){const c=o.context,u=c.gl,d=a.heatmapFbo;if(!d)return;c.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,d.colorAttachment.get()),c.activeTexture.set(u.TEXTURE1);let p=a.colorRampTexture;p||(p=a.colorRampTexture=new gr(c,a.colorRamp,u.RGBA)),p.bind(u.LINEAR,u.CLAMP_TO_EDGE),o.getOrCreateProgram("heatmapTexture").draw(o,u.TRIANGLES,qe.disabled,ln.disabled,o.colorModeForRenderPass(),hn.disabled,((m,_,v,x)=>({u_image:0,u_color_ramp:1,u_opacity:_.paint.get("heatmap-opacity")}))(0,a),a.id,o.viewportBuffer,o.quadTriangleIndexBuffer,o.viewportSegments,a.paint,o.transform.zoom)}(e,n))},line:function(e,t,n,r){if(e.renderPass!=="translucent")return;const o=n.paint.get("line-opacity"),a=n.paint.get("line-width");if(o.constantOr(1)===0||a.constantOr(1)===0)return;const c=n.paint.get("line-emissive-strength"),u=e.depthModeForSublayer(0,qe.ReadOnly),d=e.colorModeForDrapableLayerRenderPass(c),p=e.terrain&&e.terrain.renderingToTexture?1:Ve.devicePixelRatio,m=n.paint.get("line-dasharray"),_=m.constantOr(1),v=n.layout.get("line-cap"),x=n.paint.get("line-pattern"),w=x.constantOr(1),T=n.paint.get("line-pattern").constantOr(1),S=n.paint.get("line-opacity").constantOr(1)!==1;let I=!T&&S;const A=n.paint.get("line-gradient"),R=w?"linePattern":"line",k=e.context,P=k.gl,O=lR(n);e.terrain&&e.terrain.clipOrMaskOverlapStencilType()&&(I=!1);for(const j of r){const G=t.getTile(j);if(w&&!G.patternsLoaded())continue;const W=G.getBucket(n);if(!W)continue;e.prepareDrawTile();const Z=W.programConfigurations.get(n.id),K=e.isTileAffectedByFog(j),Q=e.getOrCreateProgram(R,{config:Z,defines:O,overrideFog:K}),at=x.constantOr(null);if(at&&G.imageAtlas){const At=G.imageAtlas.patternPositions[at.toString()];At&&Z.setConstantPatternPositions(At)}const X=m.constantOr(null),ft=v.constantOr(null);if(!w&&X&&ft&&G.lineAtlas){const At=G.lineAtlas.getDash(X,ft);At&&Z.setConstantPatternPositions(At)}let[gt,vt]=n.paint.get("line-trim-offset");(ft==="round"||ft==="square")&&gt!==vt&&(gt===0&&(gt-=1),vt===1&&(vt+=1));const ht=e.terrain?j.projMatrix:null,pt=w?FU(e,G,n,ht,p):BU(e,G,n,ht,W.lineClipsArray.length,p,[gt,vt]);if(A){const At=W.gradients[n.id];let It=At.texture;if(n.gradientVersion!==At.version){let zt=256;if(n.stepInterpolant){const Ft=t.getSource().maxzoom,Ut=j.canonical.z===Ft?Math.ceil(1<<e.transform.maxZoom-j.canonical.z):1;zt=jt(je(W.maxLineLength/Rt*1024*Ut),256,k.maxTextureSize)}At.gradient=Gm({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:zt,image:At.gradient||void 0,clips:W.lineClipsArray}),At.texture?At.texture.update(At.gradient):At.texture=new gr(k,At.gradient,P.RGBA),At.version=n.gradientVersion,It=At.texture}k.activeTexture.set(P.TEXTURE1),It.bind(n.stepInterpolant?P.NEAREST:P.LINEAR,P.CLAMP_TO_EDGE)}_&&(k.activeTexture.set(P.TEXTURE0),G.lineAtlasTexture&&G.lineAtlasTexture.bind(P.LINEAR,P.REPEAT),Z.updatePaintBuffers()),w&&(k.activeTexture.set(P.TEXTURE0),G.imageAtlasTexture&&G.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),Z.updatePaintBuffers()),e.uploadCommonUniforms(k,Q,j.toUnwrapped());const Ct=At=>{Q.draw(e,P.TRIANGLES,u,At,d,hn.disabled,pt,n.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,n.paint,e.transform.zoom,Z,[W.layoutVertexBuffer2])};if(I){const At=e.stencilModeForClipping(j).ref;At===0&&e.terrain&&k.clear({stencil:0});const It={func:P.EQUAL,mask:255};pt.u_alpha_discard_threshold=.8,Ct(new ln(It,At,255,P.KEEP,P.KEEP,P.INVERT)),pt.u_alpha_discard_threshold=0,Ct(new ln(It,At,255,P.KEEP,P.KEEP,P.KEEP))}else Ct(e.stencilModeForClipping(j))}I&&(e.resetStencilClippingMasks(),e.terrain&&k.clear({stencil:0}))},fill:function(e,t,n,r){const o=n.paint.get("fill-color"),a=n.paint.get("fill-opacity");if(a.constantOr(1)===0)return;const c=n.paint.get("fill-emissive-strength"),u=e.colorModeForDrapableLayerRenderPass(c),d=n.paint.get("fill-pattern"),p=e.opaquePassEnabledForLayer()&&!d.constantOr(1)&&o.constantOr(en.transparent).a===1&&a.constantOr(0)===1?"opaque":"translucent";if(e.renderPass===p){const m=e.depthModeForSublayer(1,e.renderPass==="opaque"?qe.ReadWrite:qe.ReadOnly);kk(e,t,n,r,m,u,!1)}if(e.renderPass==="translucent"&&n.paint.get("fill-antialias")){const m=e.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,qe.ReadOnly);kk(e,t,n,r,m,u,!0)}},"fill-extrusion":function(e,t,n,r){const o=n.paint.get("fill-extrusion-opacity"),a=e.context,c=a.gl,u=e.terrain,d=u&&u.renderingToTexture,p=n.paint.get("fill-extrusion-cutoff-fade-range");if(o===0)return;const m=e.conflationActive&&e.layerUsedInConflation(n,t.getSource());if(m&&function(_,v,x,w){for(const T of w){const S=v.getTile(T).getBucket(x);S&&(S.updateReplacement(T,_.replacementSource),S.uploadCentroid(_.context))}}(e,t,n,r),u||m)for(const _ of r){const v=t.getTile(_).getBucket(n);v&&v8(e.context,t,_,v,n,u,m)}if(e.renderPass==="shadow"&&e.shadowRenderer){const _=e.shadowRenderer;if(u&&o<.65&&n._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof fl)return;const v=_.getShadowPassDepthMode(),x=_.getShadowPassColorMode();Wg(e,t,n,r,v,ln.disabled,x,m)}else if(e.renderPass==="translucent"){const _=!n.paint.get("fill-extrusion-pattern").constantOr(1);if(!d){const v=new qe(e.context.gl.LEQUAL,qe.ReadWrite,e.depthRangeFor3D);p===0&&o===1&&_?Wg(e,t,n,r,v,ln.disabled,Mn.unblended,m):(Wg(e,t,n,r,v,ln.disabled,Mn.disabled,m),Wg(e,t,n,r,v,e.stencilModeFor3D(),e.colorModeForRenderPass(),m),e.resetStencilClippingMasks())}if(e.style.enable3dLights()&&_&&(!u&&e.transform.projection.name!=="globe"||d)){const v=n.paint.get("fill-extrusion-opacity"),x=n.paint.get("fill-extrusion-ambient-occlusion-intensity"),w=n.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),T=n.paint.get("fill-extrusion-flood-light-intensity"),S=n.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),I=x>0&&w>0,A=T>0,R=(P,O,j)=>(1-j)*P+j*O,k=P=>{const O=e.depthModeForSublayer(1,qe.ReadOnly,c.LEQUAL,!0),j=n.paint.get(P?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),G=R(.1,3,j),W=e._showOverdrawInspector;if(!W){const Z=new ln({func:c.ALWAYS,mask:255},255,255,c.KEEP,c.KEEP,c.REPLACE),K=new Mn([c.ONE,c.ONE,c.ONE,c.ONE],en.transparent,[!1,!1,!1,!0],c.MIN);gh(e,t,n,r,O,Z,K,hn.disabled,P,"sdf",v,x,w,T,S,G,m,!1)}{const Z=W?ln.disabled:new ln({func:c.EQUAL,mask:255},255,255,c.KEEP,c.DECR,c.DECR),K=W?e.colorModeForRenderPass():new Mn([c.ONE_MINUS_DST_ALPHA,c.DST_ALPHA,c.ONE,c.ONE],en.transparent,[!0,!0,!0,!0]);gh(e,t,n,r,O,Z,K,hn.disabled,P,"color",v,x,w,T,S,G,m,!1)}};if(d){const P=(O,j,G)=>{const W=e.depthModeForSublayer(1,qe.ReadOnly,c.LEQUAL,!1),Z=n.paint.get(O?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),K=R(.1,3,Z);{const Q=new Mn([c.ONE,c.ONE,c.ONE,c.ONE],en.transparent,[!1,!1,!1,!0]);gh(e,t,n,r,W,ln.disabled,Q,hn.disabled,O,"clear",v,x,w,T,S,K,m,j)}{const Q=new ln({func:c.ALWAYS,mask:255},255,255,c.KEEP,c.KEEP,c.REPLACE),at=new Mn([c.ONE,c.ONE,c.ONE,c.ONE],en.transparent,[!1,!1,!1,!0],c.MIN);gh(e,t,n,r,W,Q,at,hn.disabled,O,"sdf",v,x,w,T,S,K,m,j)}{const Q=O?c.ZERO:c.ONE_MINUS_DST_ALPHA,at=new ln({func:c.EQUAL,mask:255},255,255,c.KEEP,c.DECR,c.DECR),X=new Mn([Q,c.DST_ALPHA,c.ONE_MINUS_DST_ALPHA,c.ZERO],en.transparent,[!0,!0,!0,!0]);gh(e,t,n,r,W,at,X,hn.disabled,O,"color",v,x,w,T,S,K,m,j)}{const Q=new Mn([c.ONE,c.ONE,c.ONE,O?c.ZERO:c.ONE],en.transparent,[!1,!1,!1,!0],O?c.FUNC_ADD:c.MAX);gh(e,t,n,r,W,ln.disabled,Q,hn.disabled,O,"clear",v,x,w,T,S,K,m,j,G)}};if(I||A){let O;if(e.prepareDrawTile(),u){const j=u.drapeBufferSize[0],G=u.drapeBufferSize[1];O=u.framebufferCopyTexture,O&&(!O||O.size[0]===j&&O.size[1]===G)||(O&&O.destroy(),O=u.framebufferCopyTexture=new gr(a,new jr({width:j,height:G}),c.RGBA)),O.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,0,0,j,G,0)}I&&P(!0,!1,O),A&&P(!1,!0,O)}}else I&&k(!0),A&&k(!1)}}},hillshade:function(e,t,n,r){if(e.renderPass!=="offscreen"&&e.renderPass!=="translucent"||e.style.disableElevatedTerrain)return;const o=e.context,a=e.terrain&&e.terrain.renderingToTexture,[c,u]=e.renderPass!=="translucent"||a?[{},r]:e.stencilConfigForOverlap(r);for(const d of u){const p=t.getTile(d);if(p.needsHillshadePrepare&&e.renderPass==="offscreen")H$(e,p,n);else if(e.renderPass==="translucent"){const m=e.depthModeForSublayer(0,qe.ReadOnly),_=n.paint.get("hillshade-emissive-strength"),v=e.colorModeForDrapableLayerRenderPass(_),x=a&&e.terrain?e.terrain.stencilModeForRTTOverlap(d):c[d.overscaledZ];q$(e,d,p,n,m,x,v)}}o.viewport.set([0,0,e.width,e.height]),e.resetStencilClippingMasks()},raster:function(e,t,n,r,o,a){if(e.renderPass!=="translucent"||n.paint.get("raster-opacity")===0)return;const c=e.context,u=c.gl,d=t.getSource(),p=function(j,G,W){const Z=j.paint.get("raster-color"),K=[],Q=j.paint.get("raster-resampling"),at=j.paint.get("raster-color-mix"),X=j.paint.get("raster-color-range"),ft=[at[0],at[1],at[2],0],gt=at[3],vt=Q==="nearest"?W.NEAREST:W.LINEAR;if(Z&&K.push("RASTER_COLOR"),Z){G.activeTexture.set(W.TEXTURE2);let ht=j.colorRampTexture;ht||(ht=j.colorRampTexture=new gr(G,j.colorRamp,W.RGBA)),ht.bind(W.LINEAR,W.CLAMP_TO_EDGE)}return{mix:ft,range:X,offset:gt,defines:K,resampling:vt}}(n,c,u),m=p.defines,_=e.transform.projection.name==="globe";let v=!1;if(d instanceof ms&&!r.length){if(!_)return;if(d.onNorthPole)v=!0,m.push("GLOBE_POLES");else{if(!d.onSouthPole)return;v=!0,m.push("GLOBE_POLES")}}const x=n.paint.get("raster-emissive-strength"),w=e.colorModeForDrapableLayerRenderPass(x),T=e.terrain&&e.terrain.renderingToTexture,S=d instanceof ms&&n.paint.get("raster-elevation")!==0,I=!e.options.moving,A=n.paint.get("raster-resampling")==="nearest"?u.NEAREST:u.LINEAR;if(v){const j=t.getSource();if(!(j instanceof ms))return;const G=j.texture;if(!G)return;const W=e.globeSharedBuffers;if(!W)return;const Z=new qe(u.LEQUAL,qe.ReadWrite,e.depthRangeFor3D),K=Float32Array.from(e.transform.expandedFarZProjMatrix);let Q=FI(0,0,e.transform);const at=Float32Array.from(Tl(qo(new hs(0,0,0)))),X={opacity:1,mix:0};e.terrain&&e.terrain.prepareDrawTile(),c.activeTexture.set(u.TEXTURE0),G.bind(A,u.CLAMP_TO_EDGE),c.activeTexture.set(u.TEXTURE1),G.bind(A,u.CLAMP_TO_EDGE),G.useMipmap&&c.extTextureFilterAnisotropic&&e.transform.pitch>20&&u.texParameterf(u.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax);const[ft,gt,vt,ht]=W.getPoleBuffers(0,!0);let pt;j.onNorthPole?(pt=ft,e.renderDefaultNorthPole=!1):(Q=wt.scale(wt.create(),Q,[1,-1,1]),pt=gt,e.renderDefaultSouthPole=!1);const Ct=((It,zt,Ft,Ut,Pt,Ht,he,de,_e,xe,He,Ae)=>Tk(It,zt,Ft,new Float32Array(16),new Float32Array(9),[0,0],[0,0,0,0],0,[0,0],[0,0,0,0],1,Ut,Pt,Ht||[0,0],he,2,_e,xe,He,1,0,Ae))(K,at,Q,X,n,j.perspectiveTransform||[0,0],n.paint.get("raster-elevation"),0,p.mix,p.offset,p.range,x),At=e.getOrCreateProgram("raster",{defines:p.defines});return e.uploadCommonUniforms(c,At,null),void At.draw(e,u.TRIANGLES,Z,ln.disabled,w,hn.disabled,Ct,n.id,pt,vt,ht)}if(!r.length)return;const[R,k]=d instanceof ms||T?[{},r]:e.stencilConfigForOverlap(r),P=k[k.length-1].overscaledZ,O=S&&_;O&&p.defines.push("PROJECTION_GLOBE_VIEW"),S&&p.defines.push("RENDER_CUTOFF");for(const j of k){const G=j.toUnwrapped(),W=t.getTile(j);if(T&&(!W||!W.hasData())||!W.texture)continue;let Z,K;T?(Z=qe.disabled,K=j.projMatrix):S?(Z=new qe(u.LEQUAL,qe.ReadWrite,e.depthRangeFor3D),K=_?Float32Array.from(e.transform.expandedFarZProjMatrix):e.transform.calculateProjMatrix(G,I)):(Z=e.depthModeForSublayer(j.overscaledZ-P,n.paint.get("raster-opacity")===1?qe.ReadWrite:qe.ReadOnly,u.LESS),K=e.transform.calculateProjMatrix(G,I));const Q=e.terrain&&T?e.terrain.stencilModeForRTTOverlap(j):R[j.overscaledZ],at=a?0:n.paint.get("raster-fade-duration");W.registerFadeDuration(at);const X=t.findLoadedParent(j,0),ft=mk(W,X,t,e.transform,at);let gt,vt;e.terrain&&e.terrain.prepareDrawTile(),c.activeTexture.set(u.TEXTURE0),W.texture&&W.texture.bind(A,u.CLAMP_TO_EDGE),c.activeTexture.set(u.TEXTURE1),X?(X.texture&&X.texture.bind(A,u.CLAMP_TO_EDGE),gt=Math.pow(2,X.tileID.overscaledZ-W.tileID.overscaledZ),vt=[W.tileID.canonical.x*gt%1,W.tileID.canonical.y*gt%1]):W.texture&&W.texture.bind(A,u.CLAMP_TO_EDGE),W.texture&&W.texture.useMipmap&&c.extTextureFilterAnisotropic&&e.transform.pitch>20&&u.texParameterf(u.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax);const ht=e.transform,pt=d instanceof ms?d.perspectiveTransform:[0,0],Ct=S?S8(ht):[0,0,0,0];let At,It,zt,Ft,Ut,Pt;if(O&&d instanceof ms&&d.coordinates.length>3){At=Float32Array.from(Tl(qo(new hs(0,0,0)))),It=Float32Array.from(ht.globeMatrix),zt=Float32Array.from(BI(ht)),Ft=[Qr(ht.center.lng),oi(ht.center.lat)],Pt=[Qr(d.coordinates[1][0]),oi(d.coordinates[1][1]),Qr(d.coordinates[3][0]),oi(d.coordinates[3][1])];const _e=new To(d.coordinates[1],d.coordinates[3]);Ut=Float32Array.from(jI(new hs(0,0,0),_e,0,ht.worldSize/e.transform._pixelsPerMercatorPixel))}else At=new Float32Array(16),It=new Float32Array(9),zt=new Float32Array(16),Ft=[0,0],Ut=new Float32Array(16),Pt=[0,0,0,0];const Ht=Tk(K,At,It,zt,Ut,vt||[0,0],Pt,fi(e.transform.zoom),Ft,Ct,gt||1,ft,n,pt,S?n.paint.get("raster-elevation"):0,2,p.mix,p.offset,p.range,1,0,x),he=e.isTileAffectedByFog(j),de=e.getOrCreateProgram("raster",{defines:p.defines,overrideFog:he});if(e.uploadCommonUniforms(c,de,G),d instanceof ms){if(T||!_)d.boundsBuffer&&d.boundsSegments&&de.draw(e,u.TRIANGLES,Z,ln.disabled,w,hn.disabled,Ht,n.id,d.boundsBuffer,e.quadTriangleIndexBuffer,d.boundsSegments);else if(e.globeSharedBuffers){const[_e,xe,He]=e.globeSharedBuffers.getGridBuffers(0,!1);de.draw(e,u.TRIANGLES,Z,ln.disabled,w,hn.frontCCW,Ht,n.id,_e,xe,He),de.draw(e,u.TRIANGLES,Z,ln.disabled,w,hn.backCCW,Ht,n.id,_e,xe,He)}}else{const{tileBoundsBuffer:_e,tileBoundsIndexBuffer:xe,tileBoundsSegments:He}=e.getTileBoundsBuffers(W);de.draw(e,u.TRIANGLES,Z,Q,w,hn.disabled,Ht,n.id,_e,xe,He)}}e.resetStencilClippingMasks()},background:function(e,t,n,r){const o=n.paint.get("background-color"),a=n.paint.get("background-opacity"),c=n.paint.get("background-emissive-strength");if(a===0)return;const u=e.context,d=u.gl,p=e.transform,m=p.tileSize,_=n.paint.get("background-pattern");if(e.isPatternMissing(_,n.scope))return;const v=!_&&o.a===1&&a===1&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==v)return;const x=ln.disabled,w=e.depthModeForSublayer(0,v==="opaque"?qe.ReadWrite:qe.ReadOnly),T=e.colorModeForDrapableLayerRenderPass(c),S=_?"backgroundPattern":"background";let I,A=r;A||(I=e.getBackgroundTiles(),A=Object.values(I).map(R=>R.tileID)),_&&(u.activeTexture.set(d.TEXTURE0),e.imageManager.bind(e.context,n.scope));for(const R of A){const k=e.isTileAffectedByFog(R),P=e.getOrCreateProgram(S,{overrideFog:k}),O=R.toUnwrapped(),j=r?R.projMatrix:e.transform.calculateProjMatrix(O);e.prepareDrawTile();const G=t?t.getTile(R):I?I[R.key]:new _f(R,m,p.zoom,e),W=_?p8(j,c,a,e,_,n.scope,{tileID:R,tileSize:m}):f8(j,c,a,o);e.uploadCommonUniforms(u,P,O);const{tileBoundsBuffer:Z,tileBoundsIndexBuffer:K,tileBoundsSegments:Q}=e.getTileBoundsBuffers(G);P.draw(e,d.TRIANGLES,w,x,T,hn.disabled,W,n.id,Z,K,Q)}},sky:function(e,t,n){const r=e._atmosphere?fi(e.transform.zoom):1,o=n.paint.get("sky-opacity")*r;if(o===0)return;const a=e.context,c=n.paint.get("sky-type"),u=new qe(a.gl.LEQUAL,qe.ReadOnly,[0,1]),d=e.frameCounter/1e3%1;c==="atmosphere"?e.renderPass==="offscreen"?n.needsSkyboxCapture(e)&&(function(p,m,_,v){const x=p.context,w=x.gl;let T=m.skyboxFbo;if(!T){T=m.skyboxFbo=x.createFramebuffer(32,32,!0,null),m.skyboxGeometry=new zk(x),m.skyboxTexture=x.gl.createTexture(),w.bindTexture(w.TEXTURE_CUBE_MAP,m.skyboxTexture),w.texParameteri(w.TEXTURE_CUBE_MAP,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_CUBE_MAP,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_CUBE_MAP,w.TEXTURE_MIN_FILTER,w.LINEAR),w.texParameteri(w.TEXTURE_CUBE_MAP,w.TEXTURE_MAG_FILTER,w.LINEAR);for(let R=0;R<6;++R)w.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+R,0,w.RGBA,32,32,0,w.RGBA,w.UNSIGNED_BYTE,null)}x.bindFramebuffer.set(T.framebuffer),x.viewport.set([0,0,32,32]);const S=m.getCenter(p,!0),I=p.getOrCreateProgram("skyboxCapture"),A=new Float64Array(16);wt.identity(A),wt.rotateY(A,A,.5*-Math.PI),_h(p,m,I,A,S,0),wt.identity(A),wt.rotateY(A,A,.5*Math.PI),_h(p,m,I,A,S,1),wt.identity(A),wt.rotateX(A,A,.5*-Math.PI),_h(p,m,I,A,S,2),wt.identity(A),wt.rotateX(A,A,.5*Math.PI),_h(p,m,I,A,S,3),wt.identity(A),_h(p,m,I,A,S,4),wt.identity(A),wt.rotateY(A,A,Math.PI),_h(p,m,I,A,S,5),x.viewport.set([0,0,p.width,p.height])}(e,n),n.markSkyboxValid(e)):e.renderPass==="sky"&&function(p,m,_,v,x){const w=p.context,T=w.gl,S=p.transform,I=p.getOrCreateProgram("skybox");w.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_CUBE_MAP,m.skyboxTexture);const A=((R,k,P,O,j)=>({u_matrix:R,u_sun_direction:k,u_cubemap:0,u_opacity:O,u_temporal_offset:j}))(S.skyboxMatrix,m.getCenter(p,!1),0,v,x);p.uploadCommonUniforms(w,I),I.draw(p,T.TRIANGLES,_,ln.disabled,p.colorModeForRenderPass(),hn.backCW,A,"skybox",m.skyboxGeometry.vertexBuffer,m.skyboxGeometry.indexBuffer,m.skyboxGeometry.segment)}(e,n,u,o,d):c==="gradient"&&e.renderPass==="sky"&&function(p,m,_,v,x){const w=p.context,T=w.gl,S=p.transform,I=p.getOrCreateProgram("skyboxGradient");m.skyboxGeometry||(m.skyboxGeometry=new zk(w)),w.activeTexture.set(T.TEXTURE0);let A=m.colorRampTexture;A||(A=m.colorRampTexture=new gr(w,m.colorRamp,T.RGBA)),A.bind(T.LINEAR,T.CLAMP_TO_EDGE);const R=((k,P,O,j,G)=>({u_matrix:k,u_color_ramp:0,u_center_direction:P,u_radius:it(O),u_opacity:j,u_temporal_offset:G}))(S.skyboxMatrix,m.getCenter(p,!1),m.paint.get("sky-gradient-radius"),v,x);p.uploadCommonUniforms(w,I),I.draw(p,T.TRIANGLES,_,ln.disabled,p.colorModeForRenderPass(),hn.backCW,R,"skyboxGradient",m.skyboxGeometry.vertexBuffer,m.skyboxGeometry.indexBuffer,m.skyboxGeometry.segment)}(e,n,u,o,d)},debug:function(e,t,n){for(let r=0;r<n.length;r++)P8(e,t,n[r])},custom:function(e,t,n,r){const o=e.context,a=n.implementation;if(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes("custom")||e.terrain&&(e.terrain.renderingToTexture||e.renderPass==="offscreen")&&n.isLayerDraped(t)){if(e.renderPass==="offscreen"){const c=a.prerender;if(c){if(e.setCustomLayerDefaults(),o.setColorMode(e.colorModeForRenderPass()),e.transform.projection.name==="globe"){const u=e.transform.pointMerc;c.call(a,o.gl,e.transform.customLayerMatrix(),e.transform.getProjection(),e.transform.globeToMercatorMatrix(),fi(e.transform.zoom),[u.x,u.y],e.transform.pixelsPerMeterRatio)}else c.call(a,o.gl,e.transform.customLayerMatrix());o.setDirty(),e.setBaseState()}}else if(e.renderPass==="translucent"){if(e.terrain&&e.terrain.renderingToTexture){const u=a.renderToTile;if(u){const d=r[0].canonical,p=new xn(d.x+r[0].wrap*(1<<d.z),d.y,d.z);o.setDepthMode(qe.disabled),o.setStencilMode(ln.disabled),o.setColorMode(e.colorModeForRenderPass()),e.setCustomLayerDefaults(),u.call(a,o.gl,p),o.setDirty(),e.setBaseState()}return}e.setCustomLayerDefaults(),o.setColorMode(e.colorModeForRenderPass()),o.setStencilMode(ln.disabled);const c=a.renderingMode==="3d"?new qe(e.context.gl.LEQUAL,qe.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,qe.ReadOnly);if(o.setDepthMode(c),e.transform.projection.name==="globe"){const u=e.transform.pointMerc;a.render(o.gl,e.transform.customLayerMatrix(),e.transform.getProjection(),e.transform.globeToMercatorMatrix(),fi(e.transform.zoom),[u.x,u.y],e.transform.pixelsPerMeterRatio)}else a.render(o.gl,e.transform.customLayerMatrix());o.setDirty(),e.setBaseState(),o.bindFramebuffer.set(null)}}else dt("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(e,t,n,r){if(e.renderPass==="opaque")return;const o=n.paint.get("model-opacity");if(o===0)return;const a=n.paint.get("model-cast-shadows");if(e.renderPass==="shadow"&&(!a||e.terrain&&o<.65&&n._transitionablePaint._values["model-opacity"].value.expression instanceof fl))return;const c=e.shadowRenderer,u=n.paint.get("model-receive-shadows");c&&(c.useNormalOffset=!0,u||(c.enabled=!1));const d=()=>{c&&(c.useNormalOffset=!0,u||(c.enabled=!0))},p=t.getSource();if(e.renderPass==="light-beam"&&p.type!=="batched-model")return;if(p.type==="vector"||p.type==="geojson")return function(I,A,R,k){const P=I.transform;if(P.projection.name!=="mercator")return void dt(`Drawing 3D models for ${P.projection.name} projection is not yet implemented`);const O=P.getFreeCameraOptions().position;if(!I.modelManager)return;const j=I.modelManager,G=I.shadowRenderer;if(!R._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const W=R._unevaluatedLayout._values["model-id"],Z={...R.layout.get("model-id").parameters};for(const K of k){const Q=A.getTile(K).getBucket(R);if(!Q||Q.projection.name!==P.projection.name)continue;const at=F8(K,P);Z.zoom=at;const X=W.possiblyEvaluate(Z);if(B8(I,Q,K),ua.shadowUniformsInitialized=!1,ua.useSingleShadowCascade=!!G&&G.getMaxCascadeForTile(K.toUnwrapped())===0,I.renderPass==="shadow"&&G){if(I.currentShadowCascade===1&&Q.isInsideFirstShadowMapFrustum)continue;const vt=P.calculatePosMatrix(K.toUnwrapped(),P.worldSize);if(ua.tileMatrix.set(vt),ua.shadowTileMatrix=Float32Array.from(G.calculateShadowPassMatrixFromMatrix(vt)),ua.aabb.min.fill(0),ua.aabb.max[0]=ua.aabb.max[1]=Rt,ua.aabb.max[2]=0,j8(Q,ua,I,R.scope))continue}const ft=1<<K.canonical.z,gt=[((O.x-K.wrap)*ft-K.canonical.x)*Rt,(O.y*ft-K.canonical.y)*Rt,O.z*ft*Rt];for(let vt in Q.instancesPerModel){const ht=Q.instancesPerModel[vt];ht.features.length>0&&(vt=X.evaluate(ht.features[0].feature,{}));const pt=j.getModel(vt,R.scope);if(pt&&pt.uploaded)for(const Ct of pt.nodes)Fk(I,R,Ct,ht,gt,K,ua)}}}(e,t,n,r),void d();if(!p.loaded())return;if(p.type==="batched-model")return function(I,A,R,k){const P=I.context,O=I.transform,j=I.style.fog,G=I.shadowRenderer;if(O.projection.name!=="mercator")return void dt(`Drawing 3D landmark models for ${O.projection.name} projection is not yet implemented`);const W=I.transform.getFreeCameraOptions().position,Z=ot.scale([],[W.x,W.y,W.z],I.transform.worldSize);ot.negate(Z,Z);const K=wt.identity([]),Q=El(O.center.lat,O.zoom),at=wt.fromScaling([],[1,1,1/Q]);wt.translate(K,K,Z);const X=R.paint.get("model-opacity"),ft=new qe(P.gl.LEQUAL,qe.ReadWrite,I.depthRangeFor3D),gt=new qe(P.gl.LEQUAL,qe.ReadOnly,I.depthRangeFor3D),vt=function(ht,pt){for(const Ct of k){const At=A.getTile(Ct).getBucket(R);if(!At||!At.uploaded)continue;let It=!1;G&&(It=G.getMaxCascadeForTile(Ct.toUnwrapped())===0);const zt=O.calculatePosMatrix(Ct.toUnwrapped(),O.worldSize),Ft=At.modelTraits;for(const Ut of At.getNodesInfo()){if(Ut.hiddenByReplacement||!Ut.node.meshes)continue;const Pt=Ut.node,Ht=I.renderPass==="light-beam",he=[...zt],de=Ut.evaluatedScale;let _e=0;I.terrain&&Pt.elevation&&(_e=Pt.elevation*I.terrain.exaggeration()),wt.translate(he,he,[(Pt.anchor?Pt.anchor[0]:0)*(de[0]-1),(Pt.anchor?Pt.anchor[1]:0)*(de[1]-1),_e]),de!==_U&&wt.scale(he,he,de),wt.multiply(he,he,Pt.matrix);const xe=wt.multiply([],at,he);wt.multiply(xe,K,xe);const He=wt.invert([],xe);wt.transpose(He,He),wt.scale(He,He,N8);const Ae=wt.multiply([],O.expandedFarZProjMatrix,he);for(let Sn=0;Sn<Pt.meshes.length;++Sn){const pn=Pt.meshes[Sn],Ze=Sn===Pt.lightMeshIndex;if(Ze){if(!Ht&&!I.terrain&&I.shadowRenderer){I.currentLayer<I.firstLightBeamLayer&&(I.firstLightBeamLayer=I.currentLayer);continue}}else if(Ht)continue;const We={defines:[]},ze=[];mb(We.defines,ze,pn,I),4&Ft||We.defines.push("DIFFUSE_SHADED"),It&&We.defines.push("SHADOWS_SINGLE_CASCADE");const yn=I.renderPass==="shadow";if(yn){gb(pn,he,I,R);continue}let wn=null;if(j){const Dr=Dk(he,I.transform);if(wn=new Float32Array(Dr),O.projection.name!=="globe"){const zr=pn.aabb.min,sr=pn.aabb.max,[jn,bi]=j.getOpacityForBounds(Dr,zr[0],zr[1],sr[0],sr[1]);We.overrideFog=jn>=Bc||bi>=Bc}}const sn=I.getOrCreateProgram("model",We);!yn&&G&&(G.useNormalOffset=!!pn.normalBuffer,G.setupShadowsFromMatrix(he,sn,G.useNormalOffset)),I.uploadCommonUniforms(P,sn,Ct.toUnwrapped(),wn);const Zn=pn.material,Lr=Zn.pbrMetallicRoughness;Lr.metallicFactor=.9,Lr.roughnessFactor=.5;const qn=0,rr=fb(new Float32Array(Ae),new Float32Array(xe),new Float32Array(He),I,X,Lr.baseColorFactor,Zn.emissiveFactor,Lr.metallicFactor,Lr.roughnessFactor,Zn,qn,R);sn.draw(I,P.gl.TRIANGLES,pt&&!Ze?ft:gt,ln.disabled,ht?Ze||X<1||Ut.hasTranslucentParts?Mn.alphaBlended:Mn.unblended:Mn.disabled,hn.backCCW,rr,R.id,pn.vertexBuffer,pn.indexBuffer,pn.segments,R.paint,I.transform.zoom,void 0,ze)}}}};(function(ht,pt,Ct,At){const It=ht.terrain?ht.terrain.exaggeration():0,zt=ht.transform.zoom;for(const Ft of At){const Ut=pt.getTile(Ft).getBucket(Ct);Ut&&(ht.conflationActive&&Ut.updateReplacement(Ft,ht.replacementSource),Ut.evaluateScale(ht,Ct),ht.terrain&&It>0&&Ut.elevationUpdate(ht.terrain,It,Ft,Ct.source),Ut.needsReEvaluation(ht,zt,Ct)&&Ut.evaluate(Ct))}})(I,A,R,k),X===1?vt(!0,!0):(vt(!1,!0),vt(!0,!1))}(e,t,n,r),void d();const m=p.getModels(),_=[],v=e.transform.getFreeCameraOptions().position,x=ot.scale([],[v.x,v.y,v.z],e.transform.worldSize);ot.negate(x,x);const w=[],T=[];let S=0;for(const I of m){const A=n.paint.get("model-rotation").constantOr(null),R=n.paint.get("model-scale").constantOr(null),k=n.paint.get("model-translation").constantOr(null);I.computeModelMatrix(e,A,R,k,!0,!0,!1);const P=wt.identity([]),O=El(I.position.lat,e.transform.zoom),j=wt.fromScaling([],[1,1,1/O]);wt.translate(P,P,x),_.push({zScaleMatrix:j,negCameraPosMatrix:P});for(const G of I.nodes)Bk(e.transform,G,I.matrix,e.transform.expandedFarZProjMatrix,S,w,T);S++}if(w.sort((I,A)=>A.depth-I.depth),e.renderPass!=="shadow"){if(o===1)for(const I of T)Hg(I,e,n,_[I.modelIndex],ln.disabled,e.colorModeForRenderPass());else{for(const I of T)Hg(I,e,n,_[I.modelIndex],ln.disabled,Mn.disabled);for(const I of T)Hg(I,e,n,_[I.modelIndex],e.stencilModeFor3D(),e.colorModeForRenderPass());e.resetStencilClippingMasks()}for(const I of w)Hg(I,e,n,_[I.modelIndex],ln.disabled,e.colorModeForRenderPass());d()}else{for(const I of T)gb(I.mesh,I.nodeModelMatrix,e,n);for(const I of w)gb(I.mesh,I.nodeModelMatrix,e,n);d()}}},jk={modelUpload:function(e,t,n){const r=t.getSource();if(!r.loaded())return;if(r.type==="vector"||r.type==="geojson")return void(e.modelManager&&e.modelManager.upload(e,n));if(r.type==="batched-model")return;const o=r.getModels();for(const a of o)a.upload(e.context)}};class V8{constructor(t,n,r){this.context=new sU(t,n),this.transform=r,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=Bs.maxUnderzooming+Bs.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new TU,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new q8(this),this._wireframeDebugCache=new $8,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(t,n){const r=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(r||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Y$(this,t));const o=this._terrain;this.transform.elevation=r?o:null,o.update(t,this.transform,n),this.transform.elevation&&!o.enabled&&(this.transform.elevation=null)}_updateFog(t){const n=t.fog;if(!n||this.transform.projection.name==="globe"||n.getOpacity(this.transform.pitch)<1||n.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[r,o]=n.getFovAdjustedRange(this.transform._fov);if(r>o)return void(this.transform.fogCullDistSq=null);const a=r+.78*(o-r);this.transform.fogCullDistSq=a*a}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(t,n){if(this.width=t*Ve.devicePixelRatio,this.height=n*Ve.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const r of this.style.order)this.style._mergedLayers[r].resize()}setup(){const t=this.context,n=new bo;n.emplaceBack(0,0),n.emplaceBack(Rt,0),n.emplaceBack(0,Rt),n.emplaceBack(Rt,Rt),this.tileExtentBuffer=t.createVertexBuffer(n,bl.members),this.tileExtentSegments=Gn.simpleSegment(0,0,4,2);const r=new bo;r.emplaceBack(0,0),r.emplaceBack(Rt,0),r.emplaceBack(0,Rt),r.emplaceBack(Rt,Rt),this.debugBuffer=t.createVertexBuffer(r,bl.members),this.debugSegments=Gn.simpleSegment(0,0,4,5);const o=new bo;o.emplaceBack(-1,-1),o.emplaceBack(1,-1),o.emplaceBack(-1,1),o.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(o,bl.members),this.viewportSegments=Gn.simpleSegment(0,0,4,2);const a=new Cc;a.emplaceBack(0,0,0,0),a.emplaceBack(Rt,0,Rt,0),a.emplaceBack(0,Rt,0,Rt),a.emplaceBack(Rt,Rt,Rt,Rt),this.mercatorBoundsBuffer=t.createVertexBuffer(a,P1.members),this.mercatorBoundsSegments=Gn.simpleSegment(0,0,4,2);const c=new Wr;c.emplaceBack(0,1,2),c.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(c);const u=new Zd;for(const p of[0,1,3,2,0])u.emplaceBack(p);this.debugIndexBuffer=t.createIndexBuffer(u),this.emptyTexture=new gr(t,new jr({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=wt.create();const d=this.context.gl;this.stencilClearMode=new ln({func:d.ALWAYS,mask:0},0,255,d.ZERO,d.ZERO,d.ZERO),this.loadTimeStamps.push(C.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,t.TRIANGLES,qe.disabled,this.stencilClearMode,Mn.disabled,hn.disabled,db(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,n,r){if(!n||this.currentStencilSource===n.id||!t.isTileClipped()||!r||r.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let u=!1;for(const d of r)if(this._tileClippingMaskIDs[d.key]===void 0){u=!0;break}if(!u)return}this.currentStencilSource=n.id;const o=this.context,a=o.gl;this.nextStencilID+r.length>256&&this.clearStencil(),o.setColorMode(Mn.disabled),o.setDepthMode(qe.disabled);const c=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const u of r){const d=n.getTile(u),p=this._tileClippingMaskIDs[u.key]=this.nextStencilID++,{tileBoundsBuffer:m,tileBoundsIndexBuffer:_,tileBoundsSegments:v}=this.getTileBoundsBuffers(d);c.draw(this,a.TRIANGLES,qe.disabled,new ln({func:a.ALWAYS,mask:0},p,255,a.KEEP,a.KEEP,a.REPLACE),Mn.disabled,hn.disabled,db(u.projMatrix),"$clipping",m,_,v)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,n=this.context.gl;return new ln({func:n.NOTEQUAL,mask:255},t,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const n=this.context.gl;return new ln({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,n.KEEP,n.KEEP,n.REPLACE)}stencilConfigForOverlap(t){const n=this.context.gl,r=t.sort((c,u)=>u.overscaledZ-c.overscaledZ),o=r[r.length-1].overscaledZ,a=r[0].overscaledZ-o+1;if(a>1){this.currentStencilSource=void 0,this.nextStencilID+a>256&&this.clearStencil();const c={};for(let u=0;u<a;u++)c[u+o]=new ln({func:n.GEQUAL,mask:255},u+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=a,[c,r]}return[{[o]:ln.disabled},r]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Mn([t.CONSTANT_COLOR,t.ONE,t.CONSTANT_COLOR,t.ONE],new en(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Mn.unblended:Mn.alphaBlended}colorModeForDrapableLayerRenderPass(t){const n=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Mn([n.ONE,n.ONE_MINUS_SRC_ALPHA,n.CONSTANT_ALPHA,n.ONE_MINUS_SRC_ALPHA],new en(0,0,0,t===void 0?0:t),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(t,n,r,o=!1){if(!this.opaquePassEnabledForLayer()&&!o)return qe.disabled;const a=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new qe(r||this.context.gl.LEQUAL,n,[a,a])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,n){this._wireframeDebugCache.update(this.frameCounter),this.style=t,this.options=n;const r=this.style._mergedLayers,o=this.style.order,a=o.map(P=>r[P]),c=this.style._mergedSourceCaches;this.imageManager=t.imageManager,this.modelManager=t.modelManager,this.symbolFadeChange=t.placement.symbolFadeChange(Ve.now()),this.imageManager.beginFrame();let u=0,d=!1;for(const P in c){const O=c[P];O.used&&(O.prepare(this.context),O.getSource().usedInConflation&&++u)}const p={},m={},_={},v={},x={};for(const P in c){const O=c[P];p[P]=O.getVisibleCoordinates(),m[P]=p[P].slice().reverse(),_[P]=O.getVisibleCoordinates(!0).reverse(),v[P]=O.getShadowCasterCoordinates(),x[P]=O.sortCoordinatesByDistance(p[P])}const w=P=>{const O=this.style.getLayerSourceCache(P);return O&&O.used?O.getSource():null};if(u){const P=[];for(const O of a)this.layerUsedInConflation(O,w(O))&&P.push(O);if(P&&P.length>1){const O=[];for(const j of P){const G=this.style.getLayerSourceCache(j);G&&G.used&&G.getSource().usedInConflation&&O.push({layer:j.fqid,cache:G})}this.replacementSource.setSources(O),d=!0}}d||this.replacementSource.clear(),this.conflationActive=d,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const P of a){const O=P.cutoffRange();if(this.longestCutoffRange=Math.max(O,this.longestCutoffRange),O>0){const j=w(P);j&&(this.minCutoffZoom=Math.max(j.minzoom,this.minCutoffZoom)),P.minzoom&&(this.minCutoffZoom=Math.max(P.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let P=0;P<a.length;P++)if(a[P].is3D()){this.opaquePassCutoff=P;break}const T=this.style&&this.style.fog;T?(this._fogVisible=T.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=T.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(_),this.opaquePassCutoff=0);const S=this._shadowRenderer;if(S){S.updateShadowParameters(this.transform,this.style.directionalLight);for(const P in c)for(const O of p[P]){let j={min:0,max:0};this.terrain&&(j=this.terrain.getMinMaxForTile(O)||j),S.addShadowReceiver(O.toUnwrapped(),j.min,j.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new bN(this.context));for(const P of a){if(P.isHidden(this.transform.zoom))continue;const O=t.getLayerSourceCache(P);this.uploadLayer(this,P,O)}if(this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new D8),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!Sa.has(this.context.gl))return;this.renderPass="offscreen";for(const P of a){const O=t.getLayerSourceCache(P);if(!P.hasOffscreenPass()||P.isHidden(this.transform.zoom))continue;const j=O?m[O.id]:void 0;(P.type==="custom"||P.type==="raster"||P.isSky()||j&&j.length)&&this.renderLayer(this,O,P,j)}this.depthRangeFor3D=[0,1-(a.length+2)*this.numSublayers*this.depthEpsilon];const I=this.terrain;I&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&I.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,v)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const A=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),R=(()=>{if(n.showOverdrawInspector)return en.black;if(this.style.fog&&this.transform.projection.supportsFog&&!A){const P=this.style.fog.properties.get("color").toArray01();return new en(...P)}if(this.style.fog&&this.transform.projection.supportsFog&&A){const P=this.style.fog.properties.get("space-color").toArray01();return new en(...P)}return en.transparent})();if(this.context.clear({color:R,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&A&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=o.length-1;this.currentLayer>=0;this.currentLayer--){const P=a[this.currentLayer],O=t.getLayerSourceCache(P);if(P.isSky())continue;const j=O?(P.is3D()?x:m)[O.id]:void 0;this._renderTileClippingMasks(P,O,j),this.renderLayer(this,O,P,j)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&A&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||fi(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<o.length;this.currentLayer++){const P=a[this.currentLayer],O=t.getLayerSourceCache(P);P.isSky()&&this.renderLayer(this,O,P,O?m[O.id]:void 0)}this.renderPass="translucent",this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let k=0;for(S&&(k=S.getShadowCastingLayerCount());this.currentLayer<o.length;){const P=a[this.currentLayer],O=t.getLayerSourceCache(P);if(P.isSky()){++this.currentLayer;continue}if(I&&this.style.isLayerDraped(P)){if(P.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=I.renderBatch(this.currentLayer);continue}let j;if(O&&(j=(P.type==="symbol"?_:P.is3D()?x:m)[O.id]),this._renderTileClippingMasks(P,O,O?p[O.id]:void 0),this.renderLayer(this,O,P,j),!I&&S&&k>0&&P.hasShadowPass()&&--k==0&&(S.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const G=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=G;this.currentLayer++){const W=a[this.currentLayer];if(!W.hasLightBeamPass())continue;const Z=t.getLayerSourceCache(W);this.renderLayer(this,Z,W,Z?m[Z.id]:void 0)}this.currentLayer=G,this.renderPass="translucent"}++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let P=null;a.forEach(O=>{const j=t.getLayerSourceCache(O);j&&!O.isHidden(this.transform.zoom)&&j.getVisibleCoordinates().length&&(!P||P.getSource().maxzoom<j.getSource().maxzoom)&&(P=j)}),P&&this.options.showTileBoundaries&&Nk.debug(this,P,P.getVisibleCoordinates())}this.options.showPadding&&function(P){const O=P.transform.padding;Ok(P,P.transform.height-(O.top||0),3,E8),Ok(P,O.bottom||0,3,C8),Lk(P,O.left||0,3,M8),Lk(P,P.transform.width-(O.right||0),3,I8);const j=P.transform.centerPoint;(function(G,W,Z,K){qg(G,W-1,Z-10,2,20,K),qg(G,W-10,Z-1,20,2,K)})(P,j.x,P.transform.height-j.y,A8)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(C.performance.now()),this.saveCanvasCopy()),d||(this.conflationActive=!1)}uploadLayer(t,n,r){this.gpuTimingStart(n),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(n.type)||t.terrain&&n.type==="custom")&&jk[`${n.type}Upload`]&&jk[`${n.type}Upload`](t,r,n.scope),this.gpuTimingEnd()}renderLayer(t,n,r,o){r.isHidden(this.transform.zoom)||(r.type==="background"||r.type==="sky"||r.type==="custom"||r.type==="model"||r.type==="raster"||o&&o.length)&&(this.id=r.id,this.gpuTimingStart(r),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(r.type)||t.terrain&&r.type==="custom")&&Nk[r.type](t,n,r,o,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const n=this.context.extTimerQuery,r=this.context.gl;let o=this.gpuTimers[t.id];o||(o=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:r.createQuery()}),o.calls++,r.beginQuery(n.TIME_ELAPSED_EXT,o.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,n=this.context.gl,r=n.createQuery();this.deferredRenderGpuTimeQueries.push(r),n.beginQuery(t.TIME_ELAPSED_EXT,r)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const n={};for(const r in t){const o=t[r],a=this.context.extTimerQuery,c=a.getQueryParameter(o.query,this.context.gl.QUERY_RESULT)/1e6;a.deleteQueryEXT(o.query),n[r]=c}return n}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const n=this.context.extTimerQuery,r=this.context.gl;let o=0;for(const a of t)o+=n.getQueryParameter(a,r.QUERY_RESULT)/1e6,n.deleteQueryEXT(a);return o}translatePosMatrix(t,n,r,o,a){if(!r[0]&&!r[1])return t;const c=a?o==="map"?this.transform.angle:0:o==="viewport"?-this.transform.angle:0;if(c){const p=Math.sin(c),m=Math.cos(c);r=[r[0]*m-r[1]*p,r[0]*p+r[1]*m]}const u=[a?r[0]:Lc(n,r[0],this.transform.zoom),a?r[1]:Lc(n,r[1],this.transform.zoom),0],d=new Float32Array(16);return wt.translate(d,t,u),d}saveTileTexture(t){const n=t.size[0],r=this._tileTextures[n];r?r.push(t):this._tileTextures[n]=[t]}getTileTexture(t){const n=this._tileTextures[t];return n&&n.length>0?n.pop():null}isPatternMissing(t,n){return t===null||t!==void 0&&!this.imageManager.getPattern(t.toString(),n)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(t,n,r){const o=r===void 0?this.terrain&&this.terrain.renderingToTexture:r,a=this.terrain&&this.terrain.exaggeration()===0,c=[];return this.style&&this.style.enable3dLights()&&(t==="globeRaster"||t==="terrainRaster"?(c.push("LIGHTING_3D_MODE"),c.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):o||c.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||c.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?c.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):c.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(c.push("TERRAIN"),this.linearFloatFilteringSupported()&&c.push("TERRAIN_DEM_FLOAT_FORMAT"),a&&c.push("ZERO_EXAGGERATION")),this.transform.projection.name==="globe"&&c.push("GLOBE"),!this._fogVisible||o||n!==void 0&&!n||c.push("FOG","FOG_DITHERING"),o&&c.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&c.push("OVERDRAW_INSPECTOR"),c}getOrCreateProgram(t,n){this.cache=this.cache||{};const r=n&&n.defines||[],o=n&&n.config,a=this.currentGlobalDefines(t,n&&n.overrideFog,n&&n.overrideRtt).concat(r),c=_k.cacheKey(ak[t],t,a,o);return this.cache[c]||(this.cache[c]=new _k(this.context,t,ak[t],o,m8[t],a)),this.cache[c]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=C.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new gr(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(t,n){if(this.style.enable3dLights()){const r=this.style.directionalLight,o=this.style.ambientLight;if(r&&o){const a=((c,u)=>{const d=c.properties.get("direction"),p=c.properties.get("color").toArray01(),m=c.properties.get("intensity"),_=u.properties.get("color").toArray01(),v=u.properties.get("intensity"),x=[d.x,d.y,d.z],w=Fn(_,v),T=Fn(p,m);return{u_lighting_ambient_color:w,u_lighting_directional_dir:x,u_lighting_directional_color:T,u_ground_radiance:Q$(x,T,w)}})(r,o);n.setLightsUniformValues(t,a)}}}uploadCommonUniforms(t,n,r,o,a){if(this.uploadCommonLightUniforms(t,n),this.terrain&&this.terrain.renderingToTexture)return;const c=this.style.fog;if(c){const u=c.getOpacity(this.transform.pitch),d=((p,m,_,v,x,w,T,S,I,A,R,k)=>{const P=p.transform,O=m.properties.get("color").toArray01();O[3]=v;const j=p.frameCounter/1e3%1,[G,W]=m.properties.get("vertical-range");return{u_fog_matrix:_?P.calculateFogTileMatrix(_):k||p.identityMat,u_fog_range:m.getFovAdjustedRange(P._fov),u_fog_color:O,u_fog_horizon_blend:m.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(G,W),W],u_fog_temporal_offset:j,u_frustum_tl:x,u_frustum_tr:w,u_frustum_br:T,u_frustum_bl:S,u_globe_pos:I,u_globe_radius:A,u_viewport:R,u_globe_transition:fi(P.zoom),u_is_globe:+(P.projection.name==="globe")}})(this,c,r,u,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*Ve.devicePixelRatio,this.transform.height*Ve.devicePixelRatio],o);n.setFogUniformValues(t,d)}a&&n.setCutoffUniformValues(t,a.uniformValues)}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){const t=this.canvasCopy();t&&(this.frameCopies.push(t),this.tileLoaded=!1)}canvasCopy(){const t=this.context.gl,n=t.createTexture();return t.bindTexture(t.TEXTURE_2D,n),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),n}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&t.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const t=this._backgroundTiles,n=this._backgroundTiles={},r=this.transform.coveringTiles({tileSize:512});for(const o of r)n[o.key]=t[o.key]||new _f(o,512,this.transform.tileZoom,this);return n}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(t,n){return!(!t.is3D()||t.minzoom&&t.minzoom>this.transform.zoom||t.sourceLayer!=="building"&&(!n||n.type!=="batched-model"))}isTileAffectedByFog(t){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let n=this._cachedTileFogOpacities[t.key];return n||(this._cachedTileFogOpacities[t.key]=n=this.style.fog.getOpacityForTile(t)),n[0]>=Bc||n[1]>=Bc}}const jc=2048;class G8{constructor(t,n){this.aabb=t,this.lastCascade=n}}class W8{add(t,n){const r=this.receivers[t.key];r!==void 0?(r.aabb.min[0]=Math.min(r.aabb.min[0],n.min[0]),r.aabb.min[1]=Math.min(r.aabb.min[1],n.min[1]),r.aabb.min[2]=Math.min(r.aabb.min[2],n.min[2]),r.aabb.max[0]=Math.max(r.aabb.max[0],n.max[0]),r.aabb.max[1]=Math.max(r.aabb.max[1],n.max[1]),r.aabb.max[2]=Math.max(r.aabb.max[2],n.max[2])):this.receivers[t.key]=new G8(n,null)}clear(){this.receivers={}}get(t){return this.receivers[t.key]}computeRequiredCascades(t,n,r){const o=nr.fromPoints(t.points);let a=0;for(const c in this.receivers){const u=this.receivers[c];if(!u||!o.intersectsAabb(u.aabb))continue;u.aabb.min=o.closestPoint(u.aabb.min),u.aabb.max=o.closestPoint(u.aabb.max);const d=u.aabb.getCorners();for(let p=0;p<r.length;p++){let m=!0;for(const _ of d){const v=[_[0]*n,_[1]*n,_[2]];if(ot.transformMat4(v,v,r[p].matrix),v[0]<-1||v[0]>1||v[1]<-1||v[1]>1){m=!1;break}}if(u.lastCascade=p,a=Math.max(a,p),m)break}}return a+1}}class q8{constructor(t){this.painter=t,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new W8,this._depthMode=new qe(t.context.gl.LEQUAL,qe.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1}destroy(){for(const t of this._cascades)t.texture.destroy(),t.framebuffer.destroy();this._cascades=[]}updateShadowParameters(t,n){const r=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!n||!n.properties)return;const o=n.properties.get("shadow-intensity");if(!n.shadowsEnabled()||o<=0||(this._shadowLayerCount=r.style.order.reduce((x,w)=>{const T=r.style._mergedLayers[w];return x+(T.hasShadowPass()&&!T.isHidden(t.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const a=r.context,c=jc,u=jc;if(this._cascades.length===0)for(let x=0;x<2;++x){const w=r._shadowMapDebug,T=a.gl,S=a.createFramebuffer(c,u,w,"texture"),I=new gr(a,{width:c,height:u,data:null},T.DEPTH_COMPONENT);if(S.depthAttachment.set(I.texture),w){const A=new gr(a,{width:c,height:u,data:null},T.RGBA);S.colorAttachment.set(A.texture)}this._cascades.push({framebuffer:S,texture:I,matrix:[],far:0,boundingSphereRadius:0,frustum:new Na,scale:0})}this.shadowDirection=Uk(n);let d=0;if(t.elevation){const x=t.elevation,w=[1e4,-1e4];x.visibleDemTiles.filter(T=>T.dem).forEach(T=>{const S=T.dem.tree;w[0]=Math.min(w[0],S.minimums[0]),w[1]=Math.max(w[1],S.maximums[0])}),w[0]!==1e4&&(d=(w[1]-w[0])*x.exaggeration())}const p=1.5*t.cameraToCenterDistance,m=3*p,_=new Float64Array(16);for(let x=0;x<2;++x){const w=this._cascades[x];let T=t.height/50,S=1;x===0?S=p:(T=p,S=m);const[I,A]=H8(t,this.shadowDirection,T,S,jc,d);w.scale=t.scale,w.matrix=I,w.boundingSphereRadius=A,wt.invert(_,w.matrix),w.frustum=Na.fromInvProjectionMatrix(_,1,0,!0),w.far=S}this._uniformValues.u_fade_range=[.75*this._cascades[1].far,this._cascades[1].far],this._uniformValues.u_shadow_intensity=o,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=.00048828125,this._uniformValues.u_shadow_map_resolution=jc,this._uniformValues.u_shadowmap_0=Co.ShadowMap0,this._uniformValues.u_shadowmap_1=Co.ShadowMap0+1,this._groundShadowTiles=r.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const v=r.transform.elevation;for(const x of this._groundShadowTiles){let w={min:0,max:0};if(v){const T=v.getMinMaxForTile(x);T&&(w=T)}this.addShadowReceiver(x.toUnwrapped(),w.min,w.max)}}get enabled(){return this._enabled}set enabled(t){this._enabled=t}drawShadowPass(t,n){if(!this._enabled)return;const r=this.painter,o=r.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(r.transform.getFrustum(0),r.transform.worldSize,this._cascades),o.viewport.set([0,0,jc,jc]);for(let a=0;a<this._numCascadesToRender;++a){r.currentShadowCascade=a,o.bindFramebuffer.set(this._cascades[a].framebuffer.framebuffer),o.clear({color:en.white,depth:1});for(const c of t.order){const u=t._mergedLayers[c];if(!u.hasShadowPass()||u.isHidden(r.transform.zoom))continue;const d=t.getLayerSourceCache(u),p=d?n[d.id]:void 0;(u.type==="model"||p&&p.length)&&r.renderLayer(r,d,u,p)}}r.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const t=this.painter,n=t.style,r=t.context,o=n.directionalLight,a=n.ambientLight;if(!o||!a)return;const c=[],u=ph(t,t.longestCutoffRange);u.shouldRenderCutoff&&c.push("RENDER_CUTOFF");const d=_b(o,a),p=new qe(r.gl.LEQUAL,qe.ReadOnly,t.depthRangeFor3D);for(const m of this._groundShadowTiles){const _=m.toUnwrapped(),v=t.isTileAffectedByFog(m),x=t.getOrCreateProgram("groundShadow",{defines:c,overrideFog:v});this.setupShadows(_,x),t.uploadCommonUniforms(r,x,_,null,u);const w={u_matrix:t.transform.calculateProjMatrix(_),u_ground_shadow_factor:d};x.draw(t,r.gl.TRIANGLES,p,ln.disabled,Mn.multiply,hn.disabled,w,"ground_shadow",t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments,{},t.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Mn.unblended:Mn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(t){const n=this.painter.transform,r=n.calculatePosMatrix(t,n.worldSize);return wt.multiply(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}calculateShadowPassMatrixFromMatrix(t){return wt.multiply(t,this._cascades[this.painter.currentShadowCascade].matrix,t),Float32Array.from(t)}setupShadows(t,n,r,o=0){if(!this._enabled)return;const a=this.painter.transform,c=this.painter.context,u=c.gl,d=this._uniformValues,p=new Float64Array(16),m=a.calculatePosMatrix(t,a.worldSize);for(let _=0;_<2;_++)wt.multiply(p,this._cascades[_].matrix,m),d[_===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(p),c.activeTexture.set(u.TEXTURE0+Co.ShadowMap0+_),this._cascades[_].texture.bind(u.NEAREST,u.CLAMP_TO_EDGE);if(this.useNormalOffset=!!r,this.useNormalOffset){const _=nf(t.canonical),v=2/a.tileSize*Rt/jc,x=v*this._cascades[0].boundingSphereRadius,w=v*this._cascades[1].boundingSphereRadius,T=(r==="vector-tile"?1:3)/Math.pow(2,o-t.canonical.z-(1-a.zoom+Math.floor(a.zoom)));d.u_shadow_normal_offset=[_,x*T,w*T],d.u_shadow_bias=[6e-5,.0012,.012]}else d.u_shadow_bias=[36e-5,.0012,.012];n.setShadowUniformValues(c,d)}setupShadowsFromMatrix(t,n,r=!1){if(!this._enabled)return;const o=this.painter.context,a=o.gl,c=this._uniformValues,u=new Float64Array(16);for(let d=0;d<2;d++)wt.multiply(u,this._cascades[d].matrix,t),c[d===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(u),o.activeTexture.set(a.TEXTURE0+Co.ShadowMap0+d),this._cascades[d].texture.bind(a.NEAREST,a.CLAMP_TO_EDGE);this.useNormalOffset=r,r?(c.u_shadow_normal_offset=[1,5,5],c.u_shadow_bias=[6e-5,.0012,.012]):c.u_shadow_bias=[36e-5,.0012,.012],n.setShadowUniformValues(o,c)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(t,n,r,o){if(o[2]>=0)return{};const a=function(d,p,m){const _=m/(1<<d.canonical.z);return new nr([d.canonical.x*_+d.wrap*m,d.canonical.y*_+d.wrap*m,0],[(d.canonical.x+1)*_+d.wrap*m,(d.canonical.y+1)*_+d.wrap*m,p])}(t,n,r).getCorners(),c=n/-o[2];o[0]<0?(ot.add(a[0],a[0],[o[0]*c,0,0]),ot.add(a[3],a[3],[o[0]*c,0,0])):o[0]>0&&(ot.add(a[1],a[1],[o[0]*c,0,0]),ot.add(a[2],a[2],[o[0]*c,0,0])),o[1]<0?(ot.add(a[0],a[0],[0,o[1]*c,0]),ot.add(a[1],a[1],[0,o[1]*c,0])):o[1]>0&&(ot.add(a[2],a[2],[0,o[1]*c,0]),ot.add(a[3],a[3],[0,o[1]*c,0]));const u={};return u.vertices=a,u.planes=[Zg(a[1],a[0],a[4]),Zg(a[2],a[1],a[5]),Zg(a[3],a[2],a[6]),Zg(a[0],a[3],a[7])],u}addShadowReceiver(t,n,r){this._receivers.add(t,nr.fromTileIdAndHeight(t,n,r))}getMaxCascadeForTile(t){const n=this._receivers.get(t);return n&&n.lastCascade?n.lastCascade:0}}function Zg(e,t,n){const r=ot.sub([],n,t),o=ot.sub([],e,t),a=ot.cross([],r,o),c=ot.length(a);return c===0?[0,0,1,0]:(ot.scale(a,a,1/c),[a[0],a[1],a[2],-ot.dot(a,t)])}function Uk(e){const t=e.properties.get("direction"),n=ce(t.x,t.y,t.z);n[2]=jt(n[2],0,75);const r=ae([n[0],n[1],n[2]]);return ot.fromValues(r.x,r.y,r.z)}function _b(e,t){const n=e.properties.get("color"),r=e.properties.get("intensity"),o=e.properties.get("direction"),a=[o.x,o.y,o.z],c=t.properties.get("color"),u=t.properties.get("intensity"),d=Math.max(ot.dot([0,0,1],a),0),p=[0,0,0];ot.scale(p,c.toArray01Linear().slice(0,3),u);const m=[0,0,0];return ot.scale(m,n.toArray01Linear().slice(0,3),d*r),ke([p[0]>0?p[0]/(p[0]+m[0]):0,p[1]>0?p[1]/(p[1]+m[1]):0,p[2]>0?p[2]/(p[2]+m[2]):0])}function H8(e,t,n,r,o,a){const c=e.zoom,u=e.scale,d=e.worldSize,p=1/d,m=e.aspect,_=Math.sqrt(1+m*m)*Math.tan(.5*e.fovX),v=_*_,x=r-n,w=r+n;let T,S;v>x/w?(T=r,S=r*_):(T=.5*w*(1+v),S=.5*Math.sqrt(x*x+2*(r*r+n*n)*v+w*w*v*v));const I=e.projection.pixelsPerMeter(e.center.lat,d),A=e._camera.getCameraToWorldMercator(),R=[0,0,-T*p];ot.transformMat4(R,R,A);let k=S*p;const P=e._edgeInsets;if(!(P.left===0&&P.top===0&&P.right===0&&P.bottom===0||P.left===P.right&&P.top===P.bottom)){const At=e._camera.getWorldToCamera(e.worldSize,e.projection.zAxisUnit==="meters"?I:1),It=e._camera.getCameraToClipPerspective(e._fov,e.width/e.height,n,r);It[8]=2*-e.centerOffset.x/e.width,It[9]=2*e.centerOffset.y/e.height;const zt=new Float64Array(16);wt.mul(zt,It,At);const Ft=new Float64Array(16);wt.invert(Ft,zt);const Ut=Na.fromInvProjectionMatrix(Ft,d,c,!0);for(const Pt of Ut.points){const Ht=((O=Pt)[0]/=u,O[1]/=u,O[2]=Hn(O[2],e._center.lat),O);k=Math.max(k,ot.len(ot.subtract([],R,Ht)))}}var O;k*=o/(o-1);const j=Math.acos(t[2]),G=Math.atan2(-t[0],-t[1]),W=new Tg;W.position=R,W.setPitchBearing(j,G);const Z=W.getWorldToCamera(d,I),K=k*d,Q=Math.min(e._mercatorZfromZoom(17)*d*-2,-2*K),at=W.getCameraToClipOrthographic(-K,K,-K,K,Q,(K+a*I)/t[2]),X=new Float64Array(16);wt.multiply(X,at,Z);const ft=ot.fromValues(Math.floor(1e6*R[0])/1e6*d,Math.floor(1e6*R[1])/1e6*d,0),gt=.5*o,vt=[0,0,0];ot.transformMat4(vt,ft,X),ot.scale(vt,vt,gt);const ht=[Math.floor(vt[0]),Math.floor(vt[1]),Math.floor(vt[2])],pt=[0,0,0];ot.sub(pt,vt,ht),ot.scale(pt,pt,-1/gt);const Ct=new Float64Array(16);return wt.identity(Ct),wt.translate(Ct,Ct,pt),wt.multiply(X,Ct,X),[X,K]}class Z8 extends En{constructor(t){super(),this.requestManager=t,this.models={"":{}},this.numModelsLoading={}}loadModel(t,n){return zR(this.requestManager.transformRequest(n,Dt.Model).url).then(r=>{if(!r)return;const o=nb(r),a=new RP(t,void 0,void 0,o);return a.computeBoundsAndApplyParent(),a}).catch(r=>{this.fire(new ve(new Error(`Could not load model ${t} from ${n}: ${r.message}`)))})}load(t,n){this.models[n]||(this.models[n]={});const r=Object.keys(t);this.numModelsLoading[n]=(this.numModelsLoading[n]||0)+r.length;const o=[];for(const a of r)o.push(this.loadModel(a,t[a]));Promise.allSettled(o).then(a=>{for(let c=0;c<a.length;c++){const{status:u,value:d}=a[c];u==="fulfilled"&&d&&(this.models[n][r[c]]=d)}this.numModelsLoading[n]-=r.length,this.fire(new Nt("data",{dataType:"style"}))}).catch(a=>{this.fire(new ve(new Error(`Could not load models: ${a.message}`)))})}isLoaded(){for(const t in this.numModelsLoading)if(this.numModelsLoading[t]>0)return!1;return!0}hasModel(t,n){return!!this.getModel(t,n)}getModel(t,n){return this.models[n]||(this.models[n]={}),this.models[n][t]}addModel(t,n,r){this.models[r]||(this.models[r]={}),this.hasModel(t,r)&&this.removeModel(t,r),this.load({[t]:this.requestManager.normalizeModelURL(n)},r)}addModels(t,n){const r={};for(const o in t)r[o]=this.requestManager.normalizeModelURL(t[o]);this.load(r,n)}removeModel(t,n){this.models[n]||(this.models[n]={});const r=this.models[n][t];delete this.models[n][t],r.destroy()}listModels(t){return this.models[t]||(this.models[t]={}),Object.keys(this.models[t])}upload(t,n){this.models[n]||(this.models[n]={});for(const r in this.models[n])this.models[n][r].upload(t.context)}}const Rf=(e,t)=>ym(e,t&&t.filter(n=>n.identifier!=="source.canvas")),X8=Pe(On,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","setImportUrl","setImportData","setImportConfig"]),K8=Pe(On,["setCenter","setZoom","setBearing","setPitch"]),$k={version:8,layers:[],sources:{}},Vk={duration:300,delay:0},Y8=new Set(["fill","line","background","hillshade","raster"]);class js extends En{constructor(t,n={}){super(),this.map=t,this.scope=n.scope||"",this.fragments=[],this.importDepth=n.importDepth||0,this.importsCache=n.importsCache||new Map,this.resolvedImports=n.resolvedImports||new Set,this.transition=Ot({},Vk),this._buildingIndex=new x$(this),this.crossTileSymbolIndex=new V$,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=n.styleChanges||new OF,this.dispatcher=n.dispatcher?n.dispatcher:new Fc(If(),this),n.imageManager?this.imageManager=n.imageManager:(this.imageManager=new XU,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=n.glyphManager?n.glyphManager:new oh(t._requestManager,n.localFontFamily?2:n.localIdeographFontFamily?1:0,n.localFontFamily||n.localIdeographFontFamily),n.modelManager?this.modelManager=n.modelManager:(this.modelManager=new Z8(t._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=new Map,this._configDependentLayers=new Set,this._config=n.config,this.dispatcher.broadcast("setReferrer",Yt());const r=this;this._rtlTextPluginCallback=js.registerForPluginStateChange(o=>{r.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:o.pluginStatus,pluginURL:o.pluginURL},(a,c)=>{if(VC(a),c&&c.every(u=>u))for(const u in r._sourceCaches){const d=r._sourceCaches[u],p=d.getSource().type;p!=="vector"&&p!=="geojson"||d.reload()}})}),this.on("data",o=>{if(o.dataType!=="source"||o.sourceDataType!=="metadata")return;const a=this.getOwnSource(o.sourceId);if(a&&a.vectorLayerIds)for(const c in this._layers){const u=this._layers[c];u.source===a.id&&this._validateLayer(u)}})}loadURL(t,n={}){this.fire(new Nt("dataloading",{dataType:"style"}));const r=typeof n.validate=="boolean"?n.validate:!kn(t);t=this.map._requestManager.normalizeStyleURL(t,n.accessToken),this.resolvedImports.add(t);const o=this.importsCache.get(t);if(o)return this._load(o,r);const a=this.map._requestManager.transformRequest(t,Dt.Style);this._request=Qt(a,(c,u)=>{if(this._request=null,c)this.fire(new ve(c));else if(u)return this.importsCache.set(t,u),this._load(u,r)})}loadJSON(t,n={}){this.fire(new Nt("dataloading",{dataType:"style"})),this._request=Ve.frame(()=>{this._request=null,this._load(t,n.validate!==!1)})}loadEmpty(){this.fire(new Nt("dataloading",{dataType:"style"})),this._load($k,!1)}_loadImports(t,n){if(this.importDepth>=4)return dt("Style doesn't support nesting deeper than 5"),Promise.resolve();const r=[];for(const o of t){const a=this._createFragmentStyle(o),c=new Promise(d=>{a.once("style.import.load",d),a.once("error",d)}).then(()=>this.mergeAll());if(r.push(c),this.resolvedImports.has(o.url)){a.loadEmpty();continue}const u=o.data||this.importsCache.get(o.url);u?a.loadJSON(u,{validate:n}):o.url?a.loadURL(o.url,{validate:n}):a.loadEmpty(),this.fragments.push({style:a,id:o.id,config:o.config})}return Promise.allSettled(r)}_createFragmentStyle(t){const n=this.scope?$i(t.id,this.scope):t.id,r=new js(this.map,{scope:n,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:t.config});return r.setEventedParent(this.map,{style:r}),r}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options});const t=this.isRootStyle();this._shouldPrecompile=t,this.fire(new Nt(t?"style.load":"style.import.load"))}_load(t,n){const r=t.schema;if(this.isRootStyle()&&(t.fragment||r&&t.fragment!==!1)){const c=Ot({},$k,{imports:[{id:"basemap",data:t,url:""}]});return void this._load(c,n)}if(this.setConfig(this._config,r),n&&Rf(this,ju(t)))return;this._loaded=!0,this.stylesheet=Y(t);for(const c in t.sources)this.addSource(c,t.sources[c],{validate:!1,isInitialLoad:!0});t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(t.glyphs,this.scope);const o=jR(this.stylesheet.layers);if(this._order=o.map(c=>c.id),this.stylesheet.light&&dt("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const c=this.stylesheet.lights[0];this.light=new fR(c.properties,c.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new fR(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const c of o){const u=Rg(c,this.options);u.setScope(this.scope),u.isConfigDependent&&this._configDependentLayers.add(u.fqid),u.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=u,this._serializedLayers[u.id]=u.serialize();const d=this.getOwnLayerSourceCache(u),p=!!this.directionalLight&&this.directionalLight.shadowsEnabled();d&&u.canCastShadows()&&p&&(d.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const a=this.stylesheet.terrain;a&&(this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=Ve.hasCanvasFingerprintNoise()),this.disableElevatedTerrain?dt("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."):this.terrainSetForDrapingOnly()||this._createTerrain(a,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new Nt("data",{dataType:"style"})),t.imports?this._loadImports(t.imports,n).then(()=>this._reloadImports()):this._reloadImports()}isRootStyle(){return this.importDepth===0}mergeAll(){let t,n,r,o,a,c,u,d;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(p=>{if(p.stylesheet){if(p.light!=null&&(t=p.light),p.stylesheet.lights)for(const m of p.stylesheet.lights)m.type==="ambient"&&p.ambientLight!=null&&(n=p.ambientLight),m.type==="directional"&&p.directionalLight!=null&&(r=p.directionalLight);o=this._prioritizeTerrain(o,p.terrain,p.stylesheet.terrain),p.stylesheet.fog&&p.fog!=null&&(a=p.fog),p.stylesheet.camera!=null&&(d=p.stylesheet.camera),p.stylesheet.projection!=null&&(c=p.stylesheet.projection),p.stylesheet.transition!=null&&(u=p.stylesheet.transition)}}),this.light=t,this.ambientLight=n,this.directionalLight=r,this.fog=a,o===null?delete this.terrain:this.terrain=o,this.camera=d||{"camera-projection":"perspective"},this.projection=c||{name:"mercator"},this.transition=Ot({},Vk,u),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(t){const n=r=>{for(const o of r.fragments)n(o.style);t(r)};n(this)}_prioritizeTerrain(t,n,r){const o=t&&t.drapeRenderMode===0;return r===null?n&&n.drapeRenderMode===0?n:o?t:null:n!=null&&(!t||o||n&&n.drapeRenderMode===1)?n:t}mergeTerrain(){let t;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(n=>{t=this._prioritizeTerrain(t,n.terrain,n.stylesheet.terrain)}),t===null?delete this.terrain:this.terrain=t}mergeProjection(){let t;this.forEachFragmentStyle(n=>{n.stylesheet.projection!=null&&(t=n.stylesheet.projection)}),this.projection=t||{name:"mercator"}}mergeSources(){const t={},n={},r={};this.forEachFragmentStyle(o=>{for(const a in o._sourceCaches){const c=$i(a,o.scope);t[c]=o._sourceCaches[a]}for(const a in o._otherSourceCaches){const c=$i(a,o.scope);n[c]=o._otherSourceCaches[a]}for(const a in o._symbolSourceCaches){const c=$i(a,o.scope);r[c]=o._symbolSourceCaches[a]}}),this._mergedSourceCaches=t,this._mergedOtherSourceCaches=n,this._mergedSymbolSourceCaches=r}mergeLayers(){const t={},n=[],r={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(a=>{for(const c of a._order){const u=a._layers[c];if(u.type==="slot"){const d=wm(c);if(t[d])continue;t[d]=[]}u.slot&&t[u.slot]?t[u.slot].push(u):n.push(u)}}),this._mergedOrder=[];const o=(a=[])=>{for(const c of a)if(c.type==="slot"){const u=wm(c.id);t[u]&&o(t[u])}else{const u=$i(c.id,c.scope);this._mergedOrder.push(u),r[u]=c,c.is3D()&&(this._has3DLayers=!0),c.type==="circle"&&(this._hasCircleLayers=!0),c.type==="symbol"&&(this._hasSymbolLayers=!0)}};o(n),this._mergedLayers=r,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(t){return this.stylesheet.camera=Ot({},this.stylesheet.camera,t),this.camera=this.stylesheet.camera,this}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(t){this._spriteRequest=function(n,r,o){let a,c,u;const d=Ve.devicePixelRatio>1?"@2x":"";let p=Qt(r.transformRequest(r.normalizeSpriteURL(n,d,".json"),Dt.SpriteJSON),(v,x)=>{p=null,u||(u=v,a=x,_())}),m=Qe(r.transformRequest(r.normalizeSpriteURL(n,d,".png"),Dt.SpriteImage),(v,x)=>{m=null,u||(u=v,c=x,_())});function _(){if(u)o(u);else if(a&&c){const v=Ve.getImageData(c),x={};for(const w in a){const{width:T,height:S,x:I,y:A,sdf:R,pixelRatio:k,stretchX:P,stretchY:O,content:j}=a[w],G=new jr({width:T,height:S});jr.copy(v,G,{x:I,y:A},{x:0,y:0},{width:T,height:S}),x[w]={data:G,pixelRatio:k,sdf:R,stretchX:P,stretchY:O,content:j}}o(null,x)}}return{cancel(){p&&(p.cancel(),p=null),m&&(m.cancel(),m=null)}}}(t,this.map._requestManager,(n,r)=>{if(this._spriteRequest=null,n)this.fire(new ve(n));else if(r)for(const o in r)this.imageManager.addImage(o,this.scope,r[o]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new Nt("data",{dataType:"style"}))})}_validateLayer(t){const n=this.getOwnSource(t.source);if(!n)return;const r=t.sourceLayer;r&&(n.type==="geojson"||n.vectorLayerIds&&n.vectorLayerIds.indexOf(r)===-1)&&this.fire(new ve(new Error(`Source layer "${r}" does not exist on source "${n.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:t}of this.fragments)if(!t.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((t,n)=>{const r=this.fragments[n];return r&&r.style&&(t.data=r.style.serialize()),t})}_serializeSources(){const t={};for(const n in this._sourceCaches){const r=this._sourceCaches[n].getSource();t[r.id]||(t[r.id]=r.serialize())}return t}_serializeLayers(t){const n=[];for(const r of t){const o=this._layers[r];o&&o.type!=="custom"&&n.push(o.serialize())}return n}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(t){return!!this.terrain&&(typeof t.isLayerDraped=="function"?t.isLayerDraped(this.getLayerSourceCache(t)):Y8.has(t.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(t){const n=this.getOwnLayer(t);if(n)return n;this.fire(new ve(new Error(`The layer '${t}' does not exist in the map's style.`)))}_checkSource(t){const n=this.getOwnSource(t);if(n)return n;this.fire(new ve(new Error(`The source '${t}' does not exist in the map's style.`)))}update(t){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(t),this.directionalLight&&this.directionalLight.recalculate(t);const n=this.calculateLightsBrightness();t.brightness=n||0,n!==this._brightness&&(this._brightness=n,this.dispatcher.broadcast("setBrightness",n));const r=this._changes.isDirty();if(this._changes.isDirty()){const a=this._changes.getLayerUpdatesByScope();for(const c in a){const{updatedIds:u,removedIds:d}=a[c];(u||d)&&this._updateWorkerLayers(c,u,d)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(t),this.light&&this.light.updateTransitions(t),this.ambientLight&&this.ambientLight.updateTransitions(t),this.directionalLight&&this.directionalLight.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._changes.reset()}const o={};for(const a in this._mergedSourceCaches){const c=this._mergedSourceCaches[a];o[a]=c.used,c.used=!1}for(const a of this._mergedOrder){const c=this._mergedLayers[a];if(c.recalculate(t,this._availableImages),!c.isHidden(t.zoom)){const u=this.getLayerSourceCache(c);u&&(u.used=!0)}if(!this._precompileDone&&this._shouldPrecompile)for(let u=c.minzoom||0;u<(c.maxzoom||25.5);u++){const d=this.map.painter;if(d){const p=c.getProgramIds();if(!p)continue;for(const m of p){const _=c.getDefaultProgramParams(m,t.zoom);_&&(d.style=this,this.fog&&(d._fogVisible=!0,_.overrideFog=!0,d.getOrCreateProgram(m,_)),d._fogVisible=!1,_.overrideFog=!1,d.getOrCreateProgram(m,_),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(_.overrideRtt=!0,d.getOrCreateProgram(m,_)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const a in o){const c=this._mergedSourceCaches[a];o[a]!==c.used&&c.getSource().fire(new Nt("data",{sourceDataType:"visibility",dataType:"source",sourceId:c.getSource().id}))}this.light&&this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),r&&this.fire(new Nt("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=this._changes.getUpdatedImages();if(t.length){for(const n in this._sourceCaches)this._sourceCaches[n].reloadTilesForDependencies(["icons","patterns"],t);this._changes.resetUpdatedImages()}}_updateWorkerLayers(t,n,r){const o=this.getFragmentStyle(t);o&&this.dispatcher.broadcast("updateLayers",{layers:n?o._serializeLayers(n):[],scope:t,removedIds:r||[],options:o.options})}setState(t){if(this._checkLoaded(),Rf(this,ju(t)))return!1;(t=Y(t)).layers=jR(t.layers);const n=function(o,a){if(!o)return[{command:On.setStyle,args:[a]}];let c=[];try{if(!et(o.version,a.version))return[{command:On.setStyle,args:[a]}];et(o.center,a.center)||c.push({command:On.setCenter,args:[a.center]}),et(o.zoom,a.zoom)||c.push({command:On.setZoom,args:[a.zoom]}),et(o.bearing,a.bearing)||c.push({command:On.setBearing,args:[a.bearing]}),et(o.pitch,a.pitch)||c.push({command:On.setPitch,args:[a.pitch]}),et(o.sprite,a.sprite)||c.push({command:On.setSprite,args:[a.sprite]}),et(o.glyphs,a.glyphs)||c.push({command:On.setGlyphs,args:[a.glyphs]}),et(o.imports,a.imports)||function(_=[],v=[],x){v=v||[];const w=(_=_||[]).map(Dg),T=v.map(Dg),S=_.reduce(Bg,{}),I=v.reduce(Bg,{}),A=w.slice();let R,k,P,O;for(R=0,k=0;R<w.length;R++)P=w[R],I.hasOwnProperty(P)?k++:(x.push({command:On.removeImport,args:[P]}),A.splice(A.indexOf(P,k),1));for(R=0,k=0;R<T.length;R++)P=T[T.length-1-R],A[A.length-1-R]!==P&&(S.hasOwnProperty(P)?(x.push({command:On.removeImport,args:[P]}),A.splice(A.lastIndexOf(P,A.length-k),1)):k++,O=A[A.length-R],x.push({command:On.addImport,args:[I[P],O]}),A.splice(A.length-R,0,P));for(const j of v){const G=S[j.id];if(!G||et(G,j))continue;et(G.config,j.config)||x.push({command:On.setImportConfig,args:[j.id,j.config]}),et(G.url,j.url)||x.push({command:On.setImportUrl,args:[j.id,j.url]});const W=j.data;et(G&&G.data,W)||x.push({command:On.setImportData,args:[j.id,W]})}}(o.imports,a.imports,c),et(o.transition,a.transition)||c.push({command:On.setTransition,args:[a.transition]}),et(o.light,a.light)||c.push({command:On.setLight,args:[a.light]}),et(o.fog,a.fog)||c.push({command:On.setFog,args:[a.fog]}),et(o.projection,a.projection)||c.push({command:On.setProjection,args:[a.projection]}),et(o.lights,a.lights)||c.push({command:On.setLights,args:[a.lights]}),et(o.camera,a.camera)||c.push({command:On.setCamera,args:[a.camera]});const u={},d=[];(function(_,v,x,w){let T;for(T in v=v||{},_=_||{})_.hasOwnProperty(T)&&(v.hasOwnProperty(T)||$R(T,x,w));for(T in v){if(!v.hasOwnProperty(T))continue;const S=v[T];_.hasOwnProperty(T)?et(_[T],S)||(_[T].type==="geojson"&&S.type==="geojson"&&T$(_,v,T)?x.push({command:On.setGeoJSONSourceData,args:[T,S.data]}):w$(T,v,x,w)):UR(T,v,x)}})(o.sources,a.sources,d,u);const p=[];o.layers&&o.layers.forEach(_=>{_.source&&u[_.source]?c.push({command:On.removeLayer,args:[_.id]}):p.push(_)});let m=o.terrain;m&&u[m.source]&&(c.push({command:On.setTerrain,args:[void 0]}),m=void 0),c=c.concat(d),et(m,a.terrain)||c.push({command:On.setTerrain,args:[a.terrain]}),function(_,v,x){v=v||[];const w=(_=_||[]).map(Dg),T=v.map(Dg),S=_.reduce(Bg,{}),I=v.reduce(Bg,{}),A=w.slice(),R=Object.create(null);let k,P,O,j,G,W,Z;for(k=0,P=0;k<w.length;k++)O=w[k],I.hasOwnProperty(O)?P++:(x.push({command:On.removeLayer,args:[O]}),A.splice(A.indexOf(O,P),1));for(k=0,P=0;k<T.length;k++)O=T[T.length-1-k],A[A.length-1-k]!==O&&(S.hasOwnProperty(O)?(x.push({command:On.removeLayer,args:[O]}),A.splice(A.lastIndexOf(O,A.length-P),1)):P++,W=A[A.length-k],x.push({command:On.addLayer,args:[I[O],W]}),A.splice(A.length-k,0,O),R[O]=!0);for(k=0;k<T.length;k++)if(O=T[k],j=S[O],G=I[O],!R[O]&&!et(j,G))if(et(j.source,G.source)&&et(j["source-layer"],G["source-layer"])&&et(j.type,G.type)){for(Z in zg(j.layout,G.layout,x,O,null,On.setLayoutProperty),zg(j.paint,G.paint,x,O,null,On.setPaintProperty),et(j.slot,G.slot)||x.push({command:On.setSlot,args:[O,G.slot]}),et(j.filter,G.filter)||x.push({command:On.setFilter,args:[O,G.filter]}),et(j.minzoom,G.minzoom)&&et(j.maxzoom,G.maxzoom)||x.push({command:On.setLayerZoomRange,args:[O,G.minzoom,G.maxzoom]}),j)j.hasOwnProperty(Z)&&Z!=="layout"&&Z!=="paint"&&Z!=="filter"&&Z!=="metadata"&&Z!=="minzoom"&&Z!=="maxzoom"&&Z!=="slot"&&(Z.indexOf("paint.")===0?zg(j[Z],G[Z],x,O,Z.slice(6),On.setPaintProperty):et(j[Z],G[Z])||x.push({command:On.setLayerProperty,args:[O,Z,G[Z]]}));for(Z in G)G.hasOwnProperty(Z)&&!j.hasOwnProperty(Z)&&Z!=="layout"&&Z!=="paint"&&Z!=="filter"&&Z!=="metadata"&&Z!=="minzoom"&&Z!=="maxzoom"&&Z!=="slot"&&(Z.indexOf("paint.")===0?zg(j[Z],G[Z],x,O,Z.slice(6),On.setPaintProperty):et(j[Z],G[Z])||x.push({command:On.setLayerProperty,args:[O,Z,G[Z]]}))}else x.push({command:On.removeLayer,args:[O]}),W=A[A.lastIndexOf(O)+1],x.push({command:On.addLayer,args:[G,W]})}(p,a.layers,c)}catch(u){console.warn("Unable to compute style diff:",u),c=[{command:On.setStyle,args:[a]}]}return c}(this.serialize(),t).filter(o=>!(o.command in K8));if(n.length===0)return!1;const r=n.filter(o=>!(o.command in X8));if(r.length>0)throw new Error(`Unimplemented: ${r.map(o=>o.command).join(", ")}.`);return n.forEach(o=>{this[o.command].apply(this,o.args)}),this.stylesheet=t,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(t,n){return this.getImage(t)?this.fire(new ve(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,this.scope,n),this._afterImageUpdated(t),this)}updateImage(t,n){this.imageManager.updateImage(t,this.scope,n)}getImage(t){return this.imageManager.getImage(t,this.scope)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t,this.scope),this._afterImageUpdated(t),this):this.fire(new ve(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(t),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new Nt("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(t,n,r={}){return this._checkLoaded(),this._validate(CF,`models.${t}`,n,null,r)||(this.modelManager.addModel(t,n,this.scope),this._changes.setDirty()),this}hasModel(t){return this.modelManager.hasModel(t,this.scope)}removeModel(t){return this.hasModel(t)?(this.modelManager.removeModel(t,this.scope),this):this.fire(new ve(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(t,n,r={}){if(this._checkLoaded(),this.getOwnSource(t)!==void 0)throw new Error(`There is already a source with ID "${t}".`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(yF,`sources.${t}`,n,null,r))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const o=ib(t,n,this.dispatcher,this);o.scope=this.scope,o.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(o.id),source:o.serialize(),sourceId:o.id}));const a=c=>{const u=(c?"symbol:":"other:")+o.id,d=$i(u,this.scope),p=this._sourceCaches[u]=new Bs(d,o,c);(c?this._symbolSourceCaches:this._otherSourceCaches)[o.id]=p,p.onAdd(this.map)};a(!1),n.type!=="vector"&&n.type!=="geojson"||a(!0),o.onAdd&&o.onAdd(this.map),r.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(t){this._checkLoaded();const n=this.getOwnSource(t);if(!n)throw new Error("There is no source with this ID");for(const o in this._layers)if(this._layers[o].source===t)return this.fire(new ve(new Error(`Source "${t}" cannot be removed while layer "${o}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===t)return this.fire(new ve(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const r=this.getOwnSourceCaches(t);for(const o of r){const a=wm(o.id);delete this._sourceCaches[a],this._changes.discardSourceCacheUpdate(o.id),o.fire(new Nt("data",{sourceDataType:"metadata",dataType:"source",sourceId:o.getSource().id})),o.setEventedParent(null),o.clearTiles()}return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],this.mergeSources(),n.setEventedParent(null),n.onRemove&&n.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(t,n){this._checkLoaded(),this.getOwnSource(t).setData(n),this._changes.setDirty()}getOwnSource(t){const n=this.getOwnSourceCache(t);return n&&n.getSource()}getOwnSources(){const t=[];for(const n in this._otherSourceCaches){const r=this.getOwnSourceCache(n);r&&t.push(r.getSource())}return t}setLights(t){if(this._checkLoaded(),!t)return delete this.ambientLight,void delete this.directionalLight;const n=this._getTransitionParameters();for(const o of t){if(this._validate(xF,"lights",o))return;switch(o.type){case"ambient":if(this.ambientLight){const a=this.ambientLight;a.set(o),a.updateTransitions(n)}else this.ambientLight=new xR(o,r$,this.scope,this.options);break;case"directional":if(this.directionalLight){const a=this.directionalLight;a.set(o),a.updateTransitions(n)}else this.directionalLight=new xR(o,i$,this.scope,this.options)}}const r=new fr(this.z||0,n);this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const t=this.directionalLight,n=this.ambientLight;if(!t||!n)return;const r=_=>.2126*(_[0]<=.03928?_[0]/12.92:Math.pow((_[0]+.055)/1.055,2.4))+.7152*(_[1]<=.03928?_[1]/12.92:Math.pow((_[1]+.055)/1.055,2.4))+.0722*(_[2]<=.03928?_[2]/12.92:Math.pow((_[2]+.055)/1.055,2.4)),o=t.properties.get("color").toArray01(),a=t.properties.get("intensity"),c=t.properties.get("direction"),u=1-ce(c.x,c.y,c.z)[2]/90,d=r(o)*a*u,p=n.properties.get("color").toArray01(),m=n.properties.get("intensity");return(d+r(p)*m)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const t=[];return this.directionalLight&&t.push(this.directionalLight.get()),this.ambientLight&&t.push(this.ambientLight.get()),t}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(t){if(!t)return this;if(HC(t)){const n=function(a){const c=a.indexOf(bm);return c>=0?a.slice(c+1):""}(t),r=this.fragments.find(({id:a})=>a===n);if(!r)throw new Error(`Style import not found: ${t}`);const o=wm(t);return r.style.getFragmentStyle(o)}{const n=this.fragments.find(({id:r})=>r===t);if(!n)throw new Error(`Style import not found: ${t}`);return n.style}}getConfigProperty(t,n){const r=this.getFragmentStyle(t);if(!r)return null;const o=r.options.get(n),a=o?o.value||o.default:null;return a?a.serialize():null}setConfigProperty(t,n,r){const o=dl(r);if(o.result!=="success")return void Rf(this,o.value);const a=o.value.expression,c=this.getFragmentStyle(t);if(!c)return;const u=c.options.get(n);u&&(c.options.set(n,{...u,value:a}),c.updateConfigDependencies())}setConfig(t,n){if(this._config=t,t||n)if(n){this.options.clear();for(const r in n){let o,a;const c=dl(n[r].default);if(c.result==="success"&&(o=c.value.expression),t&&t[r]!==void 0){const v=dl(t[r]);v.result==="success"&&(a=v.value.expression)}const{minValue:u,maxValue:d,stepValue:p,type:m,values:_}=n[r];o?this.options.set(r,{default:o,value:a,minValue:u,maxValue:d,stepValue:p,type:m,values:_}):this.fire(new ve(new Error(`No schema defined for config option "${r}".`)))}}else this.fire(new ve(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const t of this._configDependentLayers){const n=this.getLayer(t);n&&(n.possiblyEvaluateVisibility(),this._updateLayer(n))}this.ambientLight&&this.ambientLight.scope===this.scope&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.scope===this.scope&&this.directionalLight.updateConfig(this.options),this._changes.setDirty()}addLayer(t,n,r={}){this._checkLoaded();const o=t.id;if(this._layers[o])return void this.fire(new ve(new Error(`Layer with id "${o}" already exists on this map`)));let a;if(t.type==="custom"){if(Rf(this,function(m){const _=[],v=m.id;return v===void 0&&_.push({message:`layers.${v}: missing required property "id"`}),m.render===void 0&&_.push({message:`layers.${v}: missing required method "render"`}),m.renderingMode&&m.renderingMode!=="2d"&&m.renderingMode!=="3d"&&_.push({message:`layers.${v}: property "renderingMode" must be either "2d" or "3d"`}),_}(t)))return;a=Rg(t,this.options)}else{if(typeof t.source=="object"&&(this.addSource(o,t.source),t=Ot(t=Y(t),{source:o})),this._validate(TF,`layers.${o}`,t,{arrayIndex:-1},r))return;a=Rg(t,this.options),this._validateLayer(a),a.setEventedParent(this,{layer:{id:o}}),this._serializedLayers[a.id]=a.serialize()}a.isConfigDependent&&this._configDependentLayers.add(a.fqid),a.setScope(this.scope);let c=this._order.length;if(n){const m=this._order.indexOf(n);if(m===-1)return void this.fire(new ve(new Error(`Layer with id "${n}" does not exist on this map.`)));a.slot===this._layers[n].slot?c=m:dt(`Layer with id "${n}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(c,0,o),this._layerOrderChanged=!0,this._layers[o]=a;const u=this.getOwnLayerSourceCache(a),d=!!this.directionalLight&&this.directionalLight.shadowsEnabled();u&&a.canCastShadows()&&d&&(u.castsShadows=!0);const p=this._changes.getRemovedLayer(a);if(p&&a.source&&u&&a.type!=="custom"){this._changes.discardLayerRemoval(a);const m=$i(a.source,a.scope);p.type!==a.type?this._changes.updateSourceCache(m,"clear"):(this._changes.updateSourceCache(m,"reload"),u.pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map),a.scope=this.scope,this.mergeLayers()}moveLayer(t,n){this._checkLoaded();const r=this._checkLayer(t);if(!r||t===n)return;const o=this._order.indexOf(t);this._order.splice(o,1);let a=this._order.length;if(n){const c=this._order.indexOf(n);if(c===-1)return void this.fire(new ve(new Error(`Layer with id "${n}" does not exist on this map.`)));r.slot===this._layers[n].slot?a=c:dt(`Layer with id "${n}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(a,0,t),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(t){this._checkLoaded();const n=this._checkLayer(t);if(!n)return;n.setEventedParent(null);const r=this._order.indexOf(t);this._order.splice(r,1),delete this._layers[t],delete this._serializedLayers[t],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(n.fqid),this._changes.removeLayer(n);const o=this.getOwnLayerSourceCache(n);if(o&&o.castsShadows){let a=!1;for(const c in this._layers)if(this._layers[c].source===n.source&&this._layers[c].canCastShadows()){a=!0;break}o.castsShadows=a}n.onRemove&&n.onRemove(this.map),this.mergeLayers()}getOwnLayer(t){return this._layers[t]}hasLayer(t){return t in this._mergedLayers}hasLayerType(t){for(const n in this._layers)if(this._layers[n].type===t)return!0;return!1}setLayerZoomRange(t,n,r){this._checkLoaded();const o=this._checkLayer(t);o&&(o.minzoom===n&&o.maxzoom===r||(n!=null&&(o.minzoom=n),r!=null&&(o.maxzoom=r),this._updateLayer(o)))}setSlot(t,n){this._checkLoaded();const r=this._checkLayer(t);r&&r.slot!==n&&(r.slot=n,this._updateLayer(r))}setFilter(t,n,r={}){this._checkLoaded();const o=this._checkLayer(t);if(o&&!et(o.filter,n))return n==null?(o.filter=void 0,void this._updateLayer(o)):void(this._validate(Qv,`layers.${o.id}.filter`,n,{layerType:o.type},r)||(o.filter=Y(n),this._updateLayer(o)))}getFilter(t){const n=this._checkLayer(t);if(n)return Y(n.filter)}setLayoutProperty(t,n,r,o={}){this._checkLoaded();const a=this._checkLayer(t);a&&(et(a.getLayoutProperty(n),r)||(a.setLayoutProperty(n,r,o),a.isConfigDependent&&this._configDependentLayers.add(a.fqid),this._updateLayer(a)))}getLayoutProperty(t,n){const r=this._checkLayer(t);if(r)return r.getLayoutProperty(n)}setPaintProperty(t,n,r,o={}){this._checkLoaded();const a=this._checkLayer(t);if(!a||et(a.getPaintProperty(n),r))return;const c=a.setPaintProperty(n,r,o);a.isConfigDependent&&this._configDependentLayers.add(a.fqid),c&&this._updateLayer(a),this._changes.updatePaintProperties(a)}getPaintProperty(t,n){const r=this._checkLayer(t);if(r)return r.getPaintProperty(n)}setFeatureState(t,n){this._checkLoaded();const r=t.source,o=t.sourceLayer,a=this._checkSource(r);if(!a)return;const c=a.type;if(c==="geojson"&&o)return void this.fire(new ve(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(c==="vector"&&!o)return void this.fire(new ve(new Error("The sourceLayer parameter must be provided for vector source types.")));t.id===void 0&&this.fire(new ve(new Error("The feature id parameter must be provided.")));const u=this.getOwnSourceCaches(r);for(const d of u)d.setFeatureState(o,t.id,n)}removeFeatureState(t,n){this._checkLoaded();const r=t.source,o=this._checkSource(r);if(!o)return;const a=o.type,c=a==="vector"?t.sourceLayer:void 0;if(a==="vector"&&!c)return void this.fire(new ve(new Error("The sourceLayer parameter must be provided for vector source types.")));if(n&&typeof t.id!="string"&&typeof t.id!="number")return void this.fire(new ve(new Error("A feature id is required to remove its specific state property.")));const u=this.getOwnSourceCaches(r);for(const d of u)d.removeFeatureState(c,t.id,n)}getFeatureState(t){this._checkLoaded();const n=t.source,r=t.sourceLayer,o=this._checkSource(n);if(o){if(o.type!=="vector"||r)return t.id===void 0&&this.fire(new ve(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(n)[0].getFeatureState(r,t.id);this.fire(new ve(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(t){return this.stylesheet.transition=Ot({},this.stylesheet.transition,t),this.transition=this.stylesheet.transition,this}getTransition(){return Ot({},this.stylesheet.transition)}serialize(){this._checkLoaded();const t=this.getTerrain(),n=t&&this.terrain&&this.terrain.scope===this.scope?t:this.stylesheet.terrain;return Zt({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:n,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},r=>r!==void 0)}_updateLayer(t){this._changes.updateLayer(t);const n=this.getLayerSourceCache(t),r=$i(t.source,t.scope),o=this._changes.getUpdatedSourceCaches();t.source&&!o[r]&&n&&n.getSource().type!=="raster"&&(this._changes.updateSourceCache(r,"reload"),n.pause()),t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const n=u=>this._mergedLayers[u].type==="fill-extrusion",r=this.order,o={},a=[];for(let u=r.length-1;u>=0;u--){const d=r[u];if(n(d)){o[d]=u;for(const p of t){const m=p[d];if(m)for(const _ of m)a.push(_)}}}a.sort((u,d)=>d.intersectionZ-u.intersectionZ);const c=[];for(let u=r.length-1;u>=0;u--){const d=r[u];if(n(d))for(let p=a.length-1;p>=0;p--){const m=a[p].feature;if(o[m.layer.id]<u)break;c.push(m),a.pop()}else for(const p of t){const m=p[d];if(m)for(const _ of m)c.push(_.feature)}}return c}queryRenderedFeatures(t,n,r){n&&n.filter&&this._validate(Qv,"queryRenderedFeatures.filter",n.filter,null,n),n.scope=this.scope,n.availableImages=this._availableImages,n.serializedLayers=this._serializedLayers;const o={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new ve(new Error("parameters.layers must be an Array."))),[];for(const p of n.layers){const m=this._mergedLayers[p];if(!m)return this.fire(new ve(new Error(`The layer '${p}' does not exist in the map's style and cannot be queried for features.`))),[];o[m.source]=!0}}const a=[],c=n.serializedLayers||{},u=n&&n.layers?n.layers.some(p=>{const m=this.getLayer(p);return m&&m.is3D()}):this.has3DLayers(),d=V1.createFromScreenPoints(t,r);for(const p in this._mergedSourceCaches){const m=this._mergedSourceCaches[p].getSource();if(!m||m.scope!==n.scope)continue;const _=this._mergedSourceCaches[p].getSource().id;n.layers&&!o[_]||a.push(y$(this._mergedSourceCaches[p],this._mergedLayers,c,d,n,r,u,!!this.map._showQueryGeometry))}return this.placement&&a.push(function(p,m,_,v,x,w,T){const S={},I=w.queryRenderedSymbols(v),A=[];for(const R of Object.keys(I).map(Number))A.push(T[R]);A.sort(FR);for(const R of A){const k=R.featureIndex.lookupSymbolFeatures(I[R.bucketInstanceId],m,R.bucketIndex,R.sourceLayerIndex,x.filter,x.layers,x.availableImages,p);for(const P in k){const O=S[P]=S[P]||[],j=k[P];j.sort((G,W)=>{const Z=R.featureSortOrder;if(Z){const K=Z.indexOf(G.featureIndex);return Z.indexOf(W.featureIndex)-K}return W.featureIndex-G.featureIndex});for(const G of j)O.push(G)}}for(const R in S)S[R].forEach(k=>{const P=k.feature,O=_(p[R]);if(!O)return;const j=O.getFeatureState(P.layer["source-layer"],P.id);P.source=P.layer.source,P.layer["source-layer"]&&(P.sourceLayer=P.layer["source-layer"]),P.state=j});return S}(this._mergedLayers,c,this.getLayerSourceCache.bind(this),d.screenGeometry,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(t,n){n&&n.filter&&this._validate(Qv,"querySourceFeatures.filter",n.filter,null,n);const r=this.getOwnSourceCaches(t);let o=[];for(const a of r)o=o.concat(v$(a,n));return o}addSourceType(t,n,r){return js.getSourceType(t)?r(new Error(`A source type called "${t}" already exists.`)):(js.setSourceType(t,n),n.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:n.workerSourceURL},r):r(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(t,n,r={}){this._checkLoaded();const o=this.light.getLight();let a=!1;for(const u in t)if(!et(t[u],o[u])){a=!0;break}if(!a)return;const c=this._getTransitionParameters();this.light.setLight(t,n,r),this.light.updateTransitions(c)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(t,n=1){if(this._checkLoaded(),!t)return delete this.terrain,t===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let r=t;const o=t.source==null;if(n===1){if(typeof r.source=="object"){const u="terrain-dem-src";this.addSource(u,r.source),r=Y(r),r=Ot(r,{source:u})}const a=Ot({},r),c={};if(this.terrain&&o){a.source=this.terrain.get().source;const u=this.terrain?this.getFragmentStyle(this.terrain.scope):null;u&&(c.style=u.serialize())}if(this._validate(bF,"terrain",a,c))return}if(!this.terrain||this.terrain.scope!==this.scope&&!o||this.terrain&&n!==this.terrain.drapeRenderMode){if(!r)return;this._createTerrain(r,n),this.fire(new Nt("data",{dataType:"style"}))}else{const a=this.terrain,c=a.get();for(const u of Object.keys(_t.terrain))!r.hasOwnProperty(u)&&_t.terrain[u].default&&(r[u]=_t.terrain[u].default);for(const u in t)if(!et(t[u],c[u])){a.set(t,this.options),this.stylesheet.terrain=t;const d=this._getTransitionParameters({duration:0});a.updateTransitions(d),this.fire(new Nt("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const n=this.fog=new t$(t,this.map.transform);this.stylesheet.fog=n.get();const r=this._getTransitionParameters({duration:0});n.updateTransitions(r)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const n=this.fog;if(!et(n.get(),t)){n.set(t),this.stylesheet.fog=n.get();const r=this._getTransitionParameters({duration:0});n.updateTransitions(r)}}else this._createFog(t);this._markersNeedUpdate=!0}_getTransitionParameters(t){return{now:Ve.now(),transition:Ot(this.transition,t)}}updateDrapeFirstLayers(){if(!this.terrain)return;const t=[],n=[];for(const r in this._mergedLayers)this.isLayerDraped(this._mergedLayers[r])?t.push(r):n.push(r);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...n)}_createTerrain(t,n){const r=this.terrain=new QU(t,n,this.scope,this.options);n===1&&(this.stylesheet.terrain=t),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const o=this._getTransitionParameters({duration:0});r.updateTransitions(o)}_force3DLayerUpdate(){for(const t in this._layers){const n=this._layers[t];n.type==="fill-extrusion"&&this._updateLayer(n)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const n=this._layers[t];n.type==="symbol"&&this._updateLayer(n)}}_validate(t,n,r,o,a={}){if(a&&a.validate===!1)return!1;const c=Ot({},this.serialize());return Rf(this,t.call(ju,Ot({key:n,style:c,value:r,styleSpec:_t},o)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),sx.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._mergedLayers)this._mergedLayers[t].setEventedParent(null);for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles(),this._mergedSourceCaches[t].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(t){const n=this.getSourceCaches(t);for(const r of n)r.clearTiles()}clearSources(){for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles()}reloadSource(t){const n=this.getSourceCaches(t);for(const r of n)r.resume(),r.reload()}reloadSources(){for(const t of this.getSources())t.reload&&t.reload()}updateSources(t){let n;this.directionalLight&&(n=Uk(this.directionalLight));for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].update(t,void 0,void 0,n)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const n=this._sourceCaches[t];n.resume(),n.reload()}}_updatePlacement(t,n,r,o,a=!1){let c=!1,u=!1;const d={},p={};for(const m of this._mergedOrder){const _=this._mergedLayers[m];if(_.type!=="symbol")continue;const v=$i(_.source,_.scope);let x=d[v];if(!x){const T=this.getLayerSourceCache(_);if(!T)continue;const S=T.getRenderableIds(!0).map(I=>T.getTileByID(I));p[v]=S.slice(),x=d[v]=S.sort((I,A)=>A.tileID.overscaledZ-I.tileID.overscaledZ||(I.tileID.isLessThan(A.tileID)?-1:1))}const w=this.crossTileSymbolIndex.addLayer(_,x,t.center.lng,t.projection);c=c||w}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),a=a||this._layerOrderChanged||r===0,this._layerOrderChanged&&this.fire(new Nt("neworder")),(a||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Ve.now(),t.zoom))&&(this.pauseablePlacement=new N$(t,this._mergedOrder,a,n,r,o,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,d,p),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Ve.now()),u=!0),c&&this.pauseablePlacement.placement.setStale()),u||c)for(const m of this._mergedOrder){const _=this._mergedLayers[m];_.type==="symbol"&&this.placement.updateLayerOpacities(_,d[$i(_.source,_.scope)])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Ve.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}addImport(t){this._checkLoaded();const n=this.stylesheet.imports=this.stylesheet.imports||[];return n.findIndex(({id:o})=>o===t.id)!==-1?this.fire(new ve(new Error(`Import with id '${t.id}' already exists in the map's style.`))):(n.push(t),this._loadImports([t],!0),this)}setImportUrl(t,n){this._checkLoaded();const r=this.stylesheet.imports||[],o=this.getImportIndex(t);if(o===-1)return this;r[o].url=n;const a=this.fragments[o];return a.style=this._createFragmentStyle(r[o]),a.style.on("style.import.load",()=>this.mergeAll()),a.style.loadURL(n),this}setImportData(t,n){this._checkLoaded();const r=this.getImportIndex(t),o=this.stylesheet.imports||[];return r===-1?this:n?(this.fragments[r].style.setState(n),this._reloadImports(),this):(delete o[r].data,this.setImportUrl(t,o[r].url))}setImportConfig(t,n){this._checkLoaded();const r=this.getImportIndex(t),o=this.stylesheet.imports||[];if(r===-1)return this;n?o[r].config=n:delete o[r].config;const a=this.fragments[r],c=a.style.stylesheet&&a.style.stylesheet.schema;return a.config=n,a.style.setConfig(n,c),a.style.updateConfigDependencies(),this}removeImport(t){this._checkLoaded();const n=this.stylesheet.imports||[],r=this.getImportIndex(t);return r===-1||(n.splice(r,1),this.fragments[r].style._remove(),this.fragments.splice(r,1),this._reloadImports()),this}getImportIndex(t){const n=(this.stylesheet.imports||[]).findIndex(r=>r.id===t);return n===-1&&this.fire(new ve(new Error(`Import '${t}' does not exist in the map's style and cannot be updated.`))),n}getLayer(t){return this._mergedLayers[t]}getSources(){const t=[];for(const n in this._mergedOtherSourceCaches){const r=this._mergedOtherSourceCaches[n];r&&t.push(r.getSource())}return t}getSource(t,n){const r=this.getSourceCache(t,n);return r&&r.getSource()}getLayerSource(t){const n=this.getLayerSourceCache(t);return n&&n.getSource()}getSourceCache(t,n){const r=$i(t,n);return this._mergedOtherSourceCaches[r]}getLayerSourceCache(t){const n=$i(t.source,t.scope);return t.type==="symbol"?this._mergedSymbolSourceCaches[n]:this._mergedOtherSourceCaches[n]}getSourceCaches(t){const n=[];return this._mergedOtherSourceCaches[t]&&n.push(this._mergedOtherSourceCaches[t]),this._mergedSymbolSourceCaches[t]&&n.push(this._mergedSymbolSourceCaches[t]),n}updateSourceCaches(){const t=this._changes.getUpdatedSourceCaches();for(const n in t){const r=t[n];r==="reload"?this.reloadSource(n):r==="clear"&&this.clearSource(n)}}updateLayers(t){const n=this._changes.getUpdatedPaintProperties();for(const r of n){const o=this.getLayer(r);o&&o.updateTransitions(t)}}getImages(t,n,r){this.imageManager.getImages(n.icons,n.scope,r),this._updateTilesForChangedImages();const o=a=>{a&&a.setDependencies(n.tileID.key,n.type,n.icons)};o(this._otherSourceCaches[n.source]),o(this._symbolSourceCaches[n.source])}getGlyphs(t,n,r){this.glyphManager.getGlyphs(n.stacks,n.scope,r)}getResource(t,n,r){return re(n,r)}getOwnSourceCache(t){return this._otherSourceCaches[t]}getOwnLayerSourceCache(t){return t.type==="symbol"?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}getOwnSourceCaches(t){const n=[];return this._otherSourceCaches[t]&&n.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&n.push(this._symbolSourceCaches[t]),n}_isSourceCacheLoaded(t){const n=this.getOwnSourceCaches(t);return n.length===0?(this.fire(new ve(new Error(`There is no source with ID '${t}'`))),!1):n.every(r=>r.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function Gk(e,t){let n=!1,r=null;const o=()=>{r=null,n&&(e(),r=setTimeout(o,t),n=!1)};return()=>(n=!0,r||o(),r)}js.getSourceType=function(e){return rb[e]},js.setSourceType=function(e,t){rb[e]=t},js.registerForPluginStateChange=function(e){return e({pluginStatus:xo,pluginURL:ml}),sx.on("pluginStateChange",e),e};class Q8{constructor(t){this._hashName=t&&encodeURIComponent(t),Ue(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Gk(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,C.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),C.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const n=Wk(t);if(this._hashName){const r=this._hashName;let o=!1;const a=C.location.hash.slice(1).split("&").map(c=>{const u=c.split("=")[0];return u===r?(o=!0,`${u}=${n}`):c}).filter(c=>c);return o||a.push(`${r}=${n}`),`#${a.join("&")}`}return`#${n}`}_getCurrentHash(){const t=C.location.hash.replace("#","");if(this._hashName){let n;return t.split("&").map(r=>r.split("=")).forEach(r=>{r[0]===this._hashName&&(n=r)}),(n&&n[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const n=this._getCurrentHash();if(n.length>=3&&!n.some(r=>isNaN(r))){const r=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(n[3]||0):t.getBearing();return t.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:r,pitch:+(n[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=C.location.href.replace(/(#.+)?$/,this.getHashString());C.history.replaceState(C.history.state,null,t)}}function Wk(e,t){const n=e.getCenter(),r=Math.round(100*e.getZoom())/100,o=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,o),c=Math.round(n.lng*a)/a,u=Math.round(n.lat*a)/a,d=e.getBearing(),p=e.getPitch();let m=t?`/${c}/${u}/${r}`:`${r}/${u}/${c}`;return(d||p)&&(m+="/"+Math.round(10*d)/10),p&&(m+=`/${Math.round(p)}`),m}const Xg={linearity:.3,easing:ee(0,0,.3,1)},J8=Ot({deceleration:2500,maxSpeed:1400},Xg),tV=Ot({deceleration:20,maxSpeed:1400},Xg),eV=Ot({deceleration:1e3,maxSpeed:360},Xg),nV=Ot({deceleration:1e3,maxSpeed:90},Xg);class rV{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Ve.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,n=Ve.now();for(;t.length>0&&n-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const n={zoom:0,bearing:0,pitch:0,pan:new N(0,0),pinchAround:void 0,around:void 0};for(const{settings:a}of this._inertiaBuffer)n.zoom+=a.zoomDelta||0,n.bearing+=a.bearingDelta||0,n.pitch+=a.pitchDelta||0,a.panDelta&&n.pan._add(a.panDelta),a.around&&(n.around=a.around),a.pinchAround&&(n.pinchAround=a.pinchAround);const r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,o={};if(n.pan.mag()){const a=Yg(n.pan.mag(),r,Ot({},J8,t||{}));o.offset=n.pan.mult(a.amount/n.pan.mag()),o.center=this._map.transform.center,Kg(o,a)}if(n.zoom){const a=Yg(n.zoom,r,tV);o.zoom=this._map.transform.zoom+a.amount,Kg(o,a)}if(n.bearing){const a=Yg(n.bearing,r,eV);o.bearing=this._map.transform.bearing+jt(a.amount,-179,179),Kg(o,a)}if(n.pitch){const a=Yg(n.pitch,r,nV);o.pitch=this._map.transform.pitch+a.amount,Kg(o,a)}if(o.zoom||o.bearing){const a=n.pinchAround===void 0?n.around:n.pinchAround;o.around=a?this._map.unproject(a):this._map.getCenter()}return this.clear(),o.noMoveStart=!0,o}}function Kg(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function Yg(e,t,n){const{maxSpeed:r,linearity:o,deceleration:a}=n,c=jt(e*o/(t/1e3),-r,r),u=Math.abs(c)/(a*o);return{easing:n.easing,duration:1e3*u,amount:c*(u/2)}}class Ho extends Nt{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,r,o={}){const a=yo(n.getCanvasContainer(),r);super(t,Ot({point:a,lngLat:n.unproject(a),originalEvent:r},o)),this._defaultPrevented=!1,this.target=n}}class Qg extends Nt{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,r){const o=t==="touchend"?r.changedTouches:r.touches,a=Ia(n.getCanvasContainer(),o),c=a.map(d=>n.unproject(d)),u=a.reduce((d,p,m,_)=>d.add(p.div(_.length)),new N(0,0));super(t,{points:a,point:u,lngLats:c,lngLat:n.unproject(u),originalEvent:r}),this._defaultPrevented=!1}}class iV extends Nt{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,r){super(t,{originalEvent:r}),this._defaultPrevented=!1}}class oV{constructor(t,n){this._map=t,this._clickTolerance=n.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new iV(t.type,this._map,t))}mousedown(t,n){return this._mousedownPos=n,this._firePreventable(new Ho(t.type,this._map,t))}mouseup(t){this._map.fire(new Ho(t.type,this._map,t))}preclick(t){const n=Ot({},t);n.type="preclick",this._map.fire(new Ho(n.type,this._map,n))}click(t,n){this._mousedownPos&&this._mousedownPos.dist(n)>=this._clickTolerance||(this.preclick(t),this._map.fire(new Ho(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new Ho(t.type,this._map,t))}mouseover(t){this._map.fire(new Ho(t.type,this._map,t))}mouseout(t){this._map.fire(new Ho(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Qg(t.type,this._map,t))}touchmove(t){this._map.fire(new Qg(t.type,this._map,t))}touchend(t){this._map.fire(new Qg(t.type,this._map,t))}touchcancel(t){this._map.fire(new Qg(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class sV{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new Ho(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ho("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Ho(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class aV{constructor(t,n){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=n.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,n){this.isEnabled()&&t.shiftKey&&t.button===0&&(Iu(),this._startPos=this._lastPos=n,this._active=!0)}mousemoveWindow(t,n){if(!this._active)return;const r=n,o=this._startPos,a=this._lastPos;if(!o||!a||a.equals(r)||!this._box&&r.dist(o)<this._clickTolerance)return;this._lastPos=r,this._box||(this._box=$n("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const c=Math.min(o.x,r.x),u=Math.max(o.x,r.x),d=Math.min(o.y,r.y),p=Math.max(o.y,r.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${c}px,${d}px)`,this._box.style.width=u-c+"px",this._box.style.height=p-d+"px")})}mouseupWindow(t,n){if(!this._active)return;const r=this._startPos,o=n;if(r&&t.button===0){if(this.reset(),Ys(),r.x!==o.x||r.y!==o.y)return this._map.fire(new Nt("boxzoomend",{originalEvent:t})),{cameraAnimation:a=>a.fitScreenCoordinates(r,o,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Au(),delete this._startPos,delete this._lastPos}_fireEvent(t,n){return this._map.fire(new Nt(t,{originalEvent:n}))}}function yb(e,t){const n={};for(let r=0;r<e.length;r++)n[e[r].identifier]=t[r];return n}class lV{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,n,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=t.timeStamp),r.length===this.numTouches&&(this.centroid=function(o){const a=new N(0,0);for(const c of o)a._add(c);return a.div(o.length)}(n),this.touches=yb(r,n)))}touchmove(t,n,r){if(this.aborted||!this.centroid)return;const o=yb(r,n);for(const a in this.touches){const c=o[a];(!c||c.dist(this.touches[a])>30)&&(this.aborted=!0)}}touchend(t,n,r){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),r.length===0){const o=!this.aborted&&this.centroid;if(this.reset(),o)return o}}}class vb{constructor(t){this.singleTap=new lV(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,n,r){this.singleTap.touchstart(t,n,r)}touchmove(t,n,r){this.singleTap.touchmove(t,n,r)}touchend(t,n,r){const o=this.singleTap.touchend(t,n,r);if(o){const a=t.timeStamp-this.lastTime<500,c=!this.lastTap||this.lastTap.dist(o)<30;if(a&&c||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=o,this.count===this.numTaps)return this.reset(),o}}}class cV{constructor(){this._zoomIn=new vb({numTouches:1,numTaps:2}),this._zoomOut=new vb({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,n,r){this._zoomIn.touchstart(t,n,r),this._zoomOut.touchstart(t,n,r)}touchmove(t,n,r){this._zoomIn.touchmove(t,n,r),this._zoomOut.touchmove(t,n,r)}touchend(t,n,r){const o=this._zoomIn.touchend(t,n,r),a=this._zoomOut.touchend(t,n,r);return o?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:c=>c.easeTo({duration:300,zoom:c.getZoom()+1,around:c.unproject(o)},{originalEvent:t})}):a?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:c=>c.easeTo({duration:300,zoom:c.getZoom()-1,around:c.unproject(a)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const uV={0:1,2:2};class xb{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,n){return!1}_move(t,n){return{}}mousedown(t,n){if(this._lastPoint)return;const r=Pu(t);this._correctButton(t,r)&&(this._lastPoint=n,this._eventButton=r)}mousemoveWindow(t,n){const r=this._lastPoint;if(r){if(t.preventDefault(),this._eventButton!=null&&function(o,a){const c=uV[a];return o.buttons===void 0||(o.buttons&c)!==c}(t,this._eventButton))this.reset();else if(this._moved||!(n.dist(r)<this._clickTolerance))return this._moved=!0,this._lastPoint=n,this._move(r,n)}}mouseupWindow(t){this._lastPoint&&Pu(t)===this._eventButton&&(this._moved&&Ys(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hV extends xb{mousedown(t,n){super.mousedown(t,n),this._lastPoint&&(this._active=!0)}_correctButton(t,n){return n===0&&!t.ctrlKey}_move(t,n){return{around:n,panDelta:n.sub(t)}}}class qk extends xb{_correctButton(t,n){return n===0&&t.ctrlKey||n===2}_move(t,n){const r=.8*(n.x-t.x);if(r)return this._active=!0,{bearingDelta:r}}contextmenu(t){t.preventDefault()}}class Hk extends xb{_correctButton(t,n){return n===0&&t.ctrlKey||n===2}_move(t,n){const r=-.5*(n.y-t.y);if(r)return this._active=!0,{pitchDelta:r}}contextmenu(t){t.preventDefault()}}class dV{constructor(t,n){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset(),Ue(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new N(0,0)}touchstart(t,n,r){return this._calculateTransform(t,n,r)}touchmove(t,n,r){if(this._active&&!(r.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(r.length===1&&!be())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,n,r)}}touchend(t,n,r){this._calculateTransform(t,n,r),this._active&&r.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,n,r){r.length>0&&(this._active=!0);const o=yb(r,n),a=new N(0,0),c=new N(0,0);let u=0;for(const p in o){const m=o[p],_=this._touches[p];_&&(a._add(m),c._add(m.sub(_)),u++,o[p]=m)}if(this._touches=o,u<this._minTouches||!c.mag())return;const d=c.div(u);return this._sum._add(d),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(u),panDelta:d}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=$n("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class bb{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,n,r){return{}}touchstart(t,n,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([n[0],n[1]]))}touchmove(t,n,r){const o=this._firstTwoTouches;if(!o)return;t.preventDefault();const[a,c]=o,u=Jg(r,n,a),d=Jg(r,n,c);if(!u||!d)return;const p=this._aroundCenter?null:u.add(d).div(2);return this._move([u,d],p,t)}touchend(t,n,r){if(!this._firstTwoTouches)return;const[o,a]=this._firstTwoTouches,c=Jg(r,n,o),u=Jg(r,n,a);c&&u||(this._active&&Ys(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Jg(e,t,n){for(let r=0;r<e.length;r++)if(e[r].identifier===n)return t[r]}function Zk(e,t){return Math.log(e/t)/Math.LN2}class fV extends bb{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,n){const r=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Zk(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Zk(this._distance,r),pinchAround:n}}}function Xk(e,t){return 180*e.angleWith(t)/Math.PI}class pV extends bb{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,n){const r=this._vector;if(this._vector=t[0].sub(t[1]),r&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Xk(this._vector,r),pinchAround:n}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const n=25/(Math.PI*this._minDiameter)*360,r=this._startVector;if(!r)return!1;const o=Xk(t,r);return Math.abs(o)<n}}function wb(e){return Math.abs(e.y)>Math.abs(e.x)}class mV extends bb{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,wb(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,n,r){const o=this._lastPoints;if(!o)return;const a=t[0].sub(o[0]),c=t[1].sub(o[1]);return this._map._cooperativeGestures&&!be()&&r.touches.length<3||(this._valid=this.gestureBeginsVertically(a,c,r.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(a.y+c.y)/2*-.5})}gestureBeginsVertically(t,n,r){if(this._valid!==void 0)return this._valid;const o=t.mag()>=2,a=n.mag()>=2;if(!o&&!a)return;if(!o||!a)return this._firstMove==null&&(this._firstMove=r),r-this._firstMove<100&&void 0;const c=t.y>0==n.y>0;return wb(t)&&wb(n)&&c}}const gV={panStep:100,bearingStep:15,pitchStep:10};class _V{constructor(){const t=gV;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let n=0,r=0,o=0,a=0,c=0;switch(t.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:t.shiftKey?r=-1:(t.preventDefault(),a=-1);break;case 39:t.shiftKey?r=1:(t.preventDefault(),a=1);break;case 38:t.shiftKey?o=1:(t.preventDefault(),c=-1);break;case 40:t.shiftKey?o=-1:(t.preventDefault(),c=1);break;default:return}return this._rotationDisabled&&(r=0,o=0),{cameraAnimation:u=>{const d=u.getZoom();u.easeTo({duration:300,easeId:"keyboardHandler",easing:yV,zoom:n?Math.round(d)+n*(t.shiftKey?2:1):d,bearing:u.getBearing()+r*this._bearingStep,pitch:u.getPitch()+o*this._pitchStep,offset:[-a*this._panStep,-c*this._panStep],center:u.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function yV(e){return e*(2-e)}const Kk=4.000244140625;class vV{constructor(t,n){this._map=t,this._el=t.getCanvasContainer(),this._handler=n,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,Ue(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||be()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let n=t.deltaMode===C.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const r=Ve.now(),o=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,n!==0&&n%Kk==0?this._type="wheel":n!==0&&Math.abs(n)<4?this._type="trackpad":o>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(o*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),t.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=t,this._delta-=n,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=yo(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:n,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform;this._type==="wheel"&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const n=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(this._delta!==0){const p=this._type==="wheel"&&Math.abs(this._delta)>Kk?this._wheelZoomRate:this._defaultZoomRate;let m=2/(1+Math.exp(-Math.abs(this._delta*p)));this._delta<0&&m!==0&&(m=1/m);const _=n(),v=Math.pow(2,_),x=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):v;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(x*m))),this._type==="wheel"&&(this._startZoom=_,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const r=typeof this._targetZoom=="number"?this._targetZoom:n(),o=this._startZoom,a=this._easing;let c,u=!1;if(this._type==="wheel"&&o&&a){const p=Math.min((Ve.now()-this._lastWheelEventTime)/200,1);c=Xe(o,r,a(p)),p<1?this._frameId||(this._frameId=!0):u=!0}else c=r,u=!0;this._active=!0,u&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let d=c-n();return d*this._lastDelta<0&&(d=0),{noInertia:!0,needsRenderFrame:!u,zoomDelta:d,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let n=Ee;if(this._prevEase){const r=this._prevEase,o=(Ve.now()-r.start)/r.duration,a=r.easing(o+.01)-r.easing(o),c=.27/Math.sqrt(a*a+1e-4)*.01;n=ee(c,Math.sqrt(.0729-c*c),.25,1)}return this._prevEase={start:Ve.now(),duration:t,easing:n},n}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=$n("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(C.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class xV{constructor(t,n){this._clickZoom=t,this._tapZoom=n}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class bV{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,n){return t.preventDefault(),{cameraAnimation:r=>{r.easeTo({duration:300,zoom:r.getZoom()+(t.shiftKey?-1:1),around:r.unproject(n)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wV{constructor(){this._tap=new vb({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,n,r){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?r.length>0&&(this._swipePoint=n[0],this._swipeTouch=r[0].identifier):this._tap.touchstart(t,n,r))}touchmove(t,n,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;const o=n[0],a=o.y-this._swipePoint.y;return this._swipePoint=o,t.preventDefault(),this._active=!0,{zoomDelta:a/128}}}else this._tap.touchmove(t,n,r)}touchend(t,n,r){this._tapTime?this._swipePoint&&r.length===0&&this.reset():this._tap.touchend(t,n,r)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class TV{constructor(t,n,r){this._el=t,this._mousePan=n,this._touchPan=r}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class SV{constructor(t,n,r){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=n,this._mousePitch=r}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class EV{constructor(t,n,r,o){this._el=t,this._touchZoom=n,this._touchRotate=r,this._tapDragZoom=o,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const t_=e=>e.zoom||e.drag||e.pitch||e.rotate;class CV extends Nt{}class MV{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,n){const r=ot.sub([],n,t);this.radius=ot.length(r[2]<0?ot.div([],r,this.constants):[r[0],r[1],0])}projectRay(t){ot.div(t,t,this.constants),ot.normalize(t,t),ot.mul(t,t,this.constants);const n=ot.scale([],t,this.radius);if(n[2]>0){const r=ot.scale([],[0,0,1],ot.dot(n,[0,0,1])),o=ot.scale([],ot.normalize([],[n[0],n[1],0]),this.radius),a=ot.add([],n,ot.scale([],ot.sub([],ot.add([],o,r),n),2));n[0]=a[0],n[1]=a[1]}return n}}function e_(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class IV{constructor(t,n){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new rV(t),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new MV,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(n),Ue(["handleEvent","handleWindowEvent"],this);const r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[C.document,"mousemove",{capture:!0}],[C.document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[C,"blur",void 0]];for(const[o,a,c]of this._listeners)o.addEventListener(a,o===C.document?this.handleWindowEvent:this.handleEvent,c)}destroy(){for(const[t,n,r]of this._listeners)t.removeEventListener(n,t===C.document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(t){const n=this._map,r=n.getCanvasContainer();this._add("mapEvent",new oV(n,t));const o=n.boxZoom=new aV(n,t);this._add("boxZoom",o);const a=new cV,c=new bV;n.doubleClickZoom=new xV(c,a),this._add("tapZoom",a),this._add("clickZoom",c);const u=new wV;this._add("tapDragZoom",u);const d=n.touchPitch=new mV(n);this._add("touchPitch",d);const p=new qk(t),m=new Hk(t);n.dragRotate=new SV(t,p,m),this._add("mouseRotate",p,["mousePitch"]),this._add("mousePitch",m,["mouseRotate"]);const _=new hV(t),v=new dV(n,t);n.dragPan=new TV(r,_,v),this._add("mousePan",_),this._add("touchPan",v,["touchZoom","touchRotate"]);const x=new pV,w=new fV;n.touchZoomRotate=new EV(r,w,x,u),this._add("touchRotate",x,["touchPan","touchZoom"]),this._add("touchZoom",w,["touchPan","touchRotate"]),this._add("blockableMapEvent",new sV(n));const T=n.scrollZoom=new vV(n,this);this._add("scrollZoom",T,["mousePan"]);const S=n.keyboard=new _V;this._add("keyboard",S);for(const I of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[I]&&n[I].enable(t[I])}_add(t,n,r){this._handlers.push({handlerName:t,handler:n,allowed:r}),this._handlersById[t]=n}stop(t){if(!this._updatingCamera){for(const{handler:n}of this._handlers)n.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!t_(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(t,n,r){for(const o in t)if(o!==r&&(!n||n.indexOf(o)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const n=[];for(const r of t)this._el.contains(r.target)&&n.push(r);return n}handleEvent(t,n){this._updatingCamera=!0;const r=t.type==="renderFrame",o=r?void 0:t,a={needsRenderFrame:!1},c={},u={},d=t.touches?this._getMapTouches(t.touches):void 0,p=d?Ia(this._el,d):r?void 0:yo(this._el,t);for(const{handlerName:v,handler:x,allowed:w}of this._handlers){if(!x.isEnabled())continue;let T;this._blockedByActive(u,w,v)?x.reset():x[n||t.type]&&(T=x[n||t.type](t,p,d),this.mergeHandlerResult(a,c,T,v,o),T&&T.needsRenderFrame&&this._triggerRenderFrame()),(T||x.isActive())&&(u[v]=x)}const m={};for(const v in this._previousActiveHandlers)u[v]||(m[v]=o);this._previousActiveHandlers=u,(Object.keys(m).length||e_(a))&&(this._changes.push([a,c,m]),this._triggerRenderFrame()),(Object.keys(u).length||e_(a))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:_}=a;_&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],_(this._map))}mergeHandlerResult(t,n,r,o,a){if(!r)return;Ot(t,r);const c={handlerName:o,originalEvent:r.originalEvent||a};r.zoomDelta!==void 0&&(n.zoom=c),r.panDelta!==void 0&&(n.drag=c),r.pitchDelta!==void 0&&(n.pitch=c),r.bearingDelta!==void 0&&(n.rotate=c)}_applyChanges(){const t={},n={},r={};for(const[o,a,c]of this._changes)o.panDelta&&(t.panDelta=(t.panDelta||new N(0,0))._add(o.panDelta)),o.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+o.zoomDelta),o.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+o.bearingDelta),o.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+o.pitchDelta),o.around!==void 0&&(t.around=o.around),o.aroundCoord!==void 0&&(t.aroundCoord=o.aroundCoord),o.pinchAround!==void 0&&(t.pinchAround=o.pinchAround),o.noInertia&&(t.noInertia=o.noInertia),Ot(n,a),Ot(r,c);this._updateMapTransform(t,n,r),this._changes=[]}_updateMapTransform(t,n,r){const o=this._map,a=o.transform,c=A=>[A.x,A.y,A.z];if((A=>{const R=this._eventsInProgress.drag;return R&&!this._handlersById[R.handlerName].isActive()})()&&!e_(t)){const A=a.zoom;a.cameraElevationReference="sea",this._originalZoom!=null&&a._orthographicProjectionAtLowPitch&&a.projection.name!=="globe"&&a.pitch===0?(a.cameraElevationReference="ground",a.zoom=this._originalZoom):(a.recenterOnTerrain(),a.cameraElevationReference="ground"),A!==a.zoom&&this._map._update(!0)}if(a._isCameraConstrained&&o._stop(!0),!e_(t))return void this._fireEvents(n,r,!0);let{panDelta:u,zoomDelta:d,bearingDelta:p,pitchDelta:m,around:_,aroundCoord:v,pinchAround:x}=t;a._isCameraConstrained&&(d>0&&(d=0),a._isCameraConstrained=!1),x!==void 0&&(_=x),(d||(A=>n[A]&&!this._eventsInProgress[A])("drag"))&&_&&(this._dragOrigin=c(a.pointCoordinate3D(_)),this._originalZoom=a.zoom,this._trackingEllipsoid.setup(a._camera.position,this._dragOrigin)),a.cameraElevationReference="sea",o._stop(!0),_=_||o.transform.centerPoint,p&&(a.bearing+=p),m&&(a.pitch+=m),a._updateCameraState();const w=[0,0,0];if(u)if(a.projection.name==="mercator"){const A=this._trackingEllipsoid.projectRay(a.screenPointToMercatorRay(_).dir),R=this._trackingEllipsoid.projectRay(a.screenPointToMercatorRay(_.sub(u)).dir);w[0]=R[0]-A[0],w[1]=R[1]-A[1]}else{const A=a.pointCoordinate(_);if(a.projection.name==="globe"){u=u.rotate(-a.angle);const R=a._pixelsPerMercatorPixel/a.worldSize;w[0]=-u.x*Jx(qr(A.y))*R,w[1]=-u.y*Jx(a.center.lat)*R}else{const R=a.pointCoordinate(_.sub(u));A&&R&&(w[0]=R.x-A.x,w[1]=R.y-A.y)}}const T=a.zoom,S=[0,0,0];if(d){const A=c(v||a.pointCoordinate3D(_)),R={dir:ot.normalize([],ot.sub([],A,a._camera.position))};if(R.dir[2]<0){const k=a.zoomDeltaToMovement(A,d);ot.scale(S,R.dir,k)}}const I=ot.add(w,w,S);a._translateCameraConstrained(I),d&&Math.abs(a.zoom-T)>1e-4&&a.recenterOnTerrain(),a.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(n,r,!0)}_fireEvents(t,n,r){const o=t_(this._eventsInProgress),a=t_(t),c={};for(const m in t){const{originalEvent:_}=t[m];this._eventsInProgress[m]||(c[`${m}start`]=_),this._eventsInProgress[m]=t[m]}!o&&a&&this._fireEvent("movestart",a.originalEvent);for(const m in c)this._fireEvent(m,c[m]);a&&this._fireEvent("move",a.originalEvent);for(const m in t){const{originalEvent:_}=t[m];this._fireEvent(m,_)}const u={};let d;for(const m in this._eventsInProgress){const{handlerName:_,originalEvent:v}=this._eventsInProgress[m];this._handlersById[_].isActive()||(delete this._eventsInProgress[m],d=n[_]||v,u[`${m}end`]=d)}for(const m in u)this._fireEvent(m,u[m]);const p=t_(this._eventsInProgress);if(r&&(o||a)&&!p){this._updatingCamera=!0;const m=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_=v=>v!==0&&-this._bearingSnap<v&&v<this._bearingSnap;m?(_(m.bearing||this._map.getBearing())&&(m.bearing=0),this._map.easeTo(m,{originalEvent:d})):(this._map.fire(new Nt("moveend",{originalEvent:d})),_(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,n){this._map.fire(new Nt(t,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new CV("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Yk="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class AV extends En{constructor(t,n){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=n.bearingSnap,this._respectPrefersReducedMotion=n.respectPrefersReducedMotion!==!1,Ue(["_renderFrameCallback"],this)}getCenter(){return new Ke(this.transform.center.lng,this.transform.center.lat)}setCenter(t,n){return this.jumpTo({center:t},n)}panBy(t,n,r){return t=N.convert(t).mult(-1),this.panTo(this.transform.center,Ot({offset:t},n),r)}panTo(t,n,r){return this.easeTo(Ot({center:t},n),r)}getZoom(){return this.transform.zoom}setZoom(t,n){return this.jumpTo({zoom:t},n),this}zoomTo(t,n,r){return this.easeTo(Ot({zoom:t},n),r)}zoomIn(t,n){return this.zoomTo(this.getZoom()+1,t,n),this}zoomOut(t,n){return this.zoomTo(this.getZoom()-1,t,n),this}getBearing(){return this.transform.bearing}setBearing(t,n){return this.jumpTo({bearing:t},n),this}getPadding(){return this.transform.padding}setPadding(t,n){return this.jumpTo({padding:t},n),this}rotateTo(t,n,r){return this.easeTo(Ot({bearing:t},n),r)}resetNorth(t,n){return this.rotateTo(0,Ot({duration:1e3},t),n),this}resetNorthPitch(t,n){return this.easeTo(Ot({bearing:0,pitch:0,duration:1e3},t),n),this}snapToNorth(t,n){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,n):this}getPitch(){return this.transform.pitch}setPitch(t,n){return this.jumpTo({pitch:t},n),this}cameraForBounds(t,n){t=To.convert(t);const r=n&&n.bearing||0,o=n&&n.pitch||0,a=t.getNorthWest(),c=t.getSouthEast();return this._cameraForBounds(this.transform,a,c,r,o,n)}_extendCameraOptions(t){const n={top:0,bottom:0,right:0,left:0};if(typeof(t=Ot({padding:n,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding=="number"){const r=t.padding;t.padding={top:r,bottom:r,right:r,left:r}}return t.padding=Ot(n,t.padding),t}_minimumAABBFrustumDistance(t,n){const r=n.max[0]-n.min[0],o=n.max[1]-n.min[1];return r/o>t.aspect?r/(2*Math.tan(.5*t.fovX)*t.aspect):o/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(t,n,r,o,a,c){const u=t.clone(),d=this._extendCameraOptions(c);u.bearing=o,u.pitch=a;const p=Ke.convert(n),m=Ke.convert(r),_=.5*(p.lat+m.lat),v=.5*(p.lng+m.lng),x=fo(_,v),w=ot.normalize([],x),T=ot.normalize([],ot.cross([],w,[0,1,0])),S=ot.cross([],T,w),I=[T[0],T[1],T[2],0,S[0],S[1],S[2],0,w[0],w[1],w[2],0,0,0,0,1],A=[x,fo(p.lat,p.lng),fo(m.lat,p.lng),fo(m.lat,m.lng),fo(p.lat,m.lng),fo(_,p.lng),fo(_,m.lng),fo(p.lat,v),fo(m.lat,v)];let R=nr.fromPoints(A.map(pt=>[ot.dot(T,pt),ot.dot(S,pt),ot.dot(w,pt)]));const k=ot.transformMat4([],R.center,I);ot.squaredLength(k)===0&&ot.set(k,0,0,1),ot.normalize(k,k),ot.scale(k,k,Yi),u.center=function([pt,Ct,At]){const It=Math.hypot(pt,Ct,At),zt=Math.atan2(pt,At),Ft=.5*Math.PI-Math.acos(-Ct/It);return new Ke(Tt(zt),Tt(Ft))}(k);const P=u.getWorldToCameraMatrix(),O=wt.invert(new Float64Array(16),P);R=nr.applyTransform(R,wt.multiply([],P,I)),ot.transformMat4(k,k,P);const j=.5*(R.max[2]-R.min[2]),G=this._minimumAABBFrustumDistance(u,R),W=ot.scale([],[0,0,1],j),Z=ot.add(W,k,W),K=G+(u.pitch===0?0:ot.distance(k,Z)),Q=u.globeCenterInViewSpace,at=ot.sub([],k,[Q[0],Q[1],Q[2]]);ot.normalize(at,at),ot.scale(at,at,K);const X=ot.add([],k,at);ot.transformMat4(X,X,O);const ft=Ku/Yi,gt=ot.length(X),vt=Hn(Math.max(gt*ft-Ku,Number.EPSILON),0),ht=Math.min(u.zoomFromMercatorZAdjusted(vt),d.maxZoom);return ht>.5*(tf+wl)?(u.setProjection({name:"mercator"}),u.zoom=ht,this._cameraForBounds(u,n,r,o,a,c)):{center:u.center,zoom:ht,bearing:o,pitch:a}}queryTerrainElevation(t,n){const r=this.transform.elevation;return r?(n=Ot({},{exaggerated:!0},n),r.getAtPoint(xn.fromLngLat(t),null,n.exaggerated)):null}_cameraForBounds(t,n,r,o,a,c){if(t.projection.name==="globe")return this._cameraForBoundsOnGlobe(t,n,r,o,a,c);const u=t.clone(),d=this._extendCameraOptions(c),p=u.padding;u.bearing=o,u.pitch=a;const m=Ke.convert(n),_=Ke.convert(r),v=new Ke(m.lng,_.lat),x=new Ke(_.lng,m.lat),w=u.project(m),T=u.project(_),S=this.queryTerrainElevation(m),I=this.queryTerrainElevation(_),A=this.queryTerrainElevation(v),R=this.queryTerrainElevation(x),k=[[w.x,w.y,Math.min(S||0,I||0,A||0,R||0)],[T.x,T.y,Math.max(S||0,I||0,A||0,R||0)]];let P=nr.fromPoints(k);const O=u.getWorldToCameraMatrix(),j=wt.invert(new Float64Array(16),O);P=nr.applyTransform(P,O);const G=ot.sub([],P.max,P.min),W=p.left||0,Z=p.right||0,K=p.bottom||0,Q=p.top||0,{left:at,right:X,top:ft,bottom:gt}=d.padding,vt=.5*(W+Z),ht=.5*(Q+K),pt=Math.min(u.scaleZoom(u.scale*Math.min((u.width-(W+Z+at+X))/G[0],(u.height-(K+Q+gt+ft))/G[1])),d.maxZoom),Ct=u.scale/u.zoomScale(pt);P=new nr([P.min[0]-(at+vt)*Ct,P.min[1]-(gt+ht)*Ct,P.min[2]],[P.max[0]+(X+vt)*Ct,P.max[1]+(ft+ht)*Ct,P.max[2]]);const At=.5*G[2],It=this._minimumAABBFrustumDistance(u,P),zt=[0,0,1,0];Wn.transformMat4(zt,zt,O),Wn.normalize(zt,zt);const Ft=ot.scale([],zt,It+At),Ut=ot.add([],P.center,Ft),Pt=(typeof d.offset.x=="number"&&typeof d.offset.y=="number"?new N(d.offset.x,d.offset.y):N.convert(d.offset)).rotate(-it(o));P.center[0]-=Pt.x*Ct,P.center[1]+=Pt.y*Ct,ot.transformMat4(P.center,P.center,j),ot.transformMat4(Ut,Ut,j);const Ht=[P.center[0],P.center[1],Ut[2]*u.pixelsPerMeter];ot.scale(Ht,Ht,1/u.worldSize);const he=So(Ht[0]),de=qr(Ht[1]),_e=Math.min(u._zoomFromMercatorZ(Ht[2]),d.maxZoom),xe=new Ke(he,de);return u.mercatorFromTransition&&_e<.5*(tf+wl)?(u.setProjection({name:"globe"}),u.zoom=_e,this._cameraForBounds(u,n,r,o,a,c)):{center:xe,zoom:_e,bearing:o,pitch:a}}fitBounds(t,n,r){const o=this.cameraForBounds(t,n);return this._fitInternal(o,n,r)}fitScreenCoordinates(t,n,r,o,a){const c=N.convert(t),u=N.convert(n),d=new N(Math.min(c.x,u.x),Math.min(c.y,u.y)),p=new N(Math.max(c.x,u.x),Math.max(c.y,u.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(c,u))return this;const m=this.transform.pointLocation3D(d),_=this.transform.pointLocation3D(p),v=this.transform.pointLocation3D(new N(d.x,p.y)),x=this.transform.pointLocation3D(new N(p.x,d.y)),w=[Math.min(m.lng,_.lng,v.lng,x.lng),Math.min(m.lat,_.lat,v.lat,x.lat)],T=[Math.max(m.lng,_.lng,v.lng,x.lng),Math.max(m.lat,_.lat,v.lat,x.lat)],S=o&&o.pitch?o.pitch:this.getPitch(),I=this._cameraForBounds(this.transform,w,T,r,S,o);return this._fitInternal(I,o,a)}_fitInternal(t,n,r){return t?(delete(n=Ot(t,n)).padding,n.linear?this.easeTo(n,r):this.flyTo(n,r)):this}jumpTo(t,n){this.stop();const r=t.preloadOnly?this.transform.clone():this.transform;let o=!1,a=!1,c=!1;return"zoom"in t&&r.zoom!==+t.zoom&&(o=!0,r.zoom=+t.zoom),t.center!==void 0&&(r.center=Ke.convert(t.center)),"bearing"in t&&r.bearing!==+t.bearing&&(a=!0,r.bearing=+t.bearing),"pitch"in t&&r.pitch!==+t.pitch&&(c=!0,r.pitch=+t.pitch),t.padding==null||r.isPaddingEqual(t.padding)||(r.padding=t.padding),t.preloadOnly?(this._preloadTiles(r),this):(this.fire(new Nt("movestart",n)).fire(new Nt("move",n)),o&&this.fire(new Nt("zoomstart",n)).fire(new Nt("zoom",n)).fire(new Nt("zoomend",n)),a&&this.fire(new Nt("rotatestart",n)).fire(new Nt("rotate",n)).fire(new Nt("rotateend",n)),c&&this.fire(new Nt("pitchstart",n)).fire(new Nt("pitch",n)).fire(new Nt("pitchend",n)),this.fire(new Nt("moveend",n)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||dt(Yk),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,n){const r=this.transform;if(!r.projection.supportsFreeCamera)return dt(Yk),this;this.stop();const o=r.zoom,a=r.pitch,c=r.bearing;r.setFreeCameraOptions(t);const u=o!==r.zoom,d=a!==r.pitch,p=c!==r.bearing;return this.fire(new Nt("movestart",n)).fire(new Nt("move",n)),u&&this.fire(new Nt("zoomstart",n)).fire(new Nt("zoom",n)).fire(new Nt("zoomend",n)),p&&this.fire(new Nt("rotatestart",n)).fire(new Nt("rotate",n)).fire(new Nt("rotateend",n)),d&&this.fire(new Nt("pitchstart",n)).fire(new Nt("pitch",n)).fire(new Nt("pitchend",n)),this.fire(new Nt("moveend",n)),this}easeTo(t,n){this._stop(!1,t.easeId),((t=Ot({offset:[0,0],duration:500,easing:Ee},t)).animate===!1||this._prefersReducedMotion(t))&&(t.duration=0);const r=this.transform,o=this.getZoom(),a=this.getBearing(),c=this.getPitch(),u=this.getPadding(),d="zoom"in t?+t.zoom:o,p="bearing"in t?this._normalizeBearing(t.bearing,a):a,m="pitch"in t?+t.pitch:c,_="padding"in t?t.padding:r.padding,v=N.convert(t.offset);let x,w,T;if(r.projection.name==="globe"){const W=xn.fromLngLat(r.center),Z=v.rotate(-r.angle);W.x+=Z.x/r.worldSize,W.y+=Z.y/r.worldSize;const K=W.toLngLat(),Q=Ke.convert(t.center||K);this._normalizeCenter(Q),x=r.centerPoint.add(Z),w=new N(W.x,W.y).mult(r.worldSize),T=new N(Qr(Q.lng),oi(Q.lat)).mult(r.worldSize).sub(w)}else{x=r.centerPoint.add(v);const W=r.pointLocation(x),Z=Ke.convert(t.center||W);this._normalizeCenter(Z),w=r.project(W),T=r.project(Z).sub(w)}const S=r.zoomScale(d-o);let I,A;t.around&&(I=Ke.convert(t.around),A=r.locationPoint(I));const R=this._zooming||d!==o,k=this._rotating||a!==p,P=this._pitching||m!==c,O=!r.isPaddingEqual(_),j=W=>Z=>{if(R&&(W.zoom=Xe(o,d,Z)),k&&(W.bearing=Xe(a,p,Z)),P&&(W.pitch=Xe(c,m,Z)),O&&(W.interpolatePadding(u,_,Z),x=W.centerPoint.add(v)),I)W.setLocationAtPoint(I,A);else{const K=W.zoomScale(W.zoom-o),Q=d>o?Math.min(2,S):Math.max(.5,S),at=Math.pow(Q,1-Z),X=W.unproject(w.add(T.mult(Z*at)).mult(K));W.setLocationAtPoint(W.renderWorldCopies?X.wrap():X,x)}return t.preloadOnly||this._fireMoveEvents(n),W};if(t.preloadOnly){const W=this._emulate(j,t.duration,r);return this._preloadTiles(W),this}const G={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=R,this._rotating=k,this._pitching=P,this._padding=O,this._easeId=t.easeId,this._prepareEase(n,t.noMoveStart,G),this._ease(j(r),W=>{r.cameraElevationReference==="sea"&&r.recenterOnTerrain(),this._afterEase(n,W)},t),this}_prepareEase(t,n,r={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),n||r.moving||this.fire(new Nt("movestart",t)),this._zooming&&!r.zooming&&this.fire(new Nt("zoomstart",t)),this._rotating&&!r.rotating&&this.fire(new Nt("rotatestart",t)),this._pitching&&!r.pitching&&this.fire(new Nt("pitchstart",t))}_fireMoveEvents(t){this.fire(new Nt("move",t)),this._zooming&&this.fire(new Nt("zoom",t)),this._rotating&&this.fire(new Nt("rotate",t)),this._pitching&&this.fire(new Nt("pitch",t))}_afterEase(t,n){if(this._easeId&&n&&this._easeId===n)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const r=this._zooming,o=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new Nt("zoomend",t)),o&&this.fire(new Nt("rotateend",t)),a&&this.fire(new Nt("pitchend",t)),this.fire(new Nt("moveend",t))}flyTo(t,n){if(this._prefersReducedMotion(t)){const pt=Pe(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(pt,n)}this.stop(),t=Ot({offset:[0,0],speed:1.2,curve:1.42,easing:Ee},t);const r=this.transform,o=this.getZoom(),a=this.getBearing(),c=this.getPitch(),u=this.getPadding(),d="zoom"in t?jt(+t.zoom,r.minZoom,r.maxZoom):o,p="bearing"in t?this._normalizeBearing(t.bearing,a):a,m="pitch"in t?+t.pitch:c,_="padding"in t?t.padding:r.padding,v=r.zoomScale(d-o),x=N.convert(t.offset);let w=r.centerPoint.add(x);const T=r.pointLocation(w),S=Ke.convert(t.center||T);this._normalizeCenter(S);const I=r.project(T),A=r.project(S).sub(I);let R=t.curve;const k=Math.max(r.width,r.height),P=k/v,O=A.mag();if("minZoom"in t){const pt=jt(Math.min(t.minZoom,o,d),r.minZoom,r.maxZoom),Ct=k/r.zoomScale(pt-o);R=Math.sqrt(Ct/O*2)}const j=R*R;function G(pt){const Ct=(P*P-k*k+(pt?-1:1)*j*j*O*O)/(2*(pt?P:k)*j*O);return Math.log(Math.sqrt(Ct*Ct+1)-Ct)}function W(pt){return(Math.exp(pt)-Math.exp(-pt))/2}function Z(pt){return(Math.exp(pt)+Math.exp(-pt))/2}const K=G(0);let Q=function(pt){return Z(K)/Z(K+R*pt)},at=function(pt){return k*((Z(K)*(W(Ct=K+R*pt)/Z(Ct))-W(K))/j)/O;var Ct},X=(G(1)-K)/R;if(Math.abs(O)<1e-6||!isFinite(X)){if(Math.abs(k-P)<1e-6)return this.easeTo(t,n);const pt=P<k?-1:1;X=Math.abs(Math.log(P/k))/R,at=function(){return 0},Q=function(Ct){return Math.exp(pt*R*Ct)}}t.duration="duration"in t?+t.duration:1e3*X/("screenSpeed"in t?+t.screenSpeed/R:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const ft=a!==p,gt=m!==c,vt=!r.isPaddingEqual(_),ht=pt=>Ct=>{const At=Ct*X,It=1/Q(At);pt.zoom=Ct===1?d:o+pt.scaleZoom(It),ft&&(pt.bearing=Xe(a,p,Ct)),gt&&(pt.pitch=Xe(c,m,Ct)),vt&&(pt.interpolatePadding(u,_,Ct),w=pt.centerPoint.add(x));const zt=Ct===1?S:pt.unproject(I.add(A.mult(at(At))).mult(It));return pt.setLocationAtPoint(pt.renderWorldCopies?zt.wrap():zt,w),pt._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(n),pt};if(t.preloadOnly){const pt=this._emulate(ht,t.duration,r);return this._preloadTiles(pt),this}return this._zooming=!0,this._rotating=ft,this._pitching=gt,this._padding=vt,this._prepareEase(n,!1),this._ease(ht(r),()=>this._afterEase(n),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,n){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const r=this._onEaseEnd;this._onEaseEnd=void 0,r.call(this,n)}if(!t){const r=this.handlers;r&&r.stop(!1)}return this}_ease(t,n,r){r.animate===!1||r.duration===0?(t(1),n()):(this._easeStart=Ve.now(),this._easeOptions=r,this._onEaseFrame=t,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((Ve.now()-this._easeStart)/this._easeOptions.duration,1),n=this._onEaseFrame;n&&n(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,n){t=we(t,-180,180);const r=Math.abs(t-n);return Math.abs(t-360-n)<r&&(t-=360),Math.abs(t+360-n)<r&&(t+=360),t}_normalizeCenter(t){const n=this.transform;if(n.maxBounds||n.projection.name!=="globe"&&!n.renderWorldCopies)return;const r=t.lng-n.center.lng;t.lng+=r>180?-360:r<-180?360:0}_prefersReducedMotion(t){return this._respectPrefersReducedMotion&&Ve.prefersReducedMotion&&!(t&&t.essential)}_emulate(t,n,r){const o=Math.ceil(15*n/1e3),a=[],c=t(r.clone());for(let u=0;u<=o;u++){const d=c(u/o);a.push(d.clone())}return a}}class Qk{constructor(t={}){this.options=t,Ue(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const n=this.options&&this.options.compact;return this._map=t,this._container=$n("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=$n("button","mapboxgl-ctrl-attrib-button",this._container),$n("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=$n("div","mapboxgl-ctrl-attrib-inner",this._container),n&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),n===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,n){const r=this._map._getUIString(`AttributionControl.${n}`);t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",r)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||z.ACCESS_TOKEN}];if(t){const r=n.reduce((o,a,c)=>(a.value&&(o+=`${a.key}=${a.value}${c<n.length-1?"&":""}`),o),"?");t.href=`${z.FEEDBACK_URL}/${r}#${Wk(this._map,!0)}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(t){!t||t.sourceDataType!=="metadata"&&t.sourceDataType!=="visibility"&&t.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const o=this._map.style.stylesheet;this.styleOwner=o.owner,this.styleId=o.id}const n=this._map.style._mergedSourceCaches;for(const o in n){const a=n[o];if(a.used){const c=a.getSource();c.attribution&&t.indexOf(c.attribution)<0&&t.push(c.attribution)}}t.sort((o,a)=>o.length-a.length),t=t.filter((o,a)=>{for(let c=a+1;c<t.length;c++)if(t[c].indexOf(o)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const r=t.join(" | ");r!==this._attribHTML&&(this._attribHTML=r,t.length?(this._innerContainer.innerHTML=r,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Jk{constructor(){Ue(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=$n("div","mapboxgl-ctrl");const n=$n("a","mapboxgl-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://www.mapbox.com/",n.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),n.setAttribute("rel","noopener nofollow"),this._container.appendChild(n),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&t.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(Object.entries(t).length===0)return!0;for(const n in t){const r=t[n].getSource();if(r.hasOwnProperty("mapbox_logo")&&!r.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const n=t[0];this._map.getCanvasContainer().offsetWidth<250?n.classList.add("mapboxgl-compact"):n.classList.remove("mapboxgl-compact")}}}class tO{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const n=++this._id;return this._queue.push({callback:t,id:n,cancelled:!1}),n}remove(t){const n=this._currentlyRunning,r=n?this._queue.concat(n):this._queue;for(const o of r)if(o.id===t)return void(o.cancelled=!0)}run(t=0){const n=this._currentlyRunning=this._queue;this._queue=[];for(const r of n)if(!r.cancelled&&(r.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function eO(e,t,n){if(e=new Ke(e.lng,e.lat),t){const r=new Ke(e.lng-360,e.lat),o=new Ke(e.lng+360,e.lat),a=360*Math.ceil(Math.abs(e.lng-n.center.lng)/360),c=n.locationPoint(e).distSqr(t),u=t.x<0||t.y<0||t.x>n.width||t.y>n.height;n.locationPoint(r).distSqr(t)<c&&(u||Math.abs(r.lng-n.center.lng)<a)?e=r:n.locationPoint(o).distSqr(t)<c&&(u||Math.abs(o.lng-n.center.lng)<a)&&(e=o)}for(;Math.abs(e.lng-n.center.lng)>180;){const r=n.locationPoint(e);if(r.x>=0&&r.y>=0&&r.x<=n.width&&r.y<=n.height)break;e.lng>n.center.lng?e.lng-=360:e.lng+=360}return e}const Tb={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Sb extends En{constructor(t,n){if(super(),(t instanceof C.HTMLElement||n)&&(t=Ot({element:t},n)),Ue(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=N.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=$n("div");const a=41,c=27,u=jo("svg",{display:"block",height:a*this._scale+"px",width:c*this._scale+"px",viewBox:`0 0 ${c} ${a}`},this._element),d=jo("radialGradient",{id:"shadowGradient"},jo("defs",{},u));jo("stop",{offset:"10%","stop-opacity":.4},d),jo("stop",{offset:"100%","stop-opacity":.05},d),jo("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},u),jo("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},u),jo("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},u),jo("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},u),this._offset=N.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()});const r=this._element.classList;for(const a in Tb)r.remove(`mapboxgl-marker-anchor-${a}`);r.add(`mapboxgl-marker-anchor-${this._anchor}`);const o=t&&t.className?t.className.trim().split(/\s+/):[];r.add(...o),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=Ke.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const o=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[o,-1*(38.1-13.5+o)],"bottom-right":[-o,-1*(38.1-13.5+o)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const n=t.code,r=t.charCode||t.keyCode;n!=="Space"&&n!=="Enter"&&r!==32&&r!==13||this.togglePopup()}_onMapClick(t){const n=t.originalEvent.target,r=this._element;this._popup&&(n===r||r.contains(n))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,n=this._pos;if(!t||!n)return!1;const r=t.unproject(n),o=t.getFreeCameraOptions();if(!o.position)return!1;const a=o.position.toLngLat();return a.distanceTo(r)<.9*a.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const n=this._pos;if(!n||n.x<0||n.x>t.transform.width||n.y<0||n.y>t.transform.height)return void this._clearFadeTimer();const r=t.unproject(n);let o;t._showingGlobe()&&Nm(t.transform,this._lngLat)?o=0:(o=1-t._queryFogOpacity(r),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(o*=this._occludedOpacity)),this._element.style.opacity=`${o}`,this._element.style.pointerEvents=o>0?"auto":"none",this._popup&&this._popup._setOpacity(o),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const n=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${t.x}px,${t.y}px)
            ${Tb[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${n.x}px,${n.y}px)
        `}_calculateXYTransform(){const t=this._pos,n=this._map,r=this.getPitchAlignment();if(!n||!t||r!=="map")return"";if(!n._showingGlobe()){const d=n.getPitch();return d?`rotateX(${d}deg)`:""}const o=Tt($I(n.transform,this._lngLat)),a=t.sub(UI(n.transform)),c=Math.abs(a.x)+Math.abs(a.y);if(c===0)return"";const u=o/c;return`rotateX(${-a.y*u}deg) rotateY(${a.x*u}deg)`}_calculateZTransform(){const t=this._pos,n=this._map;if(!n||!t)return"";let r=0;const o=this.getRotationAlignment();if(o==="map")if(n._showingGlobe()){const a=n.project(new Ke(this._lngLat.lng,this._lngLat.lat+.001)),c=n.project(new Ke(this._lngLat.lng,this._lngLat.lat-.001)).sub(a);r=Tt(Math.atan2(c.y,c.x))-90}else r=-n.getBearing();else if(o==="horizon"){const a=Le(4,6,n.getZoom()),c=UI(n.transform);c.y+=a*n.transform.height;const u=t.sub(c),d=Tt(Math.atan2(u.y,u.x));r=(d>90?d-270:d+90)*(1-a)}return r+=this._rotation,r?`rotateZ(${r}deg)`:""}_update(t){C.cancelAnimationFrame(this._updateFrameId);const n=this._map;n&&(n.transform.renderWorldCopies&&(this._lngLat=eO(this._lngLat,this._pos,n.transform)),this._pos=n.project(this._lngLat),t===!0?this._updateFrameId=C.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),n._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(n._showingGlobe()||n.getTerrain()||n.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=N.convert(t),this._update(),this}addClassName(t){return this._element.classList.add(t),this}removeClassName(t){return this._element.classList.remove(t),this}toggleClassName(t){return this._element.classList.toggle(t)}_onMove(t){const n=this._map;if(!n)return;const r=this._pointerdownPos,o=this._positionDelta;if(r&&o){if(!this._isDragging){const a=this._clickTolerance||n._clickTolerance;if(t.point.dist(r)<a)return;this._isDragging=!0}this._pos=t.point.sub(o),this._lngLat=n.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new Nt("dragstart"))),this.fire(new Nt("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new Nt("dragend")),this._state="inactive"}_addDragHandler(t){const n=this._map,r=this._pos;n&&r&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(r),this._pointerdownPos=t.point,this._state="pending",n.on("mousemove",this._onMove),n.on("touchmove",this._onMove),n.once("mouseup",this._onUp),n.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const n=this._map;return n&&(t?(n.on("mousedown",this._addDragHandler),n.on("touchstart",this._addDragHandler)):(n.off("mousedown",this._addDragHandler),n.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const PV={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},RV=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function nO(e=new N(0,0),t="bottom"){if(typeof e=="number"){const n=Math.round(Math.sqrt(.5*Math.pow(e,2)));switch(t){case"top":return new N(0,e);case"top-left":return new N(n,n);case"top-right":return new N(-n,n);case"bottom":return new N(0,-e);case"bottom-left":return new N(n,-n);case"bottom-right":return new N(-n,-n);case"left":return new N(e,0);case"right":return new N(-e,0)}return new N(0,0)}return e instanceof N||Array.isArray(e)?N.convert(e):N.convert(e[t]||[0,0])}class kV{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const n=ne((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-n)+this._end*n}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,n,r){this._start=this.getValue(n),this._end=t,this._startTime=n,this._endTime=n+r}}const OV={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},LV={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},zV={showCompass:!0,showZoom:!0,visualizePitch:!1};class DV{constructor(t,n,r=!1){this._clickTolerance=10,this.element=n,this.mouseRotate=new qk({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,r&&(this.mousePitch=new Hk({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),Ue(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener("mousedown",this.mousedown),n.addEventListener("touchstart",this.touchstart,{passive:!1}),n.addEventListener("touchmove",this.touchmove),n.addEventListener("touchend",this.touchend),n.addEventListener("touchcancel",this.reset)}down(t,n){this.mouseRotate.mousedown(t,n),this.mousePitch&&this.mousePitch.mousedown(t,n),Iu()}move(t,n){const r=this.map,o=this.mouseRotate.mousemoveWindow(t,n),a=o&&o.bearingDelta;if(a&&r.setBearing(r.getBearing()+a),this.mousePitch){const c=this.mousePitch.mousemoveWindow(t,n),u=c&&c.pitchDelta;u&&r.setPitch(r.getPitch()+u)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Au(),C.removeEventListener("mousemove",this.mousemove),C.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(Ot({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),yo(this.element,t)),C.addEventListener("mousemove",this.mousemove),C.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,yo(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){t.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ia(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){t.targetTouches.length!==1?this.reset():(this._lastPos=Ia(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const BV={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},FV={maxWidth:100,unit:"metric"},NV={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},n_={version:L,supported:il,setRTLTextPlugin:function(e,t,n=!1){if(xo===ex||xo===nx||xo===rx)throw new Error("setRTLTextPlugin cannot be called multiple times.");ml=Ve.resolveURL(e),xo=ex,ix=t,ox(),n||GC()},getRTLTextPluginStatus:ax,Map:class extends AV{constructor(e){Cu.mark(Is.create);const t=e;if((e=Ot({},LV,e)).minZoom!=null&&e.maxZoom!=null&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(e.minPitch!=null&&e.maxPitch!=null&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(e.minPitch!=null&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(e.maxPitch!=null&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(e.antialias&&function(n){const r=n.navigator?n.navigator.userAgent:null;return!!function(o){if(Re==null){const a=o.navigator?o.navigator.userAgent:null;Re=!!o.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return Re}(n)&&r&&(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))}(C)&&(e.antialias=!1,dt("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new F1(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),e),this._interactive=e.interactive,this._minTileCacheSize=e.minTileCacheSize,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=e.crossSourceCollisions,this._collectResourceTiming=e.collectResourceTiming,this._language=this._parseLanguage(e.language),this._worldview=e.worldview,this._renderTaskQueue=new tO,this._domRenderTaskQueue=new tO,this._controls=[],this._markers=[],this._popups=[],this._mapId=Ne(),this._locale=Ot({},OV,e.locale),this._clickTolerance=e.clickTolerance,this._cooperativeGestures=e.cooperativeGestures,this._performanceMetricsCollection=e.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new kV(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new Oe(e.transformRequest,e.accessToken,e.testMode),this._silenceAuthErrors=!!e.testMode,this._contextCreateOptions=e.contextCreateOptions?{...e.contextCreateOptions}:{},typeof e.container=="string"){if(this._container=C.document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container.toString()}' not found.`)}else{if(!(e.container instanceof C.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(this._container.childNodes.length>0&&dt("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),e.maxBounds&&this.setMaxBounds(e.maxBounds),Ue(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),C!==void 0&&(this._fullscreenchangeEvent="onfullscreenchange"in C.document?"fullscreenchange":"webkitfullscreenchange",C.addEventListener("online",this._onWindowOnline,!1),C.addEventListener("resize",this._onWindowResize,!1),C.addEventListener("orientationchange",this._onWindowResize,!1),C.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),C.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new IV(this,e),this._localFontFamily=e.localFontFamily,this._localIdeographFontFamily=e.localIdeographFontFamily,(e.style||!e.testMode)&&this.setStyle(e.style||z.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),e.projection&&this.setProjection(e.projection),e.hash&&(this._hash=new Q8(typeof e.hash=="string"&&e.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){t.center==null&&t.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch});const n=e.bounds;n&&(this.resize(),this.fitBounds(n,Ot({},e.fitBoundsOptions,{duration:0})))}this.resize(),e.attributionControl&&this.addControl(new Qk({customAttribution:e.customAttribution})),this._logoControl=new Jk,this.addControl(this._logoControl,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",n=>{this._update(n.dataType==="style"),this.fire(new Nt(`${n.dataType}data`,n))}),this.on("dataloading",n=>{this.fire(new Nt(`${n.dataType}dataloading`,n))})}_getMapId(){return this._mapId}addControl(e,t){if(t===void 0&&(t=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new ve(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=e.onAdd(this);this._controls.push(e);const r=this._controlPositions[t];return t.indexOf("bottom")!==-1?r.insertBefore(n,r.firstChild):r.appendChild(n),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new ve(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(e);return t>-1&&this._controls.splice(t,1),e.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(e){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new Nt("movestart",e)).fire(new Nt("move",e)),this.fire(new Nt("resize",e)),t&&this.fire(new Nt("moveend",e)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(e){return this.transform.setMaxBounds(To.convert(e)),this._update()}setMinZoom(e){if((e=e??-2)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e?this.setZoom(e):this.fire(new Nt("zoomstart")).fire(new Nt("zoom")).fire(new Nt("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=e??22)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e?this.setZoom(e):this.fire(new Nt("zoomstart")).fire(new Nt("zoom")).fire(new Nt("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=e??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e?this.setPitch(e):this.fire(new Nt("pitchstart")).fire(new Nt("pitch")).fire(new Nt("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=e??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e?this.setPitch(e):this.fire(new Nt("pitchstart")).fire(new Nt("pitch")).fire(new Nt("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(e){return e==="auto"?C.navigator.language:Array.isArray(e)?e.length===0?void 0:e.map(t=>t==="auto"?C.navigator.language:t):e}setLanguage(e){const t=this._parseLanguage(e);if(!this.style||t===this._language)return this;this._language=t,this.style.reloadSources();for(const n of this._controls)n._setLanguage&&n._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(e){return this.style&&e!==this._worldview?(this._worldview=e,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(e){return this._lazyInitEmptyStyle(),e?typeof e=="string"&&(e={name:e}):e=null,this._useExplicitProjection=!!e,this._prioritizeAndUpdateProjection(e,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const e=this.transform,t=e.projection.name;let n;t==="globe"&&e.zoom>=wl?(e.setMercatorFromTransition(),n=!0):t==="mercator"&&e.zoom<wl&&(e.setProjection({name:"globe"}),n=!0),n&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(e,t){return this._updateProjection(e||t||{name:"mercator"})}_updateProjection(e){let t;return t=e.name==="globe"&&this.transform.zoom>=wl?this.transform.setMercatorFromTransition():this.transform.setProjection(e),this.style.applyProjectionUpdate(),t&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(e){return this.transform.locationPoint3D(Ke.convert(e))}unproject(e){return this.transform.pointLocation3D(N.convert(e))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(e,t,n){if(e==="mouseenter"||e==="mouseover"){let r=!1;const o=c=>{const u=t.filter(p=>this.getLayer(p)),d=u.length?this.queryRenderedFeatures(c.point,{layers:u}):[];d.length?r||(r=!0,n.call(this,new Ho(e,this,c.originalEvent,{features:d}))):r=!1},a=()=>{r=!1};return{layers:new Set(t),listener:n,delegates:{mousemove:o,mouseout:a}}}if(e==="mouseleave"||e==="mouseout"){let r=!1;const o=c=>{const u=t.filter(d=>this.getLayer(d));(u.length?this.queryRenderedFeatures(c.point,{layers:u}):[]).length?r=!0:r&&(r=!1,n.call(this,new Ho(e,this,c.originalEvent)))},a=c=>{r&&(r=!1,n.call(this,new Ho(e,this,c.originalEvent)))};return{layers:new Set(t),listener:n,delegates:{mousemove:o,mouseout:a}}}{const r=o=>{const a=t.filter(u=>this.getLayer(u)),c=a.length?this.queryRenderedFeatures(o.point,{layers:a}):[];c.length&&(o.features=c,n.call(this,o),delete o.features)};return{layers:new Set(t),listener:n,delegates:{[e]:r}}}}on(e,t,n){if(n===void 0)return super.on(e,t);if(Array.isArray(t)||(t=[t]),t){for(const o of t)if(!this._isValidId(o))return this}const r=this._createDelegatedListener(e,t,n);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(r);for(const o in r.delegates)this.on(o,r.delegates[o]);return this}once(e,t,n){if(n===void 0)return super.once(e,t);if(Array.isArray(t)||(t=[t]),t){for(const o of t)if(!this._isValidId(o))return this}const r=this._createDelegatedListener(e,t,n);for(const o in r.delegates)this.once(o,r.delegates[o]);return this}off(e,t,n){if(n===void 0)return super.off(e,t);t=new Set(Array.isArray(t)?t:[t]);for(const a of t)if(!this._isValidId(a))return this;const r=(a,c)=>{if(a.size!==c.size)return!1;for(const u of a)if(!c.has(u))return!1;return!0},o=this._delegatedListeners?this._delegatedListeners[e]:void 0;return o&&(a=>{for(let c=0;c<a.length;c++){const u=a[c];if(u.listener===n&&r(u.layers,t)){for(const d in u.delegates)this.off(d,u.delegates[d]);return a.splice(c,1),this}}})(o),this}queryRenderedFeatures(e,t){if(!this.style)return[];if(t!==void 0||e===void 0||e instanceof N||Array.isArray(e)||(t=e,e=void 0),e=e||[[0,0],[this.transform.width,this.transform.height]],(t=t||{}).layers&&Array.isArray(t.layers)){for(const n of t.layers)if(!this._isValidId(n))return[]}return this.style.queryRenderedFeatures(e,t,this.transform)}querySourceFeatures(e,t){return this._isValidId(e)?this.style.querySourceFeatures(e,t):[]}isPointOnSurface(e){const{name:t}=this.transform.projection;return t!=="globe"&&t!=="mercator"&&dt(`${t} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(N.convert(e))}setStyle(e,t){return(t=Ot({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&t.localFontFamily===this._localFontFamily&&this.style&&e?(this._diffStyle(e,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(e,t))}_getUIString(e){const t=this._locale[e];if(t==null)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),e&&(this.style=new js(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof e=="string"?this.style.loadURL(e):this.style.loadJSON(e)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new js(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,t){if(typeof e=="string"){const n=this._requestManager.normalizeStyleURL(e),r=this._requestManager.transformRequest(n,Dt.Style);Qt(r,(o,a)=>{o?this.fire(new ve(o)):a&&this._updateDiff(a,t)})}else typeof e=="object"&&this._updateDiff(e,t)}_updateDiff(e,t){try{this.style.setState(e)&&this._update(!0)}catch(n){dt(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(e,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(dt("There is no style added to the map."),!1)}_isValidId(e){return e==null?(this.fire(new ve(new Error("IDs can't be empty."))),!1):!HC(e)||(this.fire(new ve(new Error(`IDs can't contain special symbols: "${e}".`))),!1)}addSource(e,t){return this._isValidId(e)?(this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)):this}isSourceLoaded(e){return!!this._isValidId(e)&&!!this.style&&this.style._isSourceCacheLoaded(e)}areTilesLoaded(){const e=this.style&&this.style._sourceCaches;for(const t in e){const n=e[t]._tiles;for(const r in n){const o=n[r];if(o.state!=="loaded"&&o.state!=="errored")return!1}}return!0}addSourceType(e,t,n){this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,n)}removeSource(e){return this._isValidId(e)?(this.style.removeSource(e),this._updateTerrain(),this._update(!0)):this}getSource(e){return this._isValidId(e)?this.style.getOwnSource(e):null}addImage(e,t,{pixelRatio:n=1,sdf:r=!1,stretchX:o,stretchY:a,content:c}={}){if(this._lazyInitEmptyStyle(),t instanceof C.HTMLImageElement||C.ImageBitmap&&t instanceof C.ImageBitmap){const{width:u,height:d,data:p}=Ve.getImageData(t);this.style.addImage(e,{data:new jr({width:u,height:d},p),pixelRatio:n,stretchX:o,stretchY:a,content:c,sdf:r,version:0})}else if(t.width===void 0||t.height===void 0)this.fire(new ve(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:u,height:d}=t,p=t;this.style.addImage(e,{data:new jr({width:u,height:d},new Uint8Array(p.data)),pixelRatio:n,stretchX:o,stretchY:a,content:c,sdf:r,version:0,userImage:p}),p.onAdd&&p.onAdd(this,e)}}updateImage(e,t){this._lazyInitEmptyStyle();const n=this.style.getImage(e);if(!n)return void this.fire(new ve(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=t instanceof C.HTMLImageElement||C.ImageBitmap&&t instanceof C.ImageBitmap?Ve.getImageData(t):t,{width:o,height:a}=r;o!==void 0&&a!==void 0?o===n.data.width&&a===n.data.height?(n.data.replace(r.data,!(t instanceof C.HTMLImageElement||C.ImageBitmap&&t instanceof C.ImageBitmap)),this.style.updateImage(e,n)):this.fire(new ve(new Error(`The width and height of the updated image (${o}, ${a})
                must be that same as the previous version of the image
                (${n.data.width}, ${n.data.height})`))):this.fire(new ve(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(e){return e?!!this.style&&!!this.style.getImage(e):(this.fire(new ve(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e,t){Qe(this._requestManager.transformRequest(e,Dt.Image),(n,r)=>{t(n,r instanceof C.HTMLImageElement?Ve.getImageData(r):r)})}listImages(){return this.style.listImages()}addModel(e,t){this._lazyInitEmptyStyle(),this.style.addModel(e,t)}hasModel(e){return e?this.style.hasModel(e):(this.fire(new ve(new Error("Missing required model id"))),!1)}removeModel(e){this.style.removeModel(e)}listModels(){return this.style.listModels()}addLayer(e,t){return this._isValidId(e.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)):this}moveLayer(e,t){return this._isValidId(e)?(this.style.moveLayer(e,t),this._update(!0)):this}removeLayer(e){return this._isValidId(e)?(this.style.removeLayer(e),this._update(!0)):this}getLayer(e){return this._isValidId(e)?this.style.getOwnLayer(e):null}setLayerZoomRange(e,t,n){return this._isValidId(e)?(this.style.setLayerZoomRange(e,t,n),this._update(!0)):this}setFilter(e,t,n={}){return this._isValidId(e)?(this.style.setFilter(e,t,n),this._update(!0)):this}getFilter(e){return this._isValidId(e)?this.style.getFilter(e):null}setPaintProperty(e,t,n,r={}){return this._isValidId(e)?(this.style.setPaintProperty(e,t,n,r),this._update(!0)):this}getPaintProperty(e,t){return this._isValidId(e)?this.style.getPaintProperty(e,t):null}setLayoutProperty(e,t,n,r={}){return this._isValidId(e)?(this.style.setLayoutProperty(e,t,n,r),this._update(!0)):this}getLayoutProperty(e,t){return this._isValidId(e)?this.style.getLayoutProperty(e,t):null}getConfigProperty(e,t){return this.style.getConfigProperty(e,t)}setConfigProperty(e,t,n){return this.style.setConfigProperty(e,t,n),this._update(!0)}setLights(e){if(this._lazyInitEmptyStyle(),e&&e.length===1&&e[0].type==="flat"){const t=e[0];t.properties?this.style.setFlatLight(t.properties,t.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(e),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const e=this.style.getLights()||[];return e.length===0&&e.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),e}setLight(e,t={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:e}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(e){return this._lazyInitEmptyStyle(),!e&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(e),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(e){return this._lazyInitEmptyStyle(),this.style.setFog(e),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(e){return this.style.setCamera(e),this._triggerCameraUpdate(e)}_triggerCameraUpdate(e){return this._update(this.transform.setOrthographicProjectionAtLowPitch(e["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(e){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(Ke.convert(e),this.transform):0}setFeatureState(e,t){return this._isValidId(e.source)?(this.style.setFeatureState(e,t),this._update()):this}removeFeatureState(e,t){return this._isValidId(e.source)?(this.style.removeFeatureState(e,t),this._update()):this}getFeatureState(e){return this._isValidId(e.source)?this.style.getFeatureState(e):null}_updateContainerDimensions(){if(!this._container)return;const e=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let n,r,o,a=this._container;for(;a&&(!r||!o);){const c=C.getComputedStyle(a).transform;c&&c!=="none"&&(n=c.match(/matrix.*\((.+)\)/)[1].split(", "),n[0]&&n[0]!=="0"&&n[0]!=="1"&&(r=n[0]),n[3]&&n[3]!=="0"&&n[3]!=="1"&&(o=n[3])),a=a.parentElement}this._containerWidth=r?Math.abs(e/r):e,this._containerHeight=o?Math.abs(t/o):t}_detectMissingCSS(){C.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&dt("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=$n("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=$n("div","mapboxgl-canvas-container",e);this._canvas=$n("canvas","mapboxgl-canvas",t),this._interactive&&(t.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const n=this._controlContainer=$n("div","mapboxgl-control-container",e),r=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(o=>{r[o]=$n("div",`mapboxgl-ctrl-${o}`,n)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,t){const n=Ve.devicePixelRatio||1;this._canvas.width=n*Math.ceil(e),this._canvas.height=n*Math.ceil(t),this._canvas.style.width=`${e}px`,this._canvas.style.height=`${t}px`}_addMarker(e){this._markers.push(e)}_removeMarker(e){const t=this._markers.indexOf(e);t!==-1&&this._markers.splice(t,1)}_addPopup(e){this._popups.push(e)}_removePopup(e){const t=this._popups.indexOf(e);t!==-1&&this._popups.splice(t,1)}_setupPainter(){const e=Ot({},il.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl2",e);t?(Eu(t,!0),this.painter=new V8(t,this._contextCreateOptions,this.transform),this.on("data",n=>{n.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),H.testSupport(t)):this.fire(new ve(new Error("Failed to initialize WebGL")))}_contextLost(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new Nt("webglcontextlost",{originalEvent:e}))}_contextRestored(e){this._setupPainter(),this.resize(),this._update(),this.fire(new Nt("webglcontextrestored",{originalEvent:e}))}_onMapScroll(e){if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_requestDomTask(e){!this.loaded()||this.loaded()&&!this.isMoving()?e():this._domRenderTaskQueue.add(e)}_render(e){let t;this.fire(new Nt("renderstart"));const n=this.painter.context.extTimerQuery,r=Ve.now(),o=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(t=o.createQuery(),o.beginQuery(n.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],C.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],C.performance.now())),this._renderTaskQueue.run(e),this._domRenderTaskQueue.run(e),this._removed)return;this._updateProjectionTransition();const a=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const d=this.transform.zoom,p=this.transform.pitch,m=Ve.now(),_=new fr(d,{now:m,fadeDuration:a,pitch:p,transition:this.style.transition});this.style.update(_)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let c=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),c=this._updateAverageElevation(r),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):c=this._updateAverageElevation(r),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,a,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:a,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new Nt("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new Nt("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),t){const d=Ve.now()-r;o.endQuery(n.TIME_ELAPSED_EXT),setTimeout(()=>{const p=o.getQueryParameter(t,o.QUERY_RESULT)/1e6;o.deleteQuery(t),this.fire(new Nt("gpu-timing-frame",{cpuTime:d,gpuTime:p})),C.performance.mark("frame-gpu",{startTime:r,detail:{gpuTime:p}})},50)}if(this.listens("gpu-timing-layer")){const d=this.painter.collectGpuTimers();setTimeout(()=>{const p=this.painter.queryGpuTimers(d);this.fire(new Nt("gpu-timing-layer",{layerTimes:p}))},50)}if(this.listens("gpu-timing-deferred-render")){const d=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const p=this.painter.queryGpuTimeDeferredRender(d);this.fire(new Nt("gpu-timing-deferred-render",{gpuTime:p}))},50)}const u=this._sourcesDirty||this._styleDirty||this._placementDirty||c;if(u||this._repaint)this.triggerRepaint();else{const d=!this.isMoving()&&this.loaded();if(d&&(c=this._updateAverageElevation(r,!0)),c)this.triggerRepaint();else if(this._triggerFrame(!1),d&&(this.fire(new Nt("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const p=this._calculateSpeedIndex();this.fire(new Nt("speedindexcompleted",{speedIndex:p})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||u||(this._fullyLoaded=!0,Cu.mark(Is.fullLoad),this._performanceMetricsCollection&&Su(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(e){for(const t of this._markers)e&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!e||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(e,t=!1){const n=o=>(this.transform.averageElevation=o,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&n(0);const r=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(r||(t||e-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(e)){const o=this.transform.averageElevation;let a=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(a)?a=0:this._averageElevationLastSampledAt=e;const c=Math.abs(o-a);if(c>1){if(this._isInitialLoad||r)return this._averageElevation.jumpTo(a),n(a);this._averageElevation.easeTo(a,e,300)}else if(c>1e-4)return this._averageElevation.jumpTo(a),n(a)}return!!this._averageElevation.isEasing(e)&&n(this._averageElevation.getValue(e))}_authenticate(){Id(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,e=>{if(e&&(e.message===Rn||e.status===401)){const t=this.painter.context.gl;Eu(t,!1),this._logoControl instanceof Jk&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new ve(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Md(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const e=this._isDragging();this.painter.updateTerrain(this.style,e)}_calculateSpeedIndex(){const e=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const n=this.painter.context.gl,r=n.createFramebuffer();function o(a){n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,a,0);const c=new Uint8Array(n.drawingBufferWidth*n.drawingBufferHeight*4);return n.readPixels(0,0,n.drawingBufferWidth,n.drawingBufferHeight,n.RGBA,n.UNSIGNED_BYTE,c),c}return n.bindFramebuffer(n.FRAMEBUFFER,r),this._canvasPixelComparison(o(e),t.canvasCopies.map(o),t.timeStamps)}_canvasPixelComparison(e,t,n){let r=n[1]-n[0];const o=e.length/4;for(let a=0;a<t.length;a++){const c=t[a];let u=0;for(let d=0;d<c.length;d+=4)c[d]===e[d]&&c[d+1]===e[d+1]&&c[d+2]===e[d+2]&&c[d+3]===e[d+3]&&(u+=1);r+=(n[a+2]-n[a+1])*(1-u/o)}return r}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),C!==void 0&&(C.removeEventListener("resize",this._onWindowResize,!1),C.removeEventListener("orientationchange",this._onWindowResize,!1),C.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),C.removeEventListener("online",this._onWindowOnline,!1),C.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Sa.delete(this.painter.context.gl),this._removed=!0,this.fire(new Nt("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(e){this._renderNextFrame=this._renderNextFrame||e,this.style&&!this._frame&&(this._frame=Ve.frame(t=>{const n=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,n&&this._render(t)}))}_preloadTiles(e){return kt(this.style?Object.values(this.style._sourceCaches):[],(t,n)=>t._preloadTiles(e,n),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(e){this._trackResize&&this.resize({originalEvent:e})._update()}_onVisibilityChange(){C.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(e){this._showTerrainWireframe!==e&&(this._showTerrainWireframe=e,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(e){this._showLayers2DWireframe!==e&&(this._showLayers2DWireframe=e,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(e){this._showLayers3DWireframe!==e&&(this._showLayers3DWireframe=e,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(e){this._speedIndexTiming!==e&&(this._speedIndexTiming=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(e){this._showTileAABBs!==e&&(this._showTileAABBs=e,e&&this._update())}_setCacheLimits(e,t){(function(n,r){Nn=n,ar=r})(e,t)}get version(){return L}},NavigationControl:class{constructor(e){this.options=Ot({},zV,e),this._container=$n("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(Ue(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),$n("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),$n("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(Ue(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const n=this._map;n&&(this.options.visualizePitch?n.resetNorthPitch({},{originalEvent:t}):n.resetNorth({},{originalEvent:t}))}),this._compassIcon=$n("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const e=this._map;if(!e)return;const t=e.getZoom(),n=t===e.getMaxZoom(),r=t===e.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())}_rotateCompassArrow(){const e=this._map;if(!e)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(e.transform.pitch*(Math.PI/180)),.5)}) rotateX(${e.transform.pitch}deg) rotateZ(${e.transform.angle*(180/Math.PI)}deg)`:`rotate(${e.transform.angle*(180/Math.PI)}deg)`;e._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),e.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&e.on("pitch",this._rotateCompassArrow),e.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new DV(e,this._compass,this.options.visualizePitch)),this._container}onRemove(){const e=this._map;e&&(this._container.remove(),this.options.showZoom&&e.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&e.off("pitch",this._rotateCompassArrow),e.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(e,t){const n=$n("button",e,this._container);return n.type="button",n.addEventListener("click",t),n}_setButtonTitle(e,t){if(!this._map)return;const n=this._map._getUIString(`NavigationControl.${t}`);e.setAttribute("aria-label",n),e.firstElementChild&&e.firstElementChild.setAttribute("title",n)}},GeolocateControl:class extends En{constructor(e){super(),this.options=Ot({geolocation:C.navigator.geolocation},BV,e),Ue(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Gk(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(e){return this._map=e,this._container=$n("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(e){const t=(n=!!this.options.geolocation)=>{this._supportsGeolocation=n,e(n)};this._supportsGeolocation!==void 0?e(this._supportsGeolocation):C.navigator.permissions!==void 0?C.navigator.permissions.query({name:"geolocation"}).then(n=>t(n.state!=="denied")).catch(()=>t()):t()}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),n=e.coords;return!!t&&(n.longitude<t.getWest()||n.longitude>t.getEast()||n.latitude<t.getSouth()||n.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new Nt("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new Nt("geolocate",e)),this._finish()}}_updateCamera(e){const t=new Ke(e.coords.longitude,e.coords.latitude),n=e.coords.accuracy,r=Ot({bearing:this._map.getBearing()},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(n),r,{geolocateSource:!0})}_updateMarker(e){if(e){const t=new Ke(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const e=this._map.transform,t=Hn(1,e._center.lat)*e.worldSize,n=Math.ceil(2*this._accuracy*t);this._circleElement.style.width=`${n}px`,this._circleElement.style.height=`${n}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(e){if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new Nt("error",e)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(e){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=$n("button","mapboxgl-ctrl-geolocate",this._container),$n("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",e===!1){dt("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=$n("div","mapboxgl-user-location"),this._dotElement.appendChild($n("div","mapboxgl-user-location-dot")),this._dotElement.appendChild($n("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Sb({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=$n("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Sb({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||this._watchState!=="ACTIVE_LOCK"||t.originalEvent&&t.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new Nt("trackuserlocationend")))})}}_onDeviceOrientation(e){this._userLocationDotMarker&&(e.webkitCompassHeading?this._heading=e.webkitCompassHeading:e.absolute===!0&&(this._heading=-1*e.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return dt("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new Nt("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new Nt("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new Nt("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(e={maximumAge:6e5,timeout:0},this._noTimeout=!0):(e=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,e),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const e=()=>{C.addEventListener("ondeviceorientationabsolute"in C?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};C.DeviceMotionEvent!==void 0&&typeof C.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(t=>{t==="granted"&&e()}).catch(console.error):e()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),C.removeEventListener("deviceorientation",this._onDeviceOrientation),C.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Qk,ScaleControl:class{constructor(e){this.options=Ot({},FV,e),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),Ue(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const e=this.options.maxWidth||100,t=this._map,n=t._containerHeight/2,r=t._containerWidth/2-e/2,o=t.unproject([r,n]),a=t.unproject([r+e,n]),c=o.distanceTo(a);if(this.options.unit==="imperial"){const u=3.2808*c;u>5280?this._setScale(e,u/5280,"mile"):this._setScale(e,u,"foot")}else this.options.unit==="nautical"?this._setScale(e,c/1852,"nautical-mile"):c>=1e3?this._setScale(e,c/1e3,"kilometer"):this._setScale(e,c,"meter")}_setScale(e,t,n){this._map._requestDomTask(()=>{const r=function(a){const c=Math.pow(10,`${Math.floor(a)}`.length-1);let u=a/c;return u=u>=10?10:u>=5?5:u>=3?3:u>=2?2:u>=1?1:function(d){const p=Math.pow(10,Math.ceil(-Math.log(d)/Math.LN10));return Math.round(d*p)/p}(u),c*u}(t),o=r/t;this._container.innerHTML=this._isNumberFormatSupported&&n!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:n}).format(r):`${r}&nbsp;${NV[n]}`,this._container.style.width=e*o+"px"})}onAdd(e){return this._map=e,this._language=e.getLanguage(),this._container=$n("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(e){this._language=e,this._update()}setUnit(e){this.options.unit=e,this._update()}},FullscreenControl:class{constructor(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof C.HTMLElement?this._container=e.container:dt("Full screen control 'container' must be a DOM element.")),Ue(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in C.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in C.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=$n("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",dt("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,C.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!C.document.fullscreenEnabled&&!C.document.webkitFullscreenEnabled)}_setupUI(){const e=this._fullscreenButton=$n("button","mapboxgl-ctrl-fullscreen",this._controlContainer);$n("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),C.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",e)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(C.document.fullscreenElement||C.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?C.document.exitFullscreen?C.document.exitFullscreen():C.document.webkitCancelFullScreen&&C.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends En{constructor(e){super(),this.options=Ot(Object.create(PV),e),Ue(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(e&&e.className?e.className.trim().split(/\s+/):[])}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&e.on("preclick",this._onClose),this.options.closeOnMove&&e.on("move",this._onClose),e.on("remove",this.remove),this._update(),e._addPopup(this),this._focusFirstElement(),this._trackPointer?(e.on("mousemove",this._onMouseEvent),e.on("mouseup",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")):e.on("move",this._update),this.fire(new Nt("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const e=this._map;return e&&(e.off("move",this._update),e.off("move",this._onClose),e.off("preclick",this._onClose),e.off("click",this._onClose),e.off("remove",this.remove),e.off("mousemove",this._onMouseEvent),e.off("mouseup",this._onMouseEvent),e.off("drag",this._onMouseEvent),e._canvasContainer&&e._canvasContainer.classList.remove("mapboxgl-track-pointer"),e._removePopup(this),this._map=void 0),this.fire(new Nt("close")),this}getLngLat(){return this._lngLat}setLngLat(e){this._lngLat=Ke.convert(e),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const e=this._map;return e&&(e.off("move",this._update),e.on("mousemove",this._onMouseEvent),e.on("drag",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(C.document.createTextNode(e))}setHTML(e){const t=C.document.createDocumentFragment(),n=C.document.createElement("body");let r;for(n.innerHTML=e;r=n.firstChild,r;)t.appendChild(r);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=$n("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(e),this.options.closeButton){const n=this._closeButton=$n("button","mapboxgl-popup-close-button",t);n.type="button",n.setAttribute("aria-label","Close popup"),n.setAttribute("aria-hidden","true"),n.innerHTML="&#215;",n.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(e){return this._classList.add(e),this._updateClassList(),this}removeClassName(e){return this._classList.delete(e),this._updateClassList(),this}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){let t;return this._classList.delete(e)?t=!1:(this._classList.add(e),t=!0),this._updateClassList(),t}_onMouseEvent(e){this._update(e.point)}_getAnchor(e){if(this.options.anchor)return this.options.anchor;const t=this._map,n=this._container,r=this._pos;if(!t||!n||!r)return"bottom";const o=n.offsetWidth,a=n.offsetHeight,c=r.x<o/2,u=r.x>t.transform.width-o/2;if(r.y+e<a)return c?"top-left":u?"top-right":"top";if(r.y>t.transform.height-a){if(c)return"bottom-left";if(u)return"bottom-right"}return c?"left":u?"right":"bottom"}_updateClassList(){const e=this._container;if(!e)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),e.className=t.join(" ")}_update(e){const t=this._map,n=this._content;if(!t||!this._lngLat&&!this._trackPointer||!n)return;let r=this._container;if(r||(r=this._container=$n("div","mapboxgl-popup",t.getContainer()),this._tip=$n("div","mapboxgl-popup-tip",r),r.appendChild(n)),this.options.maxWidth&&r.style.maxWidth!==this.options.maxWidth&&(r.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=eO(this._lngLat,this._pos,t.transform)),!this._trackPointer||e){const o=this._pos=this._trackPointer&&e?e:t.project(this._lngLat),a=nO(this.options.offset),c=this._anchor=this._getAnchor(a.y),u=nO(this.options.offset,c),d=o.add(u).round();t._requestDomTask(()=>{this._container&&c&&(this._container.style.transform=`${Tb[c]} translate(${d.x}px,${d.y}px)`)})}if(!this._marker&&t._showingGlobe()){const o=Nm(t.transform,this._lngLat)?0:1;this._setOpacity(o)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(RV);e&&e.focus()}_onClose(){this.remove()}_setOpacity(e){this._container&&(this._container.style.opacity=`${e}`),this._content&&(this._content.style.pointerEvents=e?"auto":"none")}},Marker:Sb,Style:js,LngLat:Ke,LngLatBounds:To,Point:N,MercatorCoordinate:xn,FreeCameraOptions:fP,Evented:En,config:z,prewarm:function(){If().acquire(Z1)},clearPrewarmedResources:function(){const e=Mf;e&&(e.isPreloaded()&&e.numActive()===1?(e.release(Z1),Mf=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return z.ACCESS_TOKEN},set accessToken(e){z.ACCESS_TOKEN=e},get baseApiUrl(){return z.API_URL},set baseApiUrl(e){z.API_URL=e},get workerCount(){return fh.workerCount},set workerCount(e){fh.workerCount=e},get maxParallelImageRequests(){return z.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){z.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage(e){(function(t){if(!Kr())return;const n=C.caches.delete($e);t&&n.catch(t).then(()=>t())})(e)},workerUrl:"",workerClass:null,get dracoUrl(){return IR()},set dracoUrl(e){(function(t){X1=Ve.resolveURL(t),K1||(K1=new Fc(If(),new En)),K1.broadcast("setDracoUrl",X1)})(e)},setNow:Ve.setNow,restoreNow:Ve.restoreNow};E.A=vR,E.D=rg,E.E=Rt,E.F=_1,E.K=jg,E.O=Pn,E.P=N,E.T=FP,E.V=Qm,E.a=Ym,E.b=gA,E.c=Rg,E.d=class extends En{constructor(e,t,n,r,o,a){super(),this.actor=e,this.layerIndex=t,this.availableImages=n,this.loadVectorData=o||CR,this.loading={},this.loaded={},this.deduped=new ER(e.scheduler),this.isSpriteLoaded=r,this.scheduler=e.scheduler,this.brightness=a}loadTile(e,t){const n=e.uid,r=e&&e.request,o=r&&r.collectResourceTiming,a=this.loading[n]=new o$(e);a.abort=this.loadVectorData(e,(c,u)=>{const d=!this.loading[n];if(delete this.loading[n],d||c||!u)return a.status="done",d||(this.loaded[n]=a),t(c);const p=u.rawData,m={};u.expires&&(m.expires=u.expires),u.cacheControl&&(m.cacheControl=u.cacheControl),a.vectorTile=u.vectorTile||new m1(new ng(p));const _=()=>{a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,(v,x)=>{if(v||!x)return t(v);const w={};if(o){const T=Mu(r);T.length>0&&(w.resourceTiming=JSON.parse(JSON.stringify(T)))}t(null,Ot({rawTileData:p.slice(0)},x,m,w))})};this.isSpriteLoaded?_():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(_,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom}):_()}),this.loaded=this.loaded||{},this.loaded[n]=a})}reloadTile(e,t){const n=this.loaded,r=e.uid,o=this;if(n&&n[r]){const a=n[r];a.showCollisionBoxes=e.showCollisionBoxes,a.projection=e.projection,a.brightness=e.brightness,a.tileTransform=Oc(e.tileID.canonical,e.projection),a.extraShadowCaster=e.extraShadowCaster;const c=(u,d)=>{const p=a.reloadCallback;p&&(delete a.reloadCallback,a.parse(a.vectorTile,o.layerIndex,this.availableImages,o.actor,p)),t(u,d)};a.status==="parsing"?a.reloadCallback=c:a.status==="done"&&(a.vectorTile?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,c):c())}else t(null,void 0)}abortTile(e,t){const n=e.uid,r=this.loading[n];r&&(r.abort&&r.abort(),delete this.loading[n]),t()}removeTile(e,t){const n=this.loaded,r=e.uid;n&&n[r]&&delete n[r],t()}},E.e=dl,E.f=Mu,E.g=$,E.h=Qt,E.i=le,E.j=function(e,t){const n=nb(e);for(const r of n){for(const o of r.meshes)m$(o);r.lights&&(r.lightMeshIndex=r.meshes.length,r.meshes.push(g$(r.lights,t)))}return n},E.k=fr,E.l=function(e){let t=0;if(new Uint32Array(e,0,1)[0]!==PR){const n=new Uint32Array(e,0,7),[,,r,o,a,c]=n;t=n.byteLength+o+a+c+a,(r!==e.byteLength||t>=e.byteLength)&&dt("Invalid b3dm header information.")}return LR(e,t)},E.m=dg,E.n=cs,E.o=Nt,E.p=yt,E.q=function(e){_i(),Gr&&Gr.then(t=>{t.keys().then(n=>{for(let r=0;r<n.length-e;r++)t.delete(n[r])})})},E.r=NR,E.s=n_,E.t=nf,E.v=Xt,E.w=C}),b(["./shared"],function(E){function C(Zt){if(typeof Zt=="number"||typeof Zt=="boolean"||typeof Zt=="string"||Zt==null)return JSON.stringify(Zt);if(Array.isArray(Zt)){let nt="[";for(const dt of Zt)nt+=`${C(dt)},`;return`${nt}]`}let Y="{";for(const nt of Object.keys(Zt).sort())Y+=`${nt}:${C(Zt[nt])},`;return`${Y}}`}function L(Zt){let Y="";for(const nt of E.r)Y+=`/${C(Zt[nt])}`;return Y}class B{constructor(Y){this.keyCache={},this._layers={},this._layerConfigs={},Y&&this.replace(Y)}replace(Y,nt){this._layerConfigs={},this._layers={},this.update(Y,[],nt)}update(Y,nt,dt){this._options=dt;for(const Wt of Y){this._layerConfigs[Wt.id]=Wt;const ae=this._layers[Wt.id]=E.c(Wt,this._options);ae.setScope(this.scope),ae.compileFilter(),this.keyCache[Wt.id]&&delete this.keyCache[Wt.id]}for(const Wt of nt)delete this.keyCache[Wt],delete this._layerConfigs[Wt],delete this._layers[Wt];this.familiesBySource={};const Bt=function(Wt,ae){const ce={};for(let Ce=0;Ce<Wt.length;Ce++){const Re=ae&&ae[Wt[Ce].id]||L(Wt[Ce]);ae&&(ae[Wt[Ce].id]=Re);let be=ce[Re];be||(be=ce[Re]=[]),be.push(Wt[Ce])}const qt=[];for(const Ce in ce)qt.push(ce[Ce]);return qt}(E.v(this._layerConfigs),this.keyCache);for(const Wt of Bt){const ae=Wt.map(Me=>this._layers[Me.id]),ce=ae[0];if(ce.visibility==="none")continue;const qt=ce.source||"";let Ce=this.familiesBySource[qt];Ce||(Ce=this.familiesBySource[qt]={});const Re=ce.sourceLayer||"_geojsonTileLayer";let be=Ce[Re];be||(be=Ce[Re]=[]),be.push(ae)}}}class z{loadTile(Y,nt){const{uid:dt,encoding:Bt,rawImageData:Wt,padding:ae}=Y,ce=E.w.ImageBitmap&&Wt instanceof E.w.ImageBitmap?this.getImageData(Wt,ae):Wt;nt(null,new E.D(dt,ce,Bt,ae<1))}getImageData(Y,nt){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Y.width,Y.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Y.width,this.offscreenCanvas.height=Y.height,this.offscreenCanvasContext.drawImage(Y,0,0,Y.width,Y.height);const dt=this.offscreenCanvasContext.getImageData(-nt,-nt,Y.width+2*nt,Y.height+2*nt);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),dt}}function H(Zt,Y){if(Zt.length!==0){U(Zt[0],Y);for(var nt=1;nt<Zt.length;nt++)U(Zt[nt],!Y)}}function U(Zt,Y){for(var nt=0,dt=0,Bt=0,Wt=Zt.length,ae=Wt-1;Bt<Wt;ae=Bt++){var ce=(Zt[Bt][0]-Zt[ae][0])*(Zt[ae][1]+Zt[Bt][1]),qt=nt+ce;dt+=Math.abs(nt)>=Math.abs(ce)?nt-qt+ce:ce-qt+nt,nt=qt}nt+dt>=0!=!!Y&&Zt.reverse()}var q=E.g(function Zt(Y,nt){var dt,Bt=Y&&Y.type;if(Bt==="FeatureCollection")for(dt=0;dt<Y.features.length;dt++)Zt(Y.features[dt],nt);else if(Bt==="GeometryCollection")for(dt=0;dt<Y.geometries.length;dt++)Zt(Y.geometries[dt],nt);else if(Bt==="Feature")Zt(Y.geometry,nt);else if(Bt==="Polygon")H(Y.coordinates,nt);else if(Bt==="MultiPolygon")for(dt=0;dt<Y.coordinates.length;dt++)H(Y.coordinates[dt],nt);return Y});const tt=E.V.prototype.toGeoJSON;var V={exports:{}},F=E.p,D=E.a.VectorTileFeature,$=J;function J(Zt,Y){this.options=Y||{},this.features=Zt,this.length=Zt.length}function ct(Zt,Y){this.id=typeof Zt.id=="number"?Zt.id:void 0,this.type=Zt.type,this.rawGeometry=Zt.type===1?[Zt.geometry]:Zt.geometry,this.properties=Zt.tags,this.extent=Y||4096}J.prototype.feature=function(Zt){return new ct(this.features[Zt],this.options.extent)},ct.prototype.loadGeometry=function(){var Zt=this.rawGeometry;this.geometry=[];for(var Y=0;Y<Zt.length;Y++){for(var nt=Zt[Y],dt=[],Bt=0;Bt<nt.length;Bt++)dt.push(new F(nt[Bt][0],nt[Bt][1]));this.geometry.push(dt)}return this.geometry},ct.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Zt=this.geometry,Y=1/0,nt=-1/0,dt=1/0,Bt=-1/0,Wt=0;Wt<Zt.length;Wt++)for(var ae=Zt[Wt],ce=0;ce<ae.length;ce++){var qt=ae[ce];Y=Math.min(Y,qt.x),nt=Math.max(nt,qt.x),dt=Math.min(dt,qt.y),Bt=Math.max(Bt,qt.y)}return[Y,dt,nt,Bt]},ct.prototype.toGeoJSON=D.prototype.toGeoJSON;var st=E.b,yt=$;function ut(Zt){var Y=new st;return function(nt,dt){for(var Bt in nt.layers)dt.writeMessage(3,N,nt.layers[Bt])}(Zt,Y),Y.finish()}function N(Zt,Y){var nt;Y.writeVarintField(15,Zt.version||1),Y.writeStringField(1,Zt.name||""),Y.writeVarintField(5,Zt.extent||4096);var dt={keys:[],values:[],keycache:{},valuecache:{}};for(nt=0;nt<Zt.length;nt++)dt.feature=Zt.feature(nt),Y.writeMessage(2,et,dt);var Bt=dt.keys;for(nt=0;nt<Bt.length;nt++)Y.writeStringField(3,Bt[nt]);var Wt=dt.values;for(nt=0;nt<Wt.length;nt++)Y.writeMessage(4,Vt,Wt[nt])}function et(Zt,Y){var nt=Zt.feature;nt.id!==void 0&&Y.writeVarintField(1,nt.id),Y.writeMessage(2,Mt,Zt),Y.writeVarintField(3,nt.type),Y.writeMessage(4,Tt,nt)}function Mt(Zt,Y){var nt=Zt.feature,dt=Zt.keys,Bt=Zt.values,Wt=Zt.keycache,ae=Zt.valuecache;for(var ce in nt.properties){var qt=nt.properties[ce],Ce=Wt[ce];if(qt!==null){Ce===void 0&&(dt.push(ce),Wt[ce]=Ce=dt.length-1),Y.writeVarint(Ce);var Re=typeof qt;Re!=="string"&&Re!=="boolean"&&Re!=="number"&&(qt=JSON.stringify(qt));var be=Re+":"+qt,Me=ae[be];Me===void 0&&(Bt.push(qt),ae[be]=Me=Bt.length-1),Y.writeVarint(Me)}}}function Lt(Zt,Y){return(Y<<3)+(7&Zt)}function it(Zt){return Zt<<1^Zt>>31}function Tt(Zt,Y){for(var nt=Zt.loadGeometry(),dt=Zt.type,Bt=0,Wt=0,ae=nt.length,ce=0;ce<ae;ce++){var qt=nt[ce],Ce=1;dt===1&&(Ce=qt.length),Y.writeVarint(Lt(1,Ce));for(var Re=dt===3?qt.length-1:qt.length,be=0;be<Re;be++){be===1&&dt!==1&&Y.writeVarint(Lt(2,Re-1));var Me=qt[be].x-Bt,zn=qt[be].y-Wt;Y.writeVarint(it(Me)),Y.writeVarint(it(zn)),Bt+=Me,Wt+=zn}dt===3&&Y.writeVarint(Lt(7,1))}}function Vt(Zt,Y){var nt=typeof Zt;nt==="string"?Y.writeStringField(1,Zt):nt==="boolean"?Y.writeBooleanField(7,Zt):nt==="number"&&(Zt%1!=0?Y.writeDoubleField(3,Zt):Zt<0?Y.writeSVarintField(6,Zt):Y.writeVarintField(5,Zt))}V.exports=ut,V.exports.fromVectorTileJs=ut,V.exports.fromGeojsonVt=function(Zt,Y){Y=Y||{};var nt={};for(var dt in Zt)nt[dt]=new yt(Zt[dt].features,Y),nt[dt].name=dt,nt[dt].version=Y.version,nt[dt].extent=Y.extent;return ut({layers:nt})},V.exports.GeoJSONWrapper=yt;var ne=E.g(V.exports);const Et={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Zt=>Zt},$t=Math.fround||(ee=new Float32Array(1),Zt=>(ee[0]=+Zt,ee[0]));var ee;const Ee=3,jt=5,Le=6;class we{constructor(Y){this.options=Object.assign(Object.create(Et),Y),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Y){const{log:nt,minZoom:dt,maxZoom:Bt}=this.options;nt&&console.time("total time");const Wt=`prepare ${Y.length} points`;nt&&console.time(Wt),this.points=Y;const ae=[];for(let qt=0;qt<Y.length;qt++){const Ce=Y[qt];if(!Ce.geometry)continue;const[Re,be]=Ce.geometry.coordinates,Me=$t(Ot(Re)),zn=$t(Pe(be));ae.push(Me,zn,1/0,qt,-1,1),this.options.reduce&&ae.push(0)}let ce=this.trees[Bt+1]=this._createTree(ae);nt&&console.timeEnd(Wt);for(let qt=Bt;qt>=dt;qt--){const Ce=+Date.now();ce=this.trees[qt]=this._createTree(this._cluster(ce,qt)),nt&&console.log("z%d: %d clusters in %dms",qt,ce.numItems,+Date.now()-Ce)}return nt&&console.timeEnd("total time"),this}getClusters(Y,nt){let dt=((Y[0]+180)%360+360)%360-180;const Bt=Math.max(-90,Math.min(90,Y[1]));let Wt=Y[2]===180?180:((Y[2]+180)%360+360)%360-180;const ae=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)dt=-180,Wt=180;else if(dt>Wt){const be=this.getClusters([dt,Bt,180,ae],nt),Me=this.getClusters([-180,Bt,Wt,ae],nt);return be.concat(Me)}const ce=this.trees[this._limitZoom(nt)],qt=ce.range(Ot(dt),Pe(ae),Ot(Wt),Pe(Bt)),Ce=ce.data,Re=[];for(const be of qt){const Me=this.stride*be;Re.push(Ce[Me+jt]>1?kt(Ce,Me,this.clusterProps):this.points[Ce[Me+Ee]])}return Re}getChildren(Y){const nt=this._getOriginId(Y),dt=this._getOriginZoom(Y),Bt="No cluster with the specified id.",Wt=this.trees[dt];if(!Wt)throw new Error(Bt);const ae=Wt.data;if(nt*this.stride>=ae.length)throw new Error(Bt);const ce=this.options.radius/(this.options.extent*Math.pow(2,dt-1)),qt=Wt.within(ae[nt*this.stride],ae[nt*this.stride+1],ce),Ce=[];for(const Re of qt){const be=Re*this.stride;ae[be+4]===Y&&Ce.push(ae[be+jt]>1?kt(ae,be,this.clusterProps):this.points[ae[be+Ee]])}if(Ce.length===0)throw new Error(Bt);return Ce}getLeaves(Y,nt,dt){const Bt=[];return this._appendLeaves(Bt,Y,nt=nt||10,dt=dt||0,0),Bt}getTile(Y,nt,dt){const Bt=this.trees[this._limitZoom(Y)],Wt=Math.pow(2,Y),{extent:ae,radius:ce}=this.options,qt=ce/ae,Ce=(dt-qt)/Wt,Re=(dt+1+qt)/Wt,be={features:[]};return this._addTileFeatures(Bt.range((nt-qt)/Wt,Ce,(nt+1+qt)/Wt,Re),Bt.data,nt,dt,Wt,be),nt===0&&this._addTileFeatures(Bt.range(1-qt/Wt,Ce,1,Re),Bt.data,Wt,dt,Wt,be),nt===Wt-1&&this._addTileFeatures(Bt.range(0,Ce,qt/Wt,Re),Bt.data,-1,dt,Wt,be),be.features.length?be:null}getClusterExpansionZoom(Y){let nt=this._getOriginZoom(Y)-1;for(;nt<=this.options.maxZoom;){const dt=this.getChildren(Y);if(nt++,dt.length!==1)break;Y=dt[0].properties.cluster_id}return nt}_appendLeaves(Y,nt,dt,Bt,Wt){const ae=this.getChildren(nt);for(const ce of ae){const qt=ce.properties;if(qt&&qt.cluster?Wt+qt.point_count<=Bt?Wt+=qt.point_count:Wt=this._appendLeaves(Y,qt.cluster_id,dt,Bt,Wt):Wt<Bt?Wt++:Y.push(ce),Y.length===dt)break}return Wt}_createTree(Y){const nt=new E.K(Y.length/this.stride|0,this.options.nodeSize,Float32Array);for(let dt=0;dt<Y.length;dt+=this.stride)nt.add(Y[dt],Y[dt+1]);return nt.finish(),nt.data=Y,nt}_addTileFeatures(Y,nt,dt,Bt,Wt,ae){for(const ce of Y){const qt=ce*this.stride,Ce=nt[qt+jt]>1;let Re,be,Me;if(Ce)Re=Xt(nt,qt,this.clusterProps),be=nt[qt],Me=nt[qt+1];else{const Fn=this.points[nt[qt+Ee]];Re=Fn.properties;const[ke,$e]=Fn.geometry.coordinates;be=Ot(ke),Me=Pe($e)}const zn={type:1,geometry:[[Math.round(this.options.extent*(be*Wt-dt)),Math.round(this.options.extent*(Me*Wt-Bt))]],tags:Re};let er;er=Ce||this.options.generateId?nt[qt+Ee]:this.points[nt[qt+Ee]].id,er!==void 0&&(zn.id=er),ae.features.push(zn)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))}_cluster(Y,nt){const{radius:dt,extent:Bt,reduce:Wt,minPoints:ae}=this.options,ce=dt/(Bt*Math.pow(2,nt)),qt=Y.data,Ce=[],Re=this.stride;for(let be=0;be<qt.length;be+=Re){if(qt[be+2]<=nt)continue;qt[be+2]=nt;const Me=qt[be],zn=qt[be+1],er=Y.within(qt[be],qt[be+1],ce),Fn=qt[be+jt];let ke=Fn;for(const $e of er){const Nn=$e*Re;qt[Nn+2]>nt&&(ke+=qt[Nn+jt])}if(ke>Fn&&ke>=ae){let $e,Nn=Me*Fn,ar=zn*Fn,Gr=-1;const Ci=((be/Re|0)<<5)+(nt+1)+this.points.length;for(const Kr of er){const _i=Kr*Re;if(qt[_i+2]<=nt)continue;qt[_i+2]=nt;const so=qt[_i+jt];Nn+=qt[_i]*so,ar+=qt[_i+1]*so,qt[_i+4]=Ci,Wt&&($e||($e=this._map(qt,be,!0),Gr=this.clusterProps.length,this.clusterProps.push($e)),Wt($e,this._map(qt,_i)))}qt[be+4]=Ci,Ce.push(Nn/ke,ar/ke,1/0,Ci,-1,ke),Wt&&Ce.push(Gr)}else{for(let $e=0;$e<Re;$e++)Ce.push(qt[be+$e]);if(ke>1)for(const $e of er){const Nn=$e*Re;if(!(qt[Nn+2]<=nt)){qt[Nn+2]=nt;for(let ar=0;ar<Re;ar++)Ce.push(qt[Nn+ar])}}}}return Ce}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,nt,dt){if(Y[nt+jt]>1){const ae=this.clusterProps[Y[nt+Le]];return dt?Object.assign({},ae):ae}const Bt=this.points[Y[nt+Ee]].properties,Wt=this.options.map(Bt);return dt&&Wt===Bt?Object.assign({},Wt):Wt}}function kt(Zt,Y,nt){return{type:"Feature",id:Zt[Y+Ee],properties:Xt(Zt,Y,nt),geometry:{type:"Point",coordinates:[(dt=Zt[Y],360*(dt-.5)),ie(Zt[Y+1])]}};var dt}function Xt(Zt,Y,nt){const dt=Zt[Y+jt],Bt=dt>=1e4?`${Math.round(dt/1e3)}k`:dt>=1e3?Math.round(dt/100)/10+"k":dt,Wt=Zt[Y+Le],ae=Wt===-1?{}:Object.assign({},nt[Wt]);return Object.assign(ae,{cluster:!0,cluster_id:Zt[Y+Ee],point_count:dt,point_count_abbreviated:Bt})}function Ot(Zt){return Zt/360+.5}function Pe(Zt){const Y=Math.sin(Zt*Math.PI/180),nt=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return nt<0?0:nt>1?1:nt}function ie(Zt){const Y=(180-360*Zt)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}var Ne={exports:{}};Ne.exports=function(){function Zt(Dt,Gt,Yt,re){for(var Qt,le=re,pe=Yt-Gt>>1,oe=Yt-Gt,ye=Dt[Gt],ue=Dt[Gt+1],Qe=Dt[Yt],Rn=Dt[Yt+1],Oe=Gt+3;Oe<Yt;Oe+=3){var kn=Y(Dt[Oe],Dt[Oe+1],ye,ue,Qe,Rn);if(kn>le)Qt=Oe,le=kn;else if(kn===le){var Jn=Math.abs(Oe-pe);Jn<oe&&(Qt=Oe,oe=Jn)}}le>re&&(Qt-Gt>3&&Zt(Dt,Gt,Qt,re),Dt[Qt+2]=le,Yt-Qt>3&&Zt(Dt,Qt,Yt,re))}function Y(Dt,Gt,Yt,re,Qt,le){var pe=Qt-Yt,oe=le-re;if(pe!==0||oe!==0){var ye=((Dt-Yt)*pe+(Gt-re)*oe)/(pe*pe+oe*oe);ye>1?(Yt=Qt,re=le):ye>0&&(Yt+=pe*ye,re+=oe*ye)}return(pe=Dt-Yt)*pe+(oe=Gt-re)*oe}function nt(Dt,Gt,Yt,re){var Qt={id:Dt===void 0?null:Dt,type:Gt,geometry:Yt,tags:re,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(le){var pe=le.geometry,oe=le.type;if(oe==="Point"||oe==="MultiPoint"||oe==="LineString")dt(le,pe);else if(oe==="Polygon"||oe==="MultiLineString")for(var ye=0;ye<pe.length;ye++)dt(le,pe[ye]);else if(oe==="MultiPolygon")for(ye=0;ye<pe.length;ye++)for(var ue=0;ue<pe[ye].length;ue++)dt(le,pe[ye][ue])}(Qt),Qt}function dt(Dt,Gt){for(var Yt=0;Yt<Gt.length;Yt+=3)Dt.minX=Math.min(Dt.minX,Gt[Yt]),Dt.minY=Math.min(Dt.minY,Gt[Yt+1]),Dt.maxX=Math.max(Dt.maxX,Gt[Yt]),Dt.maxY=Math.max(Dt.maxY,Gt[Yt+1])}function Bt(Dt,Gt,Yt,re){if(Gt.geometry){var Qt=Gt.geometry.coordinates,le=Gt.geometry.type,pe=Math.pow(Yt.tolerance/((1<<Yt.maxZoom)*Yt.extent),2),oe=[],ye=Gt.id;if(Yt.promoteId?ye=Gt.properties[Yt.promoteId]:Yt.generateId&&(ye=re||0),le==="Point")Wt(Qt,oe);else if(le==="MultiPoint")for(var ue=0;ue<Qt.length;ue++)Wt(Qt[ue],oe);else if(le==="LineString")ae(Qt,oe,pe,!1);else if(le==="MultiLineString"){if(Yt.lineMetrics){for(ue=0;ue<Qt.length;ue++)ae(Qt[ue],oe=[],pe,!1),Dt.push(nt(ye,"LineString",oe,Gt.properties));return}ce(Qt,oe,pe,!1)}else if(le==="Polygon")ce(Qt,oe,pe,!0);else{if(le!=="MultiPolygon"){if(le==="GeometryCollection"){for(ue=0;ue<Gt.geometry.geometries.length;ue++)Bt(Dt,{id:ye,geometry:Gt.geometry.geometries[ue],properties:Gt.properties},Yt,re);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ue=0;ue<Qt.length;ue++){var Qe=[];ce(Qt[ue],Qe,pe,!0),oe.push(Qe)}}Dt.push(nt(ye,le,oe,Gt.properties))}}function Wt(Dt,Gt){Gt.push(qt(Dt[0])),Gt.push(Ce(Dt[1])),Gt.push(0)}function ae(Dt,Gt,Yt,re){for(var Qt,le,pe=0,oe=0;oe<Dt.length;oe++){var ye=qt(Dt[oe][0]),ue=Ce(Dt[oe][1]);Gt.push(ye),Gt.push(ue),Gt.push(0),oe>0&&(pe+=re?(Qt*ue-ye*le)/2:Math.sqrt(Math.pow(ye-Qt,2)+Math.pow(ue-le,2))),Qt=ye,le=ue}var Qe=Gt.length-3;Gt[2]=1,Zt(Gt,0,Qe,Yt),Gt[Qe+2]=1,Gt.size=Math.abs(pe),Gt.start=0,Gt.end=Gt.size}function ce(Dt,Gt,Yt,re){for(var Qt=0;Qt<Dt.length;Qt++){var le=[];ae(Dt[Qt],le,Yt,re),Gt.push(le)}}function qt(Dt){return Dt/360+.5}function Ce(Dt){var Gt=Math.sin(Dt*Math.PI/180),Yt=.5-.25*Math.log((1+Gt)/(1-Gt))/Math.PI;return Yt<0?0:Yt>1?1:Yt}function Re(Dt,Gt,Yt,re,Qt,le,pe,oe){if(re/=Gt,le>=(Yt/=Gt)&&pe<re)return Dt;if(pe<Yt||le>=re)return null;for(var ye=[],ue=0;ue<Dt.length;ue++){var Qe=Dt[ue],Rn=Qe.geometry,Oe=Qe.type,kn=Qt===0?Qe.minX:Qe.minY,Jn=Qt===0?Qe.maxX:Qe.maxY;if(kn>=Yt&&Jn<re)ye.push(Qe);else if(!(Jn<Yt||kn>=re)){var Xn=[];if(Oe==="Point"||Oe==="MultiPoint")be(Rn,Xn,Yt,re,Qt);else if(Oe==="LineString")Me(Rn,Xn,Yt,re,Qt,!1,oe.lineMetrics);else if(Oe==="MultiLineString")er(Rn,Xn,Yt,re,Qt,!1);else if(Oe==="Polygon")er(Rn,Xn,Yt,re,Qt,!0);else if(Oe==="MultiPolygon")for(var tr=0;tr<Rn.length;tr++){var ci=[];er(Rn[tr],ci,Yt,re,Qt,!0),ci.length&&Xn.push(ci)}if(Xn.length){if(oe.lineMetrics&&Oe==="LineString"){for(tr=0;tr<Xn.length;tr++)ye.push(nt(Qe.id,Oe,Xn[tr],Qe.tags));continue}Oe!=="LineString"&&Oe!=="MultiLineString"||(Xn.length===1?(Oe="LineString",Xn=Xn[0]):Oe="MultiLineString"),Oe!=="Point"&&Oe!=="MultiPoint"||(Oe=Xn.length===3?"Point":"MultiPoint"),ye.push(nt(Qe.id,Oe,Xn,Qe.tags))}}}return ye.length?ye:null}function be(Dt,Gt,Yt,re,Qt){for(var le=0;le<Dt.length;le+=3){var pe=Dt[le+Qt];pe>=Yt&&pe<=re&&(Gt.push(Dt[le]),Gt.push(Dt[le+1]),Gt.push(Dt[le+2]))}}function Me(Dt,Gt,Yt,re,Qt,le,pe){for(var oe,ye,ue=zn(Dt),Qe=Qt===0?ke:$e,Rn=Dt.start,Oe=0;Oe<Dt.length-3;Oe+=3){var kn=Dt[Oe],Jn=Dt[Oe+1],Xn=Dt[Oe+2],tr=Dt[Oe+3],ci=Dt[Oe+4],Zi=Qt===0?kn:Jn,Nr=Qt===0?tr:ci,Mi=!1;pe&&(oe=Math.sqrt(Math.pow(kn-tr,2)+Math.pow(Jn-ci,2))),Zi<Yt?Nr>Yt&&(ye=Qe(ue,kn,Jn,tr,ci,Yt),pe&&(ue.start=Rn+oe*ye)):Zi>re?Nr<re&&(ye=Qe(ue,kn,Jn,tr,ci,re),pe&&(ue.start=Rn+oe*ye)):Fn(ue,kn,Jn,Xn),Nr<Yt&&Zi>=Yt&&(ye=Qe(ue,kn,Jn,tr,ci,Yt),Mi=!0),Nr>re&&Zi<=re&&(ye=Qe(ue,kn,Jn,tr,ci,re),Mi=!0),!le&&Mi&&(pe&&(ue.end=Rn+oe*ye),Gt.push(ue),ue=zn(Dt)),pe&&(Rn+=oe)}var ri=Dt.length-3;kn=Dt[ri],Jn=Dt[ri+1],Xn=Dt[ri+2],(Zi=Qt===0?kn:Jn)>=Yt&&Zi<=re&&Fn(ue,kn,Jn,Xn),ri=ue.length-3,le&&ri>=3&&(ue[ri]!==ue[0]||ue[ri+1]!==ue[1])&&Fn(ue,ue[0],ue[1],ue[2]),ue.length&&Gt.push(ue)}function zn(Dt){var Gt=[];return Gt.size=Dt.size,Gt.start=Dt.start,Gt.end=Dt.end,Gt}function er(Dt,Gt,Yt,re,Qt,le){for(var pe=0;pe<Dt.length;pe++)Me(Dt[pe],Gt,Yt,re,Qt,le,!1)}function Fn(Dt,Gt,Yt,re){Dt.push(Gt),Dt.push(Yt),Dt.push(re)}function ke(Dt,Gt,Yt,re,Qt,le){var pe=(le-Gt)/(re-Gt);return Dt.push(le),Dt.push(Yt+(Qt-Yt)*pe),Dt.push(1),pe}function $e(Dt,Gt,Yt,re,Qt,le){var pe=(le-Yt)/(Qt-Yt);return Dt.push(Gt+(re-Gt)*pe),Dt.push(le),Dt.push(1),pe}function Nn(Dt,Gt){for(var Yt=[],re=0;re<Dt.length;re++){var Qt,le=Dt[re],pe=le.type;if(pe==="Point"||pe==="MultiPoint"||pe==="LineString")Qt=ar(le.geometry,Gt);else if(pe==="MultiLineString"||pe==="Polygon"){Qt=[];for(var oe=0;oe<le.geometry.length;oe++)Qt.push(ar(le.geometry[oe],Gt))}else if(pe==="MultiPolygon")for(Qt=[],oe=0;oe<le.geometry.length;oe++){for(var ye=[],ue=0;ue<le.geometry[oe].length;ue++)ye.push(ar(le.geometry[oe][ue],Gt));Qt.push(ye)}Yt.push(nt(le.id,pe,Qt,le.tags))}return Yt}function ar(Dt,Gt){var Yt=[];Yt.size=Dt.size,Dt.start!==void 0&&(Yt.start=Dt.start,Yt.end=Dt.end);for(var re=0;re<Dt.length;re+=3)Yt.push(Dt[re]+Gt,Dt[re+1],Dt[re+2]);return Yt}function Gr(Dt,Gt){if(Dt.transformed)return Dt;var Yt,re,Qt,le=1<<Dt.z,pe=Dt.x,oe=Dt.y;for(Yt=0;Yt<Dt.features.length;Yt++){var ye=Dt.features[Yt],ue=ye.geometry,Qe=ye.type;if(ye.geometry=[],Qe===1)for(re=0;re<ue.length;re+=2)ye.geometry.push(Ci(ue[re],ue[re+1],Gt,le,pe,oe));else for(re=0;re<ue.length;re++){var Rn=[];for(Qt=0;Qt<ue[re].length;Qt+=2)Rn.push(Ci(ue[re][Qt],ue[re][Qt+1],Gt,le,pe,oe));ye.geometry.push(Rn)}}return Dt.transformed=!0,Dt}function Ci(Dt,Gt,Yt,re,Qt,le){return[Math.round(Yt*(Dt*re-Qt)),Math.round(Yt*(Gt*re-le))]}function Kr(Dt,Gt,Yt,re,Qt){for(var le=Gt===Qt.maxZoom?0:Qt.tolerance/((1<<Gt)*Qt.extent),pe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Yt,y:re,z:Gt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},oe=0;oe<Dt.length;oe++){pe.numFeatures++,_i(pe,Dt[oe],le,Qt);var ye=Dt[oe].minX,ue=Dt[oe].minY,Qe=Dt[oe].maxX,Rn=Dt[oe].maxY;ye<pe.minX&&(pe.minX=ye),ue<pe.minY&&(pe.minY=ue),Qe>pe.maxX&&(pe.maxX=Qe),Rn>pe.maxY&&(pe.maxY=Rn)}return pe}function _i(Dt,Gt,Yt,re){var Qt=Gt.geometry,le=Gt.type,pe=[];if(le==="Point"||le==="MultiPoint")for(var oe=0;oe<Qt.length;oe+=3)pe.push(Qt[oe]),pe.push(Qt[oe+1]),Dt.numPoints++,Dt.numSimplified++;else if(le==="LineString")so(pe,Qt,Dt,Yt,!1,!1);else if(le==="MultiLineString"||le==="Polygon")for(oe=0;oe<Qt.length;oe++)so(pe,Qt[oe],Dt,Yt,le==="Polygon",oe===0);else if(le==="MultiPolygon")for(var ye=0;ye<Qt.length;ye++){var ue=Qt[ye];for(oe=0;oe<ue.length;oe++)so(pe,ue[oe],Dt,Yt,!0,oe===0)}if(pe.length){var Qe=Gt.tags||null;if(le==="LineString"&&re.lineMetrics){for(var Rn in Qe={},Gt.tags)Qe[Rn]=Gt.tags[Rn];Qe.mapbox_clip_start=Qt.start/Qt.size,Qe.mapbox_clip_end=Qt.end/Qt.size}var Oe={geometry:pe,type:le==="Polygon"||le==="MultiPolygon"?3:le==="LineString"||le==="MultiLineString"?2:1,tags:Qe};Gt.id!==null&&(Oe.id=Gt.id),Dt.features.push(Oe)}}function so(Dt,Gt,Yt,re,Qt,le){var pe=re*re;if(re>0&&Gt.size<(Qt?pe:re))Yt.numPoints+=Gt.length/3;else{for(var oe=[],ye=0;ye<Gt.length;ye+=3)(re===0||Gt[ye+2]>pe)&&(Yt.numSimplified++,oe.push(Gt[ye]),oe.push(Gt[ye+1])),Yt.numPoints++;Qt&&function(ue,Qe){for(var Rn=0,Oe=0,kn=ue.length,Jn=kn-2;Oe<kn;Jn=Oe,Oe+=2)Rn+=(ue[Oe]-ue[Jn])*(ue[Oe+1]+ue[Jn+1]);if(Rn>0===Qe)for(Oe=0,kn=ue.length;Oe<kn/2;Oe+=2){var Xn=ue[Oe],tr=ue[Oe+1];ue[Oe]=ue[kn-2-Oe],ue[Oe+1]=ue[kn-1-Oe],ue[kn-2-Oe]=Xn,ue[kn-1-Oe]=tr}}(oe,le),Dt.push(oe)}}function is(Dt,Gt){var Yt=(Gt=this.options=function(Qt,le){for(var pe in le)Qt[pe]=le[pe];return Qt}(Object.create(this.options),Gt)).debug;if(Yt&&console.time("preprocess data"),Gt.maxZoom<0||Gt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Gt.promoteId&&Gt.generateId)throw new Error("promoteId and generateId cannot be used together.");var re=function(Qt,le){var pe=[];if(Qt.type==="FeatureCollection")for(var oe=0;oe<Qt.features.length;oe++)Bt(pe,Qt.features[oe],le,oe);else Bt(pe,Qt.type==="Feature"?Qt:{geometry:Qt},le);return pe}(Dt,Gt);this.tiles={},this.tileCoords=[],Yt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Gt.indexMaxZoom,Gt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(re=function(Qt,le){var pe=le.buffer/le.extent,oe=Qt,ye=Re(Qt,1,-1-pe,pe,0,-1,2,le),ue=Re(Qt,1,1-pe,2+pe,0,-1,2,le);return(ye||ue)&&(oe=Re(Qt,1,-pe,1+pe,0,-1,2,le)||[],ye&&(oe=Nn(ye,1).concat(oe)),ue&&(oe=oe.concat(Nn(ue,-1)))),oe}(re,Gt)).length&&this.splitTile(re,0,0,0),Yt&&(re.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Hi(Dt,Gt,Yt){return 32*((1<<Dt)*Yt+Gt)+Dt}return is.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},is.prototype.splitTile=function(Dt,Gt,Yt,re,Qt,le,pe){for(var oe=[Dt,Gt,Yt,re],ye=this.options,ue=ye.debug;oe.length;){re=oe.pop(),Yt=oe.pop(),Gt=oe.pop(),Dt=oe.pop();var Qe=1<<Gt,Rn=Hi(Gt,Yt,re),Oe=this.tiles[Rn];if(!Oe&&(ue>1&&console.time("creation"),Oe=this.tiles[Rn]=Kr(Dt,Gt,Yt,re,ye),this.tileCoords.push({z:Gt,x:Yt,y:re}),ue)){ue>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Gt,Yt,re,Oe.numFeatures,Oe.numPoints,Oe.numSimplified),console.timeEnd("creation"));var kn="z"+Gt;this.stats[kn]=(this.stats[kn]||0)+1,this.total++}if(Oe.source=Dt,Qt){if(Gt===ye.maxZoom||Gt===Qt)continue;var Jn=1<<Qt-Gt;if(Yt!==Math.floor(le/Jn)||re!==Math.floor(pe/Jn))continue}else if(Gt===ye.indexMaxZoom||Oe.numPoints<=ye.indexMaxPoints)continue;if(Oe.source=null,Dt.length!==0){ue>1&&console.time("clipping");var Xn,tr,ci,Zi,Nr,Mi,ri=.5*ye.buffer/ye.extent,zi=.5-ri,No=.5+ri,Xs=1+ri;Xn=tr=ci=Zi=null,Nr=Re(Dt,Qe,Yt-ri,Yt+No,0,Oe.minX,Oe.maxX,ye),Mi=Re(Dt,Qe,Yt+zi,Yt+Xs,0,Oe.minX,Oe.maxX,ye),Dt=null,Nr&&(Xn=Re(Nr,Qe,re-ri,re+No,1,Oe.minY,Oe.maxY,ye),tr=Re(Nr,Qe,re+zi,re+Xs,1,Oe.minY,Oe.maxY,ye),Nr=null),Mi&&(ci=Re(Mi,Qe,re-ri,re+No,1,Oe.minY,Oe.maxY,ye),Zi=Re(Mi,Qe,re+zi,re+Xs,1,Oe.minY,Oe.maxY,ye),Mi=null),ue>1&&console.timeEnd("clipping"),oe.push(Xn||[],Gt+1,2*Yt,2*re),oe.push(tr||[],Gt+1,2*Yt,2*re+1),oe.push(ci||[],Gt+1,2*Yt+1,2*re),oe.push(Zi||[],Gt+1,2*Yt+1,2*re+1)}}},is.prototype.getTile=function(Dt,Gt,Yt){var re=this.options,Qt=re.extent,le=re.debug;if(Dt<0||Dt>24)return null;var pe=1<<Dt,oe=Hi(Dt,Gt=(Gt%pe+pe)%pe,Yt);if(this.tiles[oe])return Gr(this.tiles[oe],Qt);le>1&&console.log("drilling down to z%d-%d-%d",Dt,Gt,Yt);for(var ye,ue=Dt,Qe=Gt,Rn=Yt;!ye&&ue>0;)ue--,Qe=Math.floor(Qe/2),Rn=Math.floor(Rn/2),ye=this.tiles[Hi(ue,Qe,Rn)];return ye&&ye.source?(le>1&&console.log("found parent tile z%d-%d-%d",ue,Qe,Rn),le>1&&console.time("drilling down"),this.splitTile(ye.source,ue,Qe,Rn,Dt,Gt,Yt),le>1&&console.timeEnd("drilling down"),this.tiles[oe]?Gr(this.tiles[oe],Qt):null):null},function(Dt,Gt){return new is(Dt,Gt)}}();var Fe=E.g(Ne.exports);function je(Zt,Y){const nt=Zt.tileID.canonical;if(!this._geoJSONIndex)return Y(null,null);const dt=this._geoJSONIndex.getTile(nt.z,nt.x,nt.y);if(!dt)return Y(null,null);const Bt=new class{constructor(ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=E.E,this.length=ae.length,this._features=ae}feature(ae){return new class{constructor(ce){this._feature=ce,this.extent=E.E,this.type=ce.type,this.properties=ce.tags,"id"in ce&&!isNaN(ce.id)&&(this.id=parseInt(ce.id,10))}loadGeometry(){if(this._feature.type===1){const ce=[];for(const qt of this._feature.geometry)ce.push([new E.P(qt[0],qt[1])]);return ce}{const ce=[];for(const qt of this._feature.geometry){const Ce=[];for(const Re of qt)Ce.push(new E.P(Re[0],Re[1]));ce.push(Ce)}return ce}}toGeoJSON(ce,qt,Ce){return tt.call(this,ce,qt,Ce)}}(this._features[ae])}}(dt.features);let Wt=ne(Bt);Wt.byteOffset===0&&Wt.byteLength===Wt.buffer.byteLength||(Wt=new Uint8Array(Wt)),Y(null,{vectorTile:Bt,rawData:Wt.buffer})}class De extends E.d{constructor(Y,nt,dt,Bt,Wt,ae){super(Y,nt,dt,Bt,je,ae),Wt&&(this.loadGeoJSON=Wt)}loadData(Y,nt){const dt=Y&&Y.request,Bt=dt&&dt.collectResourceTiming;this.loadGeoJSON(Y,(Wt,ae)=>{if(Wt||!ae)return nt(Wt);if(typeof ae!="object")return nt(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));{q(ae,!0);try{if(Y.filter){const qt=E.e(Y.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(qt.result==="error")throw new Error(qt.value.map(Re=>`${Re.key}: ${Re.message}`).join(", "));ae={type:"FeatureCollection",features:ae.features.filter(Re=>qt.value.evaluate({zoom:0},Re))}}this._geoJSONIndex=Y.cluster?new we(function({superclusterOptions:qt,clusterProperties:Ce}){if(!Ce||!qt)return qt;const Re={},be={},Me={accumulated:null,zoom:0},zn={properties:null},er=Object.keys(Ce);for(const Fn of er){const[ke,$e]=Ce[Fn],Nn=E.e($e),ar=E.e(typeof ke=="string"?[ke,["accumulated"],["get",Fn]]:ke);Re[Fn]=Nn.value,be[Fn]=ar.value}return qt.map=Fn=>{zn.properties=Fn;const ke={};for(const $e of er)ke[$e]=Re[$e].evaluate(Me,zn);return ke},qt.reduce=(Fn,ke)=>{zn.properties=ke;for(const $e of er)Me.accumulated=Fn[$e],Fn[$e]=be[$e].evaluate(Me,zn)},qt}(Y)).load(ae.features):Fe(ae,Y.geojsonVtOptions)}catch(qt){return nt(qt)}this.loaded={};const ce={};if(Bt){const qt=E.f(dt);qt&&(ce.resourceTiming={},ce.resourceTiming[Y.source]=JSON.parse(JSON.stringify(qt)))}nt(null,ce)}})}reloadTile(Y,nt){const dt=this.loaded;return dt&&dt[Y.uid]?super.reloadTile(Y,nt):this.loadTile(Y,nt)}loadGeoJSON(Y,nt){if(Y.request)E.h(Y.request,nt);else{if(typeof Y.data!="string")return nt(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));try{return nt(null,JSON.parse(Y.data))}catch{return nt(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Y,nt){try{nt(null,this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId))}catch(dt){nt(dt)}}getClusterChildren(Y,nt){try{nt(null,this._geoJSONIndex.getChildren(Y.clusterId))}catch(dt){nt(dt)}}getClusterLeaves(Y,nt){try{nt(null,this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset))}catch(dt){nt(dt)}}}class Ue{constructor(Y,nt){this.tileID=new E.O(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.tileZoom=Y.tileZoom,this.uid=Y.uid,this.zoom=Y.zoom,this.canonical=Y.tileID.canonical,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=Y.projection,this.brightness=nt}parse(Y,nt,dt,Bt){this.status="parsing";const Wt=new E.O(dt.tileID.overscaledZ,dt.tileID.wrap,dt.tileID.canonical.z,dt.tileID.canonical.x,dt.tileID.canonical.y),ae={},ce=nt.familiesBySource[dt.source],qt=new E.F(Wt,dt.promoteId);return qt.bucketLayerIDs=[],E.l(Y).then(Ce=>{if(!Ce)return Bt(new Error("Could not parse tile"));const Re=E.j(Ce,1/E.t(dt.tileID.canonical)),be=Ce.json.extensionsUsed&&Ce.json.extensionsUsed.includes("MAPBOX_mesh_features"),Me=new E.k(this.zoom,{brightness:this.brightness});for(const zn in ce)for(const er of ce[zn]){const Fn=er[0],ke=Ce.json.extensionsUsed;Fn.recalculate(Me,[]);const $e=new E.T(Re,Wt,ke&&ke.includes("MAPBOX_mesh_features"),this.brightness);be||($e.needsUpload=!0),ae[Fn.fqid]=$e,$e.evaluate(Fn)}this.status="done",Bt(null,{buckets:ae,featureIndex:qt})}).catch(Ce=>Bt(new Error(Ce.message)))}}class An{constructor(Y,nt,dt,Bt,Wt,ae){this.actor=Y,this.layerIndex=nt,this.brightness=ae,this.loading={},this.loaded={}}loadTile(Y,nt){const dt=Y.uid,Bt=this.loading[dt]=new Ue(Y,this.brightness);E.i(Y.request,(Wt,ae)=>{const ce=!this.loading[dt];return delete this.loading[dt],ce||Wt?(Bt.status="done",ce||(this.loaded[dt]=Bt),nt(Wt)):ae&&ae.byteLength!==0?void Bt.parse(ae,this.layerIndex,Y,(qt,Ce)=>{Bt.status="done",this.loaded=this.loaded||{},this.loaded[dt]=Bt,qt||!Ce?nt(qt):nt(null,Ce)}):(Bt.status="done",this.loaded[dt]=Bt,nt())})}reloadTile(Y,nt){const dt=this.loaded,Bt=Y.uid;if(dt&&dt[Bt]){const Wt=dt[Bt];Wt.projection=Y.projection,Wt.brightness=Y.brightness;const ae=(ce,qt)=>{Wt.reloadCallback&&(delete Wt.reloadCallback,this.loadTile(Y,nt)),nt(ce,qt)};Wt.status==="parsing"?Wt.reloadCallback=ae:Wt.status==="done"&&this.loadTile(Y,nt)}}abortTile(Y,nt){const dt=Y.uid;this.loading[dt]&&delete this.loading[dt],nt()}removeTile(Y,nt){const dt=this.loaded,Bt=Y.uid;dt&&dt[Bt]&&delete dt[Bt],nt()}}class vn{constructor(Y){this.self=Y,this.actor=new E.A(Y,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=E.m({name:"mercator"}),this.workerSourceTypes={vector:E.d,geojson:De,"batched-model":An},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(nt,dt)=>{if(this.workerSourceTypes[nt])throw new Error(`Worker source with name "${nt}" already registered.`);this.workerSourceTypes[nt]=dt},this.self.registerRTLTextPlugin=nt=>{if(E.n.isParsed())throw new Error("RTL text plugin already registered.");E.n.applyArabicShaping=nt.applyArabicShaping,E.n.processBidirectionalText=nt.processBidirectionalText,E.n.processStyledBidirectionalText=nt.processStyledBidirectionalText}}clearCaches(Y,nt,dt){delete this.layerIndexes[Y],delete this.availableImages[Y],delete this.workerSources[Y],delete this.demWorkerSources[Y],dt()}checkIfReady(Y,nt,dt){dt()}setReferrer(Y,nt){this.referrer=nt}spriteLoaded(Y,{scope:nt,isLoaded:dt}){if(this.isSpriteLoaded[Y]||(this.isSpriteLoaded[Y]={}),this.isSpriteLoaded[Y][nt]=dt,this.workerSources[Y]&&this.workerSources[Y][nt])for(const Bt in this.workerSources[Y][nt]){const Wt=this.workerSources[Y][nt][Bt];for(const ae in Wt)Wt[ae]instanceof E.d&&(Wt[ae].isSpriteLoaded=dt,Wt[ae].fire(new E.o("isSpriteLoaded")))}}setImages(Y,{scope:nt,images:dt},Bt){if(this.availableImages[Y]||(this.availableImages[Y]={}),this.availableImages[Y][nt]=dt,this.workerSources[Y]&&this.workerSources[Y][nt]){for(const Wt in this.workerSources[Y][nt]){const ae=this.workerSources[Y][nt][Wt];for(const ce in ae)ae[ce].availableImages=dt}Bt()}else Bt()}setProjection(Y,nt){this.projections[Y]=E.m(nt)}setBrightness(Y,nt,dt){this.brightness=nt,dt()}setLayers(Y,nt,dt){this.getLayerIndex(Y,nt.scope).replace(nt.layers,nt.options),dt()}updateLayers(Y,nt,dt){this.getLayerIndex(Y,nt.scope).update(nt.layers,nt.removedIds,nt.options),dt()}loadTile(Y,nt,dt){nt.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,nt.type,nt.source,nt.scope).loadTile(nt,dt)}loadDEMTile(Y,nt,dt){this.getDEMWorkerSource(Y,nt.source,nt.scope).loadTile(nt,dt)}reloadTile(Y,nt,dt){nt.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,nt.type,nt.source,nt.scope).reloadTile(nt,dt)}abortTile(Y,nt,dt){this.getWorkerSource(Y,nt.type,nt.source,nt.scope).abortTile(nt,dt)}removeTile(Y,nt,dt){this.getWorkerSource(Y,nt.type,nt.source,nt.scope).removeTile(nt,dt)}removeSource(Y,nt,dt){if(!(this.workerSources[Y]&&this.workerSources[Y][nt.scope]&&this.workerSources[Y][nt.scope][nt.type]&&this.workerSources[Y][nt.scope][nt.type][nt.source]))return;const Bt=this.workerSources[Y][nt.scope][nt.type][nt.source];delete this.workerSources[Y][nt.scope][nt.type][nt.source],Bt.removeSource!==void 0?Bt.removeSource(nt,dt):dt()}loadWorkerSource(Y,nt,dt){try{this.self.importScripts(nt.url),dt()}catch(Bt){dt(Bt.toString())}}syncRTLPluginState(Y,nt,dt){try{E.n.setState(nt);const Bt=E.n.getPluginURL();if(E.n.isLoaded()&&!E.n.isParsed()&&Bt!=null){this.self.importScripts(Bt);const Wt=E.n.isParsed();dt(Wt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Bt}`),Wt)}}catch(Bt){dt(Bt.toString())}}setDracoUrl(Y,nt){this.dracoUrl=nt}getAvailableImages(Y,nt){this.availableImages[Y]||(this.availableImages[Y]={});let dt=this.availableImages[Y][nt];return dt||(dt=[]),dt}getLayerIndex(Y,nt){this.layerIndexes[Y]||(this.layerIndexes[Y]={});let dt=this.layerIndexes[Y][nt];return dt||(dt=this.layerIndexes[Y][nt]=new B,dt.scope=nt),dt}getWorkerSource(Y,nt,dt,Bt){if(this.workerSources[Y]||(this.workerSources[Y]={}),this.workerSources[Y][Bt]||(this.workerSources[Y][Bt]={}),this.workerSources[Y][Bt][nt]||(this.workerSources[Y][Bt][nt]={}),this.isSpriteLoaded[Y]||(this.isSpriteLoaded[Y]={}),!this.workerSources[Y][Bt][nt][dt]){const Wt={send:(ae,ce,qt,Ce,Re,be)=>{this.actor.send(ae,ce,qt,Y,Re,be)},scheduler:this.actor.scheduler};this.workerSources[Y][Bt][nt][dt]=new this.workerSourceTypes[nt](Wt,this.getLayerIndex(Y,Bt),this.getAvailableImages(Y,Bt),this.isSpriteLoaded[Y][Bt],void 0,this.brightness)}return this.workerSources[Y][Bt][nt][dt]}getDEMWorkerSource(Y,nt,dt){return this.demWorkerSources[Y]||(this.demWorkerSources[Y]={}),this.demWorkerSources[Y][dt]||(this.demWorkerSources[Y][dt]={}),this.demWorkerSources[Y][dt][nt]||(this.demWorkerSources[Y][dt][nt]=new z),this.demWorkerSources[Y][dt][nt]}enforceCacheSizeLimit(Y,nt){E.q(nt)}getWorkerPerformanceMetrics(Y,nt,dt){dt(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new vn(self)),vn}),b(["./shared"],function(E){return E.s});var M=y;return M})})(W5);var wtt=W5.exports;const qc=$p(wtt);var Cd=Stt,Ttt=Object.prototype.hasOwnProperty;function Stt(){for(var i={},s=0;s<arguments.length;s++){var h=arguments[s];for(var f in h)Ttt.call(h,f)&&(i[f]=h[f])}return i}var H5={exports:{}};(function(i,s){(function(){var h={};i.exports=h,h.simpleFilter=function(f,g){return g.filter(function(y){return h.test(f,y)})},h.test=function(f,g){return h.match(f,g)!==null},h.match=function(f,g,y){y=y||{};var b=0,M=[],E=g.length,C=0,L=0,B=y.pre||"",z=y.post||"",H=y.caseSensitive&&g||g.toLowerCase(),U;f=y.caseSensitive&&f||f.toLowerCase();for(var q=0;q<E;q++)U=g[q],H[q]===f[b]?(U=B+U+z,b+=1,L+=1+L):L=0,C+=L,M[M.length]=U;return b===f.length?(C=H===f?1/0:C,{rendered:M.join(""),score:C}):null},h.filter=function(f,g,y){return!g||g.length===0?[]:typeof f!="string"?g:(y=y||{},g.reduce(function(b,M,E,C){var L=M;y.extract&&(L=y.extract(M));var B=h.match(f,L,y);return B!=null&&(b[b.length]={string:B.rendered,score:B.score,index:E,original:M}),b},[]).sort(function(b,M){var E=M.score-b.score;return E||b.index-M.index}))}})()})(H5);var Ett=H5.exports,Fo=function(i){return this.component=i,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,i.el.parentNode.insertBefore(this.wrapper,i.el.nextSibling),this};Fo.prototype.show=function(){this.element.style.display="block"};Fo.prototype.hide=function(){this.element.style.display="none"};Fo.prototype.add=function(i){this.items.push(i)};Fo.prototype.clear=function(){this.items=[],this.active=0};Fo.prototype.isEmpty=function(){return!this.items.length};Fo.prototype.isVisible=function(){return this.element.style.display==="block"};Fo.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var i=0;i<this.items.length;i++)this.drawItem(this.items[i],this.active===i);this.show()};Fo.prototype.drawItem=function(i,s){var h=document.createElement("li"),f=document.createElement("a");s&&(h.className+=" active"),f.innerHTML=i.string,h.appendChild(f),this.element.appendChild(h),h.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),h.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,i)}).bind(this))};Fo.prototype.handleMouseUp=function(i){this.selectingListItem=!1,this.component.value(i.original),this.clear(),this.draw()};Fo.prototype.move=function(i){this.active=i,this.draw()};Fo.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)};Fo.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)};Fo.prototype.drawError=function(i){var s=document.createElement("li");s.innerHTML=i,this.element.appendChild(s),this.show()};var Ctt=Fo,Mtt=Cd,Itt=Ett,Att=Ctt,oo=function(i,s,h){return h=h||{},this.options=Mtt({minLength:2,limit:5,filter:!0,hideOnBlur:!0},h),this.el=i,this.data=s||[],this.list=new Att(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(f){this.handleKeyUp(f.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(f){this.handleKeyDown(f)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(f){this.handlePaste(f)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};oo.prototype.handleKeyUp=function(i){i===40||i===38||i===27||i===13||i===9||this.handleInputChange(this.el.value)};oo.prototype.handleKeyDown=function(i){switch(i.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&i.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}};oo.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()};oo.prototype.handlePaste=function(i){if(i.clipboardData)this.handleInputChange(i.clipboardData.getData("Text"));else{var s=this;setTimeout(function(){s.handleInputChange(i.target.value)},100)}};oo.prototype.handleInputChange=function(i){if(this.query=this.normalize(i),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(s){for(var h=0;h<s.length&&(this.list.add(s[h]),h!==this.options.limit-1);h++);this.list.draw()}).bind(this))};oo.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1};oo.prototype.update=function(i){this.data=i,this.handleKeyUp()};oo.prototype.clear=function(){this.data=[],this.list.clear()};oo.prototype.normalize=function(i){return i=i.toLowerCase(),i};oo.prototype.match=function(i,s){return i.indexOf(s)>-1};oo.prototype.value=function(i){if(this.selected=i,this.el.value=this.getItemValue(i),document.createEvent){var s=document.createEvent("HTMLEvents");s.initEvent("change",!0,!1),this.el.dispatchEvent(s)}else this.el.fireEvent("onchange")};oo.prototype.getCandidates=function(i){var s={pre:"<strong>",post:"</strong>",extract:(function(f){return this.getItemValue(f)}).bind(this)},h;this.options.filter?(h=Itt.filter(this.query,this.data,s),h=h.map((function(f){return{original:f.original,string:this.render(f.original,f.string)}}).bind(this))):h=this.data.map((function(f){var g=this.render(f);return{original:f,string:g}}).bind(this)),i(h)};oo.prototype.getItemValue=function(i){return i};oo.prototype.render=function(i,s){if(s)return s;for(var h=i.original?this.getItemValue(i.original):this.getItemValue(i),f=this.normalize(h),g=f.lastIndexOf(this.query);g>-1;){var y=g+this.query.length;h=h.slice(0,g)+"<strong>"+h.slice(g,y)+"</strong>"+h.slice(y),g=f.slice(0,g).lastIndexOf(this.query)}return h};oo.prototype.renderError=function(i){this.list.drawError(i)};var Ptt=oo,Z5=Ptt,Rtt=Z5;typeof window<"u"&&(window.Suggestions=Z5);var ktt="Expected a function",z3=NaN,Ott="[object Symbol]",Ltt=/^\s+|\s+$/g,ztt=/^[-+]0x[0-9a-f]+$/i,Dtt=/^0b[01]+$/i,Btt=/^0o[0-7]+$/i,Ftt=parseInt,Ntt=typeof ki=="object"&&ki&&ki.Object===Object&&ki,jtt=typeof self=="object"&&self&&self.Object===Object&&self,Utt=Ntt||jtt||Function("return this")(),$tt=Object.prototype,Vtt=$tt.toString,Gtt=Math.max,Wtt=Math.min,yw=function(){return Utt.Date.now()};function qtt(i,s,h){var f,g,y,b,M,E,C=0,L=!1,B=!1,z=!0;if(typeof i!="function")throw new TypeError(ktt);s=D3(s)||0,BT(h)&&(L=!!h.leading,B="maxWait"in h,y=B?Gtt(D3(h.maxWait)||0,s):y,z="trailing"in h?!!h.trailing:z);function H(ct){var st=f,yt=g;return f=g=void 0,C=ct,b=i.apply(yt,st),b}function U(ct){return C=ct,M=setTimeout(V,s),L?H(ct):b}function q(ct){var st=ct-E,yt=ct-C,ut=s-st;return B?Wtt(ut,y-yt):ut}function tt(ct){var st=ct-E,yt=ct-C;return E===void 0||st>=s||st<0||B&&yt>=y}function V(){var ct=yw();if(tt(ct))return F(ct);M=setTimeout(V,q(ct))}function F(ct){return M=void 0,z&&f?H(ct):(f=g=void 0,b)}function D(){M!==void 0&&clearTimeout(M),C=0,f=E=g=M=void 0}function $(){return M===void 0?b:F(yw())}function J(){var ct=yw(),st=tt(ct);if(f=arguments,g=this,E=ct,st){if(M===void 0)return U(E);if(B)return M=setTimeout(V,s),H(E)}return M===void 0&&(M=setTimeout(V,s)),b}return J.cancel=D,J.flush=$,J}function BT(i){var s=typeof i;return!!i&&(s=="object"||s=="function")}function Htt(i){return!!i&&typeof i=="object"}function Ztt(i){return typeof i=="symbol"||Htt(i)&&Vtt.call(i)==Ott}function D3(i){if(typeof i=="number")return i;if(Ztt(i))return z3;if(BT(i)){var s=typeof i.valueOf=="function"?i.valueOf():i;i=BT(s)?s+"":s}if(typeof i!="string")return i===0?i:+i;i=i.replace(Ltt,"");var h=Dtt.test(i);return h||Btt.test(i)?Ftt(i.slice(2),h?2:8):ztt.test(i)?z3:+i}var Xtt=qtt,wE={exports:{}},Jh=typeof Reflect=="object"?Reflect:null,B3=Jh&&typeof Jh.apply=="function"?Jh.apply:function(s,h,f){return Function.prototype.apply.call(s,h,f)},ey;Jh&&typeof Jh.ownKeys=="function"?ey=Jh.ownKeys:Object.getOwnPropertySymbols?ey=function(s){return Object.getOwnPropertyNames(s).concat(Object.getOwnPropertySymbols(s))}:ey=function(s){return Object.getOwnPropertyNames(s)};function Ktt(i){console&&console.warn&&console.warn(i)}var X5=Number.isNaN||function(s){return s!==s};function Ir(){Ir.init.call(this)}wE.exports=Ir;wE.exports.once=tet;Ir.EventEmitter=Ir;Ir.prototype._events=void 0;Ir.prototype._eventsCount=0;Ir.prototype._maxListeners=void 0;var F3=10;function ov(i){if(typeof i!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i)}Object.defineProperty(Ir,"defaultMaxListeners",{enumerable:!0,get:function(){return F3},set:function(i){if(typeof i!="number"||i<0||X5(i))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+i+".");F3=i}});Ir.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ir.prototype.setMaxListeners=function(s){if(typeof s!="number"||s<0||X5(s))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+s+".");return this._maxListeners=s,this};function K5(i){return i._maxListeners===void 0?Ir.defaultMaxListeners:i._maxListeners}Ir.prototype.getMaxListeners=function(){return K5(this)};Ir.prototype.emit=function(s){for(var h=[],f=1;f<arguments.length;f++)h.push(arguments[f]);var g=s==="error",y=this._events;if(y!==void 0)g=g&&y.error===void 0;else if(!g)return!1;if(g){var b;if(h.length>0&&(b=h[0]),b instanceof Error)throw b;var M=new Error("Unhandled error."+(b?" ("+b.message+")":""));throw M.context=b,M}var E=y[s];if(E===void 0)return!1;if(typeof E=="function")B3(E,this,h);else for(var C=E.length,L=eB(E,C),f=0;f<C;++f)B3(L[f],this,h);return!0};function Y5(i,s,h,f){var g,y,b;if(ov(h),y=i._events,y===void 0?(y=i._events=Object.create(null),i._eventsCount=0):(y.newListener!==void 0&&(i.emit("newListener",s,h.listener?h.listener:h),y=i._events),b=y[s]),b===void 0)b=y[s]=h,++i._eventsCount;else if(typeof b=="function"?b=y[s]=f?[h,b]:[b,h]:f?b.unshift(h):b.push(h),g=K5(i),g>0&&b.length>g&&!b.warned){b.warned=!0;var M=new Error("Possible EventEmitter memory leak detected. "+b.length+" "+String(s)+" listeners added. Use emitter.setMaxListeners() to increase limit");M.name="MaxListenersExceededWarning",M.emitter=i,M.type=s,M.count=b.length,Ktt(M)}return i}Ir.prototype.addListener=function(s,h){return Y5(this,s,h,!1)};Ir.prototype.on=Ir.prototype.addListener;Ir.prototype.prependListener=function(s,h){return Y5(this,s,h,!0)};function Ytt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Q5(i,s,h){var f={fired:!1,wrapFn:void 0,target:i,type:s,listener:h},g=Ytt.bind(f);return g.listener=h,f.wrapFn=g,g}Ir.prototype.once=function(s,h){return ov(h),this.on(s,Q5(this,s,h)),this};Ir.prototype.prependOnceListener=function(s,h){return ov(h),this.prependListener(s,Q5(this,s,h)),this};Ir.prototype.removeListener=function(s,h){var f,g,y,b,M;if(ov(h),g=this._events,g===void 0)return this;if(f=g[s],f===void 0)return this;if(f===h||f.listener===h)--this._eventsCount===0?this._events=Object.create(null):(delete g[s],g.removeListener&&this.emit("removeListener",s,f.listener||h));else if(typeof f!="function"){for(y=-1,b=f.length-1;b>=0;b--)if(f[b]===h||f[b].listener===h){M=f[b].listener,y=b;break}if(y<0)return this;y===0?f.shift():Qtt(f,y),f.length===1&&(g[s]=f[0]),g.removeListener!==void 0&&this.emit("removeListener",s,M||h)}return this};Ir.prototype.off=Ir.prototype.removeListener;Ir.prototype.removeAllListeners=function(s){var h,f,g;if(f=this._events,f===void 0)return this;if(f.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):f[s]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete f[s]),this;if(arguments.length===0){var y=Object.keys(f),b;for(g=0;g<y.length;++g)b=y[g],b!=="removeListener"&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(h=f[s],typeof h=="function")this.removeListener(s,h);else if(h!==void 0)for(g=h.length-1;g>=0;g--)this.removeListener(s,h[g]);return this};function J5(i,s,h){var f=i._events;if(f===void 0)return[];var g=f[s];return g===void 0?[]:typeof g=="function"?h?[g.listener||g]:[g]:h?Jtt(g):eB(g,g.length)}Ir.prototype.listeners=function(s){return J5(this,s,!0)};Ir.prototype.rawListeners=function(s){return J5(this,s,!1)};Ir.listenerCount=function(i,s){return typeof i.listenerCount=="function"?i.listenerCount(s):tB.call(i,s)};Ir.prototype.listenerCount=tB;function tB(i){var s=this._events;if(s!==void 0){var h=s[i];if(typeof h=="function")return 1;if(h!==void 0)return h.length}return 0}Ir.prototype.eventNames=function(){return this._eventsCount>0?ey(this._events):[]};function eB(i,s){for(var h=new Array(s),f=0;f<s;++f)h[f]=i[f];return h}function Qtt(i,s){for(;s+1<i.length;s++)i[s]=i[s+1];i.pop()}function Jtt(i){for(var s=new Array(i.length),h=0;h<s.length;++h)s[h]=i[h].listener||i[h];return s}function tet(i,s){return new Promise(function(h,f){function g(b){i.removeListener(s,y),f(b)}function y(){typeof i.removeListener=="function"&&i.removeListener("error",g),h([].slice.call(arguments))}nB(i,s,y,{once:!0}),s!=="error"&&eet(i,g,{once:!0})})}function eet(i,s,h){typeof i.on=="function"&&nB(i,"error",s,h)}function nB(i,s,h,f){if(typeof i.on=="function")f.once?i.once(s,h):i.on(s,h);else if(typeof i.addEventListener=="function")i.addEventListener(s,function g(y){f.once&&i.removeEventListener(s,g),h(y)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof i)}var net=wE.exports,ret={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}};function iet(i){var s=i.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return s?{key:s[1],value:s[2]}:null}function oet(i){var s=i.match(/<?([^>]*)>(.*)/);if(!s)return null;var h=s[1],f=s[2].split(";"),g=null,y=f.reduce(function(b,M){var E=iet(M);return E?E.key==="rel"?(g||(g=E.value),b):(b[E.key]=E.value,b):b},{});return g?{url:h,rel:g,params:y}:null}function set(i){return i?i.split(/,\s*</).reduce(function(s,h){var f=oet(h);if(!f)return s;var g=f.rel.split(/\s+/);return g.forEach(function(y){s[y]||(s[y]={url:f.url,params:f.params})}),s},{}):{}}var aet=set,cet=aet;function TE(i,s){this.request=i,this.headers=s.headers,this.rawBody=s.body,this.statusCode=s.statusCode;try{this.body=JSON.parse(s.body||"{}")}catch{this.body=s.body}this.links=cet(this.headers.link)}TE.prototype.hasNextPage=function(){return!!this.links.next};TE.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null};var uet=TE,sv={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"},N3=sv;function het(i){var s=i.type||N3.ERROR_HTTP,h;if(i.body)try{h=JSON.parse(i.body)}catch{h=i.body}else h=null;var f=i.message||null;f||(typeof h=="string"?f=h:h&&typeof h.message=="string"?f=h.message:s===N3.ERROR_REQUEST_ABORTED&&(f="Request aborted")),this.message=f,this.type=s,this.statusCode=i.statusCode||null,this.request=i.request,this.body=h}var det=het;function fet(i){var s=i.indexOf(":"),h=i.substring(0,s).trim().toLowerCase(),f=i.substring(s+1).trim();return{name:h,value:f}}function pet(i){var s={};return i&&i.trim().split(/[\r|\n]+/).forEach(function(h){var f=fet(h);s[f.name]=f.value}),s}var met=pet,get=uet,j3=det,vw=sv,_et=met,Ny={};function yet(i){var s=Ny[i.id];s&&(s.abort(),delete Ny[i.id])}function vet(i,s){return new get(i,{body:s.response,headers:_et(s.getAllResponseHeaders()),statusCode:s.status})}function U3(i){var s=i.total,h=i.loaded,f=100*h/s;return{total:s,transferred:h,percent:f}}function rB(i,s){return new Promise(function(h,f){s.onprogress=function(b){i.emitter.emit(vw.EVENT_PROGRESS_DOWNLOAD,U3(b))};var g=i.file;g&&(s.upload.onprogress=function(b){i.emitter.emit(vw.EVENT_PROGRESS_UPLOAD,U3(b))}),s.onerror=function(b){f(b)},s.onabort=function(){var b=new j3({request:i,type:vw.ERROR_REQUEST_ABORTED});f(b)},s.onload=function(){if(delete Ny[i.id],s.status<200||s.status>=400){var b=new j3({request:i,body:s.response,statusCode:s.status});f(b);return}h(s)};var y=i.body;typeof y=="string"?s.send(y):y?s.send(JSON.stringify(y)):g?s.send(g):s.send(),Ny[i.id]=s}).then(function(h){return vet(i,h)})}function iB(i,s){var h=i.url(s),f=new window.XMLHttpRequest;return f.open(i.method,h),Object.keys(i.headers).forEach(function(g){f.setRequestHeader(g,i.headers[g])}),f}function xet(i){return Promise.resolve().then(function(){var s=iB(i,i.client.accessToken);return rB(i,s)})}var bet={browserAbort:yet,sendRequestXhr:rB,browserSend:xet,createRequestXhr:iB},jy={exports:{}};/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */jy.exports;(function(i,s){(function(h){var f=s,g=i&&i.exports==f&&i,y=typeof ki=="object"&&ki;(y.global===y||y.window===y)&&(h=y);var b=function(U){this.message=U};b.prototype=new Error,b.prototype.name="InvalidCharacterError";var M=function(U){throw new b(U)},E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",C=/[\t\n\f\r ]/g,L=function(U){U=String(U).replace(C,"");var q=U.length;q%4==0&&(U=U.replace(/==?$/,""),q=U.length),(q%4==1||/[^+a-zA-Z0-9/]/.test(U))&&M("Invalid character: the string to be decoded is not correctly encoded.");for(var tt=0,V,F,D="",$=-1;++$<q;)F=E.indexOf(U.charAt($)),V=tt%4?V*64+F:F,tt++%4&&(D+=String.fromCharCode(255&V>>(-2*tt&6)));return D},B=function(U){U=String(U),/[^\0-\xFF]/.test(U)&&M("The string to be encoded contains characters outside of the Latin1 range.");for(var q=U.length%3,tt="",V=-1,F,D,$,J,ct=U.length-q;++V<ct;)F=U.charCodeAt(V)<<16,D=U.charCodeAt(++V)<<8,$=U.charCodeAt(++V),J=F+D+$,tt+=E.charAt(J>>18&63)+E.charAt(J>>12&63)+E.charAt(J>>6&63)+E.charAt(J&63);return q==2?(F=U.charCodeAt(V)<<8,D=U.charCodeAt(++V),J=F+D,tt+=E.charAt(J>>10)+E.charAt(J>>4&63)+E.charAt(J<<2&63)+"="):q==1&&(J=U.charCodeAt(V),tt+=E.charAt(J>>2)+E.charAt(J<<4&63)+"=="),tt},z={encode:B,decode:L,version:"0.1.0"};if(f&&!f.nodeType)if(g)g.exports=z;else for(var H in z)z.hasOwnProperty(H)&&(f[H]=z[H]);else h.base64=z})(ki)})(jy,jy.exports);var wet=jy.exports,Tet=wet,xw={};function Eet(i){if(xw[i])return xw[i];var s=i.split("."),h=s[0],f=s[1];if(!f)throw new Error("Invalid token");var g=Cet(f),y={usage:h,user:g.u};return Hc(g,"a")&&(y.authorization=g.a),Hc(g,"exp")&&(y.expires=g.exp*1e3),Hc(g,"iat")&&(y.created=g.iat*1e3),Hc(g,"scopes")&&(y.scopes=g.scopes),Hc(g,"client")&&(y.client=g.client),Hc(g,"ll")&&(y.lastLogin=g.ll),Hc(g,"iu")&&(y.impersonator=g.iu),xw[i]=y,y}function Cet(i){try{return JSON.parse(Tet.decode(i))}catch{throw new Error("Invalid token")}}function Hc(i,s){return Object.prototype.hasOwnProperty.call(i,s)}var oB=Eet,sB={exports:{}};(function(i){var s=Object.prototype.hasOwnProperty,h="~";function f(){}Object.create&&(f.prototype=Object.create(null),new f().__proto__||(h=!1));function g(E,C,L){this.fn=E,this.context=C,this.once=L||!1}function y(E,C,L,B,z){if(typeof L!="function")throw new TypeError("The listener must be a function");var H=new g(L,B||E,z),U=h?h+C:C;return E._events[U]?E._events[U].fn?E._events[U]=[E._events[U],H]:E._events[U].push(H):(E._events[U]=H,E._eventsCount++),E}function b(E,C){--E._eventsCount===0?E._events=new f:delete E._events[C]}function M(){this._events=new f,this._eventsCount=0}M.prototype.eventNames=function(){var C=[],L,B;if(this._eventsCount===0)return C;for(B in L=this._events)s.call(L,B)&&C.push(h?B.slice(1):B);return Object.getOwnPropertySymbols?C.concat(Object.getOwnPropertySymbols(L)):C},M.prototype.listeners=function(C){var L=h?h+C:C,B=this._events[L];if(!B)return[];if(B.fn)return[B.fn];for(var z=0,H=B.length,U=new Array(H);z<H;z++)U[z]=B[z].fn;return U},M.prototype.listenerCount=function(C){var L=h?h+C:C,B=this._events[L];return B?B.fn?1:B.length:0},M.prototype.emit=function(C,L,B,z,H,U){var q=h?h+C:C;if(!this._events[q])return!1;var tt=this._events[q],V=arguments.length,F,D;if(tt.fn){switch(tt.once&&this.removeListener(C,tt.fn,void 0,!0),V){case 1:return tt.fn.call(tt.context),!0;case 2:return tt.fn.call(tt.context,L),!0;case 3:return tt.fn.call(tt.context,L,B),!0;case 4:return tt.fn.call(tt.context,L,B,z),!0;case 5:return tt.fn.call(tt.context,L,B,z,H),!0;case 6:return tt.fn.call(tt.context,L,B,z,H,U),!0}for(D=1,F=new Array(V-1);D<V;D++)F[D-1]=arguments[D];tt.fn.apply(tt.context,F)}else{var $=tt.length,J;for(D=0;D<$;D++)switch(tt[D].once&&this.removeListener(C,tt[D].fn,void 0,!0),V){case 1:tt[D].fn.call(tt[D].context);break;case 2:tt[D].fn.call(tt[D].context,L);break;case 3:tt[D].fn.call(tt[D].context,L,B);break;case 4:tt[D].fn.call(tt[D].context,L,B,z);break;default:if(!F)for(J=1,F=new Array(V-1);J<V;J++)F[J-1]=arguments[J];tt[D].fn.apply(tt[D].context,F)}}return!0},M.prototype.on=function(C,L,B){return y(this,C,L,B,!1)},M.prototype.once=function(C,L,B){return y(this,C,L,B,!0)},M.prototype.removeListener=function(C,L,B,z){var H=h?h+C:C;if(!this._events[H])return this;if(!L)return b(this,H),this;var U=this._events[H];if(U.fn)U.fn===L&&(!z||U.once)&&(!B||U.context===B)&&b(this,H);else{for(var q=0,tt=[],V=U.length;q<V;q++)(U[q].fn!==L||z&&!U[q].once||B&&U[q].context!==B)&&tt.push(U[q]);tt.length?this._events[H]=tt.length===1?tt[0]:tt:b(this,H)}return this},M.prototype.removeAllListeners=function(C){var L;return C?(L=h?h+C:C,this._events[L]&&b(this,L)):(this._events=new f,this._eventsCount=0),this},M.prototype.off=M.prototype.removeListener,M.prototype.addListener=M.prototype.on,M.prefixed=h,M.EventEmitter=M,i.exports=M})(sB);var Met=sB.exports;function Iet(i){return i.map(encodeURIComponent).join(",")}function aB(i){return Array.isArray(i)?Iet(i):encodeURIComponent(String(i))}function lB(i,s,h){if(h===!1||h===null)return i;var f=/\?/.test(i)?"&":"?",g=encodeURIComponent(s);return h!==void 0&&h!==""&&h!==!0&&(g+="="+aB(h)),""+i+f+g}function Aet(i,s){if(!s)return i;var h=i;return Object.keys(s).forEach(function(f){var g=s[f];g!==void 0&&(Array.isArray(g)&&(g=g.filter(function(y){return y!=null}).join(",")),h=lB(h,f,g))}),h}function Pet(i,s){if(!s||i.slice(0,4)==="http")return i;var h=i[0]==="/"?"":"/";return""+s.replace(/\/$/,"")+h+i}function Ret(i,s){return s?i.replace(/\/:([a-zA-Z0-9]+)/g,function(h,f){var g=s[f];if(g===void 0)throw new Error("Unspecified route parameter "+f);var y=aB(g);return"/"+y}):i}var ket={appendQueryObject:Aet,appendQueryParam:lB,prependOrigin:Pet,interpolateRouteParams:Ret},Oet=oB,SE=Cd,Let=Met,R_=ket,$3=sv,zet=1;function uc(i,s){if(!i)throw new Error("MapiRequest requires a client");if(!s||!s.path||!s.method)throw new Error("MapiRequest requires an options object with path and method properties");var h={};s.body&&(h["content-type"]="application/json");var f=SE(h,s.headers),g=Object.keys(f).reduce(function(y,b){return y[b.toLowerCase()]=f[b],y},{});this.id=zet++,this._options=s,this.emitter=new Let,this.client=i,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=s.path,this.method=s.method,this.origin=s.origin||i.origin,this.query=s.query||{},this.params=s.params||{},this.body=s.body||null,this.file=s.file||null,this.encoding=s.encoding||"utf8",this.sendFileAs=s.sendFileAs||null,this.headers=g}uc.prototype.url=function(s){var h=R_.prependOrigin(this.path,this.origin);h=R_.appendQueryObject(h,this.query);var f=this.params,g=s??this.client.accessToken;if(g){h=R_.appendQueryParam(h,"access_token",g);var y=Oet(g).user;f=SE({ownerId:y},f)}return h=R_.interpolateRouteParams(h,f),h};uc.prototype.send=function(){var s=this;if(s.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return s.sent=!0,s.client.sendRequest(s).then(function(h){return s.response=h,s.emitter.emit($3.EVENT_RESPONSE,h),h},function(h){throw s.error=h,s.emitter.emit($3.EVENT_ERROR,h),h})};uc.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),!(this.response||this.error||this.aborted)&&(this.aborted=!0,this.client.abortRequest(this))};uc.prototype.eachPage=function(s){var h=this;function f(b){function M(){delete h._nextPageRequest;var E=b.nextPage();E&&(h._nextPageRequest=E,y(E))}s(null,b,M)}function g(b){s(b,null,function(){})}function y(b){b.send().then(f,g)}y(this)};uc.prototype.clone=function(){return this._extend()};uc.prototype._extend=function(s){var h=SE(this._options,s);return new uc(this.client,h)};var Det=uc,Bet=oB,Fet=Det,Net=sv;function cB(i){if(!i||!i.accessToken)throw new Error("Cannot create a client without an access token");Bet(i.accessToken),this.accessToken=i.accessToken,this.origin=i.origin||Net.API_ORIGIN}cB.prototype.createRequest=function(s){return new Fet(this,s)};var uB=cB,hB=bet,dB=uB;function gd(i){dB.call(this,i)}gd.prototype=Object.create(dB.prototype);gd.prototype.constructor=gd;gd.prototype.sendRequest=hB.browserSend;gd.prototype.abortRequest=hB.browserAbort;function jet(i){return new gd(i)}var fB=jet,Uet=fB,$et=Uet,Vet=Object.prototype.toString,Get=function(i){var s;return Vet.call(i)==="[object Object]"&&(s=Object.getPrototypeOf(i),s===null||s===Object.getPrototypeOf({}))},Wet=Get,qet=Cd,pB="value",bw=`
  `,Fr={};Fr.assert=function(i,s){return s=s||{},function(h){var f=hc(i,h);if(f){var g=EE(f,s);throw s.apiName&&(g=s.apiName+": "+g),new Error(g)}}};Fr.shape=function(s){var h=Ket(s);return function(g){var y=hc(Fr.plainObject,g);if(y)return y;for(var b,M,E=[],C=0;C<h.length;C++)b=h[C].key,M=h[C].value,y=hc(M,g[b]),y&&E.push([b].concat(y));return E.length<2?E[0]:function(L){E=E.map(function(H){var U=H[0],q=EE(H,L).split(`
`).join(bw);return"- "+U+": "+q});var B=L.path.join("."),z=B===pB?"":" of "+B;return"The following properties"+z+" have invalid values:"+bw+E.join(bw)}}};Fr.strictShape=function(s){var h=Fr.shape(s);return function(g){var y=h(g);if(y)return y;var b=Object.keys(g).reduce(function(M,E){return s[E]===void 0&&M.push(E),M},[]);if(b.length!==0)return function(){return"The following keys are invalid: "+b.join(", ")}}};Fr.arrayOf=function(s){return mB(s)};Fr.tuple=function(){var s=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return mB(s)};function mB(i){var s=Array.isArray(i),h=function(f){return s?i[f]:i};return function(g){var y=hc(Fr.plainArray,g);if(y)return y;if(s&&g.length!==i.length)return"an array with "+i.length+" items";for(var b=0;b<g.length;b++)if(y=hc(h(b),g[b]),y)return[b].concat(y)}}Fr.required=function(s){function h(f){return f==null?function(g){return gB(g,_B(g.path)?"cannot be undefined/null.":"is required.")}:s.apply(this,arguments)}return h.__required=!0,h};Fr.oneOfType=function(){var s=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(f){var g=s.map(function(y){return hc(y,f)}).filter(Boolean);if(g.length===s.length)return g.every(function(y){return y.length===1&&typeof y[0]=="string"})?Het(g.map(function(y){return y[0]})):g.reduce(function(y,b){return b.length>y.length?b:y})}};Fr.equal=function(s){return function(f){if(f!==s)return JSON.stringify(s)}};Fr.oneOf=function(){var s=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),h=s.map(function(f){return Fr.equal(f)});return Fr.oneOfType.apply(this,h)};Fr.range=function(s){var h=s[0],f=s[1];return function(y){var b=hc(Fr.number,y);if(b||y<h||y>f)return"number between "+h+" & "+f+" (inclusive)"}};Fr.any=function(){};Fr.boolean=function(s){if(typeof s!="boolean")return"boolean"};Fr.number=function(s){if(typeof s!="number")return"number"};Fr.plainArray=function(s){if(!Array.isArray(s))return"array"};Fr.plainObject=function(s){if(!Wet(s))return"object"};Fr.string=function(s){if(typeof s!="string")return"string"};Fr.func=function(s){if(typeof s!="function")return"function"};function hc(i,s){if(!(s==null&&!i.hasOwnProperty("__required"))){var h=i(s);if(h)return Array.isArray(h)?h:[h]}}function EE(i,s){var h=i.length,f=i[h-1],g=i.slice(0,h-1);return g.length===0&&(g=[pB]),s=qet(s,{path:g}),typeof f=="function"?f(s):gB(s,Zet(f))}function Het(i){return i.length<2?i[0]:i.length===2?i.join(" or "):i.slice(0,-1).join(", ")+", or "+i.slice(-1)}function Zet(i){return"must be "+Xet(i)+"."}function Xet(i){return/^an? /.test(i)?i:/^[aeiou]/i.test(i)?"an "+i:/^[a-z]/i.test(i)?"a "+i:i}function gB(i,s){var h=_B(i.path),f=i.path.join(".")+" "+s,g=h?"Item at position ":"";return g+f}function _B(i){return typeof i[i.length-1]=="number"||typeof i[0]=="number"}function Ket(i){return Object.keys(i||{}).map(function(s){return{key:s,value:i[s]}})}Fr.validate=hc;Fr.processMessage=EE;var Yet=Fr,Qet=Cd,td=Yet;function Jet(i){if(typeof window<"u")return i instanceof ki.Blob||i instanceof ki.ArrayBuffer?void 0:"Blob or ArrayBuffer";if(!(typeof i=="string"||i.pipe!==void 0))return"Filename or Readable stream"}function tnt(i,s){return td.assert(td.strictShape(i),s)}function ent(i){var s="date";if(typeof i=="boolean")return s;try{var h=new Date(i);if(h.getTime&&isNaN(h.getTime()))return s}catch{return s}}function nnt(i){return td.tuple(td.number,td.number)(i)}var rnt=Qet(td,{file:Jet,date:ent,coordinates:nnt,assertShape:tnt});function int(i,s){var h=function(f,g){return s.indexOf(f)!==-1&&g!==void 0};return typeof s=="function"&&(h=s),Object.keys(i).filter(function(f){return h(f,i[f])}).reduce(function(f,g){return f[g]=i[g],f},{})}var ont=int;function snt(i,s){return Object.keys(i).reduce(function(h,f){return h[f]=s(f,i[f]),h},{})}var ant=snt,lnt=ant;function cnt(i){return lnt(i,function(s,h){return typeof h=="boolean"?JSON.stringify(h):h})}var unt=cnt,hnt=uB,dnt=fB;function fnt(i){return function(s){var h;hnt.prototype.isPrototypeOf(s)?h=s:h=dnt(s);var f=Object.create(i);return f.client=h,f}}var pnt=fnt,yB=Cd,Qn=rnt,Uy=ont,vB=unt,mnt=pnt,CE={},xB=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];CE.forwardGeocode=function(i){Qn.assertShape({query:Qn.required(Qn.string),mode:Qn.oneOf("mapbox.places","mapbox.places-permanent"),countries:Qn.arrayOf(Qn.string),proximity:Qn.oneOf(Qn.coordinates,"ip"),types:Qn.arrayOf(Qn.oneOf(xB)),autocomplete:Qn.boolean,bbox:Qn.arrayOf(Qn.number),limit:Qn.number,language:Qn.arrayOf(Qn.string),routing:Qn.boolean,fuzzyMatch:Qn.boolean,worldview:Qn.string})(i),i.mode=i.mode||"mapbox.places";var s=vB(yB({country:i.countries},Uy(i,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:Uy(i,["mode","query"]),query:s})};CE.reverseGeocode=function(i){Qn.assertShape({query:Qn.required(Qn.coordinates),mode:Qn.oneOf("mapbox.places","mapbox.places-permanent"),countries:Qn.arrayOf(Qn.string),types:Qn.arrayOf(Qn.oneOf(xB)),bbox:Qn.arrayOf(Qn.number),limit:Qn.number,language:Qn.arrayOf(Qn.string),reverseMode:Qn.oneOf("distance","score"),routing:Qn.boolean,worldview:Qn.string})(i),i.mode=i.mode||"mapbox.places";var s=vB(yB({country:i.countries},Uy(i,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:Uy(i,["mode","query"]),query:s})};var gnt=mnt(CE);let _nt="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",bB=i=>crypto.getRandomValues(new Uint8Array(i)),wB=(i,s,h)=>{let f=(2<<Math.log(i.length-1)/Math.LN2)-1,g=-~(1.6*f*s/i.length);return(y=s)=>{let b="";for(;;){let M=h(g),E=g;for(;E--;)if(b+=i[M[E]&f]||"",b.length===y)return b}}},ynt=(i,s=21)=>wB(i,s,bB),vnt=(i=21)=>crypto.getRandomValues(new Uint8Array(i)).reduce((s,h)=>(h&=63,h<36?s+=h.toString(36):h<62?s+=(h-26).toString(36).toUpperCase():h>62?s+="-":s+="_",s),"");const xnt=Object.freeze(Object.defineProperty({__proto__:null,customAlphabet:ynt,customRandom:wB,nanoid:vnt,random:bB,urlAlphabet:_nt},Symbol.toStringTag,{value:"Module"})),bnt=q3(xnt);var wnt=bnt.nanoid;function TB(i){this.origin=i.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=i.accessToken,this.version="0.2.0",this.sessionID=this.generateSessionID(),this.userAgent=this.getUserAgent(),this.options=i,this.send=this.send.bind(this),this.countries=i.countries?i.countries.split(","):null,this.types=i.types?i.types.split(","):null,this.bbox=i.bbox?i.bbox:null,this.language=i.language?i.language.split(","):null,this.limit=i.limit?+i.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(i),this.eventQueue=new Array,this.flushInterval=i.flushInterval||1e3,this.maxQueueSize=i.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}TB.prototype={select:function(i,s){var h=this.getSelectedIndex(i,s),f=this.getEventPayload("search.select",s);if(f.resultIndex=h,f.resultPlaceName=i.place_name,f.resultId=i.id,!(h===this.lastSentIndex&&f.queryString===this.lastSentInput||h==-1)&&(this.lastSentIndex=h,this.lastSentInput=f.queryString,!!f.queryString))return this.push(f)},start:function(i){var s=this.getEventPayload("search.start",i);if(s.queryString)return this.push(s)},keyevent:function(i,s){if(i.key&&!(i.metaKey||[9,27,37,39,13,38,40].indexOf(i.keyCode)!==-1)){var h=this.getEventPayload("search.keystroke",s);if(h.lastAction=i.key,!!h.queryString)return this.push(h)}},send:function(i,s){if(!this.enableEventLogging)return s?s():void 0;var h=this.getRequestOptions(i);this.request(h,(function(f){if(f)return this.handleError(f,s);if(s)return s()}).bind(this))},getRequestOptions:function(i){Array.isArray(i)||(i=[i]);var s={method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(i)};return s},getEventPayload:function(i,s){var h;s.options.proximity?typeof s.options.proximity=="object"?h=[s.options.proximity.longitude,s.options.proximity.latitude]:s.options.proximity==="ip"?h=[999,999]:h=s.options.proximity:h=null;var f=s._map?s._map.getZoom():void 0,g={event:i,created:+new Date,sessionIdentifier:this.sessionID,country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:s.options.autocomplete,fuzzyMatch:s.options.fuzzyMatch,proximity:h,limit:s.options.limit,routing:s.options.routing,worldview:s.options.worldview,mapZoom:f,keyboardLocale:this.locale};return i==="search.select"?g.queryString=s.inputString:i!="search.select"&&s._inputEl?g.queryString=s._inputEl.value:g.queryString=s.inputString,g},request:function(i,s){var h=new XMLHttpRequest;h.onreadystatechange=function(){if(this.readyState==4)return this.status==204?s(null):s(this.statusText)},h.open(i.method,i.host+"/"+i.path,!0);for(var f in i.headers){var g=i.headers[f];h.setRequestHeader(f,g)}h.send(i.body)},handleError:function(i,s){if(s)return s(i)},generateSessionID:function(){return wnt()},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(i,s){if(s._typeahead){var h=s._typeahead.data,f=i.id,g=h.map(function(b){return b.id}),y=g.indexOf(f);return y}},shouldEnableLogging:function(i){return!(i.enableEventLogging===!1||i.origin&&i.origin!=="https://api.mapbox.com"||i.localGeocoder||i.filter)},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(i,s){this.eventQueue.push(i),(this.eventQueue.length>=this.maxQueueSize||s)&&this.flush()},remove:function(){this.flush()}};var Tnt=TB,Snt={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"",ja:"",lv:"Meklt",pt:"Procurar",sr:"",zh:"",cs:"Vyhledvn",hu:"Keress",ka:"",nb:"Ske",sk:"Vyhadvanie",th:"",fi:"Hae",is:"Leita",ko:"",pl:"Szukaj",sl:"Iskanje",fa:"",ru:""},Ent={placeholder:Snt},SB={exports:{}};(function(i){(function(s,h,f){i.exports?i.exports=f():s[h]=f()})(ki,"subtag",function(){var s="",h=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function f(E){return E.match(h)||[]}function g(E){return f(E).filter(function(C,L){return C&&L})}function y(E){return E=f(E),{language:E[1]||s,extlang:E[2]||s,script:E[3]||s,region:E[4]||s}}function b(E,C,L){Object.defineProperty(E,C,{value:L,enumerable:!0})}function M(E,C,L){function B(z){return f(z)[E]||s}b(B,"pattern",C),b(y,L,B)}return M(1,/^[a-zA-Z]{2,3}$/,"language"),M(2,/^[a-zA-Z]{3}$/,"extlang"),M(3,/^[a-zA-Z]{4}$/,"script"),M(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),b(y,"split",g),y})})(SB);var Cnt=SB.exports;function EB(){}EB.prototype={isSupport:function(){return!!window.navigator.geolocation},getCurrentPosition:function(){const i={enableHighAccuracy:!0};return new Promise(function(s,h){window.navigator.geolocation.getCurrentPosition(s,h,i)})}};var Mnt=EB;function Int(i,s){const h=CB(i),f=["address","street","place","country"];var g;if(typeof s=="function")return s(h);const y=f.indexOf(s);return y===-1?g=f:g=f.slice(y),g.reduce(function(b,M){return h[M]?(b!==""&&(b=b+", "),b+h[M]):b},"")}function CB(i){const s=i.address||"",h=i.text||"",f=i.place_name||"",y={address:f.split(",")[0],houseNumber:s,street:h,placeName:f};return i.context.forEach(function(b){const M=b.id.split(".")[0];y[M]=b.text}),y}const Ant=/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/;var Pnt={transformFeatureToGeolocationText:Int,getAddressInfo:CB,REVERSE_GEOCODE_COORD_RGX:Ant},Rnt=Rtt,knt=Xtt,Qc=Cd,Ont=net.EventEmitter,V3=ret,ww=$et,Tw=gnt,Lnt=Tnt,znt=Ent,Dnt=Cnt,Bnt=Mnt,G3=Pnt;const Ul={FORWARD:0,LOCAL:1,REVERSE:2};function Fnt(){var i=document.createElement("div");return i.className="mapboxgl-ctrl-geocoder--powered-by",i.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',i}function MB(i){this._eventEmitter=new Ont,this.options=Qc({},this.options,i),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new Bnt}MB.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(i){return i.place_name},render:function(i){var s=i.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+s[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+s.splice(1,s.length).join(",")+"</div></div>"}},addTo:function(i){function s(h,f){if(!document.body.contains(f))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const g=h.onAdd();f.appendChild(g)}if(i._controlContainer)i.addControl(this);else if(i instanceof HTMLElement)s(this,i);else if(typeof i=="string"){const h=document.querySelectorAll(i);if(h.length===0)throw new Error("Element ",i,"not found.");if(h.length>1)throw new Error("Geocoder can only be added to a single html element");s(this,h[0])}else throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(i){if(i&&typeof i!="string"&&(this._map=i),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=Tw(ww({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new Lnt(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var s=this.container=document.createElement("div");s.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var h=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",knt(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",(function(C){this.eventManager.keyevent(C,this)}).bind(this));var f=document.createElement("div");f.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var g=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(g),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),f.appendChild(this._clearEl),f.appendChild(this._loadingEl),s.appendChild(h),s.appendChild(this._inputEl),s.appendChild(f),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var y=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(y),f.appendChild(this._geolocateEl),this._showGeolocateButton()}var b=this._typeahead=new Rnt(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),b.getItemValue=this.options.getItemValue;var M=b.list.draw,E=this._footerNode=Fnt();return b.list.draw=function(){M.call(this),E.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),E.addEventListener("mouseup",(function(){this.selectingListItem=!1}).bind(this)),this.element.appendChild(E)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),s},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then((function(i){this._hideLoadingIcon();const s={geometry:{type:"Point",coordinates:[i.coords.longitude,i.coords.latitude]}};this._handleMarker(s),this._fly(s),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(s),this._showClearButton(),this.fresh=!1;const h={limit:1,language:[this.options.language],query:s.geometry.coordinates,types:["address"]};if(this.options.localGeocoderOnly){const f=s.geometry.coordinates[0]+","+s.geometry.coordinates[1];this._setInputValue(f),this._eventEmitter.emit("result",{result:s})}else this.geocoderService.reverseGeocode(h).send().then((function(f){const g=f.body.features[0];if(g){const y=G3.transformFeatureToGeolocationText(g,this.options.addressAccuracy);this._setInputValue(y),g.user_coordinates=s.geometry.coordinates,this._eventEmitter.emit("result",{result:g})}else this._eventEmitter.emit("result",{result:{user_coordinates:s.geometry.coordinates}})}).bind(this))}).bind(this)).catch((function(i){i.code===1?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}).bind(this))},createIcon:function(i,s){var h=document.createElementNS("http://www.w3.org/2000/svg","svg");return h.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+i),h.setAttribute("viewBox","0 0 18 18"),h.setAttribute("xml:space","preserve"),h.setAttribute("width",18),h.setAttribute("height",18),h.innerHTML=s,h},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(i){this._inputEl.value=i,setTimeout((function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}).bind(this),1)},_onPaste:function(i){var s=(i.clipboardData||window.clipboardData).getData("text");s.length>=this.options.minLength&&this._geocode(s)},_onKeyDown:function(i){var s=27,h=9;if(i.keyCode===s&&this.options.clearAndBlurOnEsc)return this._clear(i),this._inputEl.blur();var f=i.target&&i.target.shadowRoot?i.target.shadowRoot.activeElement:i.target,g=f?f.value:"";if(!g)return this.fresh=!0,i.keyCode!==h&&this.clear(i),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),!(i.metaKey||[h,s,37,39,13,38,40].indexOf(i.keyCode)!==-1)&&f.value.length>=this.options.minLength&&this._geocode(f.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(i){this.options.clearOnBlur&&this._clearOnBlur(i),this.options.collapsed&&this._collapse()},_onChange:function(){var i=this._typeahead.selected;i&&JSON.stringify(i)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(i),this.options.marker&&this._mapboxgl&&this._handleMarker(i),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(i),this._eventEmitter.emit("result",{result:i}),this.eventManager.select(i,this))},_fly:function(i){var s;if(i.properties&&V3[i.properties.short_code])s=Qc({},this.options.flyTo),this._map&&this._map.fitBounds(V3[i.properties.short_code].bbox,s);else if(i.bbox){var h=i.bbox;s=Qc({},this.options.flyTo),this._map&&this._map.fitBounds([[h[0],h[1]],[h[2],h[3]]],s)}else{var f={zoom:this.options.zoom};s=Qc({},f,this.options.flyTo),i.center?s.center=i.center:i.geometry&&i.geometry.type&&i.geometry.type==="Point"&&i.geometry.coordinates&&(s.center=i.geometry.coordinates),this._map&&this._map.flyTo(s)}},_requestType:function(i,s){var h;return i.localGeocoderOnly?h=Ul.LOCAL:i.reverseGeocode&&G3.REVERSE_GEOCODE_COORD_RGX.test(s)?h=Ul.REVERSE:h=Ul.FORWARD,h},_setupConfig:function(i,s){const h=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"],f=/[\s,]+/;var g=this,y=h.reduce(function(M,E){if(g.options[E]===void 0||g.options[E]===null)return M;["countries","types","language"].indexOf(E)>-1?M[E]=g.options[E].split(f):M[E]=g.options[E];const C=typeof g.options[E].longitude=="number"&&typeof g.options[E].latitude=="number";if(E==="proximity"&&C){const L=g.options[E].longitude,B=g.options[E].latitude;M[E]=[L,B]}return M},{});switch(i){case Ul.REVERSE:{var b=s.split(f).map(function(M){return parseFloat(M,10)});g.options.flipCoordinates||b.reverse(),y.types&&y.types[0],y=Qc(y,{query:b,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach(function(M){M in y&&delete y[M]})}break;case Ul.FORWARD:{const M=s.trim();/^(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)?$/.test(M)&&(s=s.replace(/,/g," ")),y=Qc(y,{query:s})}break}return y},_geocode:function(i){this.inputString=i,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:i});const s=this._requestType(this.options,i),h=this._setupConfig(s,i);var f;switch(s){case Ul.LOCAL:f=Promise.resolve();break;case Ul.FORWARD:f=this.geocoderService.forwardGeocode(h).send();break;case Ul.REVERSE:f=this.geocoderService.reverseGeocode(h).send();break}var g=this.options.localGeocoder?this.options.localGeocoder(i)||[]:[],y=[],b=null;return f.catch((function(M){b=M}).bind(this)).then((function(M){this._hideLoadingIcon();var E={};return M?M.statusCode=="200"&&(E=M.body,E.request=M.request,E.headers=M.headers):E={type:"FeatureCollection",features:[]},E.config=h,this.fresh&&(this.eventManager.start(this),this.fresh=!1),E.features=E.features?g.concat(E.features):g,this.options.externalGeocoder?(y=this.options.externalGeocoder(i,E.features)||Promise.resolve([]),y.then(function(C){return E.features=E.features?C.concat(E.features):C,E},function(){return E})):E}).bind(this)).then((function(M){if(b)throw b;this.options.filter&&M.features.length&&(M.features=M.features.filter(this.options.filter)),M.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",M),this._typeahead.update(M.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",M))}).bind(this)).catch((function(M){this._hideLoadingIcon(),this._hideAttribution(),g.length&&this.options.localGeocoder||y.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(g)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:g}),this._eventEmitter.emit("error",{error:M})}).bind(this)),f},_clear:function(i){i&&i.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(i){this._clear(i),this._inputEl.focus()},_clearOnBlur:function(i){var s=this;i.relatedTarget&&s._clear(i)},_onQueryResult:function(i){var s=i.body;if(s.features.length){var h=s.features[0];this._typeahead.selected=h,this._inputEl.value=h.place_name,this._onChange()}},_updateProximity:function(){if(!(!this._map||!this.options.trackProximity))if(this._map.getZoom()>9){var i=this._map.getCenter().wrap();this.setProximity({longitude:i.lng,latitude:i.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(i){return this._geocode(i).then(this._onQueryResult),this},_renderError:function(){var i="<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(i)},_renderLocationError:function(){var i="<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>";this._renderMessage(i)},_renderNoResults:function(){var i="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>";this._renderMessage(i)},_renderUserDeniedGeolocationError:function(){var i="<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>";this._renderMessage(i)},_renderMessage:function(i){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(i)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var i=this.options.language.split(",")[0],s=Dnt.language(i),h=znt.placeholder[s];if(h)return h}return"Search"},setInput:function(i,s){return s===void 0&&(s=!1),this._inputEl.value=i,this._typeahead.selected=null,this._typeahead.clear(),i.length>=this.options.minLength&&(s?this._geocode(i):this._onChange()),this},setProximity:function(i,s=!0){return this.options.proximity=i,s&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(i){return i&&typeof i=="function"&&(this._typeahead.render=i),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(i){var s=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=i||this.options.language||s,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(i){return this.options.zoom=i,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(i){return this.options.flyTo=i,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(i){return this.options.placeholder=i||this._getPlaceholderText(),this._inputEl.placeholder=this.options.placeholder,this._inputEl.setAttribute("aria-label",this.options.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(i){return this.options.bbox=i,this},getCountries:function(){return this.options.countries},setCountries:function(i){return this.options.countries=i,this},getTypes:function(){return this.options.types},setTypes:function(i){return this.options.types=i,this},getMinLength:function(){return this.options.minLength},setMinLength:function(i){return this.options.minLength=i,this._typeahead&&(this._typeahead.options.minLength=i),this},getLimit:function(){return this.options.limit},setLimit:function(i){return this.options.limit=i,this._typeahead&&(this._typeahead.options.limit=i),this},getFilter:function(){return this.options.filter},setFilter:function(i){return this.options.filter=i,this},setOrigin:function(i){return this.options.origin=i,this.geocoderService=Tw(ww({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(i){return this.options.accessToken=i,this.geocoderService=Tw(ww({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(i){return this.options.autocomplete=i,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(i){return this.options.fuzzyMatch=i,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(i){return this.options.routing=i,this},getRouting:function(){return this.options.routing},setWorldview:function(i){return this.options.worldview=i,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(i){if(this._map){this._removeMarker();var s={color:"#4668F2"},h=Qc({},s,this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(h),i.center?this.mapMarker.setLngLat(i.center).addTo(this._map):i.geometry&&i.geometry.type&&i.geometry.type==="Point"&&i.geometry.coordinates&&this.mapMarker.setLngLat(i.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(i,s){return this._eventEmitter.on(i,s),this},off:function(i,s){return this._eventEmitter.removeListener(i,s),this.eventManager.remove(),this}};var Nnt=MB;const jnt=$p(Nnt);function k_(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var IB={exports:{}};(function(i,s){(function(h){i.exports=h()})(function(){return function(){function h(f,g,y){function b(C,L){if(!g[C]){if(!f[C]){var B=typeof k_=="function"&&k_;if(!L&&B)return B(C,!0);if(M)return M(C,!0);var z=new Error("Cannot find module '"+C+"'");throw z.code="MODULE_NOT_FOUND",z}var H=g[C]={exports:{}};f[C][0].call(H.exports,function(U){var q=f[C][1][U];return b(q||U)},H,H.exports,h,f,g,y)}return g[C].exports}for(var M=typeof k_=="function"&&k_,E=0;E<y.length;E++)b(y[E]);return b}return h}()({1:[function(h,f,g){var y=h("./toPropertyKey.js");function b(M,E,C){return E=y(E),E in M?Object.defineProperty(M,E,{value:C,enumerable:!0,configurable:!0,writable:!0}):M[E]=C,M}f.exports=b,f.exports.__esModule=!0,f.exports.default=f.exports},{"./toPropertyKey.js":4}],2:[function(h,f,g){var y=h("./defineProperty.js");function b(E,C){var L=Object.keys(E);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(E);C&&(B=B.filter(function(z){return Object.getOwnPropertyDescriptor(E,z).enumerable})),L.push.apply(L,B)}return L}function M(E){for(var C=1;C<arguments.length;C++){var L=arguments[C]!=null?arguments[C]:{};C%2?b(Object(L),!0).forEach(function(B){y(E,B,L[B])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(L)):b(Object(L)).forEach(function(B){Object.defineProperty(E,B,Object.getOwnPropertyDescriptor(L,B))})}return E}f.exports=M,f.exports.__esModule=!0,f.exports.default=f.exports},{"./defineProperty.js":1}],3:[function(h,f,g){var y=h("./typeof.js").default;function b(M,E){if(y(M)!=="object"||M===null)return M;var C=M[Symbol.toPrimitive];if(C!==void 0){var L=C.call(M,E||"default");if(y(L)!=="object")return L;throw new TypeError("@@toPrimitive must return a primitive value.")}return(E==="string"?String:Number)(M)}f.exports=b,f.exports.__esModule=!0,f.exports.default=f.exports},{"./typeof.js":5}],4:[function(h,f,g){var y=h("./typeof.js").default,b=h("./toPrimitive.js");function M(E){var C=b(E,"string");return y(C)==="symbol"?C:String(C)}f.exports=M,f.exports.__esModule=!0,f.exports.default=f.exports},{"./toPrimitive.js":3,"./typeof.js":5}],5:[function(h,f,g){function y(b){"@babel/helpers - typeof";return f.exports=y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},f.exports.__esModule=!0,f.exports.default=f.exports,y(b)}f.exports=y,f.exports.__esModule=!0,f.exports.default=f.exports},{}],6:[function(h,f,g){var y={};function b(C){return Math.floor(Math.abs(C)+.5)*(C>=0?1:-1)}function M(C,L,B){C=b(C*B),L=b(L*B);var z=C-L;z<<=1,C-L<0&&(z=~z);for(var H="";z>=32;)H+=String.fromCharCode((32|z&31)+63),z>>=5;return H+=String.fromCharCode(z+63),H}y.decode=function(C,L){for(var B=0,z=0,H=0,U=[],q=0,tt=0,V=null,F,D,$=Math.pow(10,Number.isInteger(L)?L:5);B<C.length;){V=null,q=0,tt=0;do V=C.charCodeAt(B++)-63,tt|=(V&31)<<q,q+=5;while(V>=32);F=tt&1?~(tt>>1):tt>>1,q=tt=0;do V=C.charCodeAt(B++)-63,tt|=(V&31)<<q,q+=5;while(V>=32);D=tt&1?~(tt>>1):tt>>1,z+=F,H+=D,U.push([z/$,H/$])}return U},y.encode=function(C,L){if(!C.length)return"";for(var B=Math.pow(10,Number.isInteger(L)?L:5),z=M(C[0][0],0,B)+M(C[0][1],0,B),H=1;H<C.length;H++){var U=C[H],q=C[H-1];z+=M(U[0],q[0],B),z+=M(U[1],q[1],B)}return z};function E(C){for(var L=[],B=0;B<C.length;B++){var z=C[B].slice();L.push([z[1],z[0]])}return L}y.fromGeoJSON=function(C,L){if(C&&C.type==="Feature"&&(C=C.geometry),!C||C.type!=="LineString")throw new Error("Input must be a GeoJSON LineString");return y.encode(E(C.coordinates),L)},y.toGeoJSON=function(C,L){var B=y.decode(C,L);return{type:"LineString",coordinates:E(B)}},typeof f=="object"&&f.exports&&(f.exports=y)},{}],7:[function(h,f,g){var y=typeof Reflect=="object"?Reflect:null,b=y&&typeof y.apply=="function"?y.apply:function(N,et,Mt){return Function.prototype.apply.call(N,et,Mt)},M;y&&typeof y.ownKeys=="function"?M=y.ownKeys:Object.getOwnPropertySymbols?M=function(N){return Object.getOwnPropertyNames(N).concat(Object.getOwnPropertySymbols(N))}:M=function(N){return Object.getOwnPropertyNames(N)};function E(ut){console&&console.warn&&console.warn(ut)}var C=Number.isNaN||function(N){return N!==N};function L(){L.init.call(this)}f.exports=L,f.exports.once=ct,L.EventEmitter=L,L.prototype._events=void 0,L.prototype._eventsCount=0,L.prototype._maxListeners=void 0;var B=10;function z(ut){if(typeof ut!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ut)}Object.defineProperty(L,"defaultMaxListeners",{enumerable:!0,get:function(){return B},set:function(ut){if(typeof ut!="number"||ut<0||C(ut))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ut+".");B=ut}}),L.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},L.prototype.setMaxListeners=function(N){if(typeof N!="number"||N<0||C(N))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+N+".");return this._maxListeners=N,this};function H(ut){return ut._maxListeners===void 0?L.defaultMaxListeners:ut._maxListeners}L.prototype.getMaxListeners=function(){return H(this)},L.prototype.emit=function(N){for(var et=[],Mt=1;Mt<arguments.length;Mt++)et.push(arguments[Mt]);var Lt=N==="error",it=this._events;if(it!==void 0)Lt=Lt&&it.error===void 0;else if(!Lt)return!1;if(Lt){var Tt;if(et.length>0&&(Tt=et[0]),Tt instanceof Error)throw Tt;var Vt=new Error("Unhandled error."+(Tt?" ("+Tt.message+")":""));throw Vt.context=Tt,Vt}var ne=it[N];if(ne===void 0)return!1;if(typeof ne=="function")b(ne,this,et);else for(var Et=ne.length,$t=D(ne,Et),Mt=0;Mt<Et;++Mt)b($t[Mt],this,et);return!0};function U(ut,N,et,Mt){var Lt,it,Tt;if(z(et),it=ut._events,it===void 0?(it=ut._events=Object.create(null),ut._eventsCount=0):(it.newListener!==void 0&&(ut.emit("newListener",N,et.listener?et.listener:et),it=ut._events),Tt=it[N]),Tt===void 0)Tt=it[N]=et,++ut._eventsCount;else if(typeof Tt=="function"?Tt=it[N]=Mt?[et,Tt]:[Tt,et]:Mt?Tt.unshift(et):Tt.push(et),Lt=H(ut),Lt>0&&Tt.length>Lt&&!Tt.warned){Tt.warned=!0;var Vt=new Error("Possible EventEmitter memory leak detected. "+Tt.length+" "+String(N)+" listeners added. Use emitter.setMaxListeners() to increase limit");Vt.name="MaxListenersExceededWarning",Vt.emitter=ut,Vt.type=N,Vt.count=Tt.length,E(Vt)}return ut}L.prototype.addListener=function(N,et){return U(this,N,et,!1)},L.prototype.on=L.prototype.addListener,L.prototype.prependListener=function(N,et){return U(this,N,et,!0)};function q(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function tt(ut,N,et){var Mt={fired:!1,wrapFn:void 0,target:ut,type:N,listener:et},Lt=q.bind(Mt);return Lt.listener=et,Mt.wrapFn=Lt,Lt}L.prototype.once=function(N,et){return z(et),this.on(N,tt(this,N,et)),this},L.prototype.prependOnceListener=function(N,et){return z(et),this.prependListener(N,tt(this,N,et)),this},L.prototype.removeListener=function(N,et){var Mt,Lt,it,Tt,Vt;if(z(et),Lt=this._events,Lt===void 0)return this;if(Mt=Lt[N],Mt===void 0)return this;if(Mt===et||Mt.listener===et)--this._eventsCount===0?this._events=Object.create(null):(delete Lt[N],Lt.removeListener&&this.emit("removeListener",N,Mt.listener||et));else if(typeof Mt!="function"){for(it=-1,Tt=Mt.length-1;Tt>=0;Tt--)if(Mt[Tt]===et||Mt[Tt].listener===et){Vt=Mt[Tt].listener,it=Tt;break}if(it<0)return this;it===0?Mt.shift():$(Mt,it),Mt.length===1&&(Lt[N]=Mt[0]),Lt.removeListener!==void 0&&this.emit("removeListener",N,Vt||et)}return this},L.prototype.off=L.prototype.removeListener,L.prototype.removeAllListeners=function(N){var et,Mt,Lt;if(Mt=this._events,Mt===void 0)return this;if(Mt.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Mt[N]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete Mt[N]),this;if(arguments.length===0){var it=Object.keys(Mt),Tt;for(Lt=0;Lt<it.length;++Lt)Tt=it[Lt],Tt!=="removeListener"&&this.removeAllListeners(Tt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(et=Mt[N],typeof et=="function")this.removeListener(N,et);else if(et!==void 0)for(Lt=et.length-1;Lt>=0;Lt--)this.removeListener(N,et[Lt]);return this};function V(ut,N,et){var Mt=ut._events;if(Mt===void 0)return[];var Lt=Mt[N];return Lt===void 0?[]:typeof Lt=="function"?et?[Lt.listener||Lt]:[Lt]:et?J(Lt):D(Lt,Lt.length)}L.prototype.listeners=function(N){return V(this,N,!0)},L.prototype.rawListeners=function(N){return V(this,N,!1)},L.listenerCount=function(ut,N){return typeof ut.listenerCount=="function"?ut.listenerCount(N):F.call(ut,N)},L.prototype.listenerCount=F;function F(ut){var N=this._events;if(N!==void 0){var et=N[ut];if(typeof et=="function")return 1;if(et!==void 0)return et.length}return 0}L.prototype.eventNames=function(){return this._eventsCount>0?M(this._events):[]};function D(ut,N){for(var et=new Array(N),Mt=0;Mt<N;++Mt)et[Mt]=ut[Mt];return et}function $(ut,N){for(;N+1<ut.length;N++)ut[N]=ut[N+1];ut.pop()}function J(ut){for(var N=new Array(ut.length),et=0;et<N.length;++et)N[et]=ut[et].listener||ut[et];return N}function ct(ut,N){return new Promise(function(et,Mt){function Lt(Tt){ut.removeListener(N,it),Mt(Tt)}function it(){typeof ut.removeListener=="function"&&ut.removeListener("error",Lt),et([].slice.call(arguments))}yt(ut,N,it,{once:!0}),N!=="error"&&st(ut,Lt,{once:!0})})}function st(ut,N,et){typeof ut.on=="function"&&yt(ut,"error",N,et)}function yt(ut,N,et,Mt){if(typeof ut.on=="function")Mt.once?ut.once(N,et):ut.on(N,et);else if(typeof ut.addEventListener=="function")ut.addEventListener(N,function Lt(it){Mt.once&&ut.removeEventListener(N,Lt),et(it)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ut)}},{}],8:[function(h,f,g){(function(){var y=this,b={};typeof g<"u"?f.exports=b:y.fuzzy=b,b.simpleFilter=function(M,E){return E.filter(function(C){return b.test(M,C)})},b.test=function(M,E){return b.match(M,E)!==null},b.match=function(M,E,C){C=C||{};var L=0,B=[],z=E.length,H=0,U=0,q=C.pre||"",tt=C.post||"",V=C.caseSensitive&&E||E.toLowerCase(),F;M=C.caseSensitive&&M||M.toLowerCase();for(var D=0;D<z;D++)F=E[D],V[D]===M[L]?(F=q+F+tt,L+=1,U+=1+U):U=0,H+=U,B[B.length]=F;return L===M.length?(H=V===M?1/0:H,{rendered:B.join(""),score:H}):null},b.filter=function(M,E,C){return!E||E.length===0?[]:typeof M!="string"?E:(C=C||{},E.reduce(function(L,B,z,H){var U=B;C.extract&&(U=C.extract(B));var q=b.match(M,U,C);return q!=null&&(L[L.length]={string:q.rendered,score:q.score,index:z,original:B}),L},[]).sort(function(L,B){var z=B.score-L.score;return z||L.index-B.index}))}})()},{}],9:[function(h,f,g){var y=/<%=([\s\S]+?)%>/g;f.exports=y},{}],10:[function(h,f,g){(function(y){(function(){var b="Expected a function",M=NaN,E="[object Symbol]",C=/^\s+|\s+$/g,L=/^[-+]0x[0-9a-f]+$/i,B=/^0b[01]+$/i,z=/^0o[0-7]+$/i,H=parseInt,U=typeof y=="object"&&y&&y.Object===Object&&y,q=typeof self=="object"&&self&&self.Object===Object&&self,tt=U||q||Function("return this")(),V=Object.prototype,F=V.toString,D=Math.max,$=Math.min,J=function(){return tt.Date.now()};function ct(et,Mt,Lt){var it,Tt,Vt,ne,Et,$t,ee=0,Ee=!1,jt=!1,Le=!0;if(typeof et!="function")throw new TypeError(b);Mt=N(Mt)||0,st(Lt)&&(Ee=!!Lt.leading,jt="maxWait"in Lt,Vt=jt?D(N(Lt.maxWait)||0,Mt):Vt,Le="trailing"in Lt?!!Lt.trailing:Le);function we(De){var Ue=it,An=Tt;return it=Tt=void 0,ee=De,ne=et.apply(An,Ue),ne}function kt(De){return ee=De,Et=setTimeout(Pe,Mt),Ee?we(De):ne}function Xt(De){var Ue=De-$t,An=De-ee,vn=Mt-Ue;return jt?$(vn,Vt-An):vn}function Ot(De){var Ue=De-$t,An=De-ee;return $t===void 0||Ue>=Mt||Ue<0||jt&&An>=Vt}function Pe(){var De=J();if(Ot(De))return ie(De);Et=setTimeout(Pe,Xt(De))}function ie(De){return Et=void 0,Le&&it?we(De):(it=Tt=void 0,ne)}function Ne(){Et!==void 0&&clearTimeout(Et),ee=0,it=$t=Tt=Et=void 0}function Fe(){return Et===void 0?ne:ie(J())}function je(){var De=J(),Ue=Ot(De);if(it=arguments,Tt=this,$t=De,Ue){if(Et===void 0)return kt($t);if(jt)return Et=setTimeout(Pe,Mt),we($t)}return Et===void 0&&(Et=setTimeout(Pe,Mt)),ne}return je.cancel=Ne,je.flush=Fe,je}function st(et){var Mt=typeof et;return!!et&&(Mt=="object"||Mt=="function")}function yt(et){return!!et&&typeof et=="object"}function ut(et){return typeof et=="symbol"||yt(et)&&F.call(et)==E}function N(et){if(typeof et=="number")return et;if(ut(et))return M;if(st(et)){var Mt=typeof et.valueOf=="function"?et.valueOf():et;et=st(Mt)?Mt+"":Mt}if(typeof et!="string")return et===0?et:+et;et=et.replace(C,"");var Lt=B.test(et);return Lt||z.test(et)?H(et.slice(2),Lt?2:8):L.test(et)?M:+et}f.exports=ct}).call(this)}).call(this,typeof ki<"u"?ki:typeof self<"u"?self:typeof window<"u"?window:{})},{}],11:[function(h,f,g){(function(y){(function(){var b=200,M="__lodash_hash_undefined__",E=1,C=2,L=9007199254740991,B="[object Arguments]",z="[object Array]",H="[object AsyncFunction]",U="[object Boolean]",q="[object Date]",tt="[object Error]",V="[object Function]",F="[object GeneratorFunction]",D="[object Map]",$="[object Number]",J="[object Null]",ct="[object Object]",st="[object Promise]",yt="[object Proxy]",ut="[object RegExp]",N="[object Set]",et="[object String]",Mt="[object Symbol]",Lt="[object Undefined]",it="[object WeakMap]",Tt="[object ArrayBuffer]",Vt="[object DataView]",ne="[object Float32Array]",Et="[object Float64Array]",$t="[object Int8Array]",ee="[object Int16Array]",Ee="[object Int32Array]",jt="[object Uint8Array]",Le="[object Uint8ClampedArray]",we="[object Uint16Array]",kt="[object Uint32Array]",Xt=/[\\^$.*+?()[\]{}|]/g,Ot=/^\[object .+?Constructor\]$/,Pe=/^(?:0|[1-9]\d*)$/,ie={};ie[ne]=ie[Et]=ie[$t]=ie[ee]=ie[Ee]=ie[jt]=ie[Le]=ie[we]=ie[kt]=!0,ie[B]=ie[z]=ie[Tt]=ie[U]=ie[Vt]=ie[q]=ie[tt]=ie[V]=ie[D]=ie[$]=ie[ct]=ie[ut]=ie[N]=ie[et]=ie[it]=!1;var Ne=typeof y=="object"&&y&&y.Object===Object&&y,Fe=typeof self=="object"&&self&&self.Object===Object&&self,je=Ne||Fe||Function("return this")(),De=typeof g=="object"&&g&&!g.nodeType&&g,Ue=De&&typeof f=="object"&&f&&!f.nodeType&&f,An=Ue&&Ue.exports===De,vn=An&&Ne.process,Zt=function(){try{return vn&&vn.binding&&vn.binding("util")}catch{}}(),Y=Zt&&Zt.isTypedArray;function nt(mt,bt){for(var fe=-1,Ge=mt==null?0:mt.length,lr=0,an=[];++fe<Ge;){var Tn=mt[fe];bt(Tn,fe,mt)&&(an[lr++]=Tn)}return an}function dt(mt,bt){for(var fe=-1,Ge=bt.length,lr=mt.length;++fe<Ge;)mt[lr+fe]=bt[fe];return mt}function Bt(mt,bt){for(var fe=-1,Ge=mt==null?0:mt.length;++fe<Ge;)if(bt(mt[fe],fe,mt))return!0;return!1}function Wt(mt,bt){for(var fe=-1,Ge=Array(mt);++fe<mt;)Ge[fe]=bt(fe);return Ge}function ae(mt){return function(bt){return mt(bt)}}function ce(mt,bt){return mt.has(bt)}function qt(mt,bt){return mt==null?void 0:mt[bt]}function Ce(mt){var bt=-1,fe=Array(mt.size);return mt.forEach(function(Ge,lr){fe[++bt]=[lr,Ge]}),fe}function Re(mt,bt){return function(fe){return mt(bt(fe))}}function be(mt){var bt=-1,fe=Array(mt.size);return mt.forEach(function(Ge){fe[++bt]=Ge}),fe}var Me=Array.prototype,zn=Function.prototype,er=Object.prototype,Fn=je["__core-js_shared__"],ke=zn.toString,$e=er.hasOwnProperty,Nn=function(){var mt=/[^.]+$/.exec(Fn&&Fn.keys&&Fn.keys.IE_PROTO||"");return mt?"Symbol(src)_1."+mt:""}(),ar=er.toString,Gr=RegExp("^"+ke.call($e).replace(Xt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ci=An?je.Buffer:void 0,Kr=je.Symbol,_i=je.Uint8Array,so=er.propertyIsEnumerable,is=Me.splice,Hi=Kr?Kr.toStringTag:void 0,Dt=Object.getOwnPropertySymbols,Gt=Ci?Ci.isBuffer:void 0,Yt=Re(Object.keys,Object),re=yo(je,"DataView"),Qt=yo(je,"Map"),le=yo(je,"Promise"),pe=yo(je,"Set"),oe=yo(je,"WeakMap"),ye=yo(Object,"create"),ue=_t(re),Qe=_t(Qt),Rn=_t(le),Oe=_t(pe),kn=_t(oe),Jn=Kr?Kr.prototype:void 0,Xn=Jn?Jn.valueOf:void 0;function tr(mt){var bt=-1,fe=mt==null?0:mt.length;for(this.clear();++bt<fe;){var Ge=mt[bt];this.set(Ge[0],Ge[1])}}function ci(){this.__data__=ye?ye(null):{},this.size=0}function Zi(mt){var bt=this.has(mt)&&delete this.__data__[mt];return this.size-=bt?1:0,bt}function Nr(mt){var bt=this.__data__;if(ye){var fe=bt[mt];return fe===M?void 0:fe}return $e.call(bt,mt)?bt[mt]:void 0}function Mi(mt){var bt=this.__data__;return ye?bt[mt]!==void 0:$e.call(bt,mt)}function ri(mt,bt){var fe=this.__data__;return this.size+=this.has(mt)?0:1,fe[mt]=ye&&bt===void 0?M:bt,this}tr.prototype.clear=ci,tr.prototype.delete=Zi,tr.prototype.get=Nr,tr.prototype.has=Mi,tr.prototype.set=ri;function zi(mt){var bt=-1,fe=mt==null?0:mt.length;for(this.clear();++bt<fe;){var Ge=mt[bt];this.set(Ge[0],Ge[1])}}function No(){this.__data__=[],this.size=0}function Xs(mt){var bt=this.__data__,fe=As(bt,mt);if(fe<0)return!1;var Ge=bt.length-1;return fe==Ge?bt.pop():is.call(bt,fe,1),--this.size,!0}function mc(mt){var bt=this.__data__,fe=As(bt,mt);return fe<0?void 0:bt[fe][1]}function gc(mt){return As(this.__data__,mt)>-1}function Md(mt,bt){var fe=this.__data__,Ge=As(fe,mt);return Ge<0?(++this.size,fe.push([mt,bt])):fe[Ge][1]=bt,this}zi.prototype.clear=No,zi.prototype.delete=Xs,zi.prototype.get=mc,zi.prototype.has=gc,zi.prototype.set=Md;function os(mt){var bt=-1,fe=mt==null?0:mt.length;for(this.clear();++bt<fe;){var Ge=mt[bt];this.set(Ge[0],Ge[1])}}function Su(){this.size=0,this.__data__={hash:new tr,map:new(Qt||zi),string:new tr}}function _c(mt){var bt=Ys(this,mt).delete(mt);return this.size-=bt?1:0,bt}function Id(mt){return Ys(this,mt).get(mt)}function Sa(mt){return Ys(this,mt).has(mt)}function Eu(mt,bt){var fe=Ys(this,mt),Ge=fe.size;return fe.set(mt,bt),this.size+=fe.size==Ge?0:1,this}os.prototype.clear=Su,os.prototype.delete=_c,os.prototype.get=Id,os.prototype.has=Sa,os.prototype.set=Eu;function Is(mt){var bt=-1,fe=mt==null?0:mt.length;for(this.__data__=new os;++bt<fe;)this.add(mt[bt])}function Cu(mt){return this.__data__.set(mt,M),this}function Ad(mt){return this.__data__.has(mt)}Is.prototype.add=Is.prototype.push=Cu,Is.prototype.has=Ad;function ss(mt){var bt=this.__data__=new zi(mt);this.size=bt.size}function Mu(){this.__data__=new zi,this.size=0}function il(mt){var bt=this.__data__,fe=bt.delete(mt);return this.size=bt.size,fe}function yc(mt){return this.__data__.get(mt)}function ol(mt){return this.__data__.has(mt)}function Ea(mt,bt){var fe=this.__data__;if(fe instanceof zi){var Ge=fe.__data__;if(!Qt||Ge.length<b-1)return Ge.push([mt,bt]),this.size=++fe.size,this;fe=this.__data__=new os(Ge)}return fe.set(mt,bt),this.size=fe.size,this}ss.prototype.clear=Mu,ss.prototype.delete=il,ss.prototype.get=yc,ss.prototype.has=ol,ss.prototype.set=Ea;function sl(mt,bt){var fe=Pr(mt),Ge=!fe&&yi(mt),lr=!fe&&!Ge&&Cr(mt),an=!fe&&!Ge&&!lr&&me(mt),Tn=fe||Ge||lr||an,vi=Tn?Wt(mt.length,String):[],Yr=vi.length;for(var Rr in mt)(bt||$e.call(mt,Rr))&&!(Tn&&(Rr=="length"||lr&&(Rr=="offset"||Rr=="parent")||an&&(Rr=="buffer"||Rr=="byteLength"||Rr=="byteOffset")||Jt(Rr,Yr)))&&vi.push(Rr);return vi}function As(mt,bt){for(var fe=mt.length;fe--;)if(se(mt[fe][0],bt))return fe;return-1}function Ca(mt,bt,fe){var Ge=bt(mt);return Pr(mt)?Ge:dt(Ge,fe(mt))}function Xi(mt){return mt==null?mt===void 0?Lt:J:Hi&&Hi in Object(mt)?Ia(mt):En(mt)}function Ks(mt){return lo(mt)&&Xi(mt)==B}function Ve(mt,bt,fe,Ge,lr){return mt===bt?!0:mt==null||bt==null||!lo(mt)&&!lo(bt)?mt!==mt&&bt!==bt:$n(mt,bt,fe,Ge,Ve,lr)}function $n(mt,bt,fe,Ge,lr,an){var Tn=Pr(mt),vi=Pr(bt),Yr=Tn?z:St(mt),Rr=vi?z:St(bt);Yr=Yr==B?ct:Yr,Rr=Rr==B?ct:Rr;var Ii=Yr==ct,co=Rr==ct,Ai=Yr==Rr;if(Ai&&Cr(mt)){if(!Cr(bt))return!1;Tn=!0,Ii=!1}if(Ai&&!Ii)return an||(an=new ss),Tn||me(mt)?al(mt,bt,fe,Ge,lr,an):Iu(mt,bt,Yr,fe,Ge,lr,an);if(!(fe&E)){var Ui=Ii&&$e.call(mt,"__wrapped__"),Ki=co&&$e.call(bt,"__wrapped__");if(Ui||Ki){var Uo=Ui?mt.value():mt,$o=Ki?bt.value():bt;return an||(an=new ss),lr(Uo,$o,fe,Ge,an)}}return Ai?(an||(an=new ss),Au(mt,bt,fe,Ge,lr,an)):!1}function jo(mt){if(!Aa(mt)||Nt(mt))return!1;var bt=ao(mt)?Gr:Ot;return bt.test(_t(mt))}function Ps(mt){return lo(mt)&&Qs(mt.length)&&!!ie[Xi(mt)]}function Ma(mt){if(!ve(mt))return Yt(mt);var bt=[];for(var fe in Object(mt))$e.call(mt,fe)&&fe!="constructor"&&bt.push(fe);return bt}function al(mt,bt,fe,Ge,lr,an){var Tn=fe&E,vi=mt.length,Yr=bt.length;if(vi!=Yr&&!(Tn&&Yr>vi))return!1;var Rr=an.get(mt);if(Rr&&an.get(bt))return Rr==bt;var Ii=-1,co=!0,Ai=fe&C?new Is:void 0;for(an.set(mt,bt),an.set(bt,mt);++Ii<vi;){var Ui=mt[Ii],Ki=bt[Ii];if(Ge)var Uo=Tn?Ge(Ki,Ui,Ii,bt,mt,an):Ge(Ui,Ki,Ii,mt,bt,an);if(Uo!==void 0){if(Uo)continue;co=!1;break}if(Ai){if(!Bt(bt,function($o,ii){if(!ce(Ai,ii)&&(Ui===$o||lr(Ui,$o,fe,Ge,an)))return Ai.push(ii)})){co=!1;break}}else if(!(Ui===Ki||lr(Ui,Ki,fe,Ge,an))){co=!1;break}}return an.delete(mt),an.delete(bt),co}function Iu(mt,bt,fe,Ge,lr,an,Tn){switch(fe){case Vt:if(mt.byteLength!=bt.byteLength||mt.byteOffset!=bt.byteOffset)return!1;mt=mt.buffer,bt=bt.buffer;case Tt:return!(mt.byteLength!=bt.byteLength||!an(new _i(mt),new _i(bt)));case U:case q:case $:return se(+mt,+bt);case tt:return mt.name==bt.name&&mt.message==bt.message;case ut:case et:return mt==bt+"";case D:var vi=Ce;case N:var Yr=Ge&E;if(vi||(vi=be),mt.size!=bt.size&&!Yr)return!1;var Rr=Tn.get(mt);if(Rr)return Rr==bt;Ge|=C,Tn.set(mt,bt);var Ii=al(vi(mt),vi(bt),Ge,lr,an,Tn);return Tn.delete(mt),Ii;case Mt:if(Xn)return Xn.call(mt)==Xn.call(bt)}return!1}function Au(mt,bt,fe,Ge,lr,an){var Tn=fe&E,vi=ll(mt),Yr=vi.length,Rr=ll(bt),Ii=Rr.length;if(Yr!=Ii&&!Tn)return!1;for(var co=Yr;co--;){var Ai=vi[co];if(!(Tn?Ai in bt:$e.call(bt,Ai)))return!1}var Ui=an.get(mt);if(Ui&&an.get(bt))return Ui==bt;var Ki=!0;an.set(mt,bt),an.set(bt,mt);for(var Uo=Tn;++co<Yr;){Ai=vi[co];var $o=mt[Ai],ii=bt[Ai];if(Ge)var en=Tn?Ge(ii,$o,Ai,bt,mt,an):Ge($o,ii,Ai,mt,bt,an);if(!(en===void 0?$o===ii||lr($o,ii,fe,Ge,an):en)){Ki=!1;break}Uo||(Uo=Ai=="constructor")}if(Ki&&!Uo){var cl=mt.constructor,ul=bt.constructor;cl!=ul&&"constructor"in mt&&"constructor"in bt&&!(typeof cl=="function"&&cl instanceof cl&&typeof ul=="function"&&ul instanceof ul)&&(Ki=!1)}return an.delete(mt),an.delete(bt),Ki}function ll(mt){return Ca(mt,gn,Pu)}function Ys(mt,bt){var fe=mt.__data__;return ge(bt)?fe[typeof bt=="string"?"string":"hash"]:fe.map}function yo(mt,bt){var fe=qt(mt,bt);return jo(fe)?fe:void 0}function Ia(mt){var bt=$e.call(mt,Hi),fe=mt[Hi];try{mt[Hi]=void 0;var Ge=!0}catch{}var lr=ar.call(mt);return Ge&&(bt?mt[Hi]=fe:delete mt[Hi]),lr}var Pu=Dt?function(mt){return mt==null?[]:(mt=Object(mt),nt(Dt(mt),function(bt){return so.call(mt,bt)}))}:Cn,St=Xi;(re&&St(new re(new ArrayBuffer(1)))!=Vt||Qt&&St(new Qt)!=D||le&&St(le.resolve())!=st||pe&&St(new pe)!=N||oe&&St(new oe)!=it)&&(St=function(mt){var bt=Xi(mt),fe=bt==ct?mt.constructor:void 0,Ge=fe?_t(fe):"";if(Ge)switch(Ge){case ue:return Vt;case Qe:return D;case Rn:return st;case Oe:return N;case kn:return it}return bt});function Jt(mt,bt){return bt=bt??L,!!bt&&(typeof mt=="number"||Pe.test(mt))&&mt>-1&&mt%1==0&&mt<bt}function ge(mt){var bt=typeof mt;return bt=="string"||bt=="number"||bt=="symbol"||bt=="boolean"?mt!=="__proto__":mt===null}function Nt(mt){return!!Nn&&Nn in mt}function ve(mt){var bt=mt&&mt.constructor,fe=typeof bt=="function"&&bt.prototype||er;return mt===fe}function En(mt){return ar.call(mt)}function _t(mt){if(mt!=null){try{return ke.call(mt)}catch{}try{return mt+""}catch{}}return""}function se(mt,bt){return mt===bt||mt!==mt&&bt!==bt}var yi=Ks(function(){return arguments}())?Ks:function(mt){return lo(mt)&&$e.call(mt,"callee")&&!so.call(mt,"callee")},Pr=Array.isArray;function Er(mt){return mt!=null&&Qs(mt.length)&&!ao(mt)}var Cr=Gt||ji;function Pd(mt,bt){return Ve(mt,bt)}function ao(mt){if(!Aa(mt))return!1;var bt=Xi(mt);return bt==V||bt==F||bt==H||bt==yt}function Qs(mt){return typeof mt=="number"&&mt>-1&&mt%1==0&&mt<=L}function Aa(mt){var bt=typeof mt;return mt!=null&&(bt=="object"||bt=="function")}function lo(mt){return mt!=null&&typeof mt=="object"}var me=Y?ae(Y):Ps;function gn(mt){return Er(mt)?sl(mt):Ma(mt)}function Cn(){return[]}function ji(){return!1}f.exports=Pd}).call(this)}).call(this,typeof ki<"u"?ki:typeof self<"u"?self:typeof window<"u"?window:{})},{}],12:[function(h,f,g){(function(y){(function(){var b=h("lodash._reinterpolate"),M=h("lodash.templatesettings"),E=800,C=16,L=1/0,B=9007199254740991,z="[object Arguments]",H="[object Array]",U="[object AsyncFunction]",q="[object Boolean]",tt="[object Date]",V="[object DOMException]",F="[object Error]",D="[object Function]",$="[object GeneratorFunction]",J="[object Map]",ct="[object Number]",st="[object Null]",yt="[object Object]",ut="[object Proxy]",N="[object RegExp]",et="[object Set]",Mt="[object String]",Lt="[object Symbol]",it="[object Undefined]",Tt="[object WeakMap]",Vt="[object ArrayBuffer]",ne="[object DataView]",Et="[object Float32Array]",$t="[object Float64Array]",ee="[object Int8Array]",Ee="[object Int16Array]",jt="[object Int32Array]",Le="[object Uint8Array]",we="[object Uint8ClampedArray]",kt="[object Uint16Array]",Xt="[object Uint32Array]",Ot=/\b__p \+= '';/g,Pe=/\b(__p \+=) '' \+/g,ie=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ne=/[\\^$.*+?()[\]{}|]/g,Fe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,je=/^\[object .+?Constructor\]$/,De=/^(?:0|[1-9]\d*)$/,Ue=/($^)/,An=/['\n\r\u2028\u2029\\]/g,vn={};vn[Et]=vn[$t]=vn[ee]=vn[Ee]=vn[jt]=vn[Le]=vn[we]=vn[kt]=vn[Xt]=!0,vn[z]=vn[H]=vn[Vt]=vn[q]=vn[ne]=vn[tt]=vn[F]=vn[D]=vn[J]=vn[ct]=vn[yt]=vn[N]=vn[et]=vn[Mt]=vn[Tt]=!1;var Zt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Y=typeof y=="object"&&y&&y.Object===Object&&y,nt=typeof self=="object"&&self&&self.Object===Object&&self,dt=Y||nt||Function("return this")(),Bt=typeof g=="object"&&g&&!g.nodeType&&g,Wt=Bt&&typeof f=="object"&&f&&!f.nodeType&&f,ae=Wt&&Wt.exports===Bt,ce=ae&&Y.process,qt=function(){try{var St=Wt&&Wt.require&&Wt.require("util").types;return St||ce&&ce.binding&&ce.binding("util")}catch{}}(),Ce=qt&&qt.isTypedArray;function Re(St,Jt,ge){switch(ge.length){case 0:return St.call(Jt);case 1:return St.call(Jt,ge[0]);case 2:return St.call(Jt,ge[0],ge[1]);case 3:return St.call(Jt,ge[0],ge[1],ge[2])}return St.apply(Jt,ge)}function be(St,Jt){for(var ge=-1,Nt=St==null?0:St.length,ve=Array(Nt);++ge<Nt;)ve[ge]=Jt(St[ge],ge,St);return ve}function Me(St,Jt){for(var ge=-1,Nt=Array(St);++ge<St;)Nt[ge]=Jt(ge);return Nt}function zn(St){return function(Jt){return St(Jt)}}function er(St,Jt){return be(Jt,function(ge){return St[ge]})}function Fn(St){return"\\"+Zt[St]}function ke(St,Jt){return St==null?void 0:St[Jt]}function $e(St,Jt){return function(ge){return St(Jt(ge))}}var Nn=Function.prototype,ar=Object.prototype,Gr=dt["__core-js_shared__"],Ci=Nn.toString,Kr=ar.hasOwnProperty,_i=function(){var St=/[^.]+$/.exec(Gr&&Gr.keys&&Gr.keys.IE_PROTO||"");return St?"Symbol(src)_1."+St:""}(),so=ar.toString,is=Ci.call(Object),Hi=RegExp("^"+Ci.call(Kr).replace(Ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Dt=ae?dt.Buffer:void 0,Gt=dt.Symbol,Yt=$e(Object.getPrototypeOf,Object),re=ar.propertyIsEnumerable,Qt=Gt?Gt.toStringTag:void 0,le=function(){try{var St=Md(Object,"defineProperty");return St({},"",{}),St}catch{}}(),pe=Dt?Dt.isBuffer:void 0,oe=$e(Object.keys,Object),ye=Math.max,ue=Date.now,Qe=Gt?Gt.prototype:void 0,Rn=Qe?Qe.toString:void 0;function Oe(St,Jt){var ge=ol(St),Nt=!ge&&yc(St),ve=!ge&&!Nt&&sl(St),En=!ge&&!Nt&&!ve&&Ps(St),_t=ge||Nt||ve||En,se=_t?Me(St.length,String):[],yi=se.length;for(var Pr in St)(Jt||Kr.call(St,Pr))&&!(_t&&(Pr=="length"||ve&&(Pr=="offset"||Pr=="parent")||En&&(Pr=="buffer"||Pr=="byteLength"||Pr=="byteOffset")||Su(Pr,yi)))&&se.push(Pr);return se}function kn(St,Jt,ge){var Nt=St[Jt];(!(Kr.call(St,Jt)&&il(Nt,ge))||ge===void 0&&!(Jt in St))&&Jn(St,Jt,ge)}function Jn(St,Jt,ge){Jt=="__proto__"&&le?le(St,Jt,{configurable:!0,enumerable:!0,value:ge,writable:!0}):St[Jt]=ge}function Xn(St){return St==null?St===void 0?it:st:Qt&&Qt in Object(St)?os(St):Is(St)}function tr(St){return Ve(St)&&Xn(St)==z}function ci(St){if(!Ks(St)||Id(St))return!1;var Jt=Ca(St)?Hi:je;return Jt.test(Mu(St))}function Zi(St){return Ve(St)&&Xi(St.length)&&!!vn[Xn(St)]}function Nr(St){if(!Sa(St))return oe(St);var Jt=[];for(var ge in Object(St))Kr.call(St,ge)&&ge!="constructor"&&Jt.push(ge);return Jt}function Mi(St){if(!Ks(St))return Eu(St);var Jt=Sa(St),ge=[];for(var Nt in St)Nt=="constructor"&&(Jt||!Kr.call(St,Nt))||ge.push(Nt);return ge}function ri(St,Jt){return Ad(Cu(St,Jt,Ia),St+"")}var zi=le?function(St,Jt){return le(St,"toString",{configurable:!0,enumerable:!1,value:yo(Jt),writable:!0})}:Ia;function No(St){if(typeof St=="string")return St;if(ol(St))return be(St,No)+"";if(jo(St))return Rn?Rn.call(St):"";var Jt=St+"";return Jt=="0"&&1/St==-L?"-0":Jt}function Xs(St,Jt,ge,Nt){var ve=!ge;ge||(ge={});for(var En=-1,_t=Jt.length;++En<_t;){var se=Jt[En],yi=Nt?Nt(ge[se],St[se],se,ge,St):void 0;yi===void 0&&(yi=St[se]),ve?Jn(ge,se,yi):kn(ge,se,yi)}return ge}function mc(St){return ri(function(Jt,ge){var Nt=-1,ve=ge.length,En=ve>1?ge[ve-1]:void 0,_t=ve>2?ge[2]:void 0;for(En=St.length>3&&typeof En=="function"?(ve--,En):void 0,_t&&_c(ge[0],ge[1],_t)&&(En=ve<3?void 0:En,ve=1),Jt=Object(Jt);++Nt<ve;){var se=ge[Nt];se&&St(Jt,se,Nt,En)}return Jt})}function gc(St,Jt,ge,Nt){return St===void 0||il(St,ar[ge])&&!Kr.call(Nt,ge)?Jt:St}function Md(St,Jt){var ge=ke(St,Jt);return ci(ge)?ge:void 0}function os(St){var Jt=Kr.call(St,Qt),ge=St[Qt];try{St[Qt]=void 0;var Nt=!0}catch{}var ve=so.call(St);return Nt&&(Jt?St[Qt]=ge:delete St[Qt]),ve}function Su(St,Jt){var ge=typeof St;return Jt=Jt??B,!!Jt&&(ge=="number"||ge!="symbol"&&De.test(St))&&St>-1&&St%1==0&&St<Jt}function _c(St,Jt,ge){if(!Ks(ge))return!1;var Nt=typeof Jt;return(Nt=="number"?Ea(ge)&&Su(Jt,ge.length):Nt=="string"&&Jt in ge)?il(ge[Jt],St):!1}function Id(St){return!!_i&&_i in St}function Sa(St){var Jt=St&&St.constructor,ge=typeof Jt=="function"&&Jt.prototype||ar;return St===ge}function Eu(St){var Jt=[];if(St!=null)for(var ge in Object(St))Jt.push(ge);return Jt}function Is(St){return so.call(St)}function Cu(St,Jt,ge){return Jt=ye(Jt===void 0?St.length-1:Jt,0),function(){for(var Nt=arguments,ve=-1,En=ye(Nt.length-Jt,0),_t=Array(En);++ve<En;)_t[ve]=Nt[Jt+ve];ve=-1;for(var se=Array(Jt+1);++ve<Jt;)se[ve]=Nt[ve];return se[Jt]=ge(_t),Re(St,this,se)}}var Ad=ss(zi);function ss(St){var Jt=0,ge=0;return function(){var Nt=ue(),ve=C-(Nt-ge);if(ge=Nt,ve>0){if(++Jt>=E)return arguments[0]}else Jt=0;return St.apply(void 0,arguments)}}function Mu(St){if(St!=null){try{return Ci.call(St)}catch{}try{return St+""}catch{}}return""}function il(St,Jt){return St===Jt||St!==St&&Jt!==Jt}var yc=tr(function(){return arguments}())?tr:function(St){return Ve(St)&&Kr.call(St,"callee")&&!re.call(St,"callee")},ol=Array.isArray;function Ea(St){return St!=null&&Xi(St.length)&&!Ca(St)}var sl=pe||Pu;function As(St){if(!Ve(St))return!1;var Jt=Xn(St);return Jt==F||Jt==V||typeof St.message=="string"&&typeof St.name=="string"&&!$n(St)}function Ca(St){if(!Ks(St))return!1;var Jt=Xn(St);return Jt==D||Jt==$||Jt==U||Jt==ut}function Xi(St){return typeof St=="number"&&St>-1&&St%1==0&&St<=B}function Ks(St){var Jt=typeof St;return St!=null&&(Jt=="object"||Jt=="function")}function Ve(St){return St!=null&&typeof St=="object"}function $n(St){if(!Ve(St)||Xn(St)!=yt)return!1;var Jt=Yt(St);if(Jt===null)return!0;var ge=Kr.call(Jt,"constructor")&&Jt.constructor;return typeof ge=="function"&&ge instanceof ge&&Ci.call(ge)==is}function jo(St){return typeof St=="symbol"||Ve(St)&&Xn(St)==Lt}var Ps=Ce?zn(Ce):Zi;function Ma(St){return St==null?"":No(St)}var al=mc(function(St,Jt,ge,Nt){Xs(Jt,Au(Jt),St,Nt)});function Iu(St){return Ea(St)?Oe(St):Nr(St)}function Au(St){return Ea(St)?Oe(St,!0):Mi(St)}function ll(St,Jt,ge){var Nt=M.imports._.templateSettings||M;ge&&_c(St,Jt,ge)&&(Jt=void 0),St=Ma(St),Jt=al({},Jt,Nt,gc);var ve=al({},Jt.imports,Nt.imports,gc),En=Iu(ve),_t=er(ve,En),se,yi,Pr=0,Er=Jt.interpolate||Ue,Cr="__p += '",Pd=RegExp((Jt.escape||Ue).source+"|"+Er.source+"|"+(Er===b?Fe:Ue).source+"|"+(Jt.evaluate||Ue).source+"|$","g"),ao=Kr.call(Jt,"sourceURL")?"//# sourceURL="+(Jt.sourceURL+"").replace(/[\r\n]/g," ")+`
`:"";St.replace(Pd,function(lo,me,gn,Cn,ji,mt){return gn||(gn=Cn),Cr+=St.slice(Pr,mt).replace(An,Fn),me&&(se=!0,Cr+=`' +
__e(`+me+`) +
'`),ji&&(yi=!0,Cr+=`';
`+ji+`;
__p += '`),gn&&(Cr+=`' +
((__t = (`+gn+`)) == null ? '' : __t) +
'`),Pr=mt+lo.length,lo}),Cr+=`';
`;var Qs=Kr.call(Jt,"variable")&&Jt.variable;Qs||(Cr=`with (obj) {
`+Cr+`
}
`),Cr=(yi?Cr.replace(Ot,""):Cr).replace(Pe,"$1").replace(ie,"$1;"),Cr="function("+(Qs||"obj")+`) {
`+(Qs?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(se?", __e = _.escape":"")+(yi?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Cr+`return __p
}`;var Aa=Ys(function(){return Function(En,ao+"return "+Cr).apply(void 0,_t)});if(Aa.source=Cr,As(Aa))throw Aa;return Aa}var Ys=ri(function(St,Jt){try{return Re(St,void 0,Jt)}catch(ge){return As(ge)?ge:new Error(ge)}});function yo(St){return function(){return St}}function Ia(St){return St}function Pu(){return!1}f.exports=ll}).call(this)}).call(this,typeof ki<"u"?ki:typeof self<"u"?self:typeof window<"u"?window:{})},{"lodash._reinterpolate":9,"lodash.templatesettings":13}],13:[function(h,f,g){(function(y){(function(){var b=h("lodash._reinterpolate"),M=1/0,E="[object Symbol]",C=/[&<>"'`]/g,L=RegExp(C.source),B=/<%-([\s\S]+?)%>/g,z=/<%([\s\S]+?)%>/g,H={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},U=typeof y=="object"&&y&&y.Object===Object&&y,q=typeof self=="object"&&self&&self.Object===Object&&self,tt=U||q||Function("return this")();function V(it){return function(Tt){return it==null?void 0:it[Tt]}}var F=V(H),D=Object.prototype,$=D.toString,J=tt.Symbol,ct=J?J.prototype:void 0,st=ct?ct.toString:void 0,yt={escape:B,evaluate:z,interpolate:b,variable:"",imports:{_:{escape:Lt}}};function ut(it){if(typeof it=="string")return it;if(et(it))return st?st.call(it):"";var Tt=it+"";return Tt=="0"&&1/it==-M?"-0":Tt}function N(it){return!!it&&typeof it=="object"}function et(it){return typeof it=="symbol"||N(it)&&$.call(it)==E}function Mt(it){return it==null?"":ut(it)}function Lt(it){return it=Mt(it),it&&L.test(it)?it.replace(C,F):it}f.exports=yt}).call(this)}).call(this,typeof ki<"u"?ki:typeof self<"u"?self:typeof window<"u"?window:{})},{"lodash._reinterpolate":9}],14:[function(h,f,g){const y=h("is-plain-obj"),{hasOwnProperty:b}=Object.prototype,{propertyIsEnumerable:M}=Object,E=(F,D,$)=>Object.defineProperty(F,D,{value:$,writable:!0,enumerable:!0,configurable:!0}),C=this,L={concatArrays:!1,ignoreUndefined:!1},B=F=>{const D=[];for(const $ in F)b.call(F,$)&&D.push($);if(Object.getOwnPropertySymbols){const $=Object.getOwnPropertySymbols(F);for(const J of $)M.call(F,J)&&D.push(J)}return D};function z(F){return Array.isArray(F)?H(F):y(F)?U(F):F}function H(F){const D=F.slice(0,0);return B(F).forEach($=>{E(D,$,z(F[$]))}),D}function U(F){const D=Object.getPrototypeOf(F)===null?Object.create(null):{};return B(F).forEach($=>{E(D,$,z(F[$]))}),D}const q=(F,D,$,J)=>($.forEach(ct=>{typeof D[ct]>"u"&&J.ignoreUndefined||(ct in F&&F[ct]!==Object.getPrototypeOf(F)?E(F,ct,V(F[ct],D[ct],J)):E(F,ct,z(D[ct])))}),F),tt=(F,D,$)=>{let J=F.slice(0,0),ct=0;return[F,D].forEach(st=>{const yt=[];for(let ut=0;ut<st.length;ut++)b.call(st,ut)&&(yt.push(String(ut)),st===F?E(J,ct++,st[ut]):E(J,ct++,z(st[ut])));J=q(J,st,B(st).filter(ut=>!yt.includes(ut)),$)}),J};function V(F,D,$){return $.concatArrays&&Array.isArray(F)&&Array.isArray(D)?tt(F,D,$):!y(D)||!y(F)?z(D):q(F,D,B(D),$)}f.exports=function(...F){const D=V(z(L),this!==C&&this||{},L);let $={_:{}};for(const J of F)if(J!==void 0){if(!y(J))throw new TypeError("`"+J+"` is not an Option Object");$=V($,{_:J},D)}return $._}},{"is-plain-obj":15}],15:[function(h,f,g){f.exports=y=>{if(Object.prototype.toString.call(y)!=="[object Object]")return!1;const b=Object.getPrototypeOf(y);return b===null||b===Object.prototype}},{}],16:[function(h,f,g){var y=f.exports={},b,M;function E(){throw new Error("setTimeout has not been defined")}function C(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?b=setTimeout:b=E}catch{b=E}try{typeof clearTimeout=="function"?M=clearTimeout:M=C}catch{M=C}})();function L($){if(b===setTimeout)return setTimeout($,0);if((b===E||!b)&&setTimeout)return b=setTimeout,setTimeout($,0);try{return b($,0)}catch{try{return b.call(null,$,0)}catch{return b.call(this,$,0)}}}function B($){if(M===clearTimeout)return clearTimeout($);if((M===C||!M)&&clearTimeout)return M=clearTimeout,clearTimeout($);try{return M($)}catch{try{return M.call(null,$)}catch{return M.call(this,$)}}}var z=[],H=!1,U,q=-1;function tt(){!H||!U||(H=!1,U.length?z=U.concat(z):q=-1,z.length&&V())}function V(){if(!H){var $=L(tt);H=!0;for(var J=z.length;J;){for(U=z,z=[];++q<J;)U&&U[q].run();q=-1,J=z.length}U=null,H=!1,B($)}}y.nextTick=function($){var J=new Array(arguments.length-1);if(arguments.length>1)for(var ct=1;ct<arguments.length;ct++)J[ct-1]=arguments[ct];z.push(new F($,J)),z.length===1&&!H&&L(V)};function F($,J){this.fun=$,this.array=J}F.prototype.run=function(){this.fun.apply(null,this.array)},y.title="browser",y.browser=!0,y.env={},y.argv=[],y.version="",y.versions={};function D(){}y.on=D,y.addListener=D,y.once=D,y.off=D,y.removeListener=D,y.removeAllListeners=D,y.emit=D,y.prependListener=D,y.prependOnceListener=D,y.listeners=function($){return[]},y.binding=function($){throw new Error("process.binding is not supported")},y.cwd=function(){return"/"},y.chdir=function($){throw new Error("process.chdir is not supported")},y.umask=function(){return 0}},{}],17:[function(h,f,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;function y(E){var C=function(B){var z=B.dispatch,H=B.getState;return function(U){return function(q){return typeof q=="function"?q(z,H,E):U(q)}}};return C}var b=y();b.withExtraArgument=y;var M=b;g.default=M},{}],18:[function(h,f,g){(function(y){(function(){Object.defineProperty(g,"__esModule",{value:!0});var b=h("@babel/runtime/helpers/objectSpread2");function M(it){return it&&typeof it=="object"&&"default"in it?it:{default:it}}var E=M(b);function C(it){return"Minified Redux error #"+it+"; visit https://redux.js.org/Errors?code="+it+" for the full message or use the non-minified dev environment for full errors. "}var L=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),B=function(){return Math.random().toString(36).substring(7).split("").join(".")},z={INIT:"@@redux/INIT"+B(),REPLACE:"@@redux/REPLACE"+B(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+B()}};function H(it){if(typeof it!="object"||it===null)return!1;for(var Tt=it;Object.getPrototypeOf(Tt)!==null;)Tt=Object.getPrototypeOf(Tt);return Object.getPrototypeOf(it)===Tt}function U(it){if(it===void 0)return"undefined";if(it===null)return"null";var Tt=typeof it;switch(Tt){case"boolean":case"string":case"number":case"symbol":case"function":return Tt}if(Array.isArray(it))return"array";if(V(it))return"date";if(tt(it))return"error";var Vt=q(it);switch(Vt){case"Symbol":case"Promise":case"WeakMap":case"WeakSet":case"Map":case"Set":return Vt}return Tt.slice(8,-1).toLowerCase().replace(/\s/g,"")}function q(it){return typeof it.constructor=="function"?it.constructor.name:null}function tt(it){return it instanceof Error||typeof it.message=="string"&&it.constructor&&typeof it.constructor.stackTraceLimit=="number"}function V(it){return it instanceof Date?!0:typeof it.toDateString=="function"&&typeof it.getDate=="function"&&typeof it.setDate=="function"}function F(it){var Tt=typeof it;return y.env.NODE_ENV!=="production"&&(Tt=U(it)),Tt}function D(it,Tt,Vt){var ne;if(typeof Tt=="function"&&typeof Vt=="function"||typeof Vt=="function"&&typeof arguments[3]=="function")throw new Error(y.env.NODE_ENV==="production"?C(0):"It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.");if(typeof Tt=="function"&&typeof Vt>"u"&&(Vt=Tt,Tt=void 0),typeof Vt<"u"){if(typeof Vt!="function")throw new Error(y.env.NODE_ENV==="production"?C(1):"Expected the enhancer to be a function. Instead, received: '"+F(Vt)+"'");return Vt(D)(it,Tt)}if(typeof it!="function")throw new Error(y.env.NODE_ENV==="production"?C(2):"Expected the root reducer to be a function. Instead, received: '"+F(it)+"'");var Et=it,$t=Tt,ee=[],Ee=ee,jt=!1;function Le(){Ee===ee&&(Ee=ee.slice())}function we(){if(jt)throw new Error(y.env.NODE_ENV==="production"?C(3):"You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return $t}function kt(ie){if(typeof ie!="function")throw new Error(y.env.NODE_ENV==="production"?C(4):"Expected the listener to be a function. Instead, received: '"+F(ie)+"'");if(jt)throw new Error(y.env.NODE_ENV==="production"?C(5):"You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api/store#subscribelistener for more details.");var Ne=!0;return Le(),Ee.push(ie),function(){if(Ne){if(jt)throw new Error(y.env.NODE_ENV==="production"?C(6):"You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api/store#subscribelistener for more details.");Ne=!1,Le();var je=Ee.indexOf(ie);Ee.splice(je,1),ee=null}}}function Xt(ie){if(!H(ie))throw new Error(y.env.NODE_ENV==="production"?C(7):"Actions must be plain objects. Instead, the actual type was: '"+F(ie)+"'. You may need to add middleware to your store setup to handle dispatching other values, such as 'redux-thunk' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.");if(typeof ie.type>"u")throw new Error(y.env.NODE_ENV==="production"?C(8):'Actions may not have an undefined "type" property. You may have misspelled an action type string constant.');if(jt)throw new Error(y.env.NODE_ENV==="production"?C(9):"Reducers may not dispatch actions.");try{jt=!0,$t=Et($t,ie)}finally{jt=!1}for(var Ne=ee=Ee,Fe=0;Fe<Ne.length;Fe++){var je=Ne[Fe];je()}return ie}function Ot(ie){if(typeof ie!="function")throw new Error(y.env.NODE_ENV==="production"?C(10):"Expected the nextReducer to be a function. Instead, received: '"+F(ie));Et=ie,Xt({type:z.REPLACE})}function Pe(){var ie,Ne=kt;return ie={subscribe:function(je){if(typeof je!="object"||je===null)throw new Error(y.env.NODE_ENV==="production"?C(11):"Expected the observer to be an object. Instead, received: '"+F(je)+"'");function De(){je.next&&je.next(we())}De();var Ue=Ne(De);return{unsubscribe:Ue}}},ie[L]=function(){return this},ie}return Xt({type:z.INIT}),ne={dispatch:Xt,subscribe:kt,getState:we,replaceReducer:Ot},ne[L]=Pe,ne}var $=D;function J(it){typeof console<"u"&&typeof console.error=="function"&&console.error(it);try{throw new Error(it)}catch{}}function ct(it,Tt,Vt,ne){var Et=Object.keys(Tt),$t=Vt&&Vt.type===z.INIT?"preloadedState argument passed to createStore":"previous state received by the reducer";if(Et.length===0)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";if(!H(it))return"The "+$t+' has unexpected type of "'+F(it)+'". Expected argument to be an object with the following '+('keys: "'+Et.join('", "')+'"');var ee=Object.keys(it).filter(function(Ee){return!Tt.hasOwnProperty(Ee)&&!ne[Ee]});if(ee.forEach(function(Ee){ne[Ee]=!0}),!(Vt&&Vt.type===z.REPLACE)&&ee.length>0)return"Unexpected "+(ee.length>1?"keys":"key")+" "+('"'+ee.join('", "')+'" found in '+$t+". ")+"Expected to find one of the known reducer keys instead: "+('"'+Et.join('", "')+'". Unexpected keys will be ignored.')}function st(it){Object.keys(it).forEach(function(Tt){var Vt=it[Tt],ne=Vt(void 0,{type:z.INIT});if(typeof ne>"u")throw new Error(y.env.NODE_ENV==="production"?C(12):'The slice reducer for key "'+Tt+`" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.`);if(typeof Vt(void 0,{type:z.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(y.env.NODE_ENV==="production"?C(13):'The slice reducer for key "'+Tt+'" returned undefined when probed with a random type. '+("Don't try to handle '"+z.INIT+`' or other actions in "redux/*" `)+"namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.")})}function yt(it){for(var Tt=Object.keys(it),Vt={},ne=0;ne<Tt.length;ne++){var Et=Tt[ne];y.env.NODE_ENV!=="production"&&typeof it[Et]>"u"&&J('No reducer provided for key "'+Et+'"'),typeof it[Et]=="function"&&(Vt[Et]=it[Et])}var $t=Object.keys(Vt),ee;y.env.NODE_ENV!=="production"&&(ee={});var Ee;try{st(Vt)}catch(jt){Ee=jt}return function(Le,we){if(Le===void 0&&(Le={}),Ee)throw Ee;if(y.env.NODE_ENV!=="production"){var kt=ct(Le,Vt,we,ee);kt&&J(kt)}for(var Xt=!1,Ot={},Pe=0;Pe<$t.length;Pe++){var ie=$t[Pe],Ne=Vt[ie],Fe=Le[ie],je=Ne(Fe,we);if(typeof je>"u"){var De=we&&we.type;throw new Error(y.env.NODE_ENV==="production"?C(14):"When called with an action of type "+(De?'"'+String(De)+'"':"(unknown type)")+', the slice reducer for key "'+ie+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.')}Ot[ie]=je,Xt=Xt||je!==Fe}return Xt=Xt||$t.length!==Object.keys(Le).length,Xt?Ot:Le}}function ut(it,Tt){return function(){return Tt(it.apply(this,arguments))}}function N(it,Tt){if(typeof it=="function")return ut(it,Tt);if(typeof it!="object"||it===null)throw new Error(y.env.NODE_ENV==="production"?C(16):"bindActionCreators expected an object or a function, but instead received: '"+F(it)+`'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?`);var Vt={};for(var ne in it){var Et=it[ne];typeof Et=="function"&&(Vt[ne]=ut(Et,Tt))}return Vt}function et(){for(var it=arguments.length,Tt=new Array(it),Vt=0;Vt<it;Vt++)Tt[Vt]=arguments[Vt];return Tt.length===0?function(ne){return ne}:Tt.length===1?Tt[0]:Tt.reduce(function(ne,Et){return function(){return ne(Et.apply(void 0,arguments))}})}function Mt(){for(var it=arguments.length,Tt=new Array(it),Vt=0;Vt<it;Vt++)Tt[Vt]=arguments[Vt];return function(ne){return function(){var Et=ne.apply(void 0,arguments),$t=function(){throw new Error(y.env.NODE_ENV==="production"?C(15):"Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},ee={getState:Et.getState,dispatch:function(){return $t.apply(void 0,arguments)}},Ee=Tt.map(function(jt){return jt(ee)});return $t=et.apply(void 0,Ee)(Et.dispatch),E.default(E.default({},Et),{},{dispatch:$t})}}}function Lt(){}y.env.NODE_ENV!=="production"&&typeof Lt.name=="string"&&Lt.name!=="isCrushed"&&J('You are currently using minified code outside of NODE_ENV === "production". This means that you are running a slower development build of Redux. You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) to ensure you have the correct code for your production build.'),g.__DO_NOT_USE__ActionTypes=z,g.applyMiddleware=Mt,g.bindActionCreators=N,g.combineReducers=yt,g.compose=et,g.createStore=D,g.legacy_createStore=$}).call(this)}).call(this,h("_process"))},{"@babel/runtime/helpers/objectSpread2":2,_process:16}],19:[function(h,f,g){var y=h("./src/suggestions");f.exports=y,typeof window<"u"&&(window.Suggestions=y)},{"./src/suggestions":21}],20:[function(h,f,g){var y=function(b){return this.component=b,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,b.el.parentNode.insertBefore(this.wrapper,b.el.nextSibling),this};y.prototype.show=function(){this.element.style.display="block"},y.prototype.hide=function(){this.element.style.display="none"},y.prototype.add=function(b){this.items.push(b)},y.prototype.clear=function(){this.items=[],this.active=0},y.prototype.isEmpty=function(){return!this.items.length},y.prototype.isVisible=function(){return this.element.style.display==="block"},y.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var b=0;b<this.items.length;b++)this.drawItem(this.items[b],this.active===b);this.show()},y.prototype.drawItem=function(b,M){var E=document.createElement("li"),C=document.createElement("a");M&&(E.className+=" active"),C.innerHTML=b.string,E.appendChild(C),this.element.appendChild(E),E.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),E.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,b)}).bind(this))},y.prototype.handleMouseUp=function(b){this.selectingListItem=!1,this.component.value(b.original),this.clear(),this.draw()},y.prototype.move=function(b){this.active=b,this.draw()},y.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)},y.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},y.prototype.drawError=function(b){var M=document.createElement("li");M.innerHTML=b,this.element.appendChild(M),this.show()},f.exports=y},{}],21:[function(h,f,g){var y=h("xtend"),b=h("fuzzy"),M=h("./list"),E=function(C,L,B){return B=B||{},this.options=y({minLength:2,limit:5,filter:!0,hideOnBlur:!0},B),this.el=C,this.data=L||[],this.list=new M(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(z){this.handleKeyUp(z.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(z){this.handleKeyDown(z)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(z){this.handlePaste(z)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};E.prototype.handleKeyUp=function(C){C===40||C===38||C===27||C===13||C===9||this.handleInputChange(this.el.value)},E.prototype.handleKeyDown=function(C){switch(C.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&C.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}},E.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},E.prototype.handlePaste=function(C){if(C.clipboardData)this.handleInputChange(C.clipboardData.getData("Text"));else{var L=this;setTimeout(function(){L.handleInputChange(C.target.value)},100)}},E.prototype.handleInputChange=function(C){if(this.query=this.normalize(C),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(L){for(var B=0;B<L.length&&(this.list.add(L[B]),B!==this.options.limit-1);B++);this.list.draw()}).bind(this))},E.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},E.prototype.update=function(C){this.data=C,this.handleKeyUp()},E.prototype.clear=function(){this.data=[],this.list.clear()},E.prototype.normalize=function(C){return C=C.toLowerCase(),C},E.prototype.match=function(C,L){return C.indexOf(L)>-1},E.prototype.value=function(C){if(this.selected=C,this.el.value=this.getItemValue(C),document.createEvent){var L=document.createEvent("HTMLEvents");L.initEvent("change",!0,!1),this.el.dispatchEvent(L)}else this.el.fireEvent("onchange")},E.prototype.getCandidates=function(C){var L={pre:"<strong>",post:"</strong>",extract:(function(z){return this.getItemValue(z)}).bind(this)},B;this.options.filter?(B=b.filter(this.query,this.data,L),B=B.map((function(z){return{original:z.original,string:this.render(z.original,z.string)}}).bind(this))):B=this.data.map((function(z){var H=this.render(z);return{original:z,string:H}}).bind(this)),C(B)},E.prototype.getItemValue=function(C){return C},E.prototype.render=function(C,L){if(L)return L;for(var B=C.original?this.getItemValue(C.original):this.getItemValue(C),z=this.normalize(B),H=z.lastIndexOf(this.query);H>-1;){var U=H+this.query.length;B=B.slice(0,H)+"<strong>"+B.slice(H,U)+"</strong>"+B.slice(U),H=z.slice(0,H).lastIndexOf(this.query)}return B},E.prototype.renderError=function(C){this.list.drawError(C)},f.exports=E},{"./list":20,fuzzy:8,xtend:24}],22:[function(h,f,g){var y=h("turf-meta").coordEach;f.exports=function(b){var M=[1/0,1/0,-1/0,-1/0];return y(b,function(E){M[0]>E[0]&&(M[0]=E[0]),M[1]>E[1]&&(M[1]=E[1]),M[2]<E[0]&&(M[2]=E[0]),M[3]<E[1]&&(M[3]=E[1])}),M}},{"turf-meta":23}],23:[function(h,f,g){function y(C,L,B){var z,H,U,q,tt,V,F,D,$=0,J,ct=C.type==="FeatureCollection",st=C.type==="Feature",yt=ct?C.features.length:1;for(z=0;z<yt;z++)for(D=ct?C.features[z].geometry:st?C.geometry:C,J=D.type==="GeometryCollection",V=J?D.geometries.length:1,q=0;q<V;q++)if(tt=J?D.geometries[q]:D,F=tt.coordinates,$=B&&(tt.type==="Polygon"||tt.type==="MultiPolygon")?1:0,tt.type==="Point")L(F);else if(tt.type==="LineString"||tt.type==="MultiPoint")for(H=0;H<F.length;H++)L(F[H]);else if(tt.type==="Polygon"||tt.type==="MultiLineString")for(H=0;H<F.length;H++)for(U=0;U<F[H].length-$;U++)L(F[H][U]);else if(tt.type==="MultiPolygon")for(H=0;H<F.length;H++)for(U=0;U<F[H].length;U++)for(l=0;l<F[H][U].length-$;l++)L(F[H][U][l]);else throw new Error("Unknown Geometry Type")}f.exports.coordEach=y;function b(C,L,B,z){return y(C,function(H){B=L(B,H)},z),B}f.exports.coordReduce=b;function M(C,L){var B;switch(C.type){case"FeatureCollection":for(features=C.features,B=0;B<C.features.length;B++)L(C.features[B].properties);break;case"Feature":L(C.properties);break}}f.exports.propEach=M;function E(C,L,B){return M(C,function(z){B=L(B,z)}),B}f.exports.propReduce=E},{}],24:[function(h,f,g){f.exports=b;var y=Object.prototype.hasOwnProperty;function b(){for(var M={},E=0;E<arguments.length;E++){var C=arguments[E];for(var L in C)y.call(C,L)&&(M[L]=C[L])}return M}},{}],25:[function(h,f,g){function y(kt){"@babel/helpers - typeof";return y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Xt){return typeof Xt}:function(Xt){return Xt&&typeof Symbol=="function"&&Xt.constructor===Symbol&&Xt!==Symbol.prototype?"symbol":typeof Xt},y(kt)}Object.defineProperty(g,"__esModule",{value:!0}),g.addWaypoint=ee,g.clearDestination=N,g.clearOrigin=ut,g.createDestination=Tt,g.createOrigin=it,g.eventEmit=we,g.eventSubscribe=Le,g.hoverMarker=Mt,g.queryDestination=ct,g.queryDestinationCoordinates=yt,g.queryOrigin=J,g.queryOriginCoordinates=st,g.removeWaypoint=jt,g.reverse=ne,g.setDestinationFromCoordinates=$t,g.setOptions=et,g.setOriginFromCoordinates=Et,g.setProfile=Vt,g.setRouteIndex=Lt,g.setWaypoint=Ee;var b=L(h("../constants/action_types")),M=E(h("../utils"));function E(kt){return kt&&kt.__esModule?kt:{default:kt}}function C(kt){if(typeof WeakMap!="function")return null;var Xt=new WeakMap,Ot=new WeakMap;return(C=function(ie){return ie?Ot:Xt})(kt)}function L(kt,Xt){if(!Xt&&kt&&kt.__esModule)return kt;if(kt===null||y(kt)!=="object"&&typeof kt!="function")return{default:kt};var Ot=C(Xt);if(Ot&&Ot.has(kt))return Ot.get(kt);var Pe={},ie=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ne in kt)if(Ne!=="default"&&Object.prototype.hasOwnProperty.call(kt,Ne)){var Fe=ie?Object.getOwnPropertyDescriptor(kt,Ne):null;Fe&&(Fe.get||Fe.set)?Object.defineProperty(Pe,Ne,Fe):Pe[Ne]=kt[Ne]}return Pe.default=kt,Ot&&Ot.set(kt,Pe),Pe}function B(kt){return function(Xt){var Ot=M.default.createPoint(kt,{id:"origin","marker-symbol":"A"});Xt({type:b.ORIGIN,origin:Ot}),Xt(we("origin",{feature:Ot}))}}function z(kt){return function(Xt){var Ot=M.default.createPoint(kt,{id:"destination","marker-symbol":"B"});Xt({type:b.DESTINATION,destination:Ot}),Xt(we("destination",{feature:Ot}))}}function H(kt){return function(Xt){Xt({type:b.DIRECTIONS_REQUEST_START,request:kt})}}function U(kt){return function(Xt){Xt({type:b.DIRECTIONS,directions:kt}),Xt(we("route",{route:kt}))}}function q(kt){return{type:b.WAYPOINTS,waypoints:kt}}function tt(kt){return{type:b.HOVER_MARKER,hoverMarker:kt}}function V(){return function(kt,Xt){var Ot=Xt(),Pe=Ot.api,ie=Ot.accessToken,Ne=Ot.routeIndex,Fe=Ot.profile,je=Ot.alternatives,De=Ot.congestion,Ue=Ot.destination,An=Ot.language,vn=Ot.exclude,Zt=Ot.fetchDirectionsRequest;if(Ue&&Ue.geometry){Zt&&Zt.abort();var Y=F(Xt),nt=[];nt.push("geometries=polyline"),je&&nt.push("alternatives=true"),De&&nt.push("annotations=congestion"),nt.push("steps=true"),nt.push("overview=full"),An&&nt.push("language="+An),vn&&nt.push("exclude="+vn),ie&&nt.push("access_token="+ie);var dt=new XMLHttpRequest;dt.open("GET","".concat(Pe).concat(Fe,"/").concat(Y,".json?").concat(nt.join("&")),!0),kt(H(dt)),dt.onload=function(){if(dt.status>=200&&dt.status<400){var Bt=JSON.parse(dt.responseText);if(Bt.error)return kt(U([])),kt($(Bt.error));if(Bt.message==="No route found")return kt($("No route found"));kt($(null)),Bt.routes[Ne]||kt(Lt(0)),kt(U(Bt.routes)),kt(B(Bt.waypoints[0].location)),kt(z(Bt.waypoints[Bt.waypoints.length-1].location))}else return kt(U([])),kt($(JSON.parse(dt.responseText).message))},dt.onerror=function(){return kt(U([])),dt.responseText?kt($(JSON.parse(dt.responseText).message)):kt($("Error"))},dt.send()}}}function F(kt){var Xt=kt(),Ot=Xt.origin,Pe=Xt.destination,ie=Xt.waypoints,Ne=[];return Ne.push(Ot.geometry.coordinates.join(",")),Ne.push(";"),ie.length&&ie.forEach(function(Fe){Ne.push(Fe.geometry.coordinates.join(",")),Ne.push(";")}),Ne.push(Pe.geometry.coordinates.join(",")),encodeURIComponent(Ne.join(""))}function D(kt){var Xt={id:"waypoint"};return Object.assign(kt,{properties:kt.properties?Object.assign(kt.properties,Xt):Xt})}function $(kt){return function(Xt){Xt({type:"ERROR",error:kt}),kt&&Xt(we("error",{error:kt}))}}function J(kt){return{type:b.ORIGIN_QUERY,query:kt}}function ct(kt){return{type:b.DESTINATION_QUERY,query:kt}}function st(kt){return{type:b.ORIGIN_FROM_COORDINATES,coordinates:kt}}function yt(kt){return{type:b.DESTINATION_FROM_COORDINATES,coordinates:kt}}function ut(){return function(kt){kt({type:b.ORIGIN_CLEAR}),kt(we("clear",{type:"origin"})),kt($(null))}}function N(){return function(kt,Xt){var Ot=Xt(),Pe=Ot.fetchDirectionsRequest;Pe&&Pe.abort(),kt({type:b.DESTINATION_CLEAR}),kt(we("clear",{type:"destination"})),kt($(null))}}function et(kt){return{type:b.SET_OPTIONS,options:kt}}function Mt(kt){return function(Xt){var Ot=kt?M.default.createPoint(kt,{id:"hover"}):{};Xt(tt(Ot))}}function Lt(kt){return{type:b.ROUTE_INDEX,routeIndex:kt}}function it(kt){return function(Xt,Ot){var Pe=Ot(),ie=Pe.destination;Xt(B(kt)),ie.geometry&&Xt(V())}}function Tt(kt){return function(Xt,Ot){var Pe=Ot(),ie=Pe.origin;Xt(z(kt)),ie.geometry&&Xt(V())}}function Vt(kt){return function(Xt,Ot){var Pe=Ot(),ie=Pe.origin,Ne=Pe.destination;Xt({type:b.DIRECTIONS_PROFILE,profile:kt}),Xt(we("profile",{profile:kt})),ie.geometry&&Ne.geometry&&Xt(V())}}function ne(){return function(kt,Xt){var Ot=Xt();Ot.destination.geometry&&kt(B(Ot.destination.geometry.coordinates)),Ot.origin.geometry&&kt(z(Ot.origin.geometry.coordinates)),Ot.origin.geometry&&Ot.destination.geometry&&kt(V());for(var Pe=document.getElementsByClassName("suggestions"),ie=0;ie<Pe.length;ie++)Pe[ie].style.visibility="hidden"}}function Et(kt){return function(Xt){if(M.default.validCoords(kt)||(kt=[M.default.wrap(kt[0]),M.default.wrap(kt[1])]),isNaN(kt[0])&&isNaN(kt[1]))return Xt($(new Error("Coordinates are not valid")));Xt(st(kt)),Xt(it(kt))}}function $t(kt){return function(Xt){if(M.default.validCoords(kt)||(kt=[M.default.wrap(kt[0]),M.default.wrap(kt[1])]),isNaN(kt[0])&&isNaN(kt[1]))return Xt($(new Error("Coordinates are not valid")));Xt(Tt(kt)),Xt(yt(kt))}}function ee(kt,Xt){return function(Ot,Pe){var ie=Pe(),Ne=ie.destination,Fe=ie.waypoints;Fe.splice(kt,0,D(Xt)),Ot(q(Fe)),Ne.geometry&&Ot(V())}}function Ee(kt,Xt){return function(Ot,Pe){var ie=Pe(),Ne=ie.destination,Fe=ie.waypoints;Fe[kt]=D(Xt),Ot(q(Fe)),Ne.geometry&&Ot(V())}}function jt(kt){return function(Xt,Ot){var Pe=Ot(),ie=Pe.destination,Ne=Pe.waypoints;Ne=Ne.filter(function(Fe){return!M.default.coordinateMatch(Fe,kt)}),Xt(q(Ne)),ie.geometry&&Xt(V())}}function Le(kt,Xt){return function(Ot,Pe){var ie=Pe(),Ne=ie.events;return Ne[kt]=Ne[kt]||[],Ne[kt].push(Xt),{type:b.EVENTS,events:Ne}}}function we(kt,Xt){var Ot=this;return function(Pe,ie){var Ne=ie(),Fe=Ne.events;if(!Fe[kt])return{type:b.EVENTS,events:Fe};for(var je=Fe[kt].slice(),De=0;De<je.length;De++)je[De].call(Ot,Xt)}}},{"../constants/action_types":26,"../utils":34}],26:[function(h,f,g){Object.defineProperty(g,"__esModule",{value:!0}),g.WAYPOINTS=g.SET_OPTIONS=g.ROUTE_INDEX=g.ORIGIN_QUERY=g.ORIGIN_FROM_COORDINATES=g.ORIGIN_CLEAR=g.ORIGIN=g.HOVER_MARKER=g.EVENTS=g.ERROR=g.DIRECTIONS_REQUEST_START=g.DIRECTIONS_PROFILE=g.DIRECTIONS=g.DESTINATION_QUERY=g.DESTINATION_FROM_COORDINATES=g.DESTINATION_CLEAR=g.DESTINATION=void 0;var y="DESTINATION";g.DESTINATION=y;var b="DESTINATION_CLEAR";g.DESTINATION_CLEAR=b;var M="DESTINATION_QUERY";g.DESTINATION_QUERY=M;var E="DESTINATION_FROM_COORDINATES";g.DESTINATION_FROM_COORDINATES=E;var C="DIRECTIONS";g.DIRECTIONS=C;var L="DIRECTIONS_REQUEST_START";g.DIRECTIONS_REQUEST_START=L;var B="DIRECTIONS_PROFILE";g.DIRECTIONS_PROFILE=B;var z="EVENTS";g.EVENTS=z;var H="ERROR";g.ERROR=H;var U="HOVER_MARKER";g.HOVER_MARKER=U;var q="ORIGIN";g.ORIGIN=q;var tt="ORIGIN_CLEAR";g.ORIGIN_CLEAR=tt;var V="ORIGIN_QUERY";g.ORIGIN_QUERY=V;var F="ORIGIN_FROM_COORDINATES";g.ORIGIN_FROM_COORDINATES=F;var D="ROUTE_INDEX";g.ROUTE_INDEX=D;var $="SET_OPTIONS";g.SET_OPTIONS=$;var J="WAYPOINTS";g.WAYPOINTS=J},{}],27:[function(h,f,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var y=C(h("suggestions")),b=C(h("lodash.debounce")),M=h("events"),E=C(h("../utils"));function C(V){return V&&V.__esModule?V:{default:V}}function L(V){"@babel/helpers - typeof";return L=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(F){return typeof F}:function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F},L(V)}function B(V,F){if(!(V instanceof F))throw new TypeError("Cannot call a class as a function")}function z(V,F){for(var D=0;D<F.length;D++){var $=F[D];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(V,U($.key),$)}}function H(V,F,D){return F&&z(V.prototype,F),D&&z(V,D),Object.defineProperty(V,"prototype",{writable:!1}),V}function U(V){var F=q(V,"string");return L(F)==="symbol"?F:String(F)}function q(V,F){if(L(V)!=="object"||V===null)return V;var D=V[Symbol.toPrimitive];if(D!==void 0){var $=D.call(V,F||"default");if(L($)!=="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(F==="string"?String:Number)(V)}var tt=function(){function V(F){B(this,V),this._ev=new M.EventEmitter,this.options=F,this.api=F&&F.api||"https://api.mapbox.com/geocoding/v5/mapbox.places/"}return H(V,[{key:"onAdd",value:function(D){this._map=D,this.request=new XMLHttpRequest;var $=document.createElement("div");$.className="mapboxgl-ctrl-geocoder";var J=document.createElement("span");J.className="geocoder-icon geocoder-icon-search";var ct=this._inputEl=document.createElement("input");ct.type="text",ct.placeholder=this.options.placeholder,ct.addEventListener("keydown",(0,b.default)((function(N){if(!N.target.value)return this._clearEl.classList.remove("active");N.metaKey||[9,27,37,39,13,38,40].indexOf(N.keyCode)!==-1||this._queryFromInput(N.target.value)}).bind(this)),200),ct.addEventListener("change",(function(N){N.target.value&&this._clearEl.classList.add("active");var et=this._typeahead.selected;if(et){if(this.options.flyTo)if(et.bbox&&et.context&&et.context.length<=3||et.bbox&&!et.context){var Mt=et.bbox;D.fitBounds([[Mt[0],Mt[1]],[Mt[2],Mt[3]]])}else D.flyTo({center:et.center,zoom:this.options.zoom});this._input=et,this.fire("result",{result:et})}}).bind(this));var st=document.createElement("div");st.classList.add("geocoder-pin-right");var yt=this._clearEl=document.createElement("button");yt.className="geocoder-icon geocoder-icon-close",yt.addEventListener("click",this._clear.bind(this));var ut=this._loadingEl=document.createElement("span");return ut.className="geocoder-icon geocoder-icon-loading",st.appendChild(yt),st.appendChild(ut),$.appendChild(J),$.appendChild(ct),$.appendChild(st),this.options.container&&(this.options.position=!1),this._typeahead=new y.default(ct,[],{filter:!1}),this._typeahead.getItemValue=function(N){return N.place_name},$}},{key:"_geocode",value:function(D,$){this._loadingEl.classList.add("active"),this.fire("loading");var J=this.options,ct=["placeholder","zoom","flyTo","accessToken","api"],st=Object.keys(this.options).filter(function(ut){return ct.indexOf(ut)===-1}).map(function(ut){return ut+"="+J[ut]}),yt=this.options.accessToken?this.options.accessToken:mapboxgl.accessToken;st.push("access_token="+yt),this.request.abort(),this.request.open("GET",this.api+encodeURIComponent(D.trim())+".json?"+st.join("&"),!0),this.request.onload=(function(){if(this._loadingEl.classList.remove("active"),this.request.status>=200&&this.request.status<400){var ut=JSON.parse(this.request.responseText);return ut.features.length?this._clearEl.classList.add("active"):(this._clearEl.classList.remove("active"),this._typeahead.selected=null),this.fire("results",{results:ut.features}),this._typeahead.update(ut.features),$(ut.features)}else this.fire("error",{error:JSON.parse(this.request.responseText).message})}).bind(this),this.request.onerror=(function(){this._loadingEl.classList.remove("active"),this.fire("error",{error:JSON.parse(this.request.responseText).message})}).bind(this),this.request.send()}},{key:"_queryFromInput",value:function(D){D=D.trim(),D||this._clear(),D.length>2&&this._geocode(D,(function($){this._results=$}).bind(this))}},{key:"_change",value:function(){var D=document.createEvent("HTMLEvents");D.initEvent("change",!0,!1),this._inputEl.dispatchEvent(D)}},{key:"_query",value:function(D){D&&(L(D)==="object"&&D.length&&(D=[E.default.wrap(D[0]),E.default.wrap(D[1])].join()),this._geocode(D,(function($){if($.length){var J=$[0];this._results=$,this._typeahead.selected=J,this._inputEl.value=J.place_name,this._change()}}).bind(this)))}},{key:"_setInput",value:function(D){D&&(L(D)==="object"&&D.length&&(D=[E.default.roundWithOriginalPrecision(E.default.wrap(D[0]),D[0]),E.default.roundWithOriginalPrecision(E.default.wrap(D[1]),D[1])].join()),this._inputEl.value=D,this._input=null,this._typeahead.selected=null,this._typeahead.clear(),this._change())}},{key:"_clear",value:function(){this._input=null,this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._change(),this._inputEl.focus(),this._clearEl.classList.remove("active"),this.fire("clear")}},{key:"getResult",value:function(){return this._input}},{key:"query",value:function(D){return this._query(D),this}},{key:"setInput",value:function(D){return this._setInput(D),this}},{key:"on",value:function(D,$){return this._ev.on(D,$),this._ev.on("error",function(J){console.log(J)}),this}},{key:"fire",value:function(D,$){return this._ev.emit(D,$),this}},{key:"off",value:function(D,$){return this._ev.removeListener(D,$),this}}]),V}();g.default=tt},{"../utils":34,events:7,"lodash.debounce":10,suggestions:19}],28:[function(h,f,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var y=C(h("./geocoder")),b=C(h("lodash.template")),M=C(h("lodash.isequal")),E=C(h("turf-extent"));function C(F){return F&&F.__esModule?F:{default:F}}function L(F){"@babel/helpers - typeof";return L=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},L(F)}function B(F,D){if(!(F instanceof D))throw new TypeError("Cannot call a class as a function")}function z(F,D){for(var $=0;$<D.length;$++){var J=D[$];J.enumerable=J.enumerable||!1,J.configurable=!0,"value"in J&&(J.writable=!0),Object.defineProperty(F,U(J.key),J)}}function H(F,D,$){return D&&z(F.prototype,D),$&&z(F,$),Object.defineProperty(F,"prototype",{writable:!1}),F}function U(F){var D=q(F,"string");return L(D)==="symbol"?D:String(D)}function q(F,D){if(L(F)!=="object"||F===null)return F;var $=F[Symbol.toPrimitive];if($!==void 0){var J=$.call(F,D||"default");if(L(J)!=="object")return J;throw new TypeError("@@toPrimitive must return a primitive value.")}return(D==="string"?String:Number)(F)}var tt=(0,b.default)(`<div class='mapbox-directions-component mapbox-directions-inputs'>
  <div class='mapbox-directions-component-keyline'>
    <div class='mapbox-directions-origin'>
      <label class='mapbox-form-label'>
        <span class='directions-icon directions-icon-depart'></span>
      </label>
      <div id='mapbox-directions-origin-input'></div>
    </div>

    <button
      class='directions-icon directions-icon-reverse directions-reverse js-reverse-inputs'
      title='Reverse origin &amp; destination'>
    </button>

    <div class='mapbox-directions-destination'>
      <label class='mapbox-form-label'>
        <span class='directions-icon directions-icon-arrive'></span>
      </label>
      <div id='mapbox-directions-destination-input'></div>
    </div>
  </div>

  <% if (controls.profileSwitcher) { %>
  <div class='mapbox-directions-profile mapbox-directions-component-keyline mapbox-directions-clearfix'><input
      id='mapbox-directions-profile-driving-traffic'
      type='radio'
      name='profile'
      value='mapbox/driving-traffic'
      <% if (profile === 'mapbox/driving-traffic') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-driving-traffic'>Traffic</label>
    <input
      id='mapbox-directions-profile-driving'
      type='radio'
      name='profile'
      value='mapbox/driving'
      <% if (profile === 'mapbox/driving') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-driving'>Driving</label>
    <input
      id='mapbox-directions-profile-walking'
      type='radio'
      name='profile'
      value='mapbox/walking'
      <% if (profile === 'mapbox/walking') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-walking'>Walking</label>
    <input
      id='mapbox-directions-profile-cycling'
      type='radio'
      name='profile'
      value='mapbox/cycling'
      <% if (profile === 'mapbox/cycling') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-cycling'>Cycling</label>
  </div>
  <% } %>
</div>
`),V=function(){function F(D,$,J,ct){B(this,F);var st=$.getState(),yt=st.originQuery,ut=st.destinationQuery,N=st.profile,et=st.controls;D.innerHTML=tt({originQuery:yt,destinationQuery:ut,profile:N,controls:et}),this.container=D,this.actions=J,this.store=$,this._map=ct,this.onAdd(),this.render()}return H(F,[{key:"animateToCoordinates",value:function($,J){var ct=this.store.getState(),st=ct.origin,yt=ct.destination,ut=ct.routePadding;if(st.geometry&&yt.geometry&&!(0,M.default)(st.geometry,yt.geometry)){var N=(0,E.default)({type:"FeatureCollection",features:[st,yt]});this._map.fitBounds([[N[0],N[1]],[N[2],N[3]]],{padding:ut})}else this._map.flyTo({center:J})}},{key:"onAdd",value:function(){var $=this,J=this.actions,ct=J.clearOrigin,st=J.clearDestination,yt=J.createOrigin,ut=J.createDestination,N=J.setProfile,et=J.reverse,Mt=this.store.getState(),Lt=Mt.geocoder,it=Mt.accessToken,Tt=Mt.flyTo,Vt=Mt.placeholderOrigin,ne=Mt.placeholderDestination,Et=Mt.zoom;this.originInput=new y.default(Object.assign({},{accessToken:it},Lt,{flyTo:Tt,placeholder:Vt,zoom:Et}));var $t=this.originInput.onAdd(this._map),ee=this.container.querySelector("#mapbox-directions-origin-input");ee.appendChild($t),this.destinationInput=new y.default(Object.assign({},{accessToken:it},Lt,{flyTo:Tt,placeholder:ne,zoom:Et}));var Ee=this.destinationInput.onAdd(this._map);this.container.querySelector("#mapbox-directions-destination-input").appendChild(Ee),this.originInput.on("result",function(Le){var we=Le.result.center;yt(we),$.animateToCoordinates("origin",we)}),this.originInput.on("clear",ct),this.destinationInput.on("result",function(Le){var we=Le.result.center;ut(we),$.animateToCoordinates("destination",we)}),this.destinationInput.on("clear",st);var jt=this.container.querySelectorAll('input[type="radio"]');Array.prototype.forEach.call(jt,function(Le){Le.addEventListener("change",function(){N(Le.value)})}),this.container.querySelector(".js-reverse-inputs").addEventListener("click",function(){var Le=$.store.getState(),we=Le.origin,kt=Le.destination;we&&$.actions.queryDestination(we.geometry.coordinates),kt&&$.actions.queryOrigin(kt.geometry.coordinates),et()})}},{key:"render",value:function(){var $=this;this.store.subscribe(function(){var J=$.store.getState(),ct=J.originQuery,st=J.destinationQuery,yt=J.originQueryCoordinates,ut=J.destinationQueryCoordinates;ct&&($.originInput.query(ct),$.actions.queryOrigin(null)),st&&($.destinationInput.query(st),$.actions.queryDestination(null)),yt&&($.originInput.setInput(yt),$.animateToCoordinates("origin",yt),$.actions.queryOriginCoordinates(null)),ut&&($.destinationInput.setInput(ut),$.animateToCoordinates("destination",ut),$.actions.queryDestinationCoordinates(null))})}}]),F}();g.default=V},{"./geocoder":27,"lodash.isequal":11,"lodash.template":12,"turf-extent":22}],29:[function(h,f,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var y=E(h("../utils")),b=E(h("lodash.template")),M=E(h("lodash.isequal"));function E(F){return F&&F.__esModule?F:{default:F}}function C(F){"@babel/helpers - typeof";return C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},C(F)}function L(F,D){if(!(F instanceof D))throw new TypeError("Cannot call a class as a function")}function B(F,D){for(var $=0;$<D.length;$++){var J=D[$];J.enumerable=J.enumerable||!1,J.configurable=!0,"value"in J&&(J.writable=!0),Object.defineProperty(F,H(J.key),J)}}function z(F,D,$){return D&&B(F.prototype,D),$&&B(F,$),Object.defineProperty(F,"prototype",{writable:!1}),F}function H(F){var D=U(F,"string");return C(D)==="symbol"?D:String(D)}function U(F,D){if(C(F)!=="object"||F===null)return F;var $=F[Symbol.toPrimitive];if($!==void 0){var J=$.call(F,D||"default");if(C(J)!=="object")return J;throw new TypeError("@@toPrimitive must return a primitive value.")}return(D==="string"?String:Number)(F)}var q=(0,b.default)(`<div class='directions-control directions-control-directions'>
  <div class='mapbox-directions-component mapbox-directions-route-summary<% if (routes > 1) { %> mapbox-directions-multiple<% } %>'>
    <% if (routes > 1) { %>
    <div class='mapbox-directions-routes mapbox-directions-clearfix'>
      <% for (var i = 0; i < routes; i++) { %>
        <input type='radio' name='routes' id='<%= i %>' <% if (i === routeIndex) { %>checked<% } %>>
        <label for='<%= i %>' class='mapbox-directions-route'><%= i + 1 %></label>
      <% } %>
    </div>
    <% } %>
    <h1><%- duration %></h1>
    <span><%- distance %></span>
  </div>

  <div class='mapbox-directions-instructions'>
    <div class='mapbox-directions-instructions-wrapper'>
      <ol class='mapbox-directions-steps'>
        <% steps.forEach(function(step) { %>
          <%
            var distance = step.distance ? format(step.distance) : false;
            var icon = step.maneuver.modifier ? step.maneuver.modifier.replace(/\\s+/g, '-').toLowerCase() : step.maneuver.type.replace(/\\s+/g, '-').toLowerCase();

            if (['arrive', 'depart', 'waypoint'].includes(step.maneuver.type)) {
              icon = step.maneuver.type;
            }

            if (step.maneuver.type === 'roundabout' || step.maneuver.type === 'rotary') {
              icon = 'roundabout';
            }

            var lng = step.maneuver.location[0];
            var lat = step.maneuver.location[1];
          %>
          <li
            data-lat='<%= lat %>'
            data-lng='<%= lng %>'
            class='mapbox-directions-step'>
            <span class='directions-icon directions-icon-<%= icon %>'></span>
            <div class='mapbox-directions-step-maneuver'>
              <%= step.maneuver.instruction %>
            </div>
            <% if (distance) { %>
              <div class='mapbox-directions-step-distance'>
                <%= distance %>
              </div>
            <% } %>
          </li>
        <% }); %>
      </ol>
    </div>
  </div>
</div>
`),tt=(0,b.default)(`<div class='directions-control directions-control-directions'>
  <div class='mapbox-directions-error'>
    <%= error %>
  </div>
</div>
`),V=function(){function F(D,$,J,ct){L(this,F),this.container=D,this.actions=J,this.store=$,this._map=ct,this.directions={},this.render()}return z(F,[{key:"render",value:function(){var $=this;this.store.subscribe(function(){var J=$.actions,ct=J.hoverMarker,st=J.setRouteIndex,yt=$.store.getState(),ut=yt.routeIndex,N=yt.unit,et=yt.directions,Mt=yt.error,Lt=yt.compile,it=!(0,M.default)(et[ut],$.directions);if(Mt){$.container.innerHTML=tt({error:Mt});return}if(et.length&&it){var Tt=$.directions=et[ut],Vt=y.default.getAllSteps(Tt);Lt&&Tt.legs.forEach(function($t){$t.steps.forEach(function(ee){ee.maneuver.instruction=Lt("en",ee)})}),$.container.innerHTML=q({routeIndex:ut,routes:et.length,steps:Vt,format:y.default.format[N],duration:y.default.format.duration(Tt.duration),distance:y.default.format[N](Tt.distance)});var ne=$.container.querySelectorAll(".mapbox-directions-step");Array.prototype.forEach.call(ne,function($t){var ee=$t.getAttribute("data-lng"),Ee=$t.getAttribute("data-lat");$t.addEventListener("mouseover",function(){ct([ee,Ee])}),$t.addEventListener("mouseout",function(){ct(null)}),$t.addEventListener("click",function(){$._map.flyTo({center:[ee,Ee],zoom:16})})});var Et=$.container.querySelectorAll('input[type="radio"]');Array.prototype.forEach.call(Et,function($t){$t.addEventListener("change",function(ee){st(parseInt(ee.target.id,10))})})}else $.container.innerHTML&&it&&($.container.innerHTML="")})}}]),F}();g.default=V},{"../utils":34,"lodash.isequal":11,"lodash.template":12}],30:[function(h,f,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var y=h("redux"),b=tt(h("redux-thunk")),M=h("@mapbox/polyline"),E=tt(h("./utils")),C=tt(h("./reducers")),L=q(h("./actions")),B=tt(h("./directions_style")),z=tt(h("./controls/inputs")),H=tt(h("./controls/instructions"));function U(yt){if(typeof WeakMap!="function")return null;var ut=new WeakMap,N=new WeakMap;return(U=function(Mt){return Mt?N:ut})(yt)}function q(yt,ut){if(!ut&&yt&&yt.__esModule)return yt;if(yt===null||V(yt)!=="object"&&typeof yt!="function")return{default:yt};var N=U(ut);if(N&&N.has(yt))return N.get(yt);var et={},Mt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Lt in yt)if(Lt!=="default"&&Object.prototype.hasOwnProperty.call(yt,Lt)){var it=Mt?Object.getOwnPropertyDescriptor(yt,Lt):null;it&&(it.get||it.set)?Object.defineProperty(et,Lt,it):et[Lt]=yt[Lt]}return et.default=yt,N&&N.set(yt,et),et}function tt(yt){return yt&&yt.__esModule?yt:{default:yt}}function V(yt){"@babel/helpers - typeof";return V=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ut){return typeof ut}:function(ut){return ut&&typeof Symbol=="function"&&ut.constructor===Symbol&&ut!==Symbol.prototype?"symbol":typeof ut},V(yt)}function F(yt,ut){if(!(yt instanceof ut))throw new TypeError("Cannot call a class as a function")}function D(yt,ut){for(var N=0;N<ut.length;N++){var et=ut[N];et.enumerable=et.enumerable||!1,et.configurable=!0,"value"in et&&(et.writable=!0),Object.defineProperty(yt,J(et.key),et)}}function $(yt,ut,N){return ut&&D(yt.prototype,ut),N&&D(yt,N),Object.defineProperty(yt,"prototype",{writable:!1}),yt}function J(yt){var ut=ct(yt,"string");return V(ut)==="symbol"?ut:String(ut)}function ct(yt,ut){if(V(yt)!=="object"||yt===null)return yt;var N=yt[Symbol.toPrimitive];if(N!==void 0){var et=N.call(yt,ut||"default");if(V(et)!=="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return(ut==="string"?String:Number)(yt)}var st=function(){function yt(ut){F(this,yt),this._store=this._initStore(),this.actions=(0,y.bindActionCreators)(L,this._store.dispatch),this.actions.setOptions(ut||{}),this.options=ut||{},this.onDragDown=this._onDragDown.bind(this),this.onDragMove=this._onDragMove.bind(this),this.onDragUp=this._onDragUp.bind(this),this.move=this._move.bind(this),this.onClick=this._clickHandler().bind(this)}return $(yt,[{key:"onAdd",value:function(N){var et=this;this._map=N;var Mt=this._store.getState(),Lt=Mt.controls,it=this.container=document.createElement("div");it.className="mapboxgl-ctrl-directions mapboxgl-ctrl";var Tt=document.createElement("div");Tt.className="directions-control directions-control-inputs",new z.default(Tt,this._store,this.actions,this._map);var Vt=document.createElement("div");return Vt.className="directions-control directions-control-instructions",new H.default(Vt,this._store,{hoverMarker:this.actions.hoverMarker,setRouteIndex:this.actions.setRouteIndex},this._map),Lt.inputs&&it.appendChild(Tt),Lt.instructions&&it.appendChild(Vt),this.subscribedActions(),this._map.loaded()?this.mapState():this._map.on("load",function(){return et.mapState()}),it}},{key:"onRemove",value:function(N){return this.container.parentNode.removeChild(this.container),this.removeRoutes(),N.off("mousedown",this.onDragDown),N.off("mousemove",this.move),N.off("touchstart",this.onDragDown),N.off("touchstart",this.move),N.off("click",this.onClick),this.storeUnsubscribe&&(this.storeUnsubscribe(),delete this.storeUnsubscribe),B.default.forEach(function(et){N.getLayer(et.id)&&N.removeLayer(et.id)}),N.getSource("directions")&&N.removeSource("directions"),this._map=null,this}},{key:"mapState",value:function(){var N=this,et=this._store.getState(),Mt=et.profile;et.alternatives,et.congestion;var Lt=et.styles,it=et.interactive;et.compile,this.actions.eventEmit("profile",{profile:Mt});var Tt={type:"geojson",data:{type:"FeatureCollection",features:[]}};this._map.addSource("directions",Tt),Lt&&Lt.length&&Lt.forEach(function(Vt){return N._map.addLayer(Vt)}),B.default.forEach(function(Vt){N._map.getLayer(Vt.id)||N._map.addLayer(Vt)}),it&&(this._map.on("mousedown",this.onDragDown),this._map.on("mousemove",this.move),this._map.on("click",this.onClick),this._map.on("touchstart",this.move),this._map.on("touchstart",this.onDragDown))}},{key:"subscribedActions",value:function(){var N=this;this.storeUnsubscribe=this._store.subscribe(function(){var et=N._store.getState(),Mt=et.origin,Lt=et.destination,it=et.hoverMarker,Tt=et.directions,Vt=et.routeIndex,ne={type:"FeatureCollection",features:[Mt,Lt,it].filter(function(Et){return Et.geometry})};Tt.length&&Tt.forEach(function(Et,$t){var ee=[],Ee=(0,M.decode)(Et.geometry,5).map(function(Le){return Le.reverse()}),jt=E.default.getAllSteps(Et);Ee.forEach(function(Le,we){var kt=ee[ee.length-1],Xt=Et.legs[0].annotation&&Et.legs[0].annotation.congestion&&Et.legs[0].annotation.congestion[we-1];if(kt&&(!Xt||kt.properties.congestion===Xt))kt.geometry.coordinates.push(Le);else{var Ot={geometry:{type:"LineString",coordinates:[]},properties:{"route-index":$t,route:$t===Vt?"selected":"alternate"}};kt&&Ot.geometry.coordinates.push(kt.geometry.coordinates[kt.geometry.coordinates.length-1]),Ot.geometry.coordinates.push(Le),Xt&&(Ot.properties.congestion=Et.legs[0].annotation.congestion[we-1]),ee.push(Ot)}}),ne.features=ne.features.concat(ee),$t===Vt&&jt.forEach(function(Le){Le.maneuver.type==="waypoint"&&ne.features.push({type:"Feature",geometry:{type:"Point",coordinates:Le.maneuver.location},properties:{id:"waypoint"}})})}),N._map.style&&N._map.getSource("directions")&&N._map.getSource("directions").setData(ne)})}},{key:"_initStore",value:function(){var N=(0,y.applyMiddleware)(b.default)(y.createStore);return N(C.default)}},{key:"_clickHandler",value:function(){var N=null,et=250;return function(Mt){if(N)clearTimeout(N),N=null,this._map.zoomIn();else{var Lt=this._onSingleClick.bind(this);N=setTimeout(function(){Lt(Mt),N=null},et)}}}},{key:"_onSingleClick",value:function(N){var et=this,Mt=this._store.getState(),Lt=Mt.origin,it=[N.lngLat.lng,N.lngLat.lat];if(!Lt.geometry)this.actions.setOriginFromCoordinates(it);else{var Tt=this._map.queryRenderedFeatures(N.point,{layers:["directions-origin-point","directions-destination-point","directions-waypoint-point","directions-route-line-alt"]});if(Tt.length){if(Tt.forEach(function(ne){ne.layer.id==="directions-waypoint-point"&&et.actions.removeWaypoint(ne)}),Tt[0].properties.route==="alternate"){var Vt=Tt[0].properties["route-index"];this.actions.setRouteIndex(Vt)}}else this.actions.setDestinationFromCoordinates(it),this._map.flyTo({center:it})}}},{key:"_move",value:function(N){var et=this,Mt=this._store.getState(),Lt=Mt.hoverMarker,it=this._map.queryRenderedFeatures(N.point,{layers:["directions-route-line-alt","directions-route-line","directions-origin-point","directions-destination-point","directions-hover-point"]});this._map.getCanvas().style.cursor=it.length?"pointer":"",it.length?(this.isCursorOverPoint=it[0],this._map.dragPan.disable(),it.forEach(function(Tt){Tt.layer.id==="directions-route-line"?et.actions.hoverMarker([N.lngLat.lng,N.lngLat.lat]):Lt.geometry&&et.actions.hoverMarker(null)})):this.isCursorOverPoint&&(this.isCursorOverPoint=!1,this._map.dragPan.enable())}},{key:"_onDragDown",value:function(){this.isCursorOverPoint&&(this.isDragging=this.isCursorOverPoint,this._map.getCanvas().style.cursor="grab",this._map.on("mousemove",this.onDragMove),this._map.on("mouseup",this.onDragUp),this._map.on("touchmove",this.onDragMove),this._map.on("touchend",this.onDragUp))}},{key:"_onDragMove",value:function(N){if(this.isDragging){var et=[N.lngLat.lng,N.lngLat.lat];switch(this.isDragging.layer.id){case"directions-origin-point":this.actions.createOrigin(et);break;case"directions-destination-point":this.actions.createDestination(et);break;case"directions-hover-point":this.actions.hoverMarker(et);break}}}},{key:"_onDragUp",value:function(){if(this.isDragging){var N=this._store.getState(),et=N.hoverMarker,Mt=N.origin,Lt=N.destination;switch(this.isDragging.layer.id){case"directions-origin-point":this.actions.setOriginFromCoordinates(Mt.geometry.coordinates);break;case"directions-destination-point":this.actions.setDestinationFromCoordinates(Lt.geometry.coordinates);break;case"directions-hover-point":et.geometry&&!E.default.coordinateMatch(this.isDragging,et)&&this.actions.addWaypoint(0,et);break}this.isDragging=!1,this._map.getCanvas().style.cursor="",this._map.off("touchmove",this.onDragMove),this._map.off("touchend",this.onDragUp),this._map.off("mousemove",this.onDragMove),this._map.off("mouseup",this.onDragUp)}}},{key:"interactive",value:function(N){return N?(this._map.on("touchstart",this.move),this._map.on("touchstart",this.onDragDown),this._map.on("mousedown",this.onDragDown),this._map.on("mousemove",this.move),this._map.on("click",this.onClick)):(this._map.off("touchstart",this.move),this._map.off("touchstart",this.onDragDown),this._map.off("mousedown",this.onDragDown),this._map.off("mousemove",this.move),this._map.off("click",this.onClick)),this}},{key:"getOrigin",value:function(){return this._store.getState().origin}},{key:"setOrigin",value:function(N){return typeof N=="string"?this.actions.queryOrigin(N):this.actions.setOriginFromCoordinates(N),this}},{key:"getDestination",value:function(){return this._store.getState().destination}},{key:"setDestination",value:function(N){return typeof N=="string"?this.actions.queryDestination(N):this.actions.setDestinationFromCoordinates(N),this}},{key:"reverse",value:function(){return this.actions.reverse(),this}},{key:"addWaypoint",value:function(N,et){return et.type||(et=E.default.createPoint(et,{id:"waypoint"})),this.actions.addWaypoint(N,et),this}},{key:"setWaypoint",value:function(N,et){return et.type||(et=E.default.createPoint(et,{id:"waypoint"})),this.actions.setWaypoint(N,et),this}},{key:"removeWaypoint",value:function(N){var et=this._store.getState(),Mt=et.waypoints;return this.actions.removeWaypoint(Mt[N]),this}},{key:"getWaypoints",value:function(){return this._store.getState().waypoints}},{key:"removeRoutes",value:function(){return this.actions.clearOrigin(),this.actions.clearDestination(),this}},{key:"on",value:function(N,et){return this.actions.eventSubscribe(N,et),this}}]),yt}();g.default=st},{"./actions":25,"./controls/inputs":28,"./controls/instructions":29,"./directions_style":31,"./reducers":33,"./utils":34,"@mapbox/polyline":6,redux:18,"redux-thunk":17}],31:[function(h,f,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var y=[{id:"directions-route-line-alt",type:"line",source:"directions",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#bbb","line-width":4},filter:["all",["in","$type","LineString"],["in","route","alternate"]]},{id:"directions-route-line-casing",type:"line",source:"directions",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#2d5f99","line-width":12},filter:["all",["in","$type","LineString"],["in","route","selected"]]},{id:"directions-route-line",type:"line",source:"directions",layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":{property:"congestion",type:"categorical",default:"#4882c5",stops:[["unknown","#4882c5"],["low","#4882c5"],["moderate","#f09a46"],["heavy","#e34341"],["severe","#8b2342"]]},"line-width":7},filter:["all",["in","$type","LineString"],["in","route","selected"]]},{id:"directions-hover-point-casing",type:"circle",source:"directions",paint:{"circle-radius":8,"circle-color":"#fff"},filter:["all",["in","$type","Point"],["in","id","hover"]]},{id:"directions-hover-point",type:"circle",source:"directions",paint:{"circle-radius":6,"circle-color":"#3bb2d0"},filter:["all",["in","$type","Point"],["in","id","hover"]]},{id:"directions-waypoint-point-casing",type:"circle",source:"directions",paint:{"circle-radius":8,"circle-color":"#fff"},filter:["all",["in","$type","Point"],["in","id","waypoint"]]},{id:"directions-waypoint-point",type:"circle",source:"directions",paint:{"circle-radius":6,"circle-color":"#8a8bc9"},filter:["all",["in","$type","Point"],["in","id","waypoint"]]},{id:"directions-origin-point",type:"circle",source:"directions",paint:{"circle-radius":18,"circle-color":"#3bb2d0"},filter:["all",["in","$type","Point"],["in","marker-symbol","A"]]},{id:"directions-origin-label",type:"symbol",source:"directions",layout:{"text-field":"A","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#fff"},filter:["all",["in","$type","Point"],["in","marker-symbol","A"]]},{id:"directions-destination-point",type:"circle",source:"directions",paint:{"circle-radius":18,"circle-color":"#8a8bc9"},filter:["all",["in","$type","Point"],["in","marker-symbol","B"]]},{id:"directions-destination-label",type:"symbol",source:"directions",layout:{"text-field":"B","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#fff"},filter:["all",["in","$type","Point"],["in","marker-symbol","B"]]}],b=y;g.default=b},{}],32:[function(h,f,g){var y=b(h("./directions"));function b(M){return M&&M.__esModule?M:{default:M}}f.exports=y.default},{"./directions":30}],33:[function(h,f,g){function y(U){"@babel/helpers - typeof";return y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},y(U)}Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var b=L(h("../constants/action_types.js")),M=E(h("merge-options"));function E(U){return U&&U.__esModule?U:{default:U}}function C(U){if(typeof WeakMap!="function")return null;var q=new WeakMap,tt=new WeakMap;return(C=function(F){return F?tt:q})(U)}function L(U,q){if(!q&&U&&U.__esModule)return U;if(U===null||y(U)!=="object"&&typeof U!="function")return{default:U};var tt=C(q);if(tt&&tt.has(U))return tt.get(U);var V={},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var D in U)if(D!=="default"&&Object.prototype.hasOwnProperty.call(U,D)){var $=F?Object.getOwnPropertyDescriptor(U,D):null;$&&($.get||$.set)?Object.defineProperty(V,D,$):V[D]=U[D]}return V.default=U,tt&&tt.set(U,V),V}var B=function(){return{api:"https://api.mapbox.com/directions/v5/",profile:"mapbox/driving-traffic",alternatives:!1,congestion:!1,unit:"imperial",flyTo:!0,placeholderOrigin:"Choose a starting place",placeholderDestination:"Choose destination",zoom:16,language:"en",compile:null,proximity:!1,styles:[],controls:{profileSwitcher:!0,inputs:!0,instructions:!0},geocoder:{},interactive:!0,events:{},origin:{},destination:{},hoverMarker:{},waypoints:[],originQuery:null,destinationQuery:null,originQueryCoordinates:null,destinationQueryCoordinates:null,directions:[],fetchDirectionsRequest:null,routeIndex:0,routePadding:80}};function z(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:B(),q=arguments.length>1?arguments[1]:void 0;switch(q.type){case b.SET_OPTIONS:return(0,M.default)({},U,q.options);case b.DIRECTIONS_PROFILE:return Object.assign({},U,{profile:q.profile});case b.ORIGIN:return Object.assign({},U,{origin:q.origin,hoverMarker:{}});case b.DESTINATION:return Object.assign({},U,{destination:q.destination,hoverMarker:{}});case b.HOVER_MARKER:return Object.assign({},U,{hoverMarker:q.hoverMarker});case b.WAYPOINTS:return Object.assign({},U,{waypoints:q.waypoints});case b.ORIGIN_QUERY:return Object.assign({},U,{originQuery:q.query});case b.DESTINATION_QUERY:return Object.assign({},U,{destinationQuery:q.query});case b.ORIGIN_FROM_COORDINATES:return Object.assign({},U,{originQueryCoordinates:q.coordinates});case b.DESTINATION_FROM_COORDINATES:return Object.assign({},U,{destinationQueryCoordinates:q.coordinates});case b.ORIGIN_CLEAR:return Object.assign({},U,{origin:{},originQuery:"",waypoints:[],directions:[]});case b.DESTINATION_CLEAR:return Object.assign({},U,{destination:{},destinationQuery:"",waypoints:[],directions:[]});case b.DIRECTIONS_REQUEST_START:return Object.assign({},U,{fetchDirectionsRequest:q.request});case b.DIRECTIONS:return Object.assign({},U,{directions:q.directions,fetchDirectionsRequest:null});case b.ROUTE_INDEX:return Object.assign({},U,{routeIndex:q.routeIndex});case b.ERROR:return Object.assign({},U,{error:q.error});default:return U}}var H=z;g.default=H},{"../constants/action_types.js":26,"merge-options":14}],34:[function(h,f,g){Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;function y(H){return H[0]>=-180&&H[0]<=180&&H[1]>=-90&&H[1]<=90}function b(H,U){return H=H.geometry.coordinates,U=U.geometry.coordinates,H.join()===U.join()||H[0].toFixed(3)===U[0].toFixed(3)&&H[1].toFixed(3)===U[1].toFixed(3)}function M(H){var U=360,q=((H- -180)%U+U)%U+-180;return q===-180?180:q}function E(H,U){var q=0;return Math.floor(U)!==U&&(q=U.toString().split(".")[1].length),H.toFixed(Math.min(q,5))}function C(H,U){return{type:"Feature",geometry:{type:"Point",coordinates:H},properties:U||{}}}function L(H){return H.legs.reduce(function(U,q,tt){return tt>0&&(U[U.length-1].maneuver.type="waypoint",q.steps[0].maneuver.type=""),U.concat(q.steps)},[])}var B={duration:function(U){var q=Math.floor(U/60),tt=Math.floor(q/60);return U%=60,q%=60,tt===0&&q===0?U+"s":tt===0?q+"min":tt+"h "+q+"min"},imperial:function(U){var q=U/1609.344;return q>=100?q.toFixed(0)+"mi":q>=10?q.toFixed(1)+"mi":q>=.1?q.toFixed(2)+"mi":(q*5280).toFixed(0)+"ft"},metric:function(U){return U>=1e5?(U/1e3).toFixed(0)+"km":U>=1e4?(U/1e3).toFixed(1)+"km":U>=100?(U/1e3).toFixed(2)+"km":U.toFixed(0)+"m"}},z={format:B,coordinateMatch:b,createPoint:C,validCoords:y,wrap:M,roundWithOriginalPrecision:E,getAllSteps:L};g.default=z},{}]},{},[32])(32)})})(IB);var Unt=IB.exports;const $nt=$p(Unt);function Vnt(){const i=[[-97.762752,30.225416],[-97.745457,30.235323]];return lt.useEffect(()=>{qc.accessToken="pk.eyJ1IjoibXJkZWVkcyIsImEiOiJjbHB0aTIxaHYwYmRyMmtyb3p5aWRzdDY1In0.iqVP1-QJmTJ6KER883blXA";const s=new qc.Map({container:"map-container",style:"mapbox://styles/mapbox/streets-v11",center:[-97.753537,30.229543],zoom:17,maxBounds:i,maxBoundsViscosity:.8,bearing:30}),h=new jnt({accessToken:qc.accessToken,mapboxgl:qc});document.getElementById("search-bar").appendChild(h.onAdd(s));const f=new $nt({accessToken:qc.accessToken,unit:"metric",profile:"mapbox.driving",controls:{instructions:!0}});return s.addControl(f,"top-left"),s.on("load",()=>{s.addLayer({id:"poi-markers",type:"symbol",source:"composite","source-layer":"poi_label",layout:{"icon-image":"{maki}-15","icon-allow-overlap":!0,"icon-size":1.5},paint:{"icon-color":"#FF6347"}}),s.on("click","poi-markers",g=>{const y=g.features[0].geometry.coordinates.slice(),b=g.features[0].properties.name;new qc.Popup().setLngLat(y).setHTML(`<h3>${b}</h3>`).addTo(s)}),s.on("mouseenter","poi-markers",()=>{s.getCanvas().style.cursor="pointer"}),s.on("mouseleave","poi-markers",()=>{s.getCanvas().style.cursor=""})}),navigator.geolocation&&navigator.geolocation.getCurrentPosition(g=>{const y=[g.coords.longitude,g.coords.latitude];new qc.Marker().setLngLat(y).addTo(s)}),()=>s.remove()},[]),rt.jsxs("div",{className:"map-wrapper",children:[rt.jsx("div",{className:"search-bar-wrapper",children:rt.jsx("div",{id:"search-bar"})}),rt.jsx("div",{className:"map-container-wrapper",children:rt.jsx("div",{id:"map-container",style:{width:"100%",height:"600px"}})})]})}function Gnt(){const[i,s]=lt.useState(""),[h,f]=lt.useState(""),[g,y]=lt.useState(""),[b,M]=lt.useState(""),[E,C]=lt.useState(0),[L,B]=lt.useState(S5),[z,H]=lt.useState(!1),[U,q]=lt.useState(0),[tt,V]=lt.useState(0),[F,D]=lt.useState(0),$=et=>{const Mt=et.target.files[0],Lt=new FileReader;Lt.onload=()=>{B(Lt.result)},Mt&&Lt.readAsDataURL(Mt)},J=()=>{H(!z)},ct=()=>{H(!1)},st=et=>{et.target.value.length<=50&&s(et.target.value)},yt=et=>{const Mt=et.target.value;Mt.length<=50&&(f(Mt),q(Mt.length))},ut=et=>{const Mt=et.target.value;Mt.length<=50&&(y(Mt),V(Mt.length))},N=et=>{const Mt=et.target.value;Mt.length<=50&&(M(Mt),D(Mt.length))};return rt.jsx("div",{className:"account",children:rt.jsxs("div",{className:"account-info",children:[rt.jsx("h2",{children:"Account Information"}),rt.jsx("div",{className:"profile-picture",children:z?rt.jsxs("div",{children:[rt.jsx("p",{children:rt.jsx("strong",{children:"Profile Picture:"})}),rt.jsx("input",{type:"file",accept:"image/*",onChange:$})]}):L?rt.jsx("img",{src:L,alt:"Profile"}):rt.jsx("p",{children:"No profile picture"})}),rt.jsxs("div",{className:"form",children:[rt.jsx("p",{children:rt.jsx("strong",{children:z?rt.jsxs("span",{children:[rt.jsx("label",{htmlFor:"username",children:"Username:"}),rt.jsx("input",{type:"text",id:"username",value:i,onChange:st}),rt.jsx("p",{className:"char-field",children:`${i.length}/50`})]}):`Username: ${i}`})}),rt.jsxs("div",{className:"account-details",children:[rt.jsx("div",{className:"followerCount",children:!z&&rt.jsxs("p",{children:[rt.jsx("strong",{children:"Friends:"})," ",E]})}),rt.jsxs("p",{children:[rt.jsx("strong",{children:"Name:"})," ",z?rt.jsxs("span",{children:[rt.jsx("input",{type:"text",value:h,onChange:yt}),rt.jsx("p",{className:"char-field",children:`${U}/50`})]}):` ${h}`]}),rt.jsxs("p",{children:[rt.jsx("strong",{children:"Major:"})," ",z?rt.jsxs("span",{children:[rt.jsx("input",{type:"text",value:g,onChange:ut}),rt.jsx("p",{className:"char-field",children:`${tt}/50`})]}):`${g}`]}),rt.jsxs("p",{children:[rt.jsx("strong",{children:"Class :"})," ",z?rt.jsxs("span",{children:[rt.jsx("input",{type:"text",value:b,onChange:N}),rt.jsx("p",{className:"char-field",children:`${F}/50`})]}):` ${b}`]})]})]}),rt.jsx("div",{className:"button-container",children:z?rt.jsx("button",{onClick:ct,children:"Save"}):rt.jsx("button",{onClick:J,children:"Edit"})})]})})}var AB={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},FT=Xr.createContext&&Xr.createContext(AB),Wnt=["attr","size","title"];function qnt(i,s){if(i==null)return{};var h=Hnt(i,s),f,g;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(i);for(g=0;g<y.length;g++)f=y[g],!(s.indexOf(f)>=0)&&Object.prototype.propertyIsEnumerable.call(i,f)&&(h[f]=i[f])}return h}function Hnt(i,s){if(i==null)return{};var h={},f=Object.keys(i),g,y;for(y=0;y<f.length;y++)g=f[y],!(s.indexOf(g)>=0)&&(h[g]=i[g]);return h}function $y(){return $y=Object.assign?Object.assign.bind():function(i){for(var s=1;s<arguments.length;s++){var h=arguments[s];for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(i[f]=h[f])}return i},$y.apply(this,arguments)}function W3(i,s){var h=Object.keys(i);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(i);s&&(f=f.filter(function(g){return Object.getOwnPropertyDescriptor(i,g).enumerable})),h.push.apply(h,f)}return h}function Vy(i){for(var s=1;s<arguments.length;s++){var h=arguments[s]!=null?arguments[s]:{};s%2?W3(Object(h),!0).forEach(function(f){Znt(i,f,h[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(h)):W3(Object(h)).forEach(function(f){Object.defineProperty(i,f,Object.getOwnPropertyDescriptor(h,f))})}return i}function Znt(i,s,h){return s=Xnt(s),s in i?Object.defineProperty(i,s,{value:h,enumerable:!0,configurable:!0,writable:!0}):i[s]=h,i}function Xnt(i){var s=Knt(i,"string");return typeof s=="symbol"?s:String(s)}function Knt(i,s){if(typeof i!="object"||i===null)return i;var h=i[Symbol.toPrimitive];if(h!==void 0){var f=h.call(i,s||"default");if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(i)}function PB(i){return i&&i.map((s,h)=>Xr.createElement(s.tag,Vy({key:h},s.attr),PB(s.child)))}function Tu(i){return s=>Xr.createElement(Ynt,$y({attr:Vy({},i.attr)},s),PB(i.child))}function Ynt(i){var s=h=>{var{attr:f,size:g,title:y}=i,b=qnt(i,Wnt),M=g||h.size||"1em",E;return h.className&&(E=h.className),i.className&&(E=(E?E+" ":"")+i.className),Xr.createElement("svg",$y({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},h.attr,f,b,{className:E,style:Vy(Vy({color:i.color||h.color},h.style),i.style),height:M,width:M,xmlns:"http://www.w3.org/2000/svg"}),y&&Xr.createElement("title",null,y),i.children)};return FT!==void 0?Xr.createElement(FT.Consumer,null,h=>s(h)):s(AB)}function Qnt(i){return Tu({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"},child:[]}]})(i)}function Jnt(i){return Tu({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M288 0c-69.59 0-126 56.41-126 126 0 56.26 82.35 158.8 113.9 196.02 6.39 7.54 17.82 7.54 24.2 0C331.65 284.8 414 182.26 414 126 414 56.41 357.59 0 288 0zm0 168c-23.2 0-42-18.8-42-42s18.8-42 42-42 42 18.8 42 42-18.8 42-42 42zM20.12 215.95A32.006 32.006 0 0 0 0 245.66v250.32c0 11.32 11.43 19.06 21.94 14.86L160 448V214.92c-8.84-15.98-16.07-31.54-21.25-46.42L20.12 215.95zM288 359.67c-14.07 0-27.38-6.18-36.51-16.96-19.66-23.2-40.57-49.62-59.49-76.72v182l192 64V266c-18.92 27.09-39.82 53.52-59.49 76.72-9.13 10.77-22.44 16.95-36.51 16.95zm266.06-198.51L416 224v288l139.88-55.95A31.996 31.996 0 0 0 576 426.34V176.02c0-11.32-11.43-19.06-21.94-14.86z"},child:[]}]})(i)}function trt(i){return Tu({tag:"svg",attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"},child:[]}]})(i)}function ert(i){return Tu({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 336H54a6 6 0 0 1-6-6V118a6 6 0 0 1 6-6h404a6 6 0 0 1 6 6v276a6 6 0 0 1-6 6zM128 152c-22.091 0-40 17.909-40 40s17.909 40 40 40 40-17.909 40-40-17.909-40-40-40zM96 352h320v-80l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L192 304l-39.515-39.515c-4.686-4.686-12.284-4.686-16.971 0L96 304v48z"},child:[]}]})(i)}function nrt(i){return Tu({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M946.5 505L534.6 93.4a31.93 31.93 0 0 0-45.2 0L77.5 505c-12 12-18.8 28.3-18.8 45.3 0 35.3 28.7 64 64 64h43.4V908c0 17.7 14.3 32 32 32H448V716h112v224h265.9c17.7 0 32-14.3 32-32V614.3h43.4c17 0 33.3-6.7 45.3-18.8 24.9-25 24.9-65.5-.1-90.5z"},child:[]}]})(i)}function rrt(i){return Tu({tag:"svg",attr:{viewBox:"0 0 1024 1024",fill:"currentColor",fillRule:"evenodd"},child:[{tag:"path",attr:{d:"M799.855 166.312c.023.007.043.018.084.059l57.69 57.69c.041.041.052.06.059.084a.118.118 0 0 1 0 .069c-.007.023-.018.042-.059.083L569.926 512l287.703 287.703c.041.04.052.06.059.083a.118.118 0 0 1 0 .07c-.007.022-.018.042-.059.083l-57.69 57.69c-.041.041-.06.052-.084.059a.118.118 0 0 1-.069 0c-.023-.007-.042-.018-.083-.059L512 569.926 224.297 857.629c-.04.041-.06.052-.083.059a.118.118 0 0 1-.07 0c-.022-.007-.042-.018-.083-.059l-57.69-57.69c-.041-.041-.052-.06-.059-.084a.118.118 0 0 1 0-.069c.007-.023.018-.042.059-.083L454.073 512 166.371 224.297c-.041-.04-.052-.06-.059-.083a.118.118 0 0 1 0-.07c.007-.022.018-.042.059-.083l57.69-57.69c.041-.041.06-.052.084-.059a.118.118 0 0 1 .069 0c.023.007.042.018.083.059L512 454.073l287.703-287.702c.04-.041.06-.052.083-.059a.118.118 0 0 1 .07 0Z"},child:[]}]})(i)}function irt(i){return Tu({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0 0 42 42h216v494zM544 472c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v108H372c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h108v108c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V644h108c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V472z"},child:[]}]})(i)}function ort(){const[i,s]=lt.useState(0),[h,f]=lt.useState(""),[g,y]=lt.useState(""),[b,M]=lt.useState(""),[E,C]=lt.useState(""),[L,B]=lt.useState(""),z=D=>{s(D)},H=D=>{D.target.value.length<=50&&f(D.target.value)},U=D=>{D.target.value.length<=100&&y(D.target.value)},q=D=>{D.target.value.length<=50&&M(D.target.value)},tt=D=>{D.target.value.length<=50&&C(D.target.value)},V=D=>{D.target.value.length<=50&&B(D.target.value)},F=()=>{switch(i){case 0:return rt.jsx("div",{className:"create-post",children:rt.jsxs("div",{className:"initalCreatePage",children:[rt.jsx("h2",{children:"Choose What to Create:"}),rt.jsxs("div",{className:"btns",children:[rt.jsx("button",{className:"postBtn",onClick:()=>z(1),children:"Create Post"}),rt.jsx("button",{className:"eventBtn",onClick:()=>z(2),children:"Create Event"})]})]})});case 1:return rt.jsx("div",{className:"createPost",children:rt.jsx("div",{className:"form-containerPost",children:rt.jsxs("form",{children:[rt.jsx("div",{className:"addnewpost",children:rt.jsx("h2",{children:"Create a Post!"})}),rt.jsxs("div",{children:[rt.jsx("label",{htmlFor:"title",children:"Title:"}),rt.jsx("input",{type:"text",name:"title",placeholder:"Write Title Here.",value:h,onChange:H}),rt.jsx("p",{className:"title-char",children:`${h.length}/50`})]}),rt.jsxs("div",{children:[rt.jsx("label",{htmlFor:"description",children:"Description:"}),rt.jsx("input",{type:"text",name:"desc",placeholder:"Write Description Here.",value:g,onChange:U}),rt.jsx("p",{className:"desc-char",children:`${g.length}/100`})]}),rt.jsxs("div",{className:"file",children:[rt.jsx(ert,{}),rt.jsx("label",{htmlFor:"file",children:rt.jsx("input",{type:"file",name:"file",placeholder:"File"})})]}),rt.jsx("button",{className:"newpost-btn",children:"Post"})]})})});case 2:return rt.jsx("div",{className:"createPost",children:rt.jsx("div",{className:"form-container",children:rt.jsxs("form",{children:[rt.jsx("div",{className:"addnewevent",children:rt.jsx("h2",{children:"Create an Event!"})}),rt.jsxs("div",{children:[rt.jsx("label",{htmlFor:"title",children:"Title:"}),rt.jsx("input",{type:"text",name:"title",placeholder:"Write Title Here.",value:h,onChange:H}),rt.jsx("p",{className:"title-char",children:`${h.length}/50`})]}),rt.jsxs("div",{children:[rt.jsx("label",{htmlFor:"When",children:"When:"}),rt.jsx("input",{type:"text",name:"when",placeholder:"When is the event?",value:b,onChange:q}),rt.jsx("p",{className:"when-char",children:`${b.length}/50`})]}),rt.jsxs("div",{children:[rt.jsx("label",{htmlFor:"where",children:"Where:"}),rt.jsx("input",{type:"text",name:"where",placeholder:"Where is the event?",value:E,onChange:tt}),rt.jsx("p",{className:"where-char",children:`${E.length}/50`})]}),rt.jsxs("div",{children:[rt.jsx("label",{htmlFor:"what",children:"What:"}),rt.jsx("input",{type:"text",name:"what",placeholder:"What is this event?",value:L,onChange:V}),rt.jsx("p",{className:"what-char",children:`${L.length}/50`})]}),rt.jsx("button",{className:"newpost-btn",children:"Post"})]})})});default:return rt.jsxs("div",{className:"btns",children:[rt.jsx("h2",{children:"Choose an action:"}),rt.jsx("button",{className:"postBtn",onClick:()=>z(1),children:"Create Post"}),rt.jsx("button",{className:"eventBtn",onClick:()=>z(2),children:"Create Event"})]})}};return rt.jsx("div",{children:F()})}const srt=[{title:"Homepage",path:"/homepage",icon:rt.jsx(nrt,{}),cName:"side-text"},{title:"Account",path:"/account",icon:rt.jsx(trt,{}),cName:"side-text"},{title:"MapPage",path:"/mapPage",icon:rt.jsx(Jnt,{}),cName:"side-text"},{title:"Create Post",path:"/create-post",icon:rt.jsx(irt,{}),cName:"side-text"}],art="/assets/logo-TE2tukJr.png";function lrt(){const[i,s]=lt.useState(!1),h=()=>s(!i),f=()=>{console.log("User logged out")};return rt.jsx(rt.Fragment,{children:rt.jsxs(FT.Provider,{value:{color:"undefined"},children:[rt.jsxs("div",{className:"sidebar",children:[rt.jsx(Gf,{to:"#",className:"menu-bars",children:rt.jsx(Qnt,{onClick:h})}),rt.jsx(Gf,{to:"/homepage",className:"sidebar-logo-link",children:rt.jsx("img",{className:"sidebar-logo",src:art,alt:"react logo"})}),rt.jsx("li",{className:"side-text",onClick:f,children:rt.jsx(Gf,{to:"#",children:rt.jsx("span",{className:"logout-btn",children:"Logout"})})})]}),rt.jsx("nav",{className:i?"side-menu active":"side-menu",children:rt.jsxs("ul",{className:"side-menu-items",onClick:h,children:[rt.jsx("li",{className:"side-toggle",children:rt.jsx(Gf,{to:"#",className:"menu-bars",children:rt.jsx(rrt,{})})}),srt.map((g,y)=>rt.jsx("li",{className:g.cName,children:rt.jsxs(Gf,{to:g.path,children:[g.icon,rt.jsx("span",{children:g.title})]})},y))]})})]})})}function crt(){return rt.jsxs(dK,{children:[rt.jsx(l3,{children:rt.jsx(Ih,{path:"/",element:rt.jsx(btt,{})})}),rt.jsx(lrt,{}),rt.jsxs(l3,{children:[rt.jsx(Ih,{path:"/homepage",element:rt.jsx(vK,{})}),rt.jsx(Ih,{path:"/mapPage",element:rt.jsx(Vnt,{})}),rt.jsx(Ih,{path:"/account",element:rt.jsx(Gnt,{})}),rt.jsx(Ih,{path:"/create-post",element:rt.jsx(ort,{})})]})]})}s4(document.getElementById("root")).render(rt.jsx(crt,{}));
